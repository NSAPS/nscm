//## Щ煎斜極ID      : ip_01120_Jgc_inventoryPlanAnalysis_list_reg.js//## Щ煎斜極貲      : 濰晦羹 ヶ跡 褐敘蛔煙//## 偃嫦濠          : 檜鬼遵	//## 偃嫦橾濠        : 2015-01-28//##//## 婦溼 job file   : job_sinc_10_inventoryPlanning_03.xml//## 婦溼 query file : query_sinc_10_inventoryPlanning_03.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.1        2015-01-28  檜鬼遵      create//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             瞪羲 滲熱            ----------------------------------------------////var mode;														// WiseGrid 鱔褐 衛 瞪歎 賅萄(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 憮綰葩 ぬ酈雖(class だ橾 唳煎)var job_id = 'ip_01120_Jgc_inventoryPlanAnalysis_list_reg';var GridObj ; 													// WiseGrid 偌羹var color_tot 		 = '234|234|234';			//м啗 塭檣 寡唳儀var color_edit_col   = '255|253|208';var color_sp 		 = '230|222|230'; 			//鏽歲 掘碟摹 寡唳儀var color_select_row = '141|232|141';			//塭檣 摹鷗 寡唳儀 var colBg01 		 = '224|255|224';			//255|255|153var colBg02 	     = '255|255|255';/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 餌檜鍔 褻瞰 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue   = window.innerWidth;            maxHeightValue  = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue    = document.body.clientWidth;            maxHeightValue   = document.body.clientHeight;        }                 var tabHeightValue   = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue   += Number(search_h);             tableHeightValue += Number(search_h);           }                 // 飛 size 蹴模 衛 飛橉 傘鼠 濛嬴 斜葬萄 觼晦陛 擠熱陛 腎賊 縑楝陛 釭嘎煎 斜 唳辦 鼠褻勒 1煎 撮た         // ==> 飛橉 渦檜鼻 蹴模腎雖 彊擠         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                  //tabPage1.style.height = tabHeightValue + "px";         document.WiseGrid.height = tableHeightValue + "px";         //document.WiseGrid2.height = tableHeightValue - document.WiseGrid.height + "px";    }  /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid 螃粽薛お陛 儅撩腎堅 蟾晦音  嫦儅ж朝 							弛  弛JavaScript Event檣 Initialize()蒂 嫡嬴 斜葬萄曖 ④渦蒂 撢たи棻.			弛  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default撲薑 睡碟 (WiseGrid_Property.jsだ橾 頂縑 摹樹腎橫 氈棻.)	setHeader(GridObj);  	//п渦儅撩 	setDefault();        	//飛 晦獄 撲薑 }   /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛 晦獄 撲薑 睡碟.  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function setDefault() { 			GridObj.bUserContextMenu 	 	= true;					//餌辨濠 鐘臢蝶お 詭景曖 餌辨 罹睡蒂 唸薑и棻. 	GridObj.bHDMoving 			 	= true;                	//餌辨濠陛 ④渦蒂 萄楚斜п憮 鏽歲嬪纂蒂 檜翕й熱 橈棻.	GridObj.bHDSwapping 		 	= false;               	//④渦曖 鏽歲嬪纂檜翕 巍爾幗が擊 綠側瘓 и棻.	GridObj.bRowSelectorVisible 	= false;        			//煎辦 撚滓攪蒂 WiseGrid縑憮 獗曹棻,. 		GridObj.strRowBorderStyle   	= "none";         		//煎辦曖 纔舒葬縑 嬴鼠匙紫 釭顫釭雖 彊朝棻.	GridObj.nRowSpacing = 0;                    			//RowSpacing高擊 薑и棻. 	GridObj.strHDClickAction 		= "select";        		//贗葛и 鏽歲曖 撚擊 摹鷗陛棟ж啪 и棻.	GridObj.strActiveRowBgColor 	= "232|245|213";   		//摹鷗脹 ч曖 寡唳儀鼻擊 撲薑и棻.	GridObj.strSelectedCellBgColor 	= '232|232|255'; 		//Drag煎 摹鷗脹 撚曖 寡唳儀鼻擊 滲唳й 熱 氈棻 	    GridObj.bStatusbarVisible 		= false;				// status bar visible		GridObj.bRowSelectorIndex 		= false;						//Row Selector 艙羲縑 Row Index蒂 爾罹遽棻.    GridObj.nHDLineSize         = 10; //Header Size        //④渦曖 塭檣熱蒂 撲薑и棻.     GridObj.nHDLines = 2;          //摹鷗脹 撚曖 旋濠儀 雖薑и棻.	GridObj.strSelectedCellFgColor = '0|0|0';	GridObj.strSelectedCellBgColor = '232|232|255'; //Drag煎 摹鷗脹 撚曖 寡唳儀鼻擊 滲唳й 熱 氈棻	GridObj.strActiveRowBgColor    = "232|245|213";    //摹鷗脹 ч曖 寡唳儀鼻擊 撲薑и棻.	    GridObj.strHDClickAction 	   = "select";        	//贗葛и 鏽歲曖 撚擊 摹鷗陛棟ж啪 и棻.    GridObj.strMouseWheelAction='page';	// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9	GridObj.AddUserContextMenuItem("MENU_CELL","MENU01","Row 蹺陛");        }       /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛п渦儅撩  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/ function setHeader(GridObj) { 		GridObj.AddHeader("SELECTED"			,""   					,"t_checkbox"  ,2		,30  	,true); 	GridObj.AddHeader("DIVISION"	       ,"ぜ掘碟"	   				,"t_combo"     ,100	    ,120    ,true); 	GridObj.AddHeader("DIVISION_HIDDEN"	   ,"ぜ掘碟 鰽"	   			,"t_text"      ,100	    ,0    	,false); 	GridObj.AddHeader("ITEM_ID"	           ,"ヶ跡囀萄"				,"t_text" 	   ,100	    ,85     ,true);     	GridObj.AddHeader("ITEM_NAME"	       ,"ヶ跡貲"	     		 	,"t_text" 	   ,100	    ,220    ,false);  	GridObj.AddHeader("STOCK"	      	   ,"嫦儅營堅"	  		    ,"t_number"    ,100.3	,60     ,true);  	GridObj.AddHeader("EXPIRY_VERSION"	   ,"嶸鱔晦и\n虜晦橾"	    ,"t_date"      ,100.3	,90     ,true);  	GridObj.AddHeader("PROD_TERM"  		   ,"嶸鱔晦и\n唳婁橾熱"		,"t_number"    ,100.3	,70     ,true); 	GridObj.AddHeader("TERM_VAL"  		   ,"嶸鱔晦и"				,"t_number"    ,100.3	,70     ,true);	GridObj.AddHeader("DUE_DATE"	       ,"籀葬晦и"	        	,"t_text" 	   ,100	    ,120    ,true);  	 		GridObj.BoundHeader();		GridObj.SetColCellAlign('DIVISION',         'center'); 	GridObj.SetColCellAlign('ITEM_ID',        	'center'); 	GridObj.SetColCellAlign('ITEM_NAME',        'left'); 	GridObj.SetColCellAlign('DUE_DATE',         'left'); 	GridObj.SetColCellAlign('EXPIRY_VERSION',   'center'); 		GridObj.SetDateFormat('EXPIRY_VERSION','yyyy-MM-dd');        GridObj.SetNumberFormat("STOCK",   		 "###,###.#");  	GridObj.SetNumberFormat("PROD_TERM",     "###,###.#");  	GridObj.SetNumberFormat("TERM_VAL",      "###,###.#");  	GridObj.SetColHDCheckBoxVisible('SELECTED',true,true);		doQuery(); // DB欽縑憮 jgc_division_list 蘭葬蒂 鱔п ぜ 掘碟 巍爾葬蝶お蒂 陛螳螞棻.}    function doQuery()    {       var servlet_url      = Project_name+"/servlet/com.wisegrid.admin."+job_id;              //剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )       GridObj.SetParam("mode",           "set");//       GridObj.SetParam("start_date",   start_date);	   GridObj.DoQuery(servlet_url);          }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid User Context Menu Click Event  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridUserContextMenuClickHandler(strMenuKey, strMenuItemKey, strColumnKey, nRow){			if( strMenuKey == "MENU_CELL" ){// CELL 贗葛衛 詭景				if( strMenuItemKey == "MENU01" ){		// ROW 蹺陛					insertRow( nRow );						}		else {			alert("襄營 ж雖 彊擎 詭景殮棲棻.");		}			}}function insertRow( nRow ){		var rowCnt = GridObj.GetRowCount();		if( rowCnt-1 == nRow ){ // 葆濠虞 塭檣橾 唳辦 		GridObj.InsertRow(-1);	}else{		GridObj.InsertRow(nRow+1);	}		GridObj.SetCellValue("DIVISION"             , nRow+1, GridObj.GetCellValue("DIVISION"          , nRow));	GridObj.SetCellValue("DIVISION_HIDDEN"      , nRow+1, GridObj.GetCellValue("DIVISION_HIDDEN"   , nRow));	GridObj.SetCellValue("ITEM_ID"             	, nRow+1, GridObj.GetCellValue("ITEM_ID"           , nRow));	GridObj.SetCellValue("ITEM_NAME"      		, nRow+1, GridObj.GetCellValue("ITEM_NAME"         , nRow));	GridObj.SetCellValue("DUE_DATE"   			, nRow+1, GridObj.GetCellValue("DUE_DATE"          , nRow));	GridObj.SetCellValue("EXPIRY_VERSION"   	, nRow+1, GridObj.GetCellValue("EXPIRY_VERSION"    , nRow));	GridObj.SetCellValue("STOCK"   				, nRow+1, GridObj.GetCellValue("STOCK"             , nRow));	GridObj.SetCellValue("PROD_TERM"           	, nRow+1, GridObj.GetCellValue("PROD_TERM"         , nRow));	GridObj.SetCellValue("TERM_VAL"           	, nRow+1, GridObj.GetCellValue("TERM_VAL"         , nRow));}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛等檜攪 褻萼 薑鼻瞳戲煎 諫猿腎賊 嫦儅腎朝 Event縑 渠и Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/    function GridEndQuery()     {    	        var endMode = GridObj.GetParam("mode");        var error_msg = '';                  if(endMode == "set") //褻萼 諫猿脹 唳辦        {            if(GridObj.GetStatus() == "true")             {                    	GridObj.AddRow();            	            } else                {                 error_msg = GridObj.GetMessage();                 alert(error_msg);            			}        }	        else if( endMode =="save"){            	            	if(GridObj.GetStatus() == "true"){            		doQuery();            	}            }     		    }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 錳 贗葛 檜漸お  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GoSave(service) {		//var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;    	//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )		var GridObj = document.WiseGrid;		mode = "save";		doSave();		};      // 盪濰function doSave() {		var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;		var cnfm_date	= document.frm.cnfm_date.value;		//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.all._user_id.value);	GridObj.SetParam("cnfm_date", cnfm_date);		//WiseGrid檜 憮幗諦 鱔褐衛縑 等檜攪蒂 瞪殖ж朝 詭憮萄殮棲棻. 鱔褐檜 撩奢ж賊 true蒂 奩納桭炴.		GridObj.DoQuery(servlet_url, "SELECTED");	 	return;}    // 陳瞼 匐儀 POP BTN mouseOverfunction overBtn( objBtn ) {	clickedDateIdx = objBtn.parentNode.parentNode.parentNode.rowIndex;	}// 陳瞼 匐儀 POP BTN mouseOutfunction outBtn( objBtn ) {	clickedDateIdx = null;	}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 錳 贗葛 檜漸お  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridCellClick(strColumnKey, nRow) {}		function GridChangeCell(strColumnKey, nRow, vtOldValue, vtNewValue){			if (strColumnKey == "ITEM_ID")		{			var item_id = vtNewValue;					commonUtil.getSelQeury( "item_id", item_id, "ip_01120_Jgc_inventoryPlanAnalysis_list_reg_item_name",{			callback:function(result){												GridObj.SetCellValue("ITEM_NAME"   , nRow, result);								 	 }								   })		}		if (strColumnKey == "EXPIRY_VERSION"){				var item_id = GridObj.GetCellValue("ITEM_ID",nRow);						commonUtil.getSelQeury( "item_id!%!expiry_version", item_id+"!%!"+vtNewValue, "ip_01120_Jgc_inventoryPlanAnalysis_list_reg_term_val",{			callback:function(result){												GridObj.SetCellValue("PROD_TERM"   , nRow, result[0][0]);									GridObj.SetCellValue("TERM_VAL"    , nRow, result[0][1]);								 	 }						});	}	}function ChangeCombo(strColumnKey, nRow, nOldIndex, nNewIndex){		if (strColumnKey == "DIVISION"){		GridObj.SetCellValue("DIVISION_HIDDEN" , nRow, GridObj.GetCellHiddenValue('DIVISION',nRow));				}}