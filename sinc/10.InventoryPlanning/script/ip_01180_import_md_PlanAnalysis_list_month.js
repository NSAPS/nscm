//## 프로그램ID      : ip_01180_import_md_PlanAnalysis_list_month.js
//## 프로그램명       : 수입 상품 발주 관리(월)
//## 변경자           : 이강욱
//## 개발일자         : 2016-01-11 
//## 관련 job file   : job_sinc_10_inventoryPlanning_07.xml
//## 관련 query file : query_sinc_10_inventoryPlanning_07.xml
//##
//## REVISIONS
//## VER        DATE        AUTHOR    DESCRIPTION
//## ---------  ----------  --------  ------------------------------------
//## 1.1        2015-03-18  이강욱      CREATE  
//############################################################
/************************************************************************************************************************************/
/**********************************************  WiseGrid Java Script   *************************************************************/
/************************************************************************************************************************************/

//-----------------------------------------             전역 변수            ----------------------------------------------//
//var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)
var class_path = "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)
var job_id = 'ip_01180_import_md_PlanAnalysis_list_month';

var GridObj ; 													// WiseGrid 객체
var color_tot 		 = '234|234|234';			//합계 라인 배경색
var color_edit_col   = '255|253|208';
var color_sp 		 = '230|222|230'; 			//컬럼 구분선 배경색
var color_select_row = '141|232|141';			//라인 선택 배경색 
var colBg01 		 = '224|255|224';			//255|255|153
var colBg02 	     = '255|255|255';


/*┌──────────────────────────────────┐
  │그리드의 사이즈 조절 Fnc
  └──────────────────────────────────┘*/
    function setGridAutoResize( tab_h, table_h ){
        
        var maxWidthValue;
        var maxHeightValue;
        
        if (document.layers) {
            //Nescape
            maxWidthValue   = window.innerWidth;
            maxHeightValue  = window.innerHeight;
        }
        if (document.all) {
            //explore
            maxWidthValue    = document.body.clientWidth;
            maxHeightValue   = document.body.clientHeight;
        } 
        
        var tabHeightValue   = Number(maxHeightValue) - Number(tab_h) ; 
        var tableHeightValue = Number(maxHeightValue) - Number(table_h) ; 
        
        var search_h = document.frm.search_h.value; 
        if( search_menu.style.display == "none" ) 
        { 
            tabHeightValue   += Number(search_h); 
            tableHeightValue += Number(search_h);   
        } 
        
        // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅 
        // ==> 화면이 더이상 축소되지 않음 
        if( tabHeightValue < 1 ) 
            tabHeightValue = 1; 
        if( tableHeightValue < 1 ) 
            tableHeightValue = 1;
          
        //tabPage1.style.height = tabHeightValue + "px"; 

        document.WiseGrid.height = tableHeightValue + "px"; 
        //document.WiseGrid2.height = tableHeightValue - document.WiseGrid.height + "px";
    }  

/*┌─────────────────────────────────────────────────────────────────────┐
  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│
  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│
  └─────────────────────────────────────────────────────────────────────┘*/
function init() { 
	
	GridObj = document.WiseGrid;
	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)
	setHeader(GridObj);  	//해더생성 
	setDefault();        	//화면 기본 설정 
}   
/*┌──────────────────────────────────┐
  │화면 기본 설정 부분.
  └──────────────────────────────────┘*/
function setDefault() { 
	
	GridObj.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.

    GridObj.nHDLineSize         = 10; //Header Size
    //GridObj.bHDMoving = true;		// 컬럼 헤더 위치 이동
    
    //헤더의 라인수를 설정한다. 
    GridObj.nHDLines = 2;   
   
    //선택된 셀의 글자색 지정한다.
	GridObj.strSelectedCellFgColor = '0|0|0';
	GridObj.strSelectedCellBgColor = '232|232|255'; 	//Drag로 선택된 셀의 배경색상을 변경할 수 있다
	GridObj.strActiveRowBgColor    = "232|245|213";     //선택된 행의 배경색상을 설정한다.	
    GridObj.strHDClickAction 	   = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.
    GridObj.strMouseWheelAction='page';

	// Cell Font Setting
	GridObj.nCellFontSize = 9;					// Font Size 9
       
}
       
/*┌──────────────────────────────────┐
  │해더생성
  └──────────────────────────────────┘*/ 
function setHeader(GridObj) {       
	
	
	var cnfm_date = document.all.cnfm_date.value;

	commonUtil.getSelQeury( "cnfm_date", cnfm_date, "ip_01180_import_md_PlanAnalysis_list_header",{
	callback:function(result){

	  	//GridObj.AddHeader("CRUD"		   	  ,"CRUD"   			,"t_text"  	   ,100		,0  	,false); //0
	  	GridObj.AddHeader("SALES_CAT05"	      ,"대분류"	    		,"t_text"      ,100	    ,0     ,false); //0
		GridObj.AddHeader("SALES_CAT03"	      ,"소분류"	    		,"t_text"      ,100	    ,100     ,false); //0
		GridObj.AddHeader("ITEM_ID"	          ,"품목코드"			,"t_text" 	   ,100	    ,70     ,false); //0   
	 	GridObj.AddHeader("ITEM_NAME"	      ,"품목명"	        	,"t_text" 	   ,100	    ,180    ,false); //0
	 	
	 	//GridObj.AddHeader("AVL_STOCK"	      ,"총가용재고"		,"t_number"    ,100.3	,70     ,false); //0 	
	 	//GridObj.AddHeader("NS_STOCK"	      ,"기초재고"	 	,"t_number"    ,100.3	,70     ,false); //0
	 	//GridObj.AddHeader("EXP_STOCK"	      ,"사외재고"   		,"t_number"    ,100.3	,70     ,false); //0
	 	GridObj.AddHeader("GUBN"  		      ,"구분"				,"t_text"      ,100		,80     ,false); //0
	 	GridObj.AddHeader("GUBN_IDX"  		  ,"구분순서"			,"t_text"      ,100		,0      ,false); //0
	 	GridObj.AddHeader("NO_FLAG"  		  ,"제품구분"			,"t_text"      ,100		,0      ,false); //0
	 	GridObj.AddHeader("THREE_MON"  		  ,"3개월평균"			,"t_text"      ,100		,00      ,false); //0
	 	GridObj.AddHeader("BOX_CUM"  		  ,"누계"				,"t_number"    ,100.3	,60      ,false); //0		
 

			for(var i=0 ; i < 12 ; i++){  
				if(i < result.length) {
					GridObj.AddHeader(result[i][1]	,result[i][0]       	,"t_number" ,100.3	,60  	,true);    
				} 	
				else {
					j = strToNum(i)+strToNum(1);
					if(i < 12) { //11
						GridObj.AddHeader(result[i][1]	,result[i][0]     	,"t_number" ,100.3	,60  	,true);
					}
					else {
						GridObj.AddHeader(result[i][1]	,result[i][0]       ,"t_number" ,100.3	,60 	,true);
					}
				}
			}
		GridObj.AddHeader("TP_FLAG"	       	  ,"타임펜스"   			,"t_number"    ,100.3	,70     ,false); //0	
		GridObj.AddHeader("TIMEFANCE_SORT"	  ,"TIMEFANCE_SORT"   	,"t_number"    ,100.3	,70     ,false); //0
		GridObj.BoundHeader();
		
		//GridObj.SetNumberFormat("AVL_STOCK",       	"###,###.#");
	    //GridObj.SetNumberFormat("NS_STOCK",     	"###,###.#");
	    //GridObj.SetNumberFormat("EXP_STOCK",        "###,###.#");
	    GridObj.SetNumberFormat("BOX_CUM",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_12",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_11",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_10",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_9",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_8",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_7",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_6",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_5",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_4",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_3",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_2",       	"###,###.#");
	    GridObj.SetNumberFormat("MONTH_1",       	"###,###.#");
	   
	    
	    GridObj.SetColFix('ITEM_NAME'); 
		GridObj.SetColCellAlign('SALES_CAT05',        'left');
		GridObj.SetColCellAlign('SALES_CAT03',        'left');
	    GridObj.SetColCellAlign('ITEM_ID',            'left');
	  	GridObj.SetColCellAlign('ITEM_NAME',          'left');
	    
	    //과거 6개월
	    GridObj.SetColCellBgColor('MONTH_12','255|253|208');
	    GridObj.SetColCellBgColor('MONTH_11','255|253|208');
	    GridObj.SetColCellBgColor('MONTH_10','255|253|208');
	    GridObj.SetColCellBgColor('MONTH_9','255|253|208');
	    GridObj.SetColCellBgColor('MONTH_8','255|253|208');
	    GridObj.SetColCellBgColor('MONTH_7','255|253|208');
		//GridObj.SetColHide("CRUD", true); 
		//GridObj.SetCRUDMode("CRUD"); 			
		
		}
		
	});
 	
 	
}	

/*┌──────────────────────────────────┐
  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc
  └──────────────────────────────────┘*/
    function GridEndQuery() 
    {
    	
        var endMode = GridObj.GetParam("mode");
        var error_msg = '';
          
        if(endMode == "search") //조회가 완료된 경우
        {
            if(GridObj.GetStatus() == "true") 
            {        
            	
            	var row = GridObj.GetRowCount();            	
            	if (row == 0) return;
            	
            	GridSetMerge(); 
//            	SetThreeMonth();            	
            	GridSetStock();
            	SetTimeFence();
            	CheckStock(); 
            	CalBoxCum();           	           	
             
            } else    
            { 
                error_msg = GridObj.GetMessage(); 
                alert(error_msg);            
			}
        }	
		
    }


/*┌──────────────────────────────────┐
  │그리드의 원 클릭 이벤트
  └──────────────────────────────────┘*/
               
/*┌──────────────────────────────────┐
  │화면에 '조회'를 누르면 호출 Fnc
  └──────────────────────────────────┘*/
   function GoSearch(service) 
   {
   
   	var search_type = document.frm.search_type.value;
  
//	if( search_type == "" || search_type == null || search_type == 00 ) {
//		alert("브랜드 유형을 선택하십시요!");
//		return;
//	}   	
   	
   	
    doQuery();
   }




/*┌──────────────────────────────────┐
  │DW 1 조회 쿼리를 호출 Fnc
  └──────────────────────────────────┘*/
   function doQuery() 
   {
       var cnfm_date	    = document.all.cnfm_date.value;      
       cnfm_date 			= cnfm_date.replace(/-/g,"");
     
	   var user_id			= document.all._user_id.value;         
       var search_type	    = document.all.search_type.value;		//브랜드 유형
       var sales_cat05		= document.all.sales_cat05.value;
       //var search_item		= document.all.search_item.value;       //검색어
       var servlet_url      = Project_name+"/servlet/com.wisegrid.admin."+job_id;
       
       //넘겨줄 값들을만든다.( 파라미터 정의 부분 )
       GridObj.SetParam("mode",           	"search");
       GridObj.SetParam("cnfm_date",  		cnfm_date);
       GridObj.SetParam("user_id",       	user_id);
       GridObj.SetParam("search_type",  	search_type);	
       GridObj.SetParam("sales_cat05",  	sales_cat05);	
	   //GridObj.SetParam("search_item",  	search_item);	   
	   GridObj.DoQuery(servlet_url);       
   }

/*┌──────────────────────────────────┐
  │DW 2 조회 쿼리를 호출 Fnc
  └──────────────────────────────────┘*/
	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )

// 셀 저장 전역변수
var objTdG;


// 날짜 검색 POP BTN mouseOver
function overBtn( objBtn ) {
	clickedDateIdx = objBtn.parentNode.parentNode.parentNode.rowIndex;	
}

// 날짜 검색 POP BTN mouseOut
function outBtn( objBtn ) {
	clickedDateIdx = null;	
}

/*┌──────────────────────────────────┐
  │그리드의 원 클릭 이벤트
  └──────────────────────────────────┘*/
function GridCellClick(strColumnKey, nRow) {

}		

function GridCellDblClick(strColumnKey, nRow){
	
	var user_id		= document.all._user_id.value; 
	var item_id		= GridObj.GetCellValue('ITEM_ID',nRow)
	var	item_name	= GridObj.GetCellValue('ITEM_NAME',nRow)
	var cnfm_date	= document.frm.cnfm_date.value;
	var no_flag		= GridObj.GetCellValue('NO_FLAG',nRow);	
	var three_mon   = GridObj.GetCellValue('THREE_MON',nRow);	
	
	var service_url = "service.do?_moon_service=ip_01130_import_md_PlanAnalysis_list_pop";
		service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&cnfm_date=" + cnfm_date + "&no_flag=" + no_flag + "&three_mon=" + three_mon + "&user_id=" + user_id;
	var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=yes, resizable=yes, width=1135, height=740, top=50, left=200";
	var newWin = window.open(service_url, "", pop_win_style);
		newWin.focus();			
	
}

function HeaderClick(strColumnKey){
	
}

function GridChangeCell(strColumnKey, nRow, vtOldValue, vtNewValue){
	
//	if(strColumnKey == 'WEEK_0'){
//		
//		var start_hd_name	= 'WEEK_0';
//		var hd_name 		= start_hd_name;
//		var hd_name_1 		= start_hd_name.substr(0,5);
//		var hd_name_2 		= start_hd_name.substr(5,6);
//		
//			for(var i=0; i<26; i++){
//				
//				hd_name_2 = Number(hd_name_2)+Number(1);						
//				hd_name = hd_name_1+hd_name_2;
//			
//				GridObj.SetCellValue(hd_name, nRow,  vtNewValue);
//			}
//		
//	}
	
	GridSetStock();
	
	CheckStock();
}	

/*재고 흐름전개 Default*/
function GridSetStock(){
	
	var cur_stock;
	var reciept_expt;
	var sales_expt;
	var next_stock;	
	
	var rowcount = GridObj.GetMergeCount('ITEM_ID');   //소계 인덱스 구하기
	for (var i=0; i<rowcount; i++){
		
		var start_hd_name	= 'MONTH_6';
		var hd_name 		= start_hd_name;
		var hd_name_1 		= start_hd_name.substr(0,6);
		var hd_name_2 		= start_hd_name.substr(6,7);		
		
		var idx				= GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false);	
		
		for(var j =0; j < 5; j++){
			
			cur_stock 		= GridObj.GetCellValue(hd_name,idx);
			reciept_expt 	= GridObj.GetCellValue(hd_name,idx+1);
			sales_expt		= GridObj.GetCellValue(hd_name,idx+2);
			
			
			next_stock		= Number(cur_stock) + Number(reciept_expt) - Number(sales_expt);
			
			hd_name_2 	= Number(hd_name_2)-Number(1);						
			hd_name 	= hd_name_1+hd_name_2;
			
			GridObj.SetCellValue(hd_name, idx,  next_stock);
			
		}			
	}		
}

/*신제품 3개월 평균 전개*/
function SetThreeMonth(){
	
	var rowcount = GridObj.GetRowCount();
	
	
	var date = new Date();	
	var remain_day = Number(8) - date.getDay();	
	
	for(var i=0; i<rowcount; i++){
		
		var flag = GridObj.GetCellValue('NO_FLAG',i);
		if(flag == "NEW") {
			
			GridObj.SetCellBgColor('GUBN', i , '212|244|250');
			GridObj.SetCellValue('GUBN',i,'3개월 주평균');
			for(var j=1; j<13; j++){
			
				hd_name = 'MONTH_' + j ;
				if(GridObj.GetCellValue(hd_name,i)==0){
					
					if(hd_name == 'MONTH_1') GridObj.SetCellValue(hd_name,i,Math.round(GridObj.GetCellValue('THREE_MON',i)/Number(7) * remain_day ,0));
					else GridObj.SetCellValue(hd_name,i,GridObj.GetCellValue('THREE_MON',i));
					
				}
			
			}
		}
	}
	
	var mergecount = GridObj.GetMergeCount('ITEM_ID');   //소계 인덱스 구하기
	
    for (var i=0; i<mergecount; i++){
     	
     	var no_flag = GridObj.GetCellValue('NO_FLAG',GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false)+Number(2));		//각 Merge 단의 첫 번째 Row 값을 받아온다.
     	GridObj.SetCellValue('NO_FLAG',GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false),no_flag);
     	GridObj.SetCellValue('NO_FLAG',GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false)+Number(1),no_flag);
     	
     	var no_flag = GridObj.GetCellValue('THREE_MON',GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false)+Number(2));		//각 Merge 단의 첫 번째 Row 값을 받아온다.
     	GridObj.SetCellValue('THREE_MON',GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false),no_flag);
     	GridObj.SetCellValue('THREE_MON',GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false)+Number(1),no_flag);
     
      	   
     }
     
     
}

/*타임펜스 전개*/
/*전월 판매량 기준 타임펜스 앞당긴다 */
function SetTimeFence(){		
	
	var hd_name ;
	var fence ;
	var rowcount	= GridObj.GetRowCount();
	
	for(var i =0; i < rowcount; i++){
		fence		= GridObj.GetCellValue('TP_FLAG',i);
		
		
		for(var j=fence; j>0; j--){
			
			hd_name		= 'MONTH_'+j;				
			GridObj.SetCellBgColor(hd_name,i,'255|255|0');
		}
					
	}
	
}

function CheckStock(){
	
	var rowcount = GridObj.GetRowCount();
	
	
	for( var j =0; 3*j < rowcount; j++){
			
			for (var i =0; i < 6; i++){
				
					var hd_name = 'MONTH_'+ (Number(6) - Number(i)) ;
					var stock 	 = GridObj.GetCellValue(hd_name, j * 3);
					var tp_flag  = GridObj.GetCellValue('TP_FLAG',j * 3);
					if (stock < 0) {
						
							if ( i < tp_flag) {
								GridObj.SetCellBgColor(hd_name, j * 3 , '255|54|54');
								GridObj.SetCellBgColor('ITEM_ID', j * 3 , '255|54|54');
								
								GridObj.SetCellValue('TIMEFANCE_SORT', j * 3 , tp_flag - i );
								GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+1 , tp_flag - i );	
								GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+2 , tp_flag - i );							
								
							}
							else{
								
								GridObj.SetCellValue('TIMEFANCE_SORT', j * 3 ,  tp_flag - i );
								GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+1 ,  tp_flag - i );	
								GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+2 ,  tp_flag - i );	
							}		
						break;
								
					}
					GridObj.SetCellValue('TIMEFANCE_SORT', j * 3 ,  -99 );
								GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+1 ,  -99 );	
								GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+2 ,  -99 );	
			}	
	}
	
	
	
}

function CheckStock2(){
	
	var rowcount = GridObj.GetRowCount();
	
	
	for( var j =0; 3*j < rowcount; j++){
			
			for (var i =0; i < 6; i++){
				
					var hd_name = 'MONTH_'+ (Number(6) - Number(i)) ;
					
					var stock 	 = GridObj.GetCellValue(hd_name, j * 3);
					var tp_flag  = GridObj.GetCellValue('TP_FLAG',j * 3);
					if (stock < 0) {
						
						
								GridObj.SetCellBgColor(hd_name, j * 3 , '255|54|54');
								GridObj.SetCellBgColor('ITEM_ID', j * 3 , '255|54|54');
						break;
								
					}
					GridObj.SetCellValue('TIMEFANCE_SORT', j * 3 ,  -99 );
					GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+1 ,  -99 );	
					GridObj.SetCellValue('TIMEFANCE_SORT', (j * 3)+2 ,  -99 );	
			}	
	}
	
	
	
}

function sort(){
	
	GridObj.ClearGroupMerge();
	GridObj.SetColCellSort('TIMEFANCE_SORT','descending');
	GridSetMerge();
}

function GridSetMerge(){

	
	GridObj.SetGroupMerge('SALES_CAT03,ITEM_ID,ITEM_NAME');
    GridObj.AddSummaryBar('SUMMARY1', '소계', 'ITEM_ID', 'sum', ''); 
    GridObj.AddSummaryBar('SUMMARY2', '합계', 'summaryall', 'sum', '');      

       
	GridObj.SetSummaryBarColor('SUMMARY1', '0|153|0', color_tot);    	 		
	GridObj.SetSummaryBarColor('SUMMARY2', '0|153|0', '152|251|152');
}


function CalBoxCum(){
	
	var rowcount = GridObj.GetMergeCount('ITEM_ID'); 
	
	for (var i =0; i < rowcount; i ++){		
		
		var start_hd_name	= 'MONTH_12';
		var hd_name 		= start_hd_name;
		var hd_name_1 		= start_hd_name.substr(0,6);
		var hd_name_2 		= start_hd_name.substr(6,7);
		
		var idx				= GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false);
		var box_cum			= 0;
		
		
		for(var j =0; j < 12; j++){
			
			cur_stock 		= GridObj.GetCellValue(hd_name,idx);
			reciept_expt 	= GridObj.GetCellValue(hd_name,idx+1);
			sales_expt		= GridObj.GetCellValue(hd_name,idx+2);
			
			box_cum	+= Number(sales_expt);
			
			hd_name_2 	= Number(hd_name_2)-Number(1);						
			hd_name 	= hd_name_1+hd_name_2;
			
			
			
		}			
		GridObj.SetCellValue('BOX_CUM', idx+2,  box_cum);
	}
	
}

function SafeStock(){	
	
	var rowcount = GridObj.GetMergeCount('ITEM_ID');   //소계 인덱스 구하기
	for (var i=0; i<rowcount; i++){
		
		var start_hd_name	= 'MONTH_6';
		var pre_hd_name		= 'MONTH_7';
		var idx				= GridObj.GetRowIndexFromMergeIndex('ITEM_ID',i,false);	
		
	
			
			pre_sales		= GridObj.GetCellValue(pre_hd_name,idx+2);
			cur_stock 		= GridObj.GetCellValue(start_hd_name,idx);
			reciept_expt 	= GridObj.GetCellValue(start_hd_name,idx+1);
			sales_expt		= GridObj.GetCellValue(start_hd_name,idx+2);
			
			
			GridObj.SetCellValue(start_hd_name, idx,	cur_stock -   pre_sales);
			
			
	}
	
	GridSetStock();
	//SetTimeFence();
	CheckStock(); 
	
	
}

function changeValue(obj){
	
	var sales_cat05 = obj.value;
	var search_type = document.frm.search_type.options;
	

	
	
	commonUtil.getSelQeury( "sales_cat05", sales_cat05, "ip_01130_import_md_PlanAnalysis_list_combo",{
	callback:function(result){
			
			//옵션 지우기 현재 select option 갯수만큼
			for(var i = search_type.length-1 ; i >=1 ; i--){
		
		   		search_type.options[i] =null;
		  	}
			
			//옵션 채우기 result 갯수만큼만
			for(var i=0; i<result.length ; i++) {
	 
	   		search_type.options[i+1] = new Option(result[i][1],result[i][0]);
	  		}
			
				
		
		}
		
	});
	
	
}

