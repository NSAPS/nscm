//############################################################//## 프로그램ID      : ip_02120_Edi_NS_Analysis.vm//## 프로그램명      : 유통본부 미납추적 분석(농심)//## 개발자          : 남웅용//## 개발일자        : 2015-01-30//##//## 관련 job file   : job_sinc_10_inventoryPlanning_07.xml//## 관련 query file : query_sinc_10_inventoryPlanning_07.xml//##        //## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.0        2015-01-30  남웅용      create   //##//############################################################ /************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             전역 변수            ----------------------------------------------////var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)var job_id = 'ip_02120_Edi_NS_Analysis';var GridObj ; 													// WiseGrid 객체var GridObj2;var GridObj3;var GridObj4;var GridObj5;var sel_item_id;var sel_item_name;var color_tot = '234|234|234';			//합계 라인 배경색var color_edit_col = '255|253|208';var color_sp = '230|222|230'; 			//컬럼 구분선 배경색var color_select_row = '232|232|255';	//라인 선택 배경색var colBg01 = '224|255|224';			//255|255|153var colBg02 = '255|255|255';/*┌──────────────────────────────────┐  │그리드의 사이즈 조절 Fnc  └──────────────────────────────────┘*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅         // ==> 화면이 더이상 축소되지 않음         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         //document.WiseGrid.height = tableHeightValue + "px";         document.WiseGrid2.height = tableHeightValue - document.WiseGrid.height - document.WiseGrid3.height - document.WiseGrid4.height - document.WiseGrid5.height+ "px";        //document.WiseGrid3.height = tableHeightValue - document.WiseGrid.height - document.WiseGrid2.heigh + "px";             }  /*┌─────────────────────────────────────────────────────────────────────┐  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│  └─────────────────────────────────────────────────────────────────────┘*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader(GridObj);  	//해더생성 	setDefault();        	//화면 기본 설정 }   function init2() {	GridObj2 = document.WiseGrid2;	setProperty(GridObj2);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader2(GridObj2);  	//해더생성 	setDefault2();        	//화면 기본 설정 }   function init3() {	GridObj3 = document.WiseGrid3;	setProperty(GridObj3);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader3(GridObj3);  	//해더생성 	setDefault3();        	//화면 기본 설정 }function init4() {	GridObj4 = document.WiseGrid4;	setProperty(GridObj4);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader4(GridObj4);  	//해더생성 	setDefault4();        	//화면 기본 설정 }   function init5() {	GridObj5 = document.WiseGrid5;	setProperty(GridObj5);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader5(GridObj5);  	//해더생성 	setDefault5();        	//화면 기본 설정 }         /*┌──────────────────────────────────┐  │화면 기본 설정 부분.  └──────────────────────────────────┘*/function setDefault() { 	GridObj.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj.nHDLineSize         = 10; //Header Size    GridObj.nHDLines = 2;       GridObj.strSelectedCellFgColor = '180|82|205';    GridObj.strActiveRowBgColor = color_select_row;    //선택된 행의 배경색상을 설정한다. 	GridObj.strHDClickAction    = "sortsingle";       GridObj.strMouseWheelAction='page';    GridObj.nCellFontSize = 9;					// Font Size 9       }function setDefault2() { 	GridObj2.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj2.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj2.nHDLineSize         = 12; //Header Size    GidObj2.strSelectedCellFgColor = '180|82|205';    GridObj2.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj2.nCellFontSize = 9;					// Font Size 9	}function setDefault3() { 	GridObj3.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj3.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj3.nHDLineSize         = 13; //Header Size    GridObj3.nHDLines = 2;            GridObj3.strSelectedCellFgColor = '180|82|205';    GridObj3.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj3.nCellFontSize = 9;					// Font Size 9}function setDefault4() {  	GridObj4.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj4.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj4.nHDLineSize         = 12; //Header Size    GridObj4.strSelectedCellFgColor = '180|82|205';    GridObj4.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj4.nCellFontSize = 9;					// Font Size 9	}function setDefault5() {  	GridObj5.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj5.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj5.nHDLineSize         = 10; //Header Size    GridObj5.nHDLines = 2;       GridObj5.strSelectedCellFgColor = '180|82|205';    GridObj5.strActiveRowBgColor = color_select_row;    //선택된 행의 배경색상을 설정한다.	GridObj5.strHDClickAction    = "sortsingle";       GridObj5.strMouseWheelAction='page';    GridObj5.nCellFontSize = 9;					// Font Size 9	}       /*┌──────────────────────────────────┐  │해더생성  └──────────────────────────────────┘*/ function setHeader(GridObj) {        	GridObj.AddHeader("CRUD"			,"CRUD"       	,"t_text" 	,100    ,60  ,false);  	GridObj.AddHeader("CNFM_DATE"		,"작업일"			,"t_text"	,20		,54  ,false); //0    	GridObj.AddHeader("SELL_STOP_FLAG"	,"판매\n중지"		,"t_text" 	,100	,33 ,false); //0    	GridObj.AddHeader("ALLOC_FLAG"		,"공급할당\n여부"	,"t_text" 	,100	,33  ,false); //0 	GridObj.AddHeader("JEJU_FLAG"		,"제주배정\n여부"	,"t_text" 	,100	,33  ,false); //0 	GridObj.AddHeader("ITEM_ID"			,"품목코드"		,"t_text"	,100	,65 ,false); //0 	GridObj.AddHeader("ITEM_NAME"		,"품목명"			,"t_text" 	,100	,180 ,false); //0     	GridObj.AddHeader("CUST_CODE"		,"거래처코드"		,"t_text" 	,100	,0  ,false); //0    	GridObj.AddHeader("CUST_NAME"		,"거래처명"		,"t_text" 	,160	,230  ,false); //0 	GridObj.AddHeader("EDI_BOX"			,"발주량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj.AddHeader("SELL_BOX"		,"판매량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj.AddHeader("HS_BOX"			,"회송량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj.AddHeader("DEFAULT_BOX"		,"미납량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj.AddHeader("DEFAULT_CODE_NS"	,"사유명"     	,"t_combo" 	,100	,150  ,true); //0 	GridObj.AddHeader("DC_ID"			,"배송지점코드"	,"t_text" 	,100	,0  ,false); //0       	GridObj.AddHeader("DC_NAME"			,"배송지점"		,"t_text" 	,100	,100  ,false); //0    	GridObj.AddHeader("DEPT_CODE"		,"영업지점코드"	,"t_text" 	,100	,0  ,false); //0    	GridObj.AddHeader("DEPT_NAME"		,"영업지점"		,"t_text" 	,100	,100  ,false); //0    	GridObj.AddHeader("HAN_NAME"		,"담당자"			,"t_text" 	,100	,50  ,false); //0 	GridObj.AddHeader("BIGO"			,"비고"			,"t_text" 	,100	,200  ,true); //0   	GridObj.BoundHeader();	    GridObj.SetColCellAlign('CNFM_DATE','center');     GridObj.SetColCellAlign('SELL_STOP_FLAG','center');     GridObj.SetColCellAlign('ALLOC_FLAG','center');     GridObj.SetColCellAlign('JEJU_FLAG','center');     GridObj.SetColCellAlign('ITEM_ID','center');      GridObj.SetColCellAlign('DC_NAME','center');    GridObj.SetColCellAlign('DEPT_NAME','center');    GridObj.SetColCellAlign('HAN_NAME','center');     GridObj.SetColCellAlign('BIGO','left'); 	//GridObj.SetColFix('ITEM_NAME');	GridObj.SetColCellBgColor('DEFAULT_CODE_NS',color_edit_col);		GridObj.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	//Hidden 컬럼	GridObj.SetColHide("CRUD",true);}function setHeader5(GridObj5) {        	GridObj5.AddHeader("CRUD"			,"CRUD"       	,"t_text" 	,100    ,60  ,false);  	GridObj5.AddHeader("CNFM_DATE"		,"작업일"			,"t_text"	,20		,54  ,false); //0    	GridObj5.AddHeader("SELL_STOP_FLAG"	,"판매\n중지"		,"t_text" 	,100	,33 ,false); //0    	GridObj5.AddHeader("ALLOC_FLAG"		,"공급할당\n여부"	,"t_text" 	,100	,33  ,false); //0 	GridObj5.AddHeader("JEJU_FLAG"		,"제주배정\n여부"	,"t_text" 	,100	,33  ,false); //0 	GridObj5.AddHeader("ITEM_ID"			,"품목코드"		,"t_text"	,100	,65 ,false); //0 	GridObj5.AddHeader("ITEM_NAME"		,"품목명"			,"t_text" 	,100	,180 ,false); //0     	GridObj5.AddHeader("CUST_CODE"		,"거래처코드"		,"t_text" 	,100	,0  ,false); //0    	GridObj5.AddHeader("CUST_NAME"		,"거래처명"		,"t_text" 	,160	,230  ,false); //0 	GridObj5.AddHeader("EDI_BOX"			,"발주량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj5.AddHeader("SELL_BOX"		,"판매량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj5.AddHeader("HS_BOX"			,"회송량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj5.AddHeader("DEFAULT_BOX"		,"미납량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj5.AddHeader("DEFAULT_CODE_NS"	,"사유명"     	,"t_combo" 	,100	,150  ,true); //0 	GridObj5.AddHeader("DC_ID"			,"배송지점코드"	,"t_text" 	,100	,0  ,false); //0       	GridObj5.AddHeader("DC_NAME"			,"배송지점"		,"t_text" 	,100	,100  ,false); //0    	GridObj5.AddHeader("DEPT_CODE"		,"영업지점코드"	,"t_text" 	,100	,0  ,false); //0    	GridObj5.AddHeader("DEPT_NAME"		,"영업지점"		,"t_text" 	,100	,100  ,false); //0    	GridObj5.AddHeader("HAN_NAME"		,"담당자"			,"t_text" 	,100	,50  ,false); //0 	GridObj5.AddHeader("BIGO"			,"비고"			,"t_text" 	,100	,200  ,true); //0  	GridObj5.BoundHeader();	    GridObj5.SetColCellAlign('CNFM_DATE','center');     GridObj5.SetColCellAlign('SELL_STOP_FLAG','center');     GridObj5.SetColCellAlign('ALLOC_FLAG','center');     GridObj5.SetColCellAlign('JEJU_FLAG','center');     GridObj5.SetColCellAlign('ITEM_ID','center');      GridObj5.SetColCellAlign('DC_NAME','center');    GridObj5.SetColCellAlign('DEPT_NAME','center');    GridObj5.SetColCellAlign('HAN_NAME','center');     GridObj5.SetColCellAlign('BIGO','left'); 	//GridObj5.SetColFix('ITEM_NAME');	GridObj5.SetColCellBgColor('DEFAULT_CODE_NS',color_edit_col);		GridObj5.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	//Hidden 컬럼	GridObj5.SetColHide("CRUD",true);}/*┌──────────────────────────────────┐  │WiseGrid Change Combo Event  └──────────────────────────────────┘*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){	}function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {  }function Grid3ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {}   function setHeader2(GridObj2) { // 주문정보  	GridObj2.AddHeader("GUBN"		,"주문정보"      	,"t_text" 	,10			,70  ,false); //0   	GridObj2.AddHeader("CUST_CODE"	,"거래처코드"     ,"t_text" 	,500		,0  ,false); //0    	GridObj2.AddHeader("CUST_NAME"	,"거래처명"      	,"t_text" 	,500		,0  ,false); //0     	GridObj2.AddHeader("SLIP_NO"	,"전표번호"       ,"t_text" 	,100		,80  ,false); //0     	GridObj2.AddHeader("SEQ_NO"		,"SEQ_NO"       ,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("REQT_QTY"	,"주문수량"      	,"t_number" ,100.3		,80  ,false); //0     	GridObj2.AddHeader("SELL_QTY"	,"마감수량"      	,"t_number" ,100.3		,80  ,false); //0     	GridObj2.AddHeader("SHORTAGE_GUBN"	,"결품사유"  ,"t_text" 	,100		,180  ,false); //0     	GridObj2.AddHeader("IPUT_DTTM"	,"입력시간"      	,"t_text" 	,100		,140  ,false); //0      	GridObj2.AddHeader("CLOS_DTTM"	,"마감시간"      ,"t_text" 	,100		,140  ,false); //0     	GridObj2.AddHeader("CHGO_GUBN"	,"전표상태"		,"t_text" 	,100		,77  ,false); //0   화면 감춤	 	    	GridObj2.BoundHeader();	    GridObj2.SetColCellAlign('GUBN','center');     GridObj2.SetColCellAlign('SLIP_NO','center');     GridObj2.SetColCellAlign('IPUT_DTTM','center');     GridObj2.SetColCellAlign('CHGO_GUBN','center');     GridObj2.SetColCellAlign('CLOS_DTTM','center');         GridObj2.SetNumberFormat("REQT_QTY"  , "#,##0");    GridObj2.SetNumberFormat("SELL_QTY"  , "#,##0");}   function setHeader3(GridObj3) { //수송정보                 	GridObj3.AddHeader("DC_NAME"		,"수송정보"		,"t_text" 	,10			,60  ,false); //0     	GridObj3.AddHeader("RECEIPT_PRE"	,"전일\n입고"		,"t_number"	,100.3		,50  ,false); //0     	GridObj3.AddHeader("BASE_STOCK"		,"기초\n재고"		,"t_number"	,100.3		,50 ,false); //0     	GridObj3.AddHeader("IPGO"			,"입고"      	,"t_number" ,100.3		,50  ,false); //0     	GridObj3.AddHeader("CHGO"			,"출고"      	,"t_number" ,100.3		,50  ,false); //0     	GridObj3.AddHeader("REQT_QTY"		,"주문\n수량"  	,"t_number" ,100.3		,0  ,false); //0      	GridObj3.AddHeader("CONFIRM_QTY"	,"마감\n수량"		,"t_number" ,100.3		,0  ,false); //0    	GridObj3.AddHeader("SHORTAGE_QTY"	,"결품\n수량" 	,"t_number" ,100.3		,0  ,false); //0  	GridObj3.AddHeader("ORDER_CNT"		,"오더\n건수" 	,"t_number" ,100.3		,0  ,false); //0  	      	GridObj3.AddHeader("SRC_LOC"		,"출고장"    		,"t_text" 	,100		,70  ,false); //0     	GridObj3.AddHeader("BRAND_NO"		,"전표\n번호"  	,"t_text" 	,100		,70  ,false); //0     	GridObj3.AddHeader("TRANS_STATE"	,"전표\n상태"		,"t_text" 	,100		,70  ,false); //0     	GridObj3.AddHeader("SHORTAGE_GUBN"	,"결품\n사유"		,"t_text" 	,100		,80  ,false); //0     	GridObj3.AddHeader("QTY"			,"수송\n계획" 	,"t_number" ,100.3		,50  ,false); //0     	GridObj3.AddHeader("CHGO_QTY"		,"출고\n수량"		,"t_number" ,100.3		,0  ,false); //0     	GridObj3.AddHeader("CHGO_DTTM"		,"출고\n일시" 	,"t_text" 	,100		,120  ,false); //0     	GridObj3.AddHeader("IPGO_DTTM"		,"입고\n일시"  	,"t_text" 	,100		,120  ,false); //0     	GridObj3.AddHeader("IPGO_QTY"		,"입고\n수량"  	,"t_number" ,100.3		,50  ,false); //0   	 	      	GridObj3.AddHeader("MIN_CLOS_DTTM"	,"배송마감\n(from)" ,"t_text" ,100		,120  ,false); //0     	GridObj3.AddHeader("MAX_CLOS_DTTM"	,"배송마감\n(to)"   ,"t_text" ,100		,120  ,false); //0	GridObj3.BoundHeader();	    GridObj3.SetColCellAlign('DC_NAME','center');     GridObj3.SetColCellAlign('MIN_CLOS_DTTM','center');     GridObj3.SetColCellAlign('MAX_CLOS_DTTM','center');     GridObj3.SetColCellAlign('SRC_LOC','center');     GridObj3.SetColCellAlign('TRANS_STATE','center');     GridObj3.SetColCellAlign('CHGO_DTTM','center');     GridObj3.SetColCellAlign('IPGO_DTTM','center'); }function setHeader4(GridObj4) { // EDI 정보         	GridObj4.AddHeader("GUBN"			,"EDI 정보"		,"t_text" 	,10			,60  ,false); //0     	GridObj4.AddHeader("CNFM_DATE"		,"납품일자"		,"t_text"	,100		,90  ,false); //0     	GridObj4.AddHeader("CUST_CODE"		,"거래처코드"		,"t_text"	,100		,0 ,false); //0     	GridObj4.AddHeader("OD_SLIP_NO"		,"EDI전표번호"	,"t_text" 	,100		,90  ,false); //0     	GridObj4.AddHeader("ODER_BOX"		,"EDI발주수량"	,"t_number" ,100.3		,90  ,false); //0     	GridObj4.AddHeader("CONV_BOX"		,"주문전환수량"	,"t_number" ,100.3		,90  ,false); //0     	GridObj4.AddHeader("ODER_DATE"		,"주문일자"      	,"t_text" 	,100		,0  ,false); //0     	//GridObj4.AddHeader("IPUT_DATE"		,"입력일자"  		,"t_text" 	,100		,90  ,false); //0      	GridObj4.AddHeader("IPUT_TIME"		,"입력시각"		,"t_text" 	,100		,140  ,false); //0   화면 감춤  	GridObj4.AddHeader("IPUT_EMP_NO"	,"입력자" 		,"t_text" 	,100		,0  ,false); //0  	//GridObj4.AddHeader("CONV_DATE"		,"전환일자" 		,"t_text" 	,100		,90  ,false); //0  	GridObj4.AddHeader("CONV_TIME"		,"전환시각"    	,"t_text" 	,100		,140  ,false); //0     	GridObj4.AddHeader("CONV_EMP_NO"	,"전환자"  		,"t_text" 	,100		,70  ,false); //0     	GridObj4.AddHeader("SLIP_NO"		,"영업전표번호"	,"t_text" 	,100		,90  ,false); //0   	GridObj4.BoundHeader();	    GridObj4.SetColCellAlign('GUBN','center');     GridObj4.SetColCellAlign('CNFM_DATE','center');     GridObj4.SetColCellAlign('OD_SLIP_NO','center');     GridObj4.SetColCellAlign('ODER_DATE','center');     //GridObj4.SetColCellAlign('IPUT_DATE','center');     GridObj4.SetColCellAlign('IPUT_TIME','center');     GridObj4.SetColCellAlign('IPUT_EMP_NO','center');     //GridObj4.SetColCellAlign('CONV_DATE','center');     GridObj4.SetColCellAlign('CONV_TIME','center');     GridObj4.SetColCellAlign('CONV_EMP_NO','center');     GridObj4.SetColCellAlign('SLIP_NO','center');     }/*┌──────────────────────────────────┐  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc  └──────────────────────────────────┘*/function GridEndQuery(){	    var endMode = GridObj.GetParam("mode");    var error_msg = '';        //alert("endMode="+endMode);      if(endMode == "search") //조회가 완료된 경우    {        if(GridObj.GetStatus() == "true")         {                    	GridSetMerge();//        	for(var i=0;i<GridObj.GetRowCount();i++){//        		var flag = GridObj.GetCellValue('GUBN',i);//        		if( flag == "회송") GridObj.SetCellBgColor('GUBN', i, '255|255|200');//        		//        	}        	/*         				for(var i=0;i<GridObj.GetRowCount();i++) {			// cell색깔 변경				if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(2) ){  // GREEN					GridObj.SetCellBgColor('PR_DATE_NO', i, '200|255|110');				}else if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(1) && GridObj.GetCellValue('PR_DATE_NO',i) <= Number(2)){  // YELLOW					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|255|0');				}				else if(GridObj.GetCellValue('PR_DATE_NO',i) <= Number(1)){ // RED					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|0|0'); 				}							GridObj.SetCellFontBold('TOT_STOCK', i, 'true'); // font 굵기			GridObj.SetCellFontBold('PR_QTY', i, 'true'); // font 굵기			GridObj.SetCellFontBold('STD_STOCK', i, 'true'); // font 굵기			}*/			        } else            {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }else if(endMode == "save"){    	doQuery();		doSave2();    }else{ // 삭제, 전송 상태일시 메인그리드 제조회       }    	}function GridEndQuery5(){	    var endMode = GridObj5.GetParam("mode");    var error_msg = '';        //alert("endMode="+endMode);      if(endMode == "search5") //조회가 완료된 경우    {        if(GridObj5.GetStatus() == "true")         {                    	GridSetMerge5();//        	for(var i=0;i<GridObj5.GetRowCount();i++){//        		var flag = GridObj5.GetCellValue('GUBN',i);//        		if( flag == "회송") GridObj5.SetCellBgColor('GUBN', i, '255|255|200');//        		//        	}		        } else            {             error_msg = GridObj5.GetMessage();             alert(error_msg);            		}    }else if(endMode == "save2"){    	    	doQuery5();    }else{ // 삭제, 전송 상태일시 메인그리드 제조회       }    	}function GridEndQuery2() {		var mode = GridObj2.GetParam("mode");	var error_msg = '';	          	if(mode == "search2") {		if(GridObj2.GetStatus() == "true") {			//GridObj2.SetGroupMerge(	'ITEM_ID,ITEM_NAME,PR_NO,PR_REL,PR_QTY,PO_NO,PO_SEQ,PO_DATE,PO_QTY');		  	//GridObj2.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'SHIP_QTY');		  	//GridObj2.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot); 		}		else { 			error_msg = GridObj2.GetMessage(); 			alert(error_msg);            		}	}}function GridEndQuery3() {		var mode = GridObj3.GetParam("mode");	var error_msg = '';	          	if(mode == "search3") {		if(GridObj3.GetStatus() == "true") { 		}		else { 			error_msg = GridObj3.GetMessage(); 			alert(error_msg);            		}	}	var header_length = 0, j;	/* TP_FLAG 확인후 세팅 */	var item_id = document.all.sel_item_id.value;	}function GridEndQuery4() {		var mode = GridObj4.GetParam("mode");	var error_msg = '';	          	if(mode == "search4") {		if(GridObj4.GetStatus() == "true") {                           		}		else { 			error_msg = GridObj4.GetMessage(); 			alert(error_msg);            		}	}}/*┌──────────────────────────────────┐  │그리드의 원 클릭 이벤트  └──────────────────────────────────┘*/function GridCellClick(strColumnKey, nRow) {}	               /*┌──────────────────────────────────┐  │화면에 '조회'를 누르면 호출 Fnc  └──────────────────────────────────┘*/function GoSearch(service) {    doQuery();    doQuery5();}/*┌──────────────────────────────────┐  │하부 그리드 조회 WD1 더블클릭  └──────────────────────────────────┘*/function GridCellDblClick(strColumnKey, nRow){     	    sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);    document.all.sel_item_id.value	= sel_item_id;        sel_item_name = GridObj.GetCellValue("ITEM_NAME", nRow);    document.all.sel_item_name.value	= sel_item_name;	doQuery2(nRow);		doQuery3(nRow);		doQuery4(nRow);		};  /*┌──────────────────────────────────┐  │하부 그리드 조회 WD5 더블클릭  └──────────────────────────────────┘*/function GridCellDblClickHandler(strColumnKey, nRow){     		    sel_item_id = GridObj5.GetCellValue("ITEM_ID", nRow);    document.all.sel_item_id.value	= sel_item_id;        sel_item_name = GridObj5.GetCellValue("ITEM_NAME", nRow);    document.all.sel_item_name.value	= sel_item_name;	doQuery2_1(nRow);		doQuery3_1(nRow);		doQuery4_1(nRow);		};          /*┌──────────────────────────────────┐  │DW 1 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery() { var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var cnfm_date	= document.all.cnfm_date.value;          //넘겨줄 값들을만든다.( 파라미터 정의 부분 )   GridObj.SetParam("mode", "search");   GridObj.SetParam("cnfm_date", cnfm_date);          GridObj.DoQuery(servlet_url);}	function doQuery5() {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var cnfm_date	= document.all.cnfm_date.value;          //넘겨줄 값들을만든다.( 파라미터 정의 부분 )   GridObj5.SetParam("mode", "search5");   GridObj5.SetParam("cnfm_date", cnfm_date);          GridObj5.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 2 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery2(nRow) { //주문정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj.GetCellValue("CNFM_DATE", nRow);	var edi_gubn = '1';		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("item_id", item_id);	GridObj2.SetParam("cust_id", cust_id);	GridObj2.SetParam("dc_id", dc_id);	GridObj2.SetParam("cnfm_date", cnfm_date);	GridObj2.SetParam("edi_gubn", edi_gubn);	GridObj2.DoQuery(servlet_url);}function doQuery2_1(nRow) { //주문정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj5.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj5.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj5.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj5.GetCellValue("CNFM_DATE", nRow);	var edi_gubn = '1';		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("item_id", item_id);	GridObj2.SetParam("cust_id", cust_id);	GridObj2.SetParam("dc_id", dc_id);	GridObj2.SetParam("cnfm_date", cnfm_date);	GridObj2.SetParam("edi_gubn", edi_gubn);	GridObj2.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 3 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery3(nRow) { //수송정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj.GetCellValue("CNFM_DATE", nRow);		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj3.SetParam("mode", "search3");	GridObj3.SetParam("item_id", item_id);	GridObj3.SetParam("cust_id", cust_id);	GridObj3.SetParam("dc_id", dc_id);	GridObj3.SetParam("cnfm_date", cnfm_date);		GridObj3.DoQuery(servlet_url);}function doQuery3_1(nRow) { //수송정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj5.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj5.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj5.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj5.GetCellValue("CNFM_DATE", nRow);		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj3.SetParam("mode", "search3");	GridObj3.SetParam("item_id", item_id);	GridObj3.SetParam("cust_id", cust_id);	GridObj3.SetParam("dc_id", dc_id);	GridObj3.SetParam("cnfm_date", cnfm_date);		GridObj3.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 4 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery4(nRow) { //EDI 정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj.GetCellValue("CNFM_DATE", nRow);	var edi_gubn = '1';			//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj4.SetParam("mode", "search4");	GridObj4.SetParam("item_id", item_id);	GridObj4.SetParam("cust_id", cust_id);	GridObj4.SetParam("dc_id", dc_id);	GridObj4.SetParam("cnfm_date", cnfm_date);	GridObj4.SetParam("edi_gubn", edi_gubn);	GridObj4.DoQuery(servlet_url);}function doQuery4_1(nRow) { //EDI 정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj5.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj5.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj5.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj5.GetCellValue("CNFM_DATE", nRow);	var edi_gubn = '1';			//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj4.SetParam("mode", "search4");	GridObj4.SetParam("item_id", item_id);	GridObj4.SetParam("cust_id", cust_id);	GridObj4.SetParam("dc_id", dc_id);	GridObj4.SetParam("cnfm_date", cnfm_date);	GridObj4.SetParam("edi_gubn", edi_gubn);	GridObj4.DoQuery(servlet_url);}//--------------------------------------   main_template 에 정의된 Event ---------------------------------------------------///*┌──────────────────────────────────┐  │WiseGrid Cell Change Event  └──────────────────────────────────┘*/// 저장function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";	doSave();		};// 저장function doSave() { 	var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;    	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.frm._user_id.value);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "WISEGRIDDATA_ALL");	//GridObj.DoQuery(servlet_url, "SELECTED"); }function doSave2() { 	var GridObj5 = document.WiseGrid5;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;    	GridObj5.SetParam("mode", "save2");	GridObj5.SetParam("user_id", document.frm._user_id.value);		GridObj5.DoQuery(servlet_url, "WISEGRIDDATA_ALL"); }function GridSetMerge(){				var rowCount = GridObj.GetRowCount();				if (rowCount == 0) return;							GridObj.AddSummaryBar('SUMMARY2', '합계', 'summaryall', 'sum', 'EDI_BOX,SELL_BOX,HS_BOX,DEFAULT_BOX');        GridObj.SetSummaryBarColor('SUMMARY2', '0|153|0', '152|251|152');        }function GridSetMerge5(){				var rowCount = GridObj5.GetRowCount();				if (rowCount == 0) return;							GridObj5.AddSummaryBar('SUMMARY2', '합계', 'summaryall', 'sum', 'EDI_BOX,SELL_BOX,HS_BOX,DEFAULT_BOX');        GridObj5.SetSummaryBarColor('SUMMARY2', '0|153|0', '152|251|152');				 }function changeChecked(obj){ // 출고장 기능 구현 함수//		var sel_data  = GridObj.GetSelectedCells(); // 선택한 부분의 key와 row를 가져온다		var i=0;		var rowNo=0;		/*  	 * 첫번째 행번호 찾기	 * 첫번째 행의 출고장의 히든값 찾기	 * 	 * 선택되어진 행들의 출고장을 첫번째 출고장 히든값으로 세팅하기	 * */ 	var first_rowNo   	= sel_data.split(",")[i*2+1];		var first_rowVal  	= GridObj.GetCellValue("DEFAULT_CODE_NS",first_rowNo);		var first_row_idx 	= GridObj.GetCellHiddenValue("DEFAULT_CODE_NS", first_rowNo);		var first_row_new_idx 	= GridObj.GetComboSelectedIndex("DEFAULT_CODE_NS", first_rowNo);  		if(first_row_idx == "" ){		alert("첫 번째 출고장을 입력 후, 일괄변경을 실행하여 주십시요.");		return;	} 	while(1) {		if (sel_data.split(",")[i*2+1] == null || sel_data.split(",")[i*2+1] == "")  // 더이상 데이터 없다			return;		else {						var rowNo = sel_data.split(",")[i*2+1];						var nOldIndex = GridObj.GetComboSelectedIndex("DEFAULT_CODE_NS", rowNo);						var nNewIndex = first_row_new_idx;						//GridObj.SetComboSelectedHiddenValue("DEFAULT_CODE_NS", rowNo,  first_src_loc);			GridObj.SetComboSelectedHiddenValue("DEFAULT_CODE_NS", rowNo,  first_row_idx);			GridObj.SetComboSelectedIndex("DEFAULT_CODE_NS", rowNo,  first_row_new_idx);												}		i++;	}	}function changeChecked2(obj){ // 출고장 기능 구현 함수//		var sel_data  = GridObj5.GetSelectedCells(); // 선택한 부분의 key와 row를 가져온다		var i=0;		var rowNo=0;		/*  	 * 첫번째 행번호 찾기	 * 첫번째 행의 출고장의 히든값 찾기	 * 	 * 선택되어진 행들의 출고장을 첫번째 출고장 히든값으로 세팅하기	 * */ 	var first_rowNo   	= sel_data.split(",")[i*2+1];		var first_rowVal  	= GridObj5.GetCellValue("DEFAULT_CODE_NS",first_rowNo);		var first_row_idx 	= GridObj5.GetCellHiddenValue("DEFAULT_CODE_NS", first_rowNo);		var first_row_new_idx 	= GridObj5.GetComboSelectedIndex("DEFAULT_CODE_NS", first_rowNo);  		if(first_row_idx == "" ){		alert("첫 번째 출고장을 입력 후, 일괄변경을 실행하여 주십시요.");		return;	} 	while(1) {		if (sel_data.split(",")[i*2+1] == null || sel_data.split(",")[i*2+1] == "")  // 더이상 데이터 없다			return;		else {						var rowNo = sel_data.split(",")[i*2+1];						var nOldIndex = GridObj5.GetComboSelectedIndex("DEFAULT_CODE_NS", rowNo);						var nNewIndex = first_row_new_idx;						//GridObj.SetComboSelectedHiddenValue("DEFAULT_CODE_NS", rowNo,  first_src_loc);			GridObj5.SetComboSelectedHiddenValue("DEFAULT_CODE_NS", rowNo,  first_row_idx);			GridObj5.SetComboSelectedIndex("DEFAULT_CODE_NS", rowNo,  first_row_new_idx);												}		i++;	}	}