//## Щ煎斜極ID      : ip_03030_Long_Term_Hawa_Planning.js//## Щ煎斜極貲      : 醞濰晦 鼻ヶ嫦輿 啗(褐敘)//## 偃嫦濠          : 檜鬼遵//## 偃嫦橾濠        : 2016-03-28//##//## 婦溼 job file   : job_sinc_30_orderPlanning_08.xml//## 婦溼 query file : query_sinc_30_orderPlanning_08.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             瞪羲 滲熱            ----------------------------------------------////var mode;														// WiseGrid 鱔褐 衛 瞪歎 賅萄(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 憮綰葩 ぬ酈雖(class だ橾 唳煎)var job_id = 'ip_03030_Long_Term_Hawa_Planning';var GridObj ; 													// WiseGrid 偌羹var GridObj2;var GridObj3;//var GridObj4;//var GridObj5;Fvar color_tot 		 = '234|234|234';			//м啗 塭檣 寡唳儀var color_edit_col   = '255|253|208';var color_sp 		 = '230|222|230'; 			//鏽歲 掘碟摹 寡唳儀var color_select_row = '141|232|141';			//塭檣 摹鷗 寡唳儀 var colBg01 		 = '224|255|224';			//255|255|153var colBg02 	     = '255|255|255';/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 餌檜鍔 褻瞰 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 飛 size 蹴模 衛 飛橉 傘鼠 濛嬴 斜葬萄 觼晦陛 擠熱陛 腎賊 縑楝陛 釭嘎煎 斜 唳辦 鼠褻勒 1煎 撮た         // ==> 飛橉 渦檜鼻 蹴模腎雖 彊擠         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         //document.WiseGrid.height = tableHeightValue + "px";          document.WiseGrid2.height = tabHeightValue - document.WiseGrid.height+ "px";        //document.WiseGrid3.height = tableHeightValue - document.WiseGrid.height + "px";             }  /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid 螃粽薛お陛 儅撩腎堅 蟾晦音  嫦儅ж朝 							弛  弛JavaScript Event檣 Initialize()蒂 嫡嬴 斜葬萄曖 ④渦蒂 撢たи棻.			弛  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default撲薑 睡碟 (WiseGrid_Property.jsだ橾 頂縑 摹樹腎橫 氈棻.)	setHeader(GridObj);  	//п渦儅撩 	setDefault();        	//飛 晦獄 撲薑 }   function init2() {	GridObj2 = document.WiseGrid2;	setProperty(GridObj2);	//WiseGrid Default撲薑 睡碟 (WiseGrid_Property.jsだ橾 頂縑 摹樹腎橫 氈棻.)	setHeader2(GridObj2);  	//п渦儅撩 	setDefault2();        	//飛 晦獄 撲薑 }         /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛 晦獄 撲薑 睡碟.  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function setDefault() { 		//GridObj.bRowSelectorVisible = false;        		//煎辦 撚滓攪蒂 WiseGrid縑憮 獗曹棻,. 		GridObj.bRowSelectorIndex = true;				//Row Selector 艙羲縑 Row Index蒂 爾罹遽棻.	//GridObj.bHDMoving = true;		// 鏽歲 ④渦 嬪纂 檜翕    GridObj.nHDLineSize         = 10; //Header Size        //④渦曖 塭檣熱蒂 撲薑и棻.     GridObj.nHDLines = 2;          //摹鷗脹 撚曖 旋濠儀 雖薑и棻.	GridObj.strSelectedCellFgColor = '0|0|0';	GridObj.strSelectedCellBgColor = '232|232|255'; //Drag煎 摹鷗脹 撚曖 寡唳儀鼻擊 滲唳й 熱 氈棻	GridObj.strActiveRowBgColor    = "232|245|213";    //摹鷗脹 ч曖 寡唳儀鼻擊 撲薑и棻.	    GridObj.strHDClickAction 	   = "select";        	//贗葛и 鏽歲曖 撚擊 摹鷗陛棟ж啪 и棻.    GridObj.strMouseWheelAction='page';	// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9    }function setDefault2() { 		//GridObj2.bRowSelectorVisible	= false;        		//煎辦 撚滓攪蒂 WiseGrid縑憮 獗曹棻,. 	//GridObj2.bRowSelectorIndex		= true;					//Row Selector 艙羲縑 Row Index蒂 爾罹遽棻.    GridObj2.nHDLineSize			= 10;					//Header Size        //摹鷗脹 撚曖 旋濠儀 雖薑и棻.    GridObj2.strActiveRowBgColor	= "232|245|213";		//摹鷗脹 ч曖 寡唳儀鼻擊 撲薑и棻.    GridObj2.strSelectedCellFgColor = '180|82|205';    GridObj2.strHDClickAction		= "select";        		//贗葛и 鏽歲曖 撚擊 摹鷗陛棟ж啪 и棻.	GridObj2.nCellFontSize			= 9;					// Font Size 9    //GridObj2.bStatusbarVisible		= false;				// status bar visible 鼻鷓夥 撲薑     GridObj2.nHDLines				= 2;}       /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛п渦儅撩  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/ function setHeader(GridObj) {        	GridObj.AddHeader("CRUD"				,"CRUD"       		,"t_text" 		,100    ,0   ,false);  	GridObj.AddHeader("SELECTED"			," "       			,"t_checkbox" 	,2		,22  ,true); //0    	GridObj.AddHeader("IF_FLAG"				,"瞪歎\n鼻鷓"     	,"t_text" 		,100	,38  ,false); //0   	GridObj.AddHeader("ITEM_ID"				,"ヶ跡廓"      		,"t_text" 		,20		,70  ,false); //0    	GridObj.AddHeader("ITEM_NAME"			,"ヶ跡貲"      	 	,"t_text" 		,100	,160 ,false); //0     	GridObj.AddHeader("TERM_VAL"			,"嶸鱔晦и"    	 	,"t_text" 		,100	,60  ,false); //0   	GridObj.AddHeader("OPER_VAL"			,"遴艙晦и"    	 	,"t_text" 		,100	,60  ,false); //0   	GridObj.AddHeader("BASE_STOCK"			,"⑷營堅"       		,"t_number" 	,100.3	,60  ,false); //0 	//陛辨橾 檜醞④渦 	GridObj.AddHeader("SEL_DMD"				,"掘碟"     			,"t_combo"		,100	,60  ,true); //0 	GridObj.AddHeader("AVL_DAY"				,"陛辨橾熱"    		,"t_text" 		,100	,60  ,false); //0   	GridObj.AddHeader("PROD_TERM"			,"嶸鱔晦и\n濤罹橾"    ,"t_text" 		,100	,60  ,false); //0  	//霞ч醞 營堅 檜醞④渦 	GridObj.AddHeader("RECEIPT_M"			,"1-10"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("RECEIPT_M2"			,"11-20"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("RECEIPT_M3"			,"21-30"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("MON_M01"				,"M+1"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("MON_M02"				,"M+2"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("TOT_AVL_DAY"			,"識陛辨橾"    		,"t_text" 		,100	,80  ,false); //0 	 	//橾 っ衙褒瞳 檜醞④渦 	GridObj.AddHeader("SALES_MEAN_3WEEK_ETC"	,"3輿ゎ敕"      		,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("SALES_MEAN_3MON_TA"		,"3偃錯ゎ敕"      	,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("SALES_PY_MON_CUM_TA"		,"瞪喇翕錯"      		,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("SALES_USER"				,"餌辨濠"      		,"t_number" 	,100.3	,60  ,true); //0 	 	 	GridObj.AddHeader("LEAD_TIME"			,"殮堅\n葬萄顫歜"    	,"t_text" 		,100	,90  ,false); //0 	GridObj.AddHeader("MINMPSQTY"			,"MOQ"    			,"t_text" 		,100	,60  ,true); //0    	GridObj.AddHeader("BOX_PER_PALET"		,"PALET渡\n夢蝶熱" 	 ,"t_text" 		,100	,60  ,false); //0    	GridObj.AddHeader("BOX_DEMAND"			,"蹂掘榆\n(PALET)" 	,"t_text" 		,100	,60  ,true); //0    	GridObj.AddHeader("PR_QTY"				,"PR熱榆"        	,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("MEINS"				,"嫦輿欽嬪"    		,"t_text" 		,100	,60  ,false); //0 	GridObj.AddHeader("IPGO_DATE"			,"殮堅蹂羶橾" 		,"t_date"   	,100	,90  ,true); //0 	GridObj.AddHeader("PR_NO"				,"PR 廓"     		,"t_text" 		,100	,100  ,false); //0    	GridObj.AddHeader("IF_MSGS"				,"IF 詭撮雖"      	,"t_text" 		,100	,200 ,false); //0  	 	GridObj.AddGroup	("AVL",		"陛辨橾"); 	GridObj.AppendHeader("AVL", 	"SEL_DMD"); 	GridObj.AppendHeader("AVL", 	"AVL_DAY"); 	 	GridObj.AddGroup	("PROCESS",   	"霞ч醞 營堅");				GridObj.AppendHeader("PROCESS", 	"RECEIPT_M");	GridObj.AppendHeader("PROCESS", 	"RECEIPT_M2");	GridObj.AppendHeader("PROCESS", 	"RECEIPT_M3");	GridObj.AppendHeader("PROCESS",   	"MON_M01");	GridObj.AppendHeader("PROCESS",   	"MON_M02");		GridObj.AddGroup	("SALES",   "橾 っ衙褒瞳");				GridObj.AppendHeader("SALES", 	"SALES_MEAN_3WEEK_ETC");	GridObj.AppendHeader("SALES", 	"SALES_MEAN_3MON_TA");	GridObj.AppendHeader("SALES", 	"SALES_PY_MON_CUM_TA");	GridObj.AppendHeader("SALES",   "SALES_USER");		GridObj.BoundHeader();			GridObj.SetDateFormat("IPGO_DATE",'yyyy-MM-dd');		GridObj.SetColCellBgColor('SEL_DMD',		color_edit_col);	GridObj.SetColCellBgColor('MINMPSQTY',		color_edit_col);	GridObj.SetColCellBgColor('BOX_DEMAND',		color_edit_col);	GridObj.SetColCellBgColor('IPGO_DATE',		color_edit_col);	GridObj.SetColCellBgColor('SALES_USER',		color_edit_col);		GridObj.SetColCellBgColor('TOT_AVL_DAY',	'178|235|244');			GridObj.SetNumberFormat("RECEIPT_M"  			,"###,###.#");	GridObj.SetNumberFormat("RECEIPT_M2"  			,"###,###.#");	GridObj.SetNumberFormat("RECEIPT_M3"  			,"###,###.#");	GridObj.SetNumberFormat("MON_M01"  				,"###,###.#");	GridObj.SetNumberFormat("MON_M02"  				,"###,###.#");	GridObj.SetNumberFormat("BASE_STOCK"  			,"###,###.#");	GridObj.SetNumberFormat("SALES_MEAN_3WEEK_ETC"  ,"###,###.#");	GridObj.SetNumberFormat("SALES_MEAN_3MON_TA"  	,"###,###.#");	GridObj.SetNumberFormat("SALES_PY_MON_CUM_TA"  	,"###,###.#");	GridObj.SetNumberFormat("SALES_USER"  			,"###,###.#");	GridObj.SetNumberFormat("PR_QTY"  				,"###,###.#");	GridObj.SetColCellAlign('IPGO_DATE'		,'center');    GridObj.SetColCellAlign('ITEM_ID'		,'center');     GridObj.SetColCellAlign('ITEM_NAME'		,'left');     GridObj.SetColCellAlign('TERM_VAL'		,'right');     GridObj.SetColCellAlign('OPER_VAL'		,'right');     GridObj.SetColCellAlign('PROD_TERM'		,'right');     GridObj.SetColCellAlign('AVL_DAY'		,'right');     GridObj.SetColCellAlign('TOT_AVL_DAY'	,'center');     GridObj.SetColCellAlign('MEINS'			,'center');     GridObj.SetColCellAlign('LEAD_TIME'		,'right');     GridObj.SetColCellAlign('MINMPSQTY'		,'right');     GridObj.SetColCellAlign('BOX_PER_PALET'	,'right');     GridObj.SetColCellAlign('BOX_DEMAND'	,'right');     GridObj.SetColCellAlign('PR_QTY'		,'right'); 		GridObj.SetColFix('ITEM_NAME');	GridObj.SetCRUDMode("CRUD");  // AD諦 DE陛 撢た 腆 唳辦朝 橈棻.	GridObj.SetColHide("CRUD",true);}   function setHeader2(GridObj2) {        	GridObj2.AddHeader("CRUD"		,"CRUD"       	,"t_text" 	,100    	,0   ,false);  	GridObj2.AddHeader("ITEM_ID"	,"ヶ跡廓"      	,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("ITEM_NAME"	,"ヶ跡貲"       	,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("PR_NO"		,"PR廓"       	,"t_text" 	,100		,80  ,false); //0     	GridObj2.AddHeader("PR_DATE"	,"PR橾濠"      	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("PR_QTY"		,"PR熱榆"       	,"t_number" ,100.3		,60  ,false); //0   	     	GridObj2.AddHeader("PO_NO"		,"PO廓"      	,"t_text" 	,100		,80  ,false); //0  	GridObj2.AddHeader("PO_DATE"	,"PO橾濠"     	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("PO_QTY"		,"PO熱榆"       	,"t_number" ,100.3		,60  ,false); //0   	  	//GridObj2.AddHeader("HBL_NO"		,"HBL廓"       ,"t_text" 	,100		,90  ,false); //0  	GridObj2.AddHeader("BL_NO"		,"BL廓"       	,"t_text" 	,100		,0  ,false); //0  	  	GridObj2.AddHeader("BL_QTY"		,"碟й熱榆"      	,"t_text" 	,100		,60  ,false); //0 	  	GridObj2.AddHeader("GUBN"		,"霞ч橾薑"      	,"t_text" 	,100		,60  ,false); //0  	GridObj2.AddHeader("LEAD_1"		,"摹瞳"       	,"t_text" 	,100		,70  ,false); //0  	GridObj2.AddHeader("LEAD_2"		,"殮о"       	,"t_text" 	,100		,70  ,false); //0  	GridObj2.AddHeader("LEAD_3"		,"鱔婦"       	,"t_text" 	,100		,70  ,false); //0  	  	GridObj2.AddHeader("TEXT_1"		,"爾撮璽堅\n奩殮" 	,"t_text" 	,4		,70  ,true); //0  	GridObj2.AddHeader("TEXT_2"		,"衛濛" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_3"		,"謙猿" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_4"		,"蕾熱" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_5"		,"諫猿" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_6"		,"蕾熱" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_7"		,"諫猿" 			,"t_text" 	,4		,50  ,true); //0  	  	GridObj2.AddHeader("LEAD_4"		,"殮堅"       	,"t_text" 	,100		,80  ,false); //0  	GridObj2.AddHeader("IPGO_DATE"	,"殮堅蹂羶橾"     ,"t_text" 	,100		,90  ,false); //0  	GridObj2.AddHeader("EXPT_DATE"	,"蕨鼻殮堅橾"     ,"t_text" 	,100		,90  ,false); //0  	GridObj2.AddHeader("LEAD_TIME"	,"PR-殮堅"    	,"t_text" 	,100		,70  ,false); //0  	GridObj2.AddHeader("BIGO"		,"か檜餌о"     	,"t_text" 	,100		,120 ,true); //0  	GridObj2.AddHeader("BIGO2"		,"奢晝離韓"    	,"t_text" 	,100		,80  ,true); //0  	GridObj2.AddHeader("SEQ"		,"SEQ"    		,"t_text" 	,100		,0   ,true); //0  	  	/* 檜醞 п渦 蹺陛 */	GridObj2.AddGroup	 ("HD1",	"蝶じ醴濛機");			 	GridObj2.AppendHeader("HD1", 	"TEXT_2");	GridObj2.AppendHeader("HD1", 	"TEXT_3");		GridObj2.AddGroup	 ("HD2",	"匐羲");			 	GridObj2.AppendHeader("HD2", 	"TEXT_4");	GridObj2.AppendHeader("HD2", 	"TEXT_5");		GridObj2.AddGroup	 ("HD3",	"寞餌棟匐餌");			 	GridObj2.AppendHeader("HD3", 	"TEXT_6");	GridObj2.AppendHeader("HD3", 	"TEXT_7"); 	    	GridObj2.BoundHeader();		GridObj2.SetColCellAlign('PR_NO'	,'center');	GridObj2.SetColCellAlign('PR_DATE'	,'center');	GridObj2.SetColCellAlign('PO_NO'	,'center');	GridObj2.SetColCellAlign('PO_DATE'	,'center');	GridObj2.SetColCellAlign('GUBN'		,'center');	GridObj2.SetColCellAlign('LEAD_1'	,'center');	GridObj2.SetColCellAlign('LEAD_2'	,'center');	GridObj2.SetColCellAlign('LEAD_3'	,'center');	GridObj2.SetColCellAlign('LEAD_4'	,'center');	GridObj2.SetColCellAlign('LEAD_TIME'	,'center');	GridObj2.SetColCellAlign('IPGO_DATE'	,'center');	GridObj2.SetColCellAlign('EXPT_DATE'	,'center');		GridObj2.SetColCellAlign('PR_QTY'	,'right');	GridObj2.SetColCellAlign('PO_QTY'	,'right');	GridObj2.SetColCellAlign('BL_QTY'	,'right');	GridObj2.SetNumberFormat("PR_QTY"  	,"###,###.#");	GridObj2.SetNumberFormat("PO_QTY"  	,"###,###.#");		GridObj2.SetCRUDMode("CRUD");  // AD諦 DE陛 撢た 腆 唳辦朝 橈棻.	GridObj2.SetColHide("CRUD",true);		}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid Change Combo Event  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){		if( strColumnKey == "SEL_DMD"){				if(nNewIndex == 0) {		//3偃錯ゎ敕						var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);			var month 	= GridObj.GetCellValue('SALES_MEAN_3MON_TA',nRow);			var avl		= Math.round(stock/month,1);			GridObj.SetCellValue('AVL_DAY',nRow,avl);					}else if(nNewIndex == 1){	//3輿ゎ敕					var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);			var month 	= GridObj.GetCellValue('SALES_MEAN_3WEEK_ETC',nRow);			var avl		= Math.round(stock/month,1);			GridObj.SetCellValue('AVL_DAY',nRow,avl);					}else if(nNewIndex == 2){	//餌辨濠					var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);						var month 	= GridObj.GetCellValue('SALES_USER',nRow);			if(month == 0){				var avl		= 0;			}else{				var avl		= Math.round(stock/month,1);			}						GridObj.SetCellValue('AVL_DAY',nRow,avl);					}else{						//瞪喇翕錯					var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);			var month 	= GridObj.GetCellValue('SALES_PY_MON_CUM_TA',nRow);			var avl		= Math.round(stock/month,1);			GridObj.SetCellValue('AVL_DAY',nRow,avl);					}			}	}function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {		if( strColumnKey == "BOX_DEMAND"){				var pr_qty = GridObj.GetCellValue('BOX_PER_PALET',nRow) * GridObj.GetCellValue('BOX_DEMAND',nRow);		GridObj.SetCellValue('PR_QTY',nRow,pr_qty);	}		}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛等檜攪 褻萼 薑鼻瞳戲煎 諫猿腎賊 嫦儅腎朝 Event縑 渠и Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridEndQuery(){	    var endMode = GridObj.GetParam("mode");    var error_msg = '';              if(endMode == "search") //褻萼 諫猿脹 唳辦    {        if(GridObj.GetStatus() == "true")         {                                    }else            {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }    else if(endMode == "save") {		if(GridObj.GetStatus() == "true"){								doSave2();			}		else {			var error_msg = GridObj3.GetMessage();// 				alert(error_msg);					}    }   	}function GridEndQuery2() {	var mode = GridObj2.GetParam("mode");	var error_msg = '';	          	if(mode == "search2") {		if(GridObj2.GetStatus() == "true") {											 	GridObj2.SetGroupMerge('PR_NO,PR_DATE,PR_QTY,PO_NO,PO_DATE,PO_QTY');		 	GridObj2.AddSummaryBar('SUMMARY', '模啗', 'PR_NO', 'sum', ''); 			GridObj2.SetSummaryBarColor('SUMMARY','0|153|0', color_tot); 			GridSetColor();			GridSetBL();					}		else { 			error_msg = GridObj2.GetMessage(); 			alert(error_msg);            		}	}	 	}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 錳 贗葛 檜漸お  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridCellClick(strColumnKey, nRow) {}	               /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛橦 '褻'蒂 援腦賊 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/   function GoSearch(service)    {    doQuery();   	GridObj2.ClearGrid( ); 	setHeader2(GridObj2);			   } /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛ж睡 斜葬萄 褻 WD1 渦綰贗葛  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridCellDblClick(strColumnKey, nRow){ 		/* 熱殮鼻ヶ 嫦輿婦葬 で機璽 */	var item_id		= GridObj.GetCellValue('ITEM_ID',nRow)	var	item_name	= GridObj.GetCellValue('ITEM_NAME',nRow)	var cnfm_date	= document.frm.version.value;		if(strColumnKey == 'ITEM_NAME'){		var service_url = "service.do?_moon_service=ip_01130_import_md_PlanAnalysis_list_pop";		service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&cnfm_date=" + cnfm_date ;		var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=yes, resizable=yes, width=1135, height=740, top=50, left=200";		var newWin = window.open(service_url, "", pop_win_style);		newWin.focus();						}else{				doQuery2(nRow);	}	}           /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛DW 1 褻 蘭葬蒂 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/   function doQuery()    {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var version			= document.all.version.value;       var item_type	    = document.all.item_type.value;		//粽楠萄 嶸⑽       var sales_cat05		= document.all.sales_cat05.value;                      //剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )       GridObj.SetParam("mode", "search");       GridObj.SetParam("version", version);              GridObj.SetParam("item_type", item_type);       GridObj.SetParam("sales_cat05", sales_cat05);              GridObj.DoQuery(servlet_url);   }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛DW 2 褻 蘭葬蒂 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function doQuery2(nRow) {		var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id		= GridObj.GetCellValue("ITEM_ID", nRow);		var version		= document.all.version.value;		//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("version", version);   	GridObj2.SetParam("item_id", item_id);		GridObj2.DoQuery(servlet_url);}//--------------------------------------   main_template 縑 薑曖脹 Event ---------------------------------------------------///*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid Cell Change Event  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function Grid2ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {		}// 盪濰function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";		doSave();		};// 盪濰-詭檣斜葬萄function doSave() { 	var GridObj 		= document.WiseGrid;	var servlet_url 	= Project_name+"/servlet/com.wisegrid.admin."+job_id;		var version		  	= document.all.version.value;	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("version", version);	GridObj.DoQuery(servlet_url, "CRUD");	 return;}function doSave2() { 	var GridObj2 		= document.WiseGrid2;	var servlet_url 	= Project_name+"/servlet/com.wisegrid.admin."+job_id;		var version		  	= document.all.version.value;	GridObj2.SetParam("mode", "save2");	GridObj2.SetParam("user_id", document.frm._user_id.value);	GridObj2.SetParam("version", version);		GridObj2.DoQuery(servlet_url, "CRUD");	 	return;}function GridSetColor(){			var rowcount = GridObj2.GetRowCount(); 		for(var i =0; i < rowcount; i++){				var gubn = GridObj2.GetCellValue('GUBN',i);				if (gubn == "褒瞳"){						GridObj2.SetCellBgColor('LEAD_1', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_2', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_3', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_4', i , '212|244|250');			GridObj2.SetCellBgColor('EXPT_DATE', i , '212|244|250');			GridObj2.SetCellBgColor('IPGO_DATE', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_TIME', i , '212|244|250');					}							}	}function changeValue(obj){		var sales_cat05 = obj.value;	var item_type = document.frm.item_type.options;		commonUtil.getSelQeury( "sales_cat05", sales_cat05, "ip_01130_import_md_PlanAnalysis_list_combo",{	callback:function(result){						//褫暮 雖辦晦 ⑷營 select option 偎熱虜躑			for(var i = item_type.length-1 ; i >=1 ; i--){				   		item_type.options[i] =null;		  	}						//褫暮 瓣辦晦 result 偎熱虜躑虜			for(var i=0; i<result.length ; i++) {	 	   		item_type.options[i+1] = new Option(result[i][1],result[i][0]);	  		}					}			});	}function GoIf(){	if(confirm("摹鷗 ж褐 ヶ跡曖 ERP 瞪歎擊 挨匹牮簸睍懂炱?") == 1 ) {			}	else{		return;	}		var GridObj		= document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var version		= document.all.version.value;	 	//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj.SetParam("mode",			"doIf");	GridObj.SetParam("user_id", 		document.frm._user_id.value);	GridObj.SetParam("version",		version);		//WiseGrid檜 憮幗諦 鱔褐衛縑 等檜攪蒂 瞪殖ж朝 詭憮萄殮棲棻. 鱔褐檜 撩奢ж賊 true蒂 奩納桭炴.	GridObj.DoQuery(servlet_url, "SELECTED");	}function GridSetBL(){				var rowcount = GridObj2.GetMergeCount('PR_NO');	 for (var i=0; i<rowcount; i++){	 		 	var idx		= GridObj2.GetRowIndexFromMergeIndex('PR_NO',i,false);	 //	GridObj2.SetCellValue('BL_NO',idx,'0000000000');	 }	}