//## 프로그램ID      : ip_03030_Long_Term_Hawa_Planning.js//## 프로그램명      : 중장기 상품발주 계획(신규)//## 개발자          : 이강욱//## 개발일자        : 2016-03-28//##//## 관련 job file   : job_sinc_30_orderPlanning_08.xml//## 관련 query file : query_sinc_30_orderPlanning_08.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             전역 변수            ----------------------------------------------////var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)var job_id = 'ip_03030_Long_Term_Hawa_Planning';var GridObj ; 													// WiseGrid 객체var GridObj2;var GridObj3;//var GridObj4;//var GridObj5;Fvar color_tot 		 = '234|234|234';			//합계 라인 배경색var color_edit_col   = '255|253|208';var color_sp 		 = '230|222|230'; 			//컬럼 구분선 배경색var color_select_row = '141|232|141';			//라인 선택 배경색 var colBg01 		 = '224|255|224';			//255|255|153var colBg02 	     = '255|255|255';/*┌──────────────────────────────────┐  │그리드의 사이즈 조절 Fnc  └──────────────────────────────────┘*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅         // ==> 화면이 더이상 축소되지 않음         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         //document.WiseGrid.height = tableHeightValue + "px";          document.WiseGrid2.height = tabHeightValue - document.WiseGrid.height+ "px";        //document.WiseGrid3.height = tableHeightValue - document.WiseGrid.height + "px";             }  /*┌─────────────────────────────────────────────────────────────────────┐  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│  └─────────────────────────────────────────────────────────────────────┘*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader(GridObj);  	//해더생성 	setDefault();        	//화면 기본 설정 }   function init2() {	GridObj2 = document.WiseGrid2;	setProperty(GridObj2);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader2(GridObj2);  	//해더생성 	setDefault2();        	//화면 기본 설정 }         /*┌──────────────────────────────────┐  │화면 기본 설정 부분.  └──────────────────────────────────┘*/function setDefault() { 		//GridObj.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 		GridObj.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.	//GridObj.bHDMoving = true;		// 컬럼 헤더 위치 이동    GridObj.nHDLineSize         = 10; //Header Size        //헤더의 라인수를 설정한다.     GridObj.nHDLines = 2;          //선택된 셀의 글자색 지정한다.	GridObj.strSelectedCellFgColor = '0|0|0';	GridObj.strSelectedCellBgColor = '232|232|255'; //Drag로 선택된 셀의 배경색상을 변경할 수 있다	GridObj.strActiveRowBgColor    = "232|245|213";    //선택된 행의 배경색상을 설정한다.	    GridObj.strHDClickAction 	   = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.    GridObj.strMouseWheelAction='page';	// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9    }function setDefault2() { 		//GridObj2.bRowSelectorVisible	= false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	//GridObj2.bRowSelectorIndex		= true;					//Row Selector 영역에 Row Index를 보여준다.    GridObj2.nHDLineSize			= 10;					//Header Size        //선택된 셀의 글자색 지정한다.    GridObj2.strActiveRowBgColor	= "232|245|213";		//선택된 행의 배경색상을 설정한다.    GridObj2.strSelectedCellFgColor = '180|82|205';    GridObj2.strHDClickAction		= "select";        		//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj2.nCellFontSize			= 9;					// Font Size 9    //GridObj2.bStatusbarVisible		= false;				// status bar visible 상태바 설정     GridObj2.nHDLines				= 2;}       /*┌──────────────────────────────────┐  │해더생성  └──────────────────────────────────┘*/ function setHeader(GridObj) {        	GridObj.AddHeader("CRUD"				,"CRUD"       		,"t_text" 		,100    ,0   ,false);  	GridObj.AddHeader("SELECTED"			," "       			,"t_checkbox" 	,2		,22  ,true); //0    	GridObj.AddHeader("IF_FLAG"				,"전송\n상태"     	,"t_text" 		,100	,38  ,false); //0   	GridObj.AddHeader("ITEM_ID"				,"품목번호"      		,"t_text" 		,20		,70  ,false); //0    	GridObj.AddHeader("ITEM_NAME"			,"품목명"      	 	,"t_text" 		,100	,160 ,false); //0     	GridObj.AddHeader("TERM_VAL"			,"유통기한"    	 	,"t_text" 		,100	,60  ,false); //0   	GridObj.AddHeader("OPER_VAL"			,"운영기한"    	 	,"t_text" 		,100	,60  ,false); //0   	GridObj.AddHeader("BASE_STOCK"			,"현재고"       		,"t_number" 	,100.3	,60  ,false); //0 	//가용일 이중헤더 	GridObj.AddHeader("SEL_DMD"				,"구분"     			,"t_combo"		,100	,60  ,true); //0 	GridObj.AddHeader("AVL_DAY"				,"가용일수"    		,"t_text" 		,100	,60  ,false); //0   	GridObj.AddHeader("PROD_TERM"			,"유통기한\n잔여일"    ,"t_text" 		,100	,60  ,false); //0  	//진행중 재고 이중헤더 	GridObj.AddHeader("RECEIPT_M"			,"1-10"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("RECEIPT_M2"			,"11-20"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("RECEIPT_M3"			,"21-30"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("MON_M01"				,"M+1"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("MON_M02"				,"M+2"   	 		,"t_number" 	,100.3	,60  ,false); //0   	GridObj.AddHeader("TOT_AVL_DAY"			,"총가용일"    		,"t_text" 		,100	,80  ,false); //0 	 	//일 판매실적 이중헤더 	GridObj.AddHeader("SALES_MEAN_3WEEK_ETC"	,"3주평균"      		,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("SALES_MEAN_3MON_TA"		,"3개월평균"      	,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("SALES_PY_MON_CUM_TA"		,"전년동월"      		,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("SALES_USER"				,"사용자"      		,"t_number" 	,100.3	,60  ,true); //0 	 	 	GridObj.AddHeader("LEAD_TIME"			,"입고\n리드타임"    	,"t_text" 		,100	,90  ,false); //0 	GridObj.AddHeader("MINMPSQTY"			,"MOQ"    			,"t_text" 		,100	,60  ,true); //0    	GridObj.AddHeader("BOX_PER_PALET"		,"PALET당\n박스수" 	 ,"t_text" 		,100	,60  ,false); //0    	GridObj.AddHeader("BOX_DEMAND"			,"요구량\n(PALET)" 	,"t_text" 		,100	,60  ,true); //0    	GridObj.AddHeader("PR_QTY"				,"PR수량"        	,"t_number" 	,100.3	,60  ,false); //0 	GridObj.AddHeader("MEINS"				,"발주단위"    		,"t_text" 		,100	,60  ,false); //0 	GridObj.AddHeader("IPGO_DATE"			,"입고요청일" 		,"t_date"   	,100	,90  ,true); //0 	GridObj.AddHeader("PR_NO"				,"PR 번호"     		,"t_text" 		,100	,100  ,false); //0    	GridObj.AddHeader("IF_MSGS"				,"IF 메세지"      	,"t_text" 		,100	,200 ,false); //0  	 	GridObj.AddGroup	("AVL",		"가용일"); 	GridObj.AppendHeader("AVL", 	"SEL_DMD"); 	GridObj.AppendHeader("AVL", 	"AVL_DAY"); 	 	GridObj.AddGroup	("PROCESS",   	"진행중 재고");				GridObj.AppendHeader("PROCESS", 	"RECEIPT_M");	GridObj.AppendHeader("PROCESS", 	"RECEIPT_M2");	GridObj.AppendHeader("PROCESS", 	"RECEIPT_M3");	GridObj.AppendHeader("PROCESS",   	"MON_M01");	GridObj.AppendHeader("PROCESS",   	"MON_M02");		GridObj.AddGroup	("SALES",   "일 판매실적");				GridObj.AppendHeader("SALES", 	"SALES_MEAN_3WEEK_ETC");	GridObj.AppendHeader("SALES", 	"SALES_MEAN_3MON_TA");	GridObj.AppendHeader("SALES", 	"SALES_PY_MON_CUM_TA");	GridObj.AppendHeader("SALES",   "SALES_USER");		GridObj.BoundHeader();			GridObj.SetDateFormat("IPGO_DATE",'yyyy-MM-dd');		GridObj.SetColCellBgColor('SEL_DMD',		color_edit_col);	GridObj.SetColCellBgColor('MINMPSQTY',		color_edit_col);	GridObj.SetColCellBgColor('BOX_DEMAND',		color_edit_col);	GridObj.SetColCellBgColor('IPGO_DATE',		color_edit_col);	GridObj.SetColCellBgColor('SALES_USER',		color_edit_col);		GridObj.SetColCellBgColor('TOT_AVL_DAY',	'178|235|244');			GridObj.SetNumberFormat("RECEIPT_M"  			,"###,###.#");	GridObj.SetNumberFormat("RECEIPT_M2"  			,"###,###.#");	GridObj.SetNumberFormat("RECEIPT_M3"  			,"###,###.#");	GridObj.SetNumberFormat("MON_M01"  				,"###,###.#");	GridObj.SetNumberFormat("MON_M02"  				,"###,###.#");	GridObj.SetNumberFormat("BASE_STOCK"  			,"###,###.#");	GridObj.SetNumberFormat("SALES_MEAN_3WEEK_ETC"  ,"###,###.#");	GridObj.SetNumberFormat("SALES_MEAN_3MON_TA"  	,"###,###.#");	GridObj.SetNumberFormat("SALES_PY_MON_CUM_TA"  	,"###,###.#");	GridObj.SetNumberFormat("SALES_USER"  			,"###,###.#");	GridObj.SetNumberFormat("PR_QTY"  				,"###,###.#");	GridObj.SetColCellAlign('IPGO_DATE'		,'center');    GridObj.SetColCellAlign('ITEM_ID'		,'center');     GridObj.SetColCellAlign('ITEM_NAME'		,'left');     GridObj.SetColCellAlign('TERM_VAL'		,'right');     GridObj.SetColCellAlign('OPER_VAL'		,'right');     GridObj.SetColCellAlign('PROD_TERM'		,'right');     GridObj.SetColCellAlign('AVL_DAY'		,'right');     GridObj.SetColCellAlign('TOT_AVL_DAY'	,'center');     GridObj.SetColCellAlign('MEINS'			,'center');     GridObj.SetColCellAlign('LEAD_TIME'		,'right');     GridObj.SetColCellAlign('MINMPSQTY'		,'right');     GridObj.SetColCellAlign('BOX_PER_PALET'	,'right');     GridObj.SetColCellAlign('BOX_DEMAND'	,'right');     GridObj.SetColCellAlign('PR_QTY'		,'right'); 		GridObj.SetColFix('ITEM_NAME');	GridObj.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	GridObj.SetColHide("CRUD",true);}   function setHeader2(GridObj2) {        	GridObj2.AddHeader("CRUD"		,"CRUD"       	,"t_text" 	,100    	,0   ,false);  	GridObj2.AddHeader("ITEM_ID"	,"품목번호"      	,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("ITEM_NAME"	,"품목명"       	,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("PR_NO"		,"PR번호"       	,"t_text" 	,100		,80  ,false); //0     	GridObj2.AddHeader("PR_DATE"	,"PR일자"      	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("PR_QTY"		,"PR수량"       	,"t_number" ,100.3		,60  ,false); //0   	     	GridObj2.AddHeader("PO_NO"		,"PO번호"      	,"t_text" 	,100		,80  ,false); //0  	GridObj2.AddHeader("PO_DATE"	,"PO일자"     	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("PO_QTY"		,"PO수량"       	,"t_number" ,100.3		,60  ,false); //0   	  	//GridObj2.AddHeader("HBL_NO"		,"HBL번호"       ,"t_text" 	,100		,90  ,false); //0  	GridObj2.AddHeader("BL_NO"		,"BL번호"       	,"t_text" 	,100		,0  ,false); //0  	  	GridObj2.AddHeader("BL_QTY"		,"분할수량"      	,"t_text" 	,100		,60  ,false); //0 	  	GridObj2.AddHeader("GUBN"		,"진행일정"      	,"t_text" 	,100		,60  ,false); //0  	GridObj2.AddHeader("LEAD_1"		,"선적"       	,"t_text" 	,100		,70  ,false); //0  	GridObj2.AddHeader("LEAD_2"		,"입항"       	,"t_text" 	,100		,70  ,false); //0  	GridObj2.AddHeader("LEAD_3"		,"통관"       	,"t_text" 	,100		,70  ,false); //0  	  	GridObj2.AddHeader("TEXT_1"		,"보세창고\n반입" 	,"t_text" 	,4		,70  ,true); //0  	GridObj2.AddHeader("TEXT_2"		,"시작" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_3"		,"종료" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_4"		,"접수" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_5"		,"완료" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_6"		,"접수" 			,"t_text" 	,4		,50  ,true); //0  	GridObj2.AddHeader("TEXT_7"		,"완료" 			,"t_text" 	,4		,50  ,true); //0  	  	GridObj2.AddHeader("LEAD_4"		,"입고"       	,"t_text" 	,100		,80  ,false); //0  	GridObj2.AddHeader("IPGO_DATE"	,"입고요청일"     ,"t_text" 	,100		,90  ,false); //0  	GridObj2.AddHeader("EXPT_DATE"	,"예상입고일"     ,"t_text" 	,100		,90  ,false); //0  	GridObj2.AddHeader("LEAD_TIME"	,"PR-입고"    	,"t_text" 	,100		,70  ,false); //0  	GridObj2.AddHeader("BIGO"		,"특이사항"     	,"t_text" 	,100		,120 ,true); //0  	GridObj2.AddHeader("BIGO2"		,"공급차질"    	,"t_text" 	,100		,80  ,true); //0  	GridObj2.AddHeader("SEQ"		,"SEQ"    		,"t_text" 	,100		,0   ,true); //0  	  	/* 이중 해더 추가 */	GridObj2.AddGroup	 ("HD1",	"스티커작업");			 	GridObj2.AppendHeader("HD1", 	"TEXT_2");	GridObj2.AppendHeader("HD1", 	"TEXT_3");		GridObj2.AddGroup	 ("HD2",	"검역");			 	GridObj2.AppendHeader("HD2", 	"TEXT_4");	GridObj2.AppendHeader("HD2", 	"TEXT_5");		GridObj2.AddGroup	 ("HD3",	"방사능검사");			 	GridObj2.AppendHeader("HD3", 	"TEXT_6");	GridObj2.AppendHeader("HD3", 	"TEXT_7"); 	    	GridObj2.BoundHeader();		GridObj2.SetColCellAlign('PR_NO'	,'center');	GridObj2.SetColCellAlign('PR_DATE'	,'center');	GridObj2.SetColCellAlign('PO_NO'	,'center');	GridObj2.SetColCellAlign('PO_DATE'	,'center');	GridObj2.SetColCellAlign('GUBN'		,'center');	GridObj2.SetColCellAlign('LEAD_1'	,'center');	GridObj2.SetColCellAlign('LEAD_2'	,'center');	GridObj2.SetColCellAlign('LEAD_3'	,'center');	GridObj2.SetColCellAlign('LEAD_4'	,'center');	GridObj2.SetColCellAlign('LEAD_TIME'	,'center');	GridObj2.SetColCellAlign('IPGO_DATE'	,'center');	GridObj2.SetColCellAlign('EXPT_DATE'	,'center');		GridObj2.SetColCellAlign('PR_QTY'	,'right');	GridObj2.SetColCellAlign('PO_QTY'	,'right');	GridObj2.SetColCellAlign('BL_QTY'	,'right');	GridObj2.SetNumberFormat("PR_QTY"  	,"###,###.#");	GridObj2.SetNumberFormat("PO_QTY"  	,"###,###.#");		GridObj2.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	GridObj2.SetColHide("CRUD",true);		}/*┌──────────────────────────────────┐  │WiseGrid Change Combo Event  └──────────────────────────────────┘*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){		if( strColumnKey == "SEL_DMD"){				if(nNewIndex == 0) {		//3개월평균						var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);			var month 	= GridObj.GetCellValue('SALES_MEAN_3MON_TA',nRow);			var avl		= Math.round(stock/month,1);			GridObj.SetCellValue('AVL_DAY',nRow,avl);					}else if(nNewIndex == 1){	//3주평균					var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);			var month 	= GridObj.GetCellValue('SALES_MEAN_3WEEK_ETC',nRow);			var avl		= Math.round(stock/month,1);			GridObj.SetCellValue('AVL_DAY',nRow,avl);					}else if(nNewIndex == 2){	//사용자					var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);						var month 	= GridObj.GetCellValue('SALES_USER',nRow);			if(month == 0){				var avl		= 0;			}else{				var avl		= Math.round(stock/month,1);			}						GridObj.SetCellValue('AVL_DAY',nRow,avl);					}else{						//전년동월					var stock 	= GridObj.GetCellValue('BASE_STOCK',nRow);			var month 	= GridObj.GetCellValue('SALES_PY_MON_CUM_TA',nRow);			var avl		= Math.round(stock/month,1);			GridObj.SetCellValue('AVL_DAY',nRow,avl);					}			}	}function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {		if( strColumnKey == "BOX_DEMAND"){				var pr_qty = GridObj.GetCellValue('BOX_PER_PALET',nRow) * GridObj.GetCellValue('BOX_DEMAND',nRow);		GridObj.SetCellValue('PR_QTY',nRow,pr_qty);	}		}/*┌──────────────────────────────────┐  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc  └──────────────────────────────────┘*/function GridEndQuery(){	    var endMode = GridObj.GetParam("mode");    var error_msg = '';              if(endMode == "search") //조회가 완료된 경우    {        if(GridObj.GetStatus() == "true")         {                                    }else            {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }    else if(endMode == "save") {		if(GridObj.GetStatus() == "true"){								doSave2();			}		else {			var error_msg = GridObj3.GetMessage();// 				alert(error_msg);					}    }   	}function GridEndQuery2() {	var mode = GridObj2.GetParam("mode");	var error_msg = '';	          	if(mode == "search2") {		if(GridObj2.GetStatus() == "true") {											 	GridObj2.SetGroupMerge('PR_NO,PR_DATE,PR_QTY,PO_NO,PO_DATE,PO_QTY');		 	GridObj2.AddSummaryBar('SUMMARY', '소계', 'PR_NO', 'sum', ''); 			GridObj2.SetSummaryBarColor('SUMMARY','0|153|0', color_tot); 			GridSetColor();			GridSetBL();					}		else { 			error_msg = GridObj2.GetMessage(); 			alert(error_msg);            		}	}	 	}/*┌──────────────────────────────────┐  │그리드의 원 클릭 이벤트  └──────────────────────────────────┘*/function GridCellClick(strColumnKey, nRow) {}	               /*┌──────────────────────────────────┐  │화면에 '조회'를 누르면 호출 Fnc  └──────────────────────────────────┘*/   function GoSearch(service)    {    doQuery();   	GridObj2.ClearGrid( ); 	setHeader2(GridObj2);			   } /*┌──────────────────────────────────┐  │하부 그리드 조회 WD1 더블클릭  └──────────────────────────────────┘*/function GridCellDblClick(strColumnKey, nRow){ 		/* 수입상품 발주관리 팝업창 */	var item_id		= GridObj.GetCellValue('ITEM_ID',nRow)	var	item_name	= GridObj.GetCellValue('ITEM_NAME',nRow)	var cnfm_date	= document.frm.version.value;		if(strColumnKey == 'ITEM_NAME'){		var service_url = "service.do?_moon_service=ip_01130_import_md_PlanAnalysis_list_pop";		service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&cnfm_date=" + cnfm_date ;		var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=yes, resizable=yes, width=1135, height=740, top=50, left=200";		var newWin = window.open(service_url, "", pop_win_style);		newWin.focus();						}else{				doQuery2(nRow);	}	}           /*┌──────────────────────────────────┐  │DW 1 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/   function doQuery()    {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var version			= document.all.version.value;       var item_type	    = document.all.item_type.value;		//브랜드 유형       var sales_cat05		= document.all.sales_cat05.value;                      //넘겨줄 값들을만든다.( 파라미터 정의 부분 )       GridObj.SetParam("mode", "search");       GridObj.SetParam("version", version);              GridObj.SetParam("item_type", item_type);       GridObj.SetParam("sales_cat05", sales_cat05);              GridObj.DoQuery(servlet_url);   }/*┌──────────────────────────────────┐  │DW 2 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery2(nRow) {		var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id		= GridObj.GetCellValue("ITEM_ID", nRow);		var version		= document.all.version.value;		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("version", version);   	GridObj2.SetParam("item_id", item_id);		GridObj2.DoQuery(servlet_url);}//--------------------------------------   main_template 에 정의된 Event ---------------------------------------------------///*┌──────────────────────────────────┐  │WiseGrid Cell Change Event  └──────────────────────────────────┘*/function Grid2ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {		}// 저장function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";		doSave();		};// 저장-메인그리드function doSave() { 	var GridObj 		= document.WiseGrid;	var servlet_url 	= Project_name+"/servlet/com.wisegrid.admin."+job_id;		var version		  	= document.all.version.value;	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("version", version);	GridObj.DoQuery(servlet_url, "CRUD");	 return;}function doSave2() { 	var GridObj2 		= document.WiseGrid2;	var servlet_url 	= Project_name+"/servlet/com.wisegrid.admin."+job_id;		var version		  	= document.all.version.value;	GridObj2.SetParam("mode", "save2");	GridObj2.SetParam("user_id", document.frm._user_id.value);	GridObj2.SetParam("version", version);		GridObj2.DoQuery(servlet_url, "CRUD");	 	return;}function GridSetColor(){			var rowcount = GridObj2.GetRowCount(); 		for(var i =0; i < rowcount; i++){				var gubn = GridObj2.GetCellValue('GUBN',i);				if (gubn == "실적"){						GridObj2.SetCellBgColor('LEAD_1', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_2', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_3', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_4', i , '212|244|250');			GridObj2.SetCellBgColor('EXPT_DATE', i , '212|244|250');			GridObj2.SetCellBgColor('IPGO_DATE', i , '212|244|250');			GridObj2.SetCellBgColor('LEAD_TIME', i , '212|244|250');					}							}	}function changeValue(obj){		var sales_cat05 = obj.value;	var item_type = document.frm.item_type.options;		commonUtil.getSelQeury( "sales_cat05", sales_cat05, "ip_01130_import_md_PlanAnalysis_list_combo",{	callback:function(result){						//옵션 지우기 현재 select option 갯수만큼			for(var i = item_type.length-1 ; i >=1 ; i--){				   		item_type.options[i] =null;		  	}						//옵션 채우기 result 갯수만큼만			for(var i=0; i<result.length ; i++) {	 	   		item_type.options[i+1] = new Option(result[i][1],result[i][0]);	  		}					}			});	}function GoIf(){	if(confirm("선택 하신 품목의 ERP 전송을 확정하시겠습니까?") == 1 ) {			}	else{		return;	}		var GridObj		= document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var version		= document.all.version.value;	 	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode",			"doIf");	GridObj.SetParam("user_id", 		document.frm._user_id.value);	GridObj.SetParam("version",		version);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "SELECTED");	}function GridSetBL(){				var rowcount = GridObj2.GetMergeCount('PR_NO');	 for (var i=0; i<rowcount; i++){	 		 	var idx		= GridObj2.GetRowIndexFromMergeIndex('PR_NO',i,false);	 //	GridObj2.SetCellValue('BL_NO',idx,'0000000000');	 }	}