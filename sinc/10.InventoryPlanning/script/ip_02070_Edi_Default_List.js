//## 프로그램ID      : ip_02070_Edi_Default_List.vm//## 프로그램명      : SCM품목추적조회//## 개발자          : 남웅용//## 개발일자        : 2009-07-16//##//## 관련 job file   : job_op_02010_Long_Term_Planning_list.xml//## 관련 query file : query_op_02010_Long_Term_Planning_list.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.0        2009-07-16  남웅용      create//##//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             전역 변수            ----------------------------------------------////var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)var job_id = 'ip_02070_Edi_Default_List';var GridObj ; 													// WiseGrid 객체var GridObj2;var GridObj3;var GridObj4;//var GridObj5;var color_tot = '234|234|234';			//합계 라인 배경색var color_edit_col = '255|253|208';var color_sp = '230|222|230'; 			//컬럼 구분선 배경색var color_select_row = '141|232|141';	//라인 선택 배경색var colBg01 = '224|255|224';			//255|255|153var colBg02 = '255|255|255';/*┌──────────────────────────────────┐  │그리드의 사이즈 조절 Fnc  └──────────────────────────────────┘*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅         // ==> 화면이 더이상 축소되지 않음         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         //document.WiseGrid.height = tableHeightValue + "px";         document.WiseGrid2.height = tableHeightValue - document.WiseGrid.height + "px";        //document.WiseGrid3.height = tableHeightValue - document.WiseGrid.height + "px";             }  /*┌─────────────────────────────────────────────────────────────────────┐  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│  └─────────────────────────────────────────────────────────────────────┘*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader(GridObj);  	//해더생성 	setDefault();        	//화면 기본 설정 }   function init2() {	GridObj2 = document.WiseGrid2;	setProperty(GridObj2);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader2(GridObj2);  	//해더생성 	setDefault2();        	//화면 기본 설정 }   function init3() {	GridObj3 = document.WiseGrid3;	setProperty(GridObj3);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader3(GridObj3);  	//해더생성 	setDefault3();        	//화면 기본 설정 }function init4() {	GridObj4 = document.WiseGrid4;	setProperty(GridObj4);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader4(GridObj4);  	//해더생성 	setDefault4();        	//화면 기본 설정 }         /*┌──────────────────────────────────┐  │화면 기본 설정 부분.  └──────────────────────────────────┘*/function setDefault() { 	GridObj.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj.nHDLineSize         = 10; //Header Size        //헤더의 라인수를 설정한다.     GridObj.nHDLines = 2;              //선택된 셀의 글자색 지정한다.    GridObj.strSelectedCellFgColor = '180|82|205';    GridObj.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.     GridObj.strHDClickAction    = "sortsingle";             GridObj.strMouseWheelAction='page';    	// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9	//GridObj.strCellFontName = '맑은 고딕';     //GridObj.bStatusbarVisible = false;				// status bar visible 상태바 설정     }function setDefault2() { 	GridObj2.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj2.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj2.nHDLineSize         = 12; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    //헤더의 라인수를 설정한다.     //GridObj2.nHDLines = 2;            //선택된 셀의 글자색 지정한다.    GridObj2.strSelectedCellFgColor = '180|82|205';    GridObj2.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj2.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	// Cell Font Setting	GridObj2.nCellFontSize = 9;					// Font Size 9	//GridObj2.strCellFontName = '맑은 고딕'; }function setDefault3() { 	GridObj3.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj3.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj3.nHDLineSize         = 13; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    //선택된 셀의 글자색 지정한다.    GridObj3.nHDLines = 2;            GridObj3.strSelectedCellFgColor = '180|82|205';    GridObj3.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj3.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj3.nCellFontSize = 9;					// Font Size 9    //GridObj3.bStatusbarVisible = false;				// status bar visible 상태바 설정 }function setDefault4() {  	GridObj4.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj4.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj4.nHDLineSize         = 12; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";     //GridObj4.bStatusbarVisible = false;				// status bar visible 상태바 설정             //선택된 셀의 글자색 지정한다.    GridObj4.strSelectedCellFgColor = '180|82|205';    GridObj4.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj4.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj4.nCellFontSize = 9;					// Font Size 9}       /*┌──────────────────────────────────┐  │해더생성  └──────────────────────────────────┘*/ function setHeader(GridObj) {        	//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	GridObj.AddHeader("CRUD"			,"CRUD"       	,"t_text" 		,100    ,60  ,false);  	  	GridObj.AddHeader("SELECTED"		," "       		,"t_checkbox" 	,2		,21  ,true); //0   		//GridObj.SetColHide("CRUD", true); 	GridObj.AddHeader("CNFM_DATE"		,"작업일"			,"t_text"	,20		,54  ,false); //0    	GridObj.AddHeader("SELL_STOP_DATE"	,"판매\n중지"		,"t_text" 	,100	,33 ,false); //0    	GridObj.AddHeader("ALLOC_FLAG"		,"공급할당\n여부"	,"t_text" 	,100	,33  ,false); //0 	GridObj.AddHeader("ITEM_ID"			,"품목코드"		,"t_text"	,100	,65 ,false); //0 	GridObj.AddHeader("ITEM_NAME"		,"품목명"			,"t_text" 	,100	,180 ,false); //0     	GridObj.AddHeader("SPEC"			,"SPEC"			,"t_text" 	,100	,0 ,false); //0    	GridObj.AddHeader("CUST_CODE"		,"거래처코드"		,"t_text" 	,100	,0  ,false); //0    	GridObj.AddHeader("CUST_NAME"		,"거래처명"		,"t_text" 	,160	,140  ,false); //0 	//TOT_LEAD_TIME 리드타임의 일자 환산  	GridObj.AddHeader("EDI_QTY"			,"발주량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj.AddHeader("DEFAULT_QTY"		,"미납량"			,"t_number" ,100.3	,50  ,false); //0 	GridObj.AddHeader("AMOUNT"			,"단가"			,"t_number" ,100.3	,50  ,false); //0    	GridObj.AddHeader("DEFAULT_AMOUNT"	,"미납\n금액"		,"t_number" ,100.3	,50  ,false); //0   	GridObj.AddHeader("DEFAULT_GUBN"	,"귀책\n구분"		,"t_text"	,100	,50 ,false); //0 	GridObj.AddHeader("DEFAULT_CODE"	,"사유코드"		,"t_text" 	,100	,0  ,false);     	GridObj.AddHeader("CODE_NAME"		,"사유명"     	,"t_combo" 	,100	,150  ,true); //0    	GridObj.AddHeader("DC_ID"			,"배송지점코드"	,"t_text" 	,100	,0  ,false); //0    	GridObj.AddHeader("DC_NAME"			,"배송지점"		,"t_text" 	,100	,60  ,false); //0    	GridObj.AddHeader("DEPT_CODE"		,"영업지점코드"	,"t_text" 	,100	,0  ,false); //0    	GridObj.AddHeader("DEPT_NAME"		,"영업지점"		,"t_text" 	,100	,75  ,false); //0    	GridObj.AddHeader("HAN_NAME"		,"담당자"			,"t_text" 	,100	,50  ,false); //0    	GridObj.AddHeader("TEL_NO"			,"연락처"			,"t_text" 	,100	,93  ,false); //0    	GridObj.AddHeader("COMMT"			,"비고"			,"t_text" 	,100	,0 	,false); //0 	GridObj.AddHeader("EDI_GUBN"		,"EDI\nGUBN"	,"t_text" 	,100	,0 ,false); //0	/* 저장을 위한 히든 값 */ 	GridObj.AddHeader("CUST_ITEM_ID"	,"CUST_ITEM_ID"		,"t_text" 	,100	,0 	,false); //0 	GridObj.AddHeader("CUST_STORE_CODE"	,"CUST_STORE_CODE"	,"t_text" 	,100	,0 	,false); //0	GridObj.BoundHeader();	    GridObj.SetColCellAlign('DEFAULT_GUBN','center');     GridObj.SetColCellAlign('CNFM_DATE','center');     GridObj.SetColCellAlign('ITEM_ID','center');     GridObj.SetColCellAlign('DC_NAME','center');    GridObj.SetColCellAlign('DEPT_NAME','center');    GridObj.SetColCellAlign('HAN_NAME','center');     GridObj.SetColCellAlign('TEL_NO','center');     GridObj.SetColCellAlign('ALLOC_FLAG','center');     GridObj.SetColCellAlign('SPEC','right'); 	GridObj.SetColFix('ITEM_NAME');	//GridObj.SetColCellBgColor('SEL_DMD',color_edit_col);//기준재고    //GridObj.SetNumberFormat("BASE_STOCK"  , "#,##0");	//GridObj.SetColHDBgColor('TOT_STOCK','253|228|229');    //GridObj.bCellFontBold = true; 		GridObj.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	//Hidden 컬럼	GridObj.SetColHide("CRUD",true);}/*┌──────────────────────────────────┐  │WiseGrid Change Combo Event  └──────────────────────────────────┘*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){		/*	// if 진행중인 데이터는 수정 불가!!	var if_flag	= GridObj.GetCellValue("IF_FLAG", nRow);	if( if_flag == "" || if_flag == null) {	}else{		alert("확정된 항목은 수정하실수 없습니다!");		GridObj.SetComboSelectedIndex(strColumnKey, nRow,  nOldIndex);		return; 	}		 		var version		= document.all.version.value;	    var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);    document.all.sel_dmd.value = sel_dmd;    document.all.sel_item_id.value = sel_item_id;    */        //doQuery3(nRow);    	//alert("calPrDateNo 시작");    	//calPrDateNo(nRow);		};function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {  //pr_qty}function Grid3ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {}   function setHeader2(GridObj2) { // 주문정보  	GridObj2.AddHeader("GUBN"		,"주문정보"      	,"t_text" 	,10			,70  ,false); //0   	GridObj2.AddHeader("CUST_CODE"	,"거래처코드"     ,"t_text" 	,500		,0  ,false); //0    	GridObj2.AddHeader("CUST_NAME"	,"거래처명"      	,"t_text" 	,500		,0  ,false); //0     	GridObj2.AddHeader("SLIP_NO"	,"전표번호"       ,"t_text" 	,100		,80  ,false); //0     	GridObj2.AddHeader("SEQ_NO"		,"SEQ_NO"       ,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("REQT_QTY"	,"주문수량"      	,"t_number" ,100.3		,80  ,false); //0     	GridObj2.AddHeader("SELL_QTY"	,"마감수량"      	,"t_number" ,100.3		,80  ,false); //0     	GridObj2.AddHeader("SHORTAGE_GUBN"	,"결품사유"  ,"t_text" 	,100		,180  ,false); //0     	GridObj2.AddHeader("IPUT_DTTM"	,"입력시간"      	,"t_text" 	,100		,140  ,false); //0      	GridObj2.AddHeader("CLOS_DTTM"	,"마감시간"      ,"t_text" 	,100		,140  ,false); //0     	GridObj2.AddHeader("CHGO_GUBN"	,"전표상태"		,"t_text" 	,100		,77  ,false); //0   화면 감춤	 	    	GridObj2.BoundHeader();		//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	//GridObj.SetColHide("CRUD", true); 		//GridObj.SetColHDCheckBoxVisible('SELECTED',true,true);	//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	//GridObj.SetColHide("CRUD", true); 	//GridObj.SetColHDCheckBoxVisible('SELECTED',true,true);    //GridObj2.SetColCellAlign('DEL_RANK','right');     GridObj2.SetColCellAlign('GUBN','center');     GridObj2.SetColCellAlign('SLIP_NO','center');     GridObj2.SetColCellAlign('IPUT_DTTM','center');     GridObj2.SetColCellAlign('CHGO_GUBN','center');     GridObj2.SetColCellAlign('CLOS_DTTM','center');         GridObj2.SetNumberFormat("REQT_QTY"  , "#,##0");    GridObj2.SetNumberFormat("SELL_QTY"  , "#,##0");    //GridObj2.SetColCellAlign('SELECTED','center');     	//GridObj2.SetColFix('PR_NO');}   function setHeader3(GridObj3) { //수송정보                 	GridObj3.AddHeader("DC_NAME"		,"수송정보"		,"t_text" 	,10			,60  ,false); //0     	GridObj3.AddHeader("RECEIPT_PRE"	,"전일\n입고"		,"t_number"	,100.3		,50  ,false); //0     	GridObj3.AddHeader("BASE_STOCK"		,"기초\n재고"		,"t_number"	,100.3		,50 ,false); //0     	GridObj3.AddHeader("IPGO"			,"입고"      	,"t_number" ,100.3		,50  ,false); //0     	GridObj3.AddHeader("CHGO"			,"출고"      	,"t_number" ,100.3		,50  ,false); //0     	GridObj3.AddHeader("REQT_QTY"		,"주문\n수량"  	,"t_number" ,100.3		,0  ,false); //0      	GridObj3.AddHeader("CONFIRM_QTY"	,"마감\n수량"		,"t_number" ,100.3		,0  ,false); //0   화면 감춤  	GridObj3.AddHeader("SHORTAGE_QTY"	,"결품\n수량" 	,"t_number" ,100.3		,0  ,false); //0  	GridObj3.AddHeader("ORDER_CNT"		,"오더\n건수" 	,"t_number" ,100.3		,0  ,false); //0  	      	GridObj3.AddHeader("SRC_LOC"		,"출고장"    		,"t_text" 	,100		,70  ,false); //0     	GridObj3.AddHeader("BRAND_NO"		,"전표\n번호"  	,"t_text" 	,100		,70  ,false); //0     	GridObj3.AddHeader("TRANS_STATE"	,"전표\n상태"		,"t_text" 	,100		,70  ,false); //0     	GridObj3.AddHeader("SHORTAGE_GUBN"	,"결품\n사유"		,"t_text" 	,100		,80  ,false); //0     	GridObj3.AddHeader("QTY"			,"수송\n계획" 	,"t_number" ,100.3		,50  ,false); //0     	GridObj3.AddHeader("CHGO_QTY"		,"출고\n수량"		,"t_number" ,100.3		,0  ,false); //0     	GridObj3.AddHeader("CHGO_DTTM"		,"출고\n일시" 	,"t_text" 	,100		,120  ,false); //0     	GridObj3.AddHeader("IPGO_DTTM"		,"입고\n일시"  	,"t_text" 	,100		,120  ,false); //0     	GridObj3.AddHeader("IPGO_QTY"		,"입고\n수량"  	,"t_number" ,100.3		,50  ,false); //0   	 	      	GridObj3.AddHeader("MIN_CLOS_DTTM"	,"배송마감\n(from)" ,"t_text" ,100		,120  ,false); //0     	GridObj3.AddHeader("MAX_CLOS_DTTM"	,"배송마감\n(to)"   ,"t_text" ,100		,120  ,false); //0	GridObj3.BoundHeader();	    //GridObj2.SetColCellAlign('DEL_RANK','right');     GridObj3.SetColCellAlign('DC_NAME','center');     GridObj3.SetColCellAlign('MIN_CLOS_DTTM','center');     GridObj3.SetColCellAlign('MAX_CLOS_DTTM','center');     GridObj3.SetColCellAlign('SRC_LOC','center');     GridObj3.SetColCellAlign('TRANS_STATE','center');     GridObj3.SetColCellAlign('CHGO_DTTM','center');     GridObj3.SetColCellAlign('IPGO_DTTM','center');         //GridObj3.SetNumberFormat("REQT_QTY"  , "#,##0");    //GridObj3.SetNumberFormat("SELL_QTY"  , "#,##0");    //GridObj2.SetColCellAlign('SELECTED','center');     	//GridObj2.SetColFix('PR_NO');}function setHeader4(GridObj4) { // EDI 정보         	GridObj4.AddHeader("GUBN"			,"EDI 정보"		,"t_text" 	,10			,60  ,false); //0     	GridObj4.AddHeader("CNFM_DATE"		,"납품일자"		,"t_text"	,100		,90  ,false); //0     	GridObj4.AddHeader("CUST_CODE"		,"거래처코드"		,"t_text"	,100		,0 ,false); //0     	GridObj4.AddHeader("OD_SLIP_NO"		,"EDI전표번호"	,"t_text" 	,100		,90  ,false); //0     	GridObj4.AddHeader("ODER_BOX"		,"EDI발주수량"	,"t_number" ,100.3		,90  ,false); //0     	GridObj4.AddHeader("CONV_BOX"		,"주문전환수량"	,"t_number" ,100.3		,90  ,false); //0     	GridObj4.AddHeader("ODER_DATE"		,"주문일자"      	,"t_text" 	,100		,0  ,false); //0     	//GridObj4.AddHeader("IPUT_DATE"		,"입력일자"  		,"t_text" 	,100		,90  ,false); //0      	GridObj4.AddHeader("IPUT_TIME"		,"입력시각"		,"t_text" 	,100		,140  ,false); //0   화면 감춤  	GridObj4.AddHeader("IPUT_EMP_NO"	,"입력자" 		,"t_text" 	,100		,0  ,false); //0  	//GridObj4.AddHeader("CONV_DATE"		,"전환일자" 		,"t_text" 	,100		,90  ,false); //0  	GridObj4.AddHeader("CONV_TIME"		,"전환시각"    	,"t_text" 	,100		,140  ,false); //0     	GridObj4.AddHeader("CONV_EMP_NO"	,"전환자"  		,"t_text" 	,100		,70  ,false); //0     	GridObj4.AddHeader("SLIP_NO"		,"영업전표번호"	,"t_text" 	,100		,90  ,false); //0   	GridObj4.BoundHeader();	    //GridObj2.SetColCellAlign('DEL_RANK','right');     GridObj4.SetColCellAlign('GUBN','center');     GridObj4.SetColCellAlign('CNFM_DATE','center');     GridObj4.SetColCellAlign('OD_SLIP_NO','center');     GridObj4.SetColCellAlign('ODER_DATE','center');     //GridObj4.SetColCellAlign('IPUT_DATE','center');     GridObj4.SetColCellAlign('IPUT_TIME','center');     GridObj4.SetColCellAlign('IPUT_EMP_NO','center');     //GridObj4.SetColCellAlign('CONV_DATE','center');     GridObj4.SetColCellAlign('CONV_TIME','center');     GridObj4.SetColCellAlign('CONV_EMP_NO','center');     GridObj4.SetColCellAlign('SLIP_NO','center');         //GridObj3.SetNumberFormat("REQT_QTY"  , "#,##0");    //GridObj3.SetNumberFormat("SELL_QTY"  , "#,##0");    //GridObj2.SetColCellAlign('SELECTED','center');     	//GridObj2.SetColFix('PR_NO');}	// 컬럼 고정function setGrid(){	//GridObj2.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT	GridObj.SetColFix('ITEM_NAME');}function setGrid2(){	GridObj2.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT	//GridObj2.SetGroupMerge('ITEM_ID,ITEM_NAME');		}function setGrid5(){	//GridObj5.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT			//GridObj5.SetGroupMerge('ITEM_NAME');	}function setGrid3(){	//GridObj3.SetColCellBgColor('PLT_QTY',color_edit_col);//PLT			}/*┌──────────────────────────────────┐  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc  └──────────────────────────────────┘*/function GridEndQuery(){	    var endMode = GridObj.GetParam("mode");    var error_msg = '';        //alert("endMode="+endMode);      if(endMode == "search") //조회가 완료된 경우    {        if(GridObj.GetStatus() == "true")         {            /*         				for(var i=0;i<GridObj.GetRowCount();i++) {			// cell색깔 변경				if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(2) ){  // GREEN					GridObj.SetCellBgColor('PR_DATE_NO', i, '200|255|110');				}else if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(1) && GridObj.GetCellValue('PR_DATE_NO',i) <= Number(2)){  // YELLOW					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|255|0');				}				else if(GridObj.GetCellValue('PR_DATE_NO',i) <= Number(1)){ // RED					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|0|0'); 				}							GridObj.SetCellFontBold('TOT_STOCK', i, 'true'); // font 굵기			GridObj.SetCellFontBold('PR_QTY', i, 'true'); // font 굵기			GridObj.SetCellFontBold('STD_STOCK', i, 'true'); // font 굵기			}*/			        } else            {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }else if(endMode == "ExePlan"){		alert("중장기 자재 수급 계획이 완료되었습니다 메뉴화면을 다시 클릭후 사용해주시기 바랍니다");    }else{ // 삭제, 전송 상태일시 메인그리드 제조회       	GoSearch();    }    	}function GridEndQuery2() {		var mode = GridObj2.GetParam("mode");	var error_msg = '';	          	if(mode == "search2") {		if(GridObj2.GetStatus() == "true") {			//GridObj2.SetGroupMerge(	'ITEM_ID,ITEM_NAME,PR_NO,PR_REL,PR_QTY,PO_NO,PO_SEQ,PO_DATE,PO_QTY');		  	//GridObj2.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'SHIP_QTY');		  	//GridObj2.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot); 		}		else { 			error_msg = GridObj2.GetMessage(); 			alert(error_msg);            		}	}}function GridEndQuery3() {		var mode = GridObj3.GetParam("mode");	var error_msg = '';	          	if(mode == "search3") {		if(GridObj3.GetStatus() == "true") { 		}		else { 			error_msg = GridObj3.GetMessage(); 			alert(error_msg);            		}	}	var header_length = 0, j;	/* TP_FLAG 확인후 세팅 */	var item_id = document.all.sel_item_id.value;	}function GridEndQuery4() {		var mode = GridObj4.GetParam("mode");	var error_msg = '';	          	if(mode == "search4") {		if(GridObj4.GetStatus() == "true") {                           		}		else { 			error_msg = GridObj4.GetMessage(); 			alert(error_msg);            		}	}}/*┌──────────────────────────────────┐  │그리드의 원 클릭 이벤트  └──────────────────────────────────┘*/function GridCellClick(strColumnKey, nRow) {}	               /*┌──────────────────────────────────┐  │화면에 '조회'를 누르면 호출 Fnc  └──────────────────────────────────┘*/   function GoSearch(service)    {    doQuery();    //init2();    //init3()    //doQuery2();		//doQuery3();	GridObj2.ClearGrid( ); 	setHeader2(GridObj2);		GridObj3.ClearGrid( ); 	setHeader3(GridObj3);		GridObj4.ClearGrid( ); 	setHeader4(GridObj4);			   }/*┌──────────────────────────────────┐  │하부 그리드 조회 WD1 더블클릭  └──────────────────────────────────┘*/function GridCellDblClick(strColumnKey, nRow){         var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);    document.all.sel_item_id.value	= sel_item_id;        var sel_item_name = GridObj.GetCellValue("ITEM_NAME", nRow);    document.all.sel_item_name.value	= sel_item_name;	doQuery2(nRow);		doQuery3(nRow);		doQuery4(nRow);		}           /*┌──────────────────────────────────┐  │DW 1 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/   function doQuery()    {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var cnfm_date	= document.all.cnfm_date.value;       var sort_flag	= document.all.sort_flag.value;                       //넘겨줄 값들을만든다.( 파라미터 정의 부분 )       GridObj.SetParam("mode", "search");       GridObj.SetParam("cnfm_date", cnfm_date);       GridObj.SetParam("sort_flag"	, sort_flag);              GridObj.DoQuery(servlet_url);   }/*┌──────────────────────────────────┐  │DW 2 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery2(nRow) { //주문정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj.GetCellValue("CNFM_DATE", nRow);	var edi_gubn = GridObj.GetCellValue("EDI_GUBN", nRow);		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("item_id", item_id);	GridObj2.SetParam("cust_id", cust_id);	GridObj2.SetParam("dc_id", dc_id);	GridObj2.SetParam("cnfm_date", cnfm_date);	GridObj2.SetParam("edi_gubn", edi_gubn);		GridObj2.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 3 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery3(nRow) { //수송정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj.GetCellValue("CNFM_DATE", nRow);			//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj3.SetParam("mode", "search3");	GridObj3.SetParam("item_id", item_id);	GridObj3.SetParam("cust_id", cust_id);	GridObj3.SetParam("dc_id", dc_id);	GridObj3.SetParam("cnfm_date", cnfm_date);		GridObj3.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 4 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery4(nRow) { //EDI 정보	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	var cust_id	= GridObj.GetCellValue("CUST_CODE", nRow);	var dc_id	= GridObj.GetCellValue("DC_ID", nRow);	var cnfm_date = GridObj.GetCellValue("CNFM_DATE", nRow);	var edi_gubn = GridObj.GetCellValue("EDI_GUBN", nRow);		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj4.SetParam("mode", "search4");	GridObj4.SetParam("item_id", item_id);	GridObj4.SetParam("cust_id", cust_id);	GridObj4.SetParam("dc_id", dc_id);	GridObj4.SetParam("cnfm_date", cnfm_date);	GridObj4.SetParam("edi_gubn", edi_gubn);	GridObj4.DoQuery(servlet_url);}// 셀 저장 전역변수var objTdG;// setTimeout 에서 호출하여 시간 지연 후 setEditMode() 실행function setEditModeTime() {		//setEditMode( objTdG );	}// popup 조회 이미지 mouseOver// popup 을 띄우기 위해 제품 코드 영역을 벗어난 경우 viewMode 변환 방지를 위한 flag 설정function overImg( objImg ) {		popImgIdx = objImg.parentNode.parentNode.parentNode.rowIndex;	}// popup 조회 이미지 mouseOut// popup 을 띄우기 위해 제품 코드 영역을 벗어난 경우 viewMode 변환 방지를 위한 flag 설정function outImg( objImg ) {		popImgIdx = null;	}// 날짜 검색 POP BTN mouseOverfunction overBtn( objBtn ) {	clickedDateIdx = objBtn.parentNode.parentNode.parentNode.rowIndex;	}// 날짜 검색 POP BTN mouseOutfunction outBtn( objBtn ) {		clickedDateIdx = null;	}//--------------------------------------   main_template 에 정의된 Event ---------------------------------------------------///*┌──────────────────────────────────┐  │WiseGrid Cell Change Event  └──────────────────────────────────┘*/// 저장function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";	doSave();	};// 저장function doSave() { 	var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;    	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.frm._user_id.value);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "WISEGRIDDATA_ALL");	//GridObj.DoQuery(servlet_url, "SELECTED"); }function doChange3(obj){	}var flag = "N";var timer;function test(){    if(flag == "Y"){   try{          test2();           clearInterval(timer);   }   catch(e){     timer();   }  } }/*┌───────────────────────────────────────┐  │미납현황 엑셀 업로드 (업로드시  1, 2 줄째의 요약 정보 삭제 -헤더는 삭제 안해도 됨 )  └───────────────────────────────────────┘*/function excelUpload(){	//alert(document.frm.week_flag.value);		var service_url = "service.do?_moon_service=ip_02070_Edi_Default_List_excel_reg_pop";  	//service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&week_flag=" + week_flag;	//service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&trans_start=" + trans_start + "&version=" + version + "&seq=" + seq;	var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=940, height=450, top=200, left=200";//	var newWin = window.open(service_url, "ip_02050_Inventory_production_analysis_list_pop", pop_win_style);	var newWin = window.open(service_url, "", pop_win_style);	newWin.focus();			}/*┌───────────────────────────────────────┐  │월간 미납현황 팝업  └───────────────────────────────────────┘*/function popupMonthly(){	//alert(document.frm.week_flag.value);		var cnfm_date = document.all.cnfm_date.value;  		var service_url = "service.do?_moon_service=ip_02070_Edi_Default_List_Monthly_popup";  	service_url += "&cnfm_date=" + cnfm_date;	//service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&trans_start=" + trans_start + "&version=" + version + "&seq=" + seq;	var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=1115, height=690, top=200, left=200";//	var newWin = window.open(service_url, "ip_02050_Inventory_production_analysis_list_pop", pop_win_style);	var newWin = window.open(service_url, "", pop_win_style);	newWin.focus();			}/*┌───────────────────────────────────────┐  │미납사유 일괄변경  Fnc  └───────────────────────────────────────┘*/function changeChecked(obj){	var GridObj = document.WiseGrid;		var changeTemp = document.all.changeTemp.value;	if(changeTemp == ''){		//alert("일괄 변경 항목을 선택하고 실행시켜 주십시요.");		//return;	}		for(var i=0;i<GridObj.GetRowCount();i++) {		if(GridObj.GetCellValue('SELECTED',i) == '1' ){  // GREEN			GridObj.SetComboSelectedHiddenValue("CODE_NAME", i,  changeTemp);		}			}}/*┌───────────────────────────────────────┐  │행 멀티선택 취소 Fnc  └───────────────────────────────────────┘*/function rowInsDeSel(obj){		for(var i=0;i<GridObj.GetRowCount();i++) {		GridObj.SetCellValue("SELECTED", i, "0");	}	} //