//## 프로그램ID      : ip_03010_Lead_Time_Planning.js//## 프로그램명      : 상품 리드타임 관리//## 개발자          : 이강욱//## 개발일자        : 2016-01-13//##//## 관련 job file   : job_sinc_30_orderPlanning_08.xml//## 관련 query file : query_sinc_30_orderPlanning_08.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             전역 변수            ----------------------------------------------////var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)var job_id = 'ip_03010_Lead_Time_Planning';var GridObj ; 													// WiseGrid 객체var GridObj2;var GridObj3;//var GridObj4;//var GridObj5;Fvar color_tot 		 = '234|234|234';			//합계 라인 배경색var color_edit_col   = '255|253|208';var color_sp 		 = '230|222|230'; 			//컬럼 구분선 배경색var color_select_row = '141|232|141';			//라인 선택 배경색 var colBg01 		 = '224|255|224';			//255|255|153var colBg02 	     = '255|255|255';/*┌──────────────────────────────────┐  │그리드의 사이즈 조절 Fnc  └──────────────────────────────────┘*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅         // ==> 화면이 더이상 축소되지 않음         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         //document.WiseGrid.height = tableHeightValue + "px";          document.WiseGrid2.height = tabHeightValue - document.WiseGrid3.height+ "px";        //document.WiseGrid3.height = tableHeightValue - document.WiseGrid.height + "px";             }  /*┌─────────────────────────────────────────────────────────────────────┐  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│  └─────────────────────────────────────────────────────────────────────┘*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader(GridObj);  	//해더생성 	setDefault();        	//화면 기본 설정 }   function init2() {	GridObj2 = document.WiseGrid2;	setProperty(GridObj2);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader2(GridObj2);  	//해더생성 	setDefault2();        	//화면 기본 설정 }         /*┌──────────────────────────────────┐  │화면 기본 설정 부분.  └──────────────────────────────────┘*/function setDefault() { 		GridObj.bHDMoving 		 	= true;	GridObj.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	//GridObj.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj.nHDLineSize         = 10; //Header Size        //헤더의 라인수를 설정한다.     GridObj.nHDLines = 2;              //선택된 셀의 글자색 지정한다.    GridObj.strSelectedCellFgColor = '180|82|205';    GridObj.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.    GridObj.strHDClickAction    = "sortsingle";       	// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9	//GridObj.strCellFontName = '맑은 고딕';     }function setDefault2() { 			GridObj2.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	//GridObj2.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj2.nHDLineSize         = 10; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    //헤더의 라인수를 설정한다.     GridObj2.nHDLines = 2;            //선택된 셀의 글자색 지정한다.        GridObj2.strSelectedCellFgColor = '0|0|0';	GridObj2.strSelectedCellBgColor = '232|232|255'; //Drag로 선택된 셀의 배경색상을 변경할 수 있다	GridObj2.strActiveRowBgColor    = "232|245|213";    //선택된 행의 배경색상을 설정한다.	    GridObj2.strHDClickAction 	   = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	// Cell Font Setting	GridObj2.nCellFontSize = 9;					// Font Size 9		GridObj.strHDClickAction    = "sortsingle"; 	//GridObj2.strCellFontName = '맑은 고딕'; }       /*┌──────────────────────────────────┐  │해더생성  └──────────────────────────────────┘*/ function setHeader(GridObj) {        	//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	GridObj.AddHeader("CRUD"			,"CRUD"       	,"t_text" 		,100    ,60  ,false);  	GridObj.AddHeader("SELECTED"		," "       	,"t_checkbox" 		,2		,22  ,true); //0    	GridObj.AddHeader("IF_FLAG"			,"전송\n상태"     ,"t_text" 		,100	,38  ,true); //0   		//GridObj.SetColHide("CRUD", true); 	GridObj.AddHeader("ITEM_ID"				,"품목번호"      	,"t_text" 	,20		,60  ,false); //0    	GridObj.AddHeader("ITEM_NAME"			,"품목명"      	 	,"t_text" 	,100	,160 ,false); //0     	GridObj.AddHeader("TERM_VAL"			,"유통기한"    	 	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("LEAD_TIME"			,"입고\n리드타임"    	,"t_number" ,100.3	,70  ,false); //0 	GridObj.AddHeader("BASE_UOM"			,"기본단위"    		,"t_text" 	,100	,0  ,false); //0    	GridObj.AddHeader("NOW_STOCK"			,"현재고"       		,"t_number" ,100.3	,0  ,false); //0   	GridObj.AddHeader("BASE_STOCK"			,"기초재고"       	,"t_number" ,100.3	,60  ,false); //0  	GridObj.AddHeader("OUT_STOCK"			,"사외재고"       	,"t_number" ,100.3	,60  ,false); //0  	GridObj.AddHeader("PROG_STOCK"			,"진행재고"   	 	,"t_number" ,100.3	,70  ,false); //0    	GridObj.AddHeader("TOT_STOCK"			,"총재고"      		,"t_number" ,100.3	,70  ,false); //0 	GridObj.AddHeader("SEL_DMD"				,"선택\n구분"    		,"t_combo"	,100	,0  ,true); //0	 	GridObj.AddHeader("STD_STOCK"			,"기준재고"     		,"t_number" ,100.3	,60  ,true); //0    	GridObj.AddHeader("SAFETY_STOCK"		,"최소\n안전재고"		,"t_number" ,100.3	,60  ,true); //0    	GridObj.AddHeader("SAFETY_FACTOR"		,"안전계수"    		,"t_number" ,100.3	,0  ,true); //0    	GridObj.AddHeader("AVG_QTY"				,"12개월\n평균"  	,"t_number" ,100.3	,60  ,false); //0   	GridObj.AddHeader("SALES_MEAN_3MONTH" 	,"3개월\n평균" 		,"t_number" ,100.3	,60  ,false); //0 	GridObj.AddHeader("STD_DEV"				,"표준편차"    		,"t_number" ,100.3	,60  ,false); //0     	GridObj.AddHeader("LAST_YEAR"			,"전년동월\n누계실적"	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("USE_CUM_MONTH"		,"당월\n누계실적"  	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("MIN_LOT_SIZE"		,"최소\n발주량"   	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("PR_DATE_NO"			,"발주\n시기"	 	,"t_number" ,100.3	,0  ,true); //0    	GridObj.AddHeader("CONTAINER_BOX"		,"컨테이너\nBOX"	 	,"t_number" ,100.3	,65  ,true); //0  	GridObj.AddHeader("PR_QTY"				,"PR수량"        	,"t_number" ,100.3	,60  ,true); //0    	GridObj.AddHeader("ENTR_DATE"			,"입고요청일"      	,"t_text" 	,100	,70  ,true); //0  	//    	GridObj.AddHeader("EDIT_FLAG"			,"EDIT_FLAG"    	,"t_text" 	,100	,0  ,true); //0  	GridObj.AddHeader("PR_NO"				,"PR 번호"     		,"t_text" 	,100	,60  ,true); //0    	GridObj.AddHeader("IF_MSGS"				,"IF 메세지"      	,"t_text" 	,100	,220  ,true); //0   	GridObj.BoundHeader();		//GridObj.SetNumberFormat("IPGO"  , "#,##0");    GridObj.SetColCellAlign('ITEM_ID','center');     GridObj.SetColCellAlign('ITEM_NAME','left');     GridObj.SetColCellAlign('BASE_UOM','right');     //GridObj.SetColCellAlign('SEL_DMD','center'); 	GridObj.SetColFix('ITEM_NAME');	GridObj.SetColCellBgColor('SEL_DMD',color_edit_col);//기준재고	GridObj.SetColCellBgColor('STD_STOCK',color_edit_col);//기준재고	GridObj.SetColCellBgColor('SAFETY_STOCK',color_edit_col);//안전재고	GridObj.SetColCellBgColor('SAFETY_FACTOR',color_edit_col);//안전계수 		GridObj.SetColCellBgColor('PR_DATE_NO',color_edit_col);//안전계수 		GridObj.SetColCellBgColor('PR_QTY',color_edit_col);//안전계수 		GridObj.SetColCellBgColor('ENTR_DATE',color_edit_col);//안전계수    GridObj.SetNumberFormat("BASE_STOCK"  		 , "#,##0");    GridObj.SetNumberFormat("OUT_STOCK"  		 , "#,##0");    GridObj.SetNumberFormat("LEAD_TIME"  		 , "#,##0");    GridObj.SetNumberFormat("PROG_STOCK" 		 , "#,##0");    GridObj.SetNumberFormat("TOT_STOCK" 		 , "#,##0");    GridObj.SetNumberFormat("STD_STOCK" 		 , "#,##0");    GridObj.SetNumberFormat("SAFETY_STOCK" 		 , "#,##0");    GridObj.SetNumberFormat("AVG_QTY" 			 , "#,##0");    GridObj.SetNumberFormat("SALES_MEAN_3MONTH"	 , "#,##0");    GridObj.SetNumberFormat("STD_DEV"	 		 , "#,##0");    GridObj.SetNumberFormat("MIN_LOT_SIZE"	 	 , "#,##0");    GridObj.SetNumberFormat("SAFETY_STOCK" 		 , "#,##0");    GridObj.SetNumberFormat("CONTAINER_BOX"      , "#,##0");    GridObj.SetNumberFormat("LAST_YEAR" 		 , "#,##0");    GridObj.SetNumberFormat("USE_CUM_MONTH" 	 , "#,##0");    GridObj.SetNumberFormat("PR_QTY"  			 , "#,##0");		GridObj.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	//Hidden 컬럼	GridObj.SetColHide("CRUD",true);}/*┌──────────────────────────────────┐  │WiseGrid Change Combo Event  └──────────────────────────────────┘*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){		};function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {			//ENTR_DATE	if( strColumnKey == "ENTR_DATE"){		return;	}	// if 진행중인 데이터는 수정 불가!!	var if_flag	= GridObj.GetCellValue("IF_FLAG", nRow);	if( if_flag == "" || if_flag == null) {	}else{		alert("확정된 항목은 수정하실수 없습니다!");		GridObj.SetCellValue(strColumnKey, nRow,  nOldValue);		return;	}			if( strColumnKey == "SELECTED"){		return;	}	var version		= document.all.version.value;	    //var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);	//alert("sel_dmd="+sel_dmd);	//alert("sel_item_id="+sel_item_id);    //document.all.sel_dmd.value = sel_dmd;    //document.all.sel_item_id.value = sel_item_id;    var std_stock = GridObj.GetCellValue("STD_STOCK", nRow); //기준재고    var tot_stock = GridObj.GetCellValue("TOT_STOCK", nRow); //총재고    	//alert("std_stock="+std_stock);	//alert("tot_stock="+tot_stock);    var sales_mean_3month = GridObj.GetCellValue("SALES_MEAN_3MONTH", nRow); //3개월 평균    var avg_qty = GridObj.GetCellValue("AVG_QTY", nRow); //평균 (12개월)    var last_year = GridObj.GetCellValue("LAST_YEAR", nRow); //전년동월    var lead_time = GridObj.GetCellValue("LEAD_TIME", nRow); //리드타임    var safety_stock = GridObj.GetCellValue("SAFETY_STOCK", nRow); //평균 (12개월)        var pr_date_no = GridObj.GetCellValue("PR_DATE_NO", nRow); //발주시기     			// 1) 안전재고 변경	// 	안전재고 = 리드타임 * 변경된 기준재고 * 1	if(strColumnKey == "SAFETY_STOCK"){			}else{		//safety_stock = Math.round(lead_time * std_stock * 1)/1;	}			// 2) 발주시기 변경	//    발주시기 = (총재고-안전재고)/기준재고 -> 소숫점 첫째자리까지	// 3) 입고시기 변경						pr_date_no 			= Math.round((tot_stock-safety_stock)/std_stock);		pr_date_lead		= pr_date_no + Number(lead_time);					var result;		commonUtil.toDate(version,'YYYY-MM-DD','DAY', pr_date_lead ,{		callback:function(result){			// result값이 입고시기이다.			 entr_date =  	result;			//alert("entr_date="+entr_date);		GridObj.SetCellValue("ENTR_DATE", nRow,  entr_date);    								}							});				//GridObj.SetCellValue("PR_DATE_NO", nRow,  pr_date_no);    	GridObj.SetCellValue("SAFETY_STOCK", nRow,  safety_stock);    	GridObj.SetCellValue("STD_STOCK", nRow,  std_stock);	//GridEndQuery() // 입고 시기 별 cell 색갈 재설정	}function calPrDateNo(nRow){ // 변경된 정보(기준재고,안전제고)를 반영하여 입고 시기를 조절..	//alert("calPrDateNo 시작");	var version		= document.all.version.value;	    var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);	//alert("sel_dmd="+sel_dmd);	//alert("sel_item_id="+sel_item_id);    document.all.sel_dmd.value = sel_dmd;    document.all.sel_item_id.value = sel_item_id;    var std_stock = GridObj.GetCellValue("STD_STOCK", nRow); //기준재고    var tot_stock = GridObj.GetCellValue("TOT_STOCK", nRow); //총재고    	//alert("std_stock="+std_stock);	//alert("tot_stock="+tot_stock);    var sales_mean_3month = GridObj.GetCellValue("SALES_MEAN_3MONTH", nRow); //3개월 평균    var avg_qty = GridObj.GetCellValue("AVG_QTY", nRow); //평균 (12개월)    var last_year = GridObj.GetCellValue("LAST_YEAR", nRow); //전년동월        var lead_time = GridObj.GetCellValue("LEAD_TIME", nRow); //리드타임    var safety_stock = GridObj.GetCellValue("SAFETY_STOCK", nRow); //평균 (12개월)        var pr_date_no = GridObj.GetCellValue("PR_DATE_NO", nRow); //발주시기             var entr_date = GridObj.GetCellValue("ENTR_DATE", nRow); //발주시기         	// 1) 안전재고 변경	// 	안전재고 = 리드타임 * 변경된 기준재고 * 1	safety_stock = Math.round(lead_time * std_stock * 1)/1;		// 2) 발주시기 변경	//    발주시기 = (총재고-안전재고)/기준재고 -> 소숫점 첫째자리까지	// 3) 입고시기 변경	pr_date_no = Math.round(((tot_stock-safety_stock)/std_stock)*10)/10;		//alert("safety_stock="+safety_stock);	//alert("pr_date_no="+pr_date_no);			pr_date_no_temp = Math.round((pr_date_no*30));		//alert("pr_date_no_temp="+pr_date_no_temp);		var result;		commonUtil.toDate(version,'YYYY-MM-DD','DAY', pr_date_no_temp ,{		callback:function(result){		// result값이 입고시기이다.		 entr_date =  	result;		//alert("entr_date="+entr_date);		GridObj.SetCellValue("ENTR_DATE", nRow,  entr_date);    		}		});						GridObj.SetCellValue("PR_DATE_NO", nRow,  pr_date_no);    	GridObj.SetCellValue("SAFETY_STOCK", nRow,  safety_stock);    	GridObj.SetCellValue("STD_STOCK", nRow,  std_stock);	GridEndQuery() // 입고 시기 별 cell 색갈 재설정}   function setHeader2(GridObj2) {          	GridObj2.AddHeader("ITEM_ID"	,"품목번호"      ,"t_text" 	,10			,0  ,false); //0     	GridObj2.AddHeader("ITEM_NAME"	,"품목명"       	,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("PR_NO"		,"PR번호"       	,"t_text" 	,100		,70  ,false); //0     	GridObj2.AddHeader("PR_REL2"	,"PR개시일"      ,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("PR_REL"		,"PR개시일"      ,"t_text" 	,100		,60  ,false); //0     	GridObj2.AddHeader("PR_QTY"		,"PR수량"       	,"t_number" ,100.3		,60  ,false); //0     	GridObj2.AddHeader("PO_NO"		,"PO번호"      	,"t_text" 	,100		,70  ,false); //0   	GridObj2.AddHeader("PO_SEQ"		,"PO\n순번"   	,"t_text" 	,100		,0   ,false); //0     	GridObj2.AddHeader("PO_DATE"	,"PO개시일"     	,"t_text" 	,100		,60  ,false); //0     	GridObj2.AddHeader("PO_DATE2"	,"PO개시일"     	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("PO_QTY"		,"PO수량"       	,"t_number" ,100.3		,60  ,false); //0    	GridObj2.AddHeader("BL_NO"		,"B/L번호" 		,"t_text" 	,100		,80  ,false); //0   	GridObj2.AddHeader("CREDIT"		,"B/L\n선적일" 	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("CREDIT2"	,"B/L\n선적일" 	,"t_text" 	,100		,60  ,false); //0   	GridObj2.AddHeader("SHIP_QTY"	,"선적량"       		,"t_number" ,100.3		,60 ,false); //0   	GridObj2.AddHeader("STATUS"		,"진행상태"    		,"t_text" 	,100		,80 ,false); //0     	GridObj2.AddHeader("UNSHIP_QTY"	,"미선적량"      		,"t_number" ,100.3		,0 ,false); //0   	GridObj2.AddHeader("HBL_NO"		,"HOUSE\nB/L번호"    ,"t_text" 	,100		,90,false); //0     	GridObj2.AddHeader("PORT"		,"입항일" 			,"t_text" 	,100		,65 ,false); //0     	GridObj2.AddHeader("TONG"		,"통관일"       		,"t_text" 	,100		,65 ,false); //0     	GridObj2.AddHeader("IPGO_REQ"	,"입고요청일"     	,"t_text" 	,100		,70 ,false); //0    //GridObj2.AddHeader("IPGO_EXPT"	,"입고예정일"    		 ,"t_text" 	,100		,70 ,false); //0      	GridObj2.AddHeader("IPGO"		,"실입고일"       	,"t_text" 	,100		,65 ,false); //0     	GridObj2.AddHeader("DATE_FLAG"	,"DATE_FLAG"    	,"t_text" 	,100		,0 	,false); //0     	  	GridObj2.AddHeader("PR_TO_PO"			,"PR->PO\n(마스터)"    	,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("REL_PR_TO_PO"		,"PR->PO\n(실적)"    	,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("PO_TO_LC"			,"PO->선적\n(마스터)"    	,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("REL_PO_TO_LC"		,"PO->선적\n(실적)"    	,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("LC_TO_PORT"			,"선적->입항\n(마스터)"    ,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("REL_LC_TO_PORT"		,"선적->입항\n(실적)"    	,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("PORT_TO_CUST"		,"입항->통관\n(마스터)"    ,"t_number" ,100.3	,70  ,false); //0  	  	GridObj2.AddHeader("REL_PORT_TO_CUST"	,"입항->통관\n(실적)"    	,"t_number" ,100.3	,70  ,false); //0   	GridObj2.AddHeader("SUM_LEAD_TIME"		,"리드타임\n(마스터)"     ,"t_number" ,100.3	,70  ,false); //0  	  	GridObj2.AddHeader("SUM_REAL_TIME"		,"리드타임\n(실적)"    	,"t_number" ,100.3	,70  ,false); //0 	 	    	GridObj2.BoundHeader();		//GridObj2.SetColHide("PR_NO", 	true);	GridObj2.SetColHide("PR_REL2", 	true);		//GridObj2.SetColHide("PO_NO", 	true);	GridObj2.SetColHide("PO_DATE2", true);		GridObj2.SetColHide("BL_NO", 	true);	GridObj2.SetColHide("CREDIT2", 	true);	    GridObj2.SetColCellAlign('ITEM_ID','center');     GridObj2.SetColCellAlign('PR_NO','center');     GridObj2.SetColCellAlign('PR_REL','center');     GridObj2.SetColCellAlign('PO_SEQ','center');     GridObj2.SetColCellAlign('PO_DATE','center');     GridObj2.SetColCellAlign('BL_NO','center');     GridObj2.SetColCellAlign('CREDIT','center'); 	GridObj2.SetColCellAlign('IPGO_REQ','center'); 	GridObj2.SetColCellAlign('STATUS','center');    GridObj2.SetColCellAlign('PORT','center');     GridObj2.SetColCellAlign('TONG','center');     GridObj2.SetColCellAlign('IPGO','center');         GridObj2.SetColCellBgColor('REL_PR_TO_PO',color_edit_col); 	    GridObj2.SetColCellBgColor('REL_PO_TO_LC',color_edit_col); 	    GridObj2.SetColCellBgColor('REL_LC_TO_PORT',color_edit_col);    GridObj2.SetColCellBgColor('REL_PORT_TO_CUST',color_edit_col); 	    GridObj2.SetColCellBgColor('SUM_REAL_TIME',color_edit_col);   	    GridObj2.SetNumberFormat("PR_QTY"  		, "#,##0");    GridObj2.SetNumberFormat("PO_QTY" 		, "#,##0");    GridObj2.SetNumberFormat("UNSHIP_QTY"   , "#,##0");    GridObj2.SetNumberFormat("SHIP_QTY"  	, "#,##0");        GridObj2.SetColHDBgColor('PR_REL',			'253|228|229');    GridObj2.SetColHDBgColor('PO_DATE',			'253|228|229');    GridObj2.SetColHDBgColor('CREDIT',			'253|228|229');    	}   	// 컬럼 고정function setGrid(){	//GridObj2.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT	GridObj.SetColFix('ITEM_NAME');}function setGrid2(){	//GridObj2.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT	//GridObj2.SetGroupMerge('ITEM_ID,ITEM_NAME');		}/*┌──────────────────────────────────┐  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc  └──────────────────────────────────┘*/function GridEndQuery(){	    var endMode = GridObj.GetParam("mode");    var error_msg = '';              if(endMode == "search") //조회가 완료된 경우    {        if(GridObj.GetStatus() == "true")         {        			  GridObj.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'BASE_STOCK,PROG_STOCK,TOT_STOCK,STD_STOCK,SAFETY_STOCK,SALES_MEAN_3MONTH,LAST_YEAR,USE_CUM_MONTH,CONTAINER_BOX,PR_QTY');		  GridObj.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot);         	                    				for(var i=0;i<GridObj.GetRowCount();i++) {			// cell색깔 변경				if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(2) ){  // GREEN					GridObj.SetCellBgColor('PR_DATE_NO', i, '200|255|110');				}else if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(1) && GridObj.GetCellValue('PR_DATE_NO',i) <= Number(2)){  // YELLOW					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|255|0');				}				else if(GridObj.GetCellValue('PR_DATE_NO',i) <= Number(1)){ // RED					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|0|0'); 				}							GridObj.SetCellFontBold('TOT_STOCK', i, 'true'); // font 굵기			GridObj.SetCellFontBold('PR_DATE_NO', i, 'true'); // font 굵기			}						//EDIT_FLAG	        	               			for(var i=0;i<GridObj.GetRowCount();i++) {			// cell색깔 변경				if(GridObj.GetCellValue('EDIT_FLAG',i) == 'Y' ){  // GREEN					GridObj.SetCellBgColor('ITEM_ID', i, '0|191|255');					GridObj.SetCellBgColor('ITEM_NAME', i, '0|191|255');				}else{									}  			}				        	                                        }else            {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }    else if(endMode == "save") {		if(GridObj.GetStatus() == "true"){					doSave2();			}		else {			var error_msg = GridObj3.GetMessage();// 				alert(error_msg);					}       }        else{ // 삭제, 전송 상태일시 메인그리드 제조회           	GoSearch();    }	}function GridEndQuery2() {		var mode = GridObj2.GetParam("mode");	var error_msg = '';	          	if(mode == "search2") {		if(GridObj2.GetStatus() == "true") {					  GridObj2.SetGroupMerge('PR_NO,PR_REL,PR_QTY,PO_NO,PO_DATE,PO_QTY');		  		  GridObj2.AddSummaryBar('SUMMARY1', '소계', 'PR_NO', 'sum', 'PR_QTY,PO_QTY,SHIP_QTY,PR_TO_PO,REL_PR_TO_PO,PO_TO_LC,REL_PO_TO_LC,LC_TO_PORT,REL_LC_TO_PORT,'		  +'PORT_TO_CUST,REL_PORT_TO_CUST,SUM_LEAD_TIME,SUM_REAL_TIME'); 			  GridObj2.SetSummaryBarColor('SUMMARY1', '0|153|0', '230|230|250'); 		  //GridObj2.AddSummaryBar('SUMMARY', '소계', 'summaryall', 'sum', 'PR_QTY,PO_QTY,UNSHIP_QTY,SHIP_QTY');		  //GridObj2.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot); 		  //Group핑중 중복되는 PR,PO 수량 제거 로직  2014-12-02 이강욱//		  GridObj2.AddRow();//		  var last_idx = GridObj2.GetRowCount();//		//		  var sum_pr_value 		=0;//		  var sum_po_value 		=0;//		  var sum_ship_qty 		=0;//		  var sum_unship_qty 	=0;//		  //		  for( var i = 0; i<last_idx; i++){//		  	//		  	var pr_no 		= GridObj2.GetCellValue('PR_NO',i);//		  	var po_no		= GridObj2.GetCellValue('PO_NO',i);//		  	var pr_qty  	= GridObj2.GetCellValue('PR_QTY',i);//		  	var po_qty  	= GridObj2.GetCellValue('PO_QTY',i);//		  	var ship_qty 	= GridObj2.GetCellValue('SHIP_QTY',i);//		  	var unship_qty	= GridObj2.GetCellValue('UNSHIP_QTY',i);//		  	//		  	sum_ship_qty += Number(ship_qty);//		  	//		  	if( i==last_idx-1){//		  		//		  		sum_pr_value += Number(pr_qty);//		  		sum_po_value += Number(po_qty);	//		  			  		//		  	}else{//		  		if( pr_no != GridObj2.GetCellValue('PR_NO',i+1)){//		  			sum_pr_value += Number(pr_qty);//			  	}//		  		if( po_no != GridObj2.GetCellValue('PO_NO',i+1)){//		  			sum_po_value += Number(po_qty);//		  		}//		  		if( po_no != GridObj2.GetCellValue('PO_NO',i+1)){//		  			sum_unship_qty += Number(unship_qty);//		  			//alert(unship_qty);//		  		}//		  	}//		  	//		  }//		//		  GridObj2.SetCellValue('PR_NO'		, last_idx-1,  '합계');//		  GridObj2.SetCellValue('PR_QTY'	, last_idx-1,  sum_pr_value);//		  GridObj2.SetCellValue('PO_QTY'	, last_idx-1,  sum_po_value);//		  GridObj2.SetCellValue('SHIP_QTY'	, last_idx-1,  sum_ship_qty);//		  GridObj2.SetCellValue('UNSHIP_QTY', last_idx-1,  sum_unship_qty);		 		}		else { 			error_msg = GridObj2.GetMessage(); 			alert(error_msg);            		}	}	 	}/*┌──────────────────────────────────┐  │그리드의 원 클릭 이벤트  └──────────────────────────────────┘*/function GridCellClick(strColumnKey, nRow) {}	               /*┌──────────────────────────────────┐  │화면에 '조회'를 누르면 호출 Fnc  └──────────────────────────────────┘*/   function GoSearch(service)    {    doQuery();    //init2();    //init3()    //doQuery2();		//doQuery3();	GridObj2.ClearGrid( ); 	setHeader2(GridObj2);			   } /*┌──────────────────────────────────┐  │하부 그리드 조회 WD1 더블클릭  └──────────────────────────────────┘*/function GridCellDblClick(strColumnKey, nRow){ 		doQuery2(nRow);		}           /*┌──────────────────────────────────┐  │DW 1 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/   function doQuery()    {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var version			= document.all.version.value;       var sell_stop_gubn 	= document.all.sell_stop_gubn.value;       var item_type	    = document.all.item_type.value;		//브랜드 유형       var sales_cat05		= document.all.sales_cat05.value;                      //넘겨줄 값들을만든다.( 파라미터 정의 부분 )       GridObj.SetParam("mode", "search");       GridObj.SetParam("version", version);       GridObj.SetParam("sell_stop_gubn", sell_stop_gubn);       GridObj.SetParam("item_type", item_type);       GridObj.SetParam("sales_cat05", sales_cat05);              GridObj.DoQuery(servlet_url);   }/*┌──────────────────────────────────┐  │DW 2 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery2(nRow) {		var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("item_id", item_id);		GridObj2.DoQuery(servlet_url);}   // 셀 저장 전역변수var objTdG;// setTimeout 에서 호출하여 시간 지연 후 setEditMode() 실행function setEditModeTime() {		setEditMode( objTdG );	}// popup 조회 이미지 mouseOver// popup 을 띄우기 위해 제품 코드 영역을 벗어난 경우 viewMode 변환 방지를 위한 flag 설정function overImg( objImg ) {		popImgIdx = objImg.parentNode.parentNode.parentNode.rowIndex;	}// popup 조회 이미지 mouseOut// popup 을 띄우기 위해 제품 코드 영역을 벗어난 경우 viewMode 변환 방지를 위한 flag 설정function outImg( objImg ) {		popImgIdx = null;	}// 날짜 검색 POP BTN mouseOverfunction overBtn( objBtn ) {	clickedDateIdx = objBtn.parentNode.parentNode.parentNode.rowIndex;	}// 날짜 검색 POP BTN mouseOutfunction outBtn( objBtn ) {		clickedDateIdx = null;	}// 숫자 input box 에 문자 check // parameter : obj - inbox object , type - default value 또는 소수점 check 유뮤 등의 type 정의 // type - BLANK : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 소수점 허용//        ZERO : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 소수점 허용 //        BLANK_INT : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 소수점은 error 처리( only integer ) //        ZERO_INT : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 소수점은 error 처리( only integer ) //        BLANK_INT_UP : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 음수 & 소수점은 error 처리( only plus integer ) //        ZERO_INT_UP : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 음수 & 소수점은 error 처리( only plus integer ) //        ** type parameter 가 없으면 ZERO(default=0, 소숫점 허용) 와 같음 function checkNum(obj, type) {	var i, ch;	var pointCheck = 0;	var defaultVal = "0"; 	var alertMsg = "숫자만 입력하여 주세요.";	var checkType = "POINT"; 		// default value 는 공백 	if( type == "BLANK" || type == "BLANK_INT" || type == "BLANK_INT_UP" ) 		defaultVal = ""; 		// 소수점 허용하지 않음 	if( type == "BLANK_INT" || type == "ZERO_INT" || type == "BLANK_INT_UP" || type == "ZERO_INT_UP" ) 	{ 		if( type == "BLANK_INT_UP" || type == "ZERO_INT_UP" ) 			alertMsg = "자연수만 입력하여 주세요."; 		else 			alertMsg = "정수만 입력하여 주세요."; 		checkType = "INT"; 		pointCheck = 1; 	} 		var checkValue = delComma(obj.value).trim();	if( defaultVal == "0" && ( checkValue == null || checkValue == "" ) )	{		//objSetting(obj, defaultVal, alertMsg);		return false;	}		for (i=0; i < checkValue.length; i++) {				ch = checkValue.charAt(i);				// invalid value 		if(ch==" ")		{ 			//objSetting(obj, defaultVal, alertMsg); 			return false;		}				// valid value		else if ( ( ch >= 0 && ch <= 9 ) ) 		{ }				// point check 		else if ( ch == '.' ) 		{			pointCheck += 1;			// invalid value 			if ( pointCheck > 1 )			{				//objSetting(obj, defaultVal, alertMsg); 				return false;			} 		} 				// valid value : minus sign 		else if ( i == 0 && ch == '-' && type != "BLANK_INT_UP" && type != "ZERO_INT_UP" ) 		{ } 				// invalid value 		else 		{			//objSetting(obj, defaultVal, alertMsg); 			return false;		}	}		obj.value = checkValue; 	return true;	}function doChange_mm(obj){		var from_mm = document.all.from_mm.value;	var to_mm = document.all.to_mm.value;		var from_mm_1	= from_mm.substr(0,4);	var from_mm_2	= from_mm.substr(5,6);	var to_mm_1		= to_mm.substr(0,4);	var to_mm_2		= to_mm.substr(5,6);			//Number(hd_name_2)+Number(1);		if(obj.name == 'pre_mm'){ // 이전달		from_mm_2	= Number(from_mm_2) - Number(1);		to_mm_2		= Number(to_mm_2) - Number(1);					// 해가 넘어간다면...			if(from_mm_2 == 0){				from_mm_1 = Number(from_mm_1) - Number(1);				from_mm_2 = 12;			}else{							}			if(to_mm_2 == 0){				to_mm_1 = Number(to_mm_1) - Number(1);				to_mm_2 = 12;			}else{							}				if(from_mm_2 < 10){			from_mm = from_mm_1 +'-0'+ from_mm_2;		}else{			from_mm = from_mm_1 +'-'+  from_mm_2;		}				if(to_mm_2 < 10){			to_mm = to_mm_1 +'-0'+ to_mm_2;		}else{			to_mm = to_mm_1  +'-'+  to_mm_2;		}			}else{ //다음달		from_mm_2	= Number(from_mm_2) + Number(1);		to_mm_2		= Number(to_mm_2) + Number(1);			// 해가 넘어간다면...			if(from_mm_2 == 13){				from_mm_1 = Number(from_mm_1) + Number(1);				from_mm_2 = 1;			}else{							}			if(to_mm_2 == 13){				to_mm_1 = Number(to_mm_1) + Number(1);				to_mm_2 = 1;			}else{							}		if(from_mm_2 < 10){			from_mm = from_mm_1 +'-0'+ from_mm_2;		}else{			from_mm = from_mm_1 +'-'+  from_mm_2;		}				if(to_mm_2 < 10){			to_mm = to_mm_1 +'-0'+ to_mm_2;		}else{			to_mm = to_mm_1  +'-'+  to_mm_2;		}			}		document.all.from_mm.value = from_mm; 	document.all.to_mm.value = to_mm; 		}//--------------------------------------   main_template 에 정의된 Event ---------------------------------------------------///*┌──────────────────────────────────┐  │WiseGrid Cell Change Event  └──────────────────────────────────┘*/function Grid2ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {		var del_plt = GridObj2.GetCellValue("PLT_QTY", nRow);	if(strColumnKey == "DEL_PLT"){		if(nNewValue > 0){			GridObj2.SetCellValue("SELECTED", nRow, "1");		}else{			GridObj2.SetCellValue("SELECTED", nRow, "0");		}	}	if(strColumnKey == "SELECTED"){		if(nNewValue == "1"){			GridObj2.SetCellValue("DEL_PLT", nRow, del_plt)					}else{			GridObj2.SetCellValue("DEL_PLT", nRow, "0")					}	}}// 저장function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";		doSave();		};// 저장-메인그리드function doSave() { 	var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;		var version		  	= document.all.version.value;		var loc_id			= document.all.dc_id.value;	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("version", version);	GridObj.SetParam("loc_id", loc_id);			//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "CRUD");	 return;}// 저장-입고량 발주량 그리드 : 단 그리드 객체는 GridObj3 이다.function doSave2() { 	var GridObj3 = document.WiseGrid3;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var version		  	= document.all.version.value;		var dc_id 			= document.all.dc_id.value;				//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj3.SetParam("mode", "save2");	GridObj3.SetParam("user_id", document.frm._user_id.value);	GridObj3.SetParam("version", version);	GridObj3.SetParam("dc_id", dc_id);			//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj3.DoQuery(servlet_url,"WISEGRIDDATA_ALL");	 return;}function changeValue(obj){		var sales_cat05 = obj.value;	var item_type = document.frm.item_type.options;		commonUtil.getSelQeury( "sales_cat05", sales_cat05, "ip_01130_import_md_PlanAnalysis_list_combo",{	callback:function(result){						//옵션 지우기 현재 select option 갯수만큼			for(var i = item_type.length-1 ; i >=1 ; i--){				   		item_type.options[i] =null;		  	}						//옵션 채우기 result 갯수만큼만			for(var i=0; i<result.length ; i++) {	 	   		item_type.options[i+1] = new Option(result[i][1],result[i][0]);	  		}					}			});	}	var pr_no_idx 				= 0;	var po_no_idx	 	   		= 0;	var bl_no_idx	 	   		= 0;//그리드2 헤더클릭 기능 추가 경영개선팀 요청 2014-12-05function HeaderClick_DW2(strColumnKey){		var GridObj2 = document.WiseGrid2;		var t=GridObj2.GetRowCount();		/* PR rotation */	if(strColumnKey == "PR_REL"){		for(var i=0; i < GridObj2.GetRowCount();i++ ) {						if(pr_no_idx == 0) {				if(i==0) GridObj2.SetColHDText("PR_REL",GridObj2.GetColHDText("PR_NO"));				GridObj2.SetCellValue('PR_REL',i,GridObj2.GetCellValue("PR_NO", i));												}else{								if(i==0) GridObj2.SetColHDText("PR_REL",GridObj2.GetColHDText("PR_REL2"));				GridObj2.SetCellValue('PR_REL',i,GridObj2.GetCellValue("PR_REL2", i));			}												}		if(pr_no_idx == '1') {			pr_no_idx =0; 					}		else {			pr_no_idx =1;					}	}		if(strColumnKey == "PO_DATE"){		for(var i=0; i < GridObj2.GetRowCount();i++ ) {						if(po_no_idx == 0) {				if(i==0) GridObj2.SetColHDText("PO_DATE",GridObj2.GetColHDText("PO_NO"));				GridObj2.SetCellValue('PO_DATE',i,GridObj2.GetCellValue("PO_NO", i));												}else{								if(i==0) GridObj2.SetColHDText("PO_DATE",GridObj2.GetColHDText("PO_DATE2"));				GridObj2.SetCellValue('PO_DATE',i,GridObj2.GetCellValue("PO_DATE2", i));			}												}		if(po_no_idx == '1') {			po_no_idx =0; 					}		else {			po_no_idx =1;					}	}		if(strColumnKey == "CREDIT"){		for(var i=0; i < GridObj2.GetRowCount();i++ ) {						if(bl_no_idx == 0) {				if(i==0) GridObj2.SetColHDText("CREDIT",GridObj2.GetColHDText("BL_NO"));				GridObj2.SetCellValue('CREDIT',i,GridObj2.GetCellValue("BL_NO", i));												}else{								if(i==0) GridObj2.SetColHDText("CREDIT",GridObj2.GetColHDText("CREDIT2"));				GridObj2.SetCellValue('CREDIT',i,GridObj2.GetCellValue("CREDIT2", i));			}												}		if(bl_no_idx == '1') {			bl_no_idx =0; 					}		else {			bl_no_idx =1;					}	}}