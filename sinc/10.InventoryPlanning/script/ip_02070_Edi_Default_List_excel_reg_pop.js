//## Щ煎斜極ID		:	ip_02070_Edi_Default_List_excel_reg_pop.js//## Щ煎斜極貲		:	嶸鱔獄睡 嘐陶 碟戮 縈撚 機煎萄 //## 偃嫦濠          :	掏辨雙 //## 偃嫦橾濠       	:	2011-02-16//##//## 婦溼 job file   : ip_02070_Edi_Default_List_excel_reg_pop.xml.xml//## 婦溼 query file : ip_02070_Edi_Default_List_excel_reg_pop.xml.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.0        2011-02-16  掏辨雙      create//##//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             瞪羲 滲熱            ----------------------------------------------////var mode;														// WiseGrid 鱔褐 衛 瞪歎 賅萄(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 憮綰葩 ぬ酈雖(class だ橾 唳煎)var job_id = 'ip_02070_Edi_Default_List_excel_reg_pop';var GridObj ; 													// WiseGrid 偌羹var GridObj2 ; 													// WiseGrid 偌羹var GridObj3 ; 													// WiseGrid 偌羹var color_tot = '234|234|234';			//м啗 塭檣 寡唳儀var color_edit_col = '255|253|208';var color_sp = '230|222|230'; 			//鏽歲 掘碟摹 寡唳儀var color_select_row = '141|232|141';	//塭檣 摹鷗 寡唳儀var colBg01 = '224|255|224';			//255|255|153var colBg02 = '255|255|255';/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 餌檜鍔 褻瞰 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         //if( search_menu.style.display == "none" )         //{             //tabHeightValue += Number(search_h);             //tableHeightValue += Number(search_h);         //}                 // 飛 size 蹴模 衛 飛橉 傘鼠 濛嬴 斜葬萄 觼晦陛 擠熱陛 腎賊 縑楝陛 釭嘎煎 斜 唳辦 鼠褻勒 1煎 撮た         // ==> 飛橉 渦檜鼻 蹴模腎雖 彊擠         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         document.WiseGrid.height = tableHeightValue + "px";             }  /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid 螃粽薛お陛 儅撩腎堅 蟾晦音  嫦儅ж朝 							弛  弛JavaScript Event檣 Initialize()蒂 嫡嬴 斜葬萄曖 ④渦蒂 撢たи棻.			弛  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default撲薑 睡碟 (WiseGrid_Property.jsだ橾 頂縑 摹樹腎橫 氈棻.)	setHeader(GridObj);  	//п渦儅撩 }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛 晦獄 撲薑 睡碟.  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function setDefault() {     GridObj.nHDLineSize         = 36; //Header Size    //GridObj.strHDClickAction    = "sortsingle";    	GridObj.strActiveRowBgColor = "232|245|213";    //摹鷗脹 ч曖 寡唳儀鼻擊 撲薑и棻.	GridObj.strSelectedCellBgColor = '232|232|255'; //Drag煎 摹鷗脹 撚曖 寡唳儀鼻擊 滲唳й 熱 氈棻 		GridObj.strSelectedCellFgColor = '0|0|0'; 	GridObj.strMouseWheelAction='page'; // page 欽嬪 scroll ->晦獄擎 'default'   	// Header Font Setting	GridObj.strHDFontName = '蜈擎 堅蛐';	GridObj.nHDFontSize = 10;				  	// Font Size 9	GridObj.bHDFontBold = true;     //④渦曖 塭檣熱蒂 撲薑и棻.     GridObj.nHDLines = 2;    }     /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛п渦儅撩  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function setHeader(GridObj) {               	var header_length = 0, j;	//	GridObj.AddHeader("NS_CODE"			,"機羹囀萄"       ,"t_text" 	,100    ,1  ,false);// 	GridObj.AddHeader("NS_NAME"			,"機羹貲"       	,"t_text" 	,800	,1  ,false); //0   // 	GridObj.AddHeader("CUST_STORE_CODE"	,"薄ん囀萄"       ,"t_text" 	,800	,60 ,false); //0    	GridObj.AddHeader("CUST_ITEM_ID"	,"鼻ヶ囀萄"     	,"t_text" 	,800	,88  ,false); //0    	GridObj.AddHeader("CUST_ITEM_NAME"	,"鼻ヶ貲"     	,"t_text" 	,800	,180  ,false); //0    	GridObj.AddHeader("CUST_STORE_NAME"	,"薄ん貲"     	,"t_text" 	,800	,80  ,false); //0    	GridObj.AddHeader("ORDER_DATE"		,"嫦輿橾濠"       ,"t_text" 	,800	,80  ,false); //0    	GridObj.AddHeader("CNFM_DATE"		,"殮薄橾濠"       ,"t_text" 	,800	,80  ,false); //0    	GridObj.AddHeader("EDI_QTY"			,"嫦輿榆"     	,"t_number" ,20.3	,60  ,false); //0    	GridObj.AddHeader("EDI_AMOUNT"		,"嫦輿旎擋"     	,"t_number" ,20.3	,60  ,false); //0    	GridObj.AddHeader("DEFAULT_QTY"		,"嘐陶榆"     	,"t_number" ,20.3	,60  ,false); //0    	GridObj.AddHeader("DEFAULT_AMOUNT"	,"嘐陶旎擋"     	,"t_number" ,20.3	,60  ,false); //0    	GridObj.AddHeader("EDI_REASON"		,"嘐陶餌嶸"    	,"t_text" 	,20		,30  ,false); //0    	GridObj.AddHeader("EDI_CONFIRM"		,"挨六蝩"    	,"t_text" 	,20		,30  ,false); //0    	GridObj.AddHeader("EDI_STATUS"		,"鼻鷓"    		,"t_text" 	,20		,30  ,false); //0    	GridObj.AddHeader("EDI_GUBN"		,"陶ヶ掘碟"    	,"t_text" 	,20		,60  ,false); //0   	GridObj.BoundHeader();	    GridObj.SetColCellAlign('ORDER_DATE','center');     GridObj.SetColCellAlign('CNFM_DATE','center');     GridObj.SetColCellAlign('CUST_STORE_CODE','center');     GridObj.SetColCellAlign('CUST_STORE_NAME','center');     GridObj.SetColCellAlign('CUST_ITEM_ID','center');     GridObj.SetColCellAlign('EDI_GUBN','center'); 	//GridObj.SetCRUDMode("CRUD");  // AD諦 DE陛 撢た 腆 唳辦朝 橈棻.	GridObj.SetNumberFormat("EDI_QTY"  		, "#,##0.###");  	GridObj.SetNumberFormat("DEFAULT_QTY"  	, "#,##0.###");  	GridObj.SetNumberFormat("EDI_AMOUNT"  	, "#,##0.###");  	GridObj.SetNumberFormat("DEFAULT_AMOUNT", "#,##0.###");  	//Hidden 鏽歲  	//GridObj.SetColHide("CRUD",true);	}   /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛橦 '褻'蒂 援腦賊 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/   function GoSearch(service)    {   	//alert("GoSearch");   	//alert(service);       doQuery();   }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛羅廓簞 斜葬萄曖 褻 蘭葬蒂 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function doQuery() {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	GridObj = document.WiseGrid;		var item_id		= document.frm.item_id.value;	var qty			= document.frm.qty.value;	var prod_ver	=document.frm.prod_ver.value;	//alert(item_id);	   	//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj.SetParam("mode", "search");	GridObj.SetParam("item_id", item_id);	GridObj.SetParam("prod_ver", prod_ver);	GridObj.SetParam("qty", qty);	   	GridObj.DoQuery(servlet_url, "WISEGRIDDATA_ALL");}// 盪濰function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";	doSave();	};// 盪濰function doSave() { 	var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	for(var i=0;i<GridObj.GetRowCount();i++) {		if(GridObj.GetCellValue('EDI_GUBN',i) == '' ||  GridObj.GetCellValue('EDI_GUBN',i) == null ){  			alert("[陶ヶ掘碟]擊 縈撚縑 んл衛麵輿褊衛螃.(1:檜葆お, 2:縑粽葬等檜)");			return;		}	}		var group_code		= document.frm.group_code.value;	var cnfm_date		= GridObj.GetCellValue("CNFM_DATE", 1);	cnfm_date	= cnfm_date.replace(/-/g,"");	cnfm_date	= cnfm_date.replace(/\//g,"");	cnfm_date	= cnfm_date.replace(/\./g,"");	//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj.SetParam("mode", "doSave");	GridObj.SetParam("group_code", group_code);	GridObj.SetParam("cnfm_date", cnfm_date);	GridObj.SetParam("user_id", document.frm._user_id.value);		//WiseGrid檜 憮幗諦 鱔褐衛縑 等檜攪蒂 瞪殖ж朝 詭憮萄殮棲棻. 鱔褐檜 撩奢ж賊 true蒂 奩納桭炴.	GridObj.DoQuery(servlet_url, "WISEGRIDDATA_ALL"); }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛等檜攪 褻萼 薑鼻瞳戲煎 諫猿腎賊 嫦儅腎朝 Event縑 渠и Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridEndQuery() {    var endMode = GridObj.GetParam("mode");    var cnfm_date		= GridObj.GetCellValue("CNFM_DATE", 1);	    var error_msg = '';          if(endMode == "search"||endMode == "search") //褻萼 諫猿脹 唳辦    {        if(GridObj.GetStatus() == "true")         {                                                    } else        {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }else if(endMode == "doSave"){    	//alert("service_url="+service_url);    	var service_url = "service.do?_moon_service=sc_13010_set_prod_order_reg_pop";		var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=700, height=330, top=200, left=200";		//var newWin = window.open(service_url, "sc_13010_set_prod_order_reg_pop", pop_win_style);		alert("EXCEL だ橾檜 機煎萄 腎歷蝗棲棻.");		window.close();  		window.opener.GoSearch();    }else{    }		}function excelUpload(){	GridObj.strDefaultImportFileFilter = "xls";	GridObj.ExcelImport('', 'importall','row', 2, true); 	}