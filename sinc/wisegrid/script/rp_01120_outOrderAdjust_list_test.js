//############################################################//## 프로그램ID 	: rp_01120_outOderAdjust_list.js//## 프로그램명 	: 출고물량 조회 및 조정//## 개발자  	: 정재교//## 개발일자 	: 2009-04-01 목요일//##//## 관련 job file 	 : //##//## 관련 query file : //##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.0        2009-04-01  정재교     rp_01120_outOderAdjust_list.js 개발//##//##//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             전역 변수            ----------------------------------------------////var mode;													// WiseGrid 통신 시 전송 모드(search, save, ... etc)var class_path = "com.wisegrid.admin.";						// 서블릿 패키지(class 파일 경로)var job_id = 'rp_01120_outOrderAdjust_list_test';				// job id(서블릿 명, WiseGrid Header key)var job_id2 = 'rp_01120_outOrderAdjust_list02';var GridObj ; 												// WiseGrid 객체var GridObj2;var color_tot = '224|224|224';var color_edit_col = '255|253|208';var oldRow = 0;var rFirst = 0;/******************************************          Action Function         **********************************************//*┌──────────────────────────────────┐
  │조회
  └──────────────────────────────────┘*/
function GoSearch(service) {
		var versions_seq = document.frm.plan_version.value;	if( versions_seq == "" || versions_seq == null ) {		alert("버전을 선택하세요.");		return;	}	if( document.frm.trans_start.value == "" || document.frm.trans_start.value == null ) {		alert("수송일자를 입력하여 주십시요.");		return;	}
	
	if( document.frm.item_id.value == "" || document.frm.item_id.value == null ) {
		alert("제품코드를 입력하여 주십시요.");
		return;
	}		var verArr = versions_seq.split("!%!");	if( verArr.length == 2 ) {		document.frm.version.value 	= verArr[0].trim();		document.frm.seq.value 		= verArr[1].trim();	}		rFirst = 0;	doQuery();	doQuery2();};/*┌──────────────────────────────────┐  │저장  └──────────────────────────────────┘*/function GoSave() {		var version = document.frm.version.value;	var seq = document.frm.seq.value;	var trans_date = document.frm.trans_start.value;	var item_id = document.frm.item_id.value;	// 버전, 차수를 선택하지 않은 경우	if( version == null || version == "" || seq == null || seq == "" ) {		alert("버전을 먼저 선택하고 데이터 조회 후, 저장이 가능합니다.");		return;	}		if( trans_date == null || trans_date == ""){		alert("수송일자를 먼저 선택하고 데이터 조회 후, 저장이 가능합니다.");		return;	}		if( item_id == null || item_id == ""){		alert("제품 코드를 먼저 입력하고 데이터 조회 후, 저장이 가능합니다.");		return;	}			// 다시 확인	if(!confirm("저장하시겠습니까?"))		return;		doSave(version, seq, trans_date, item_id);	};/*┌──────────────────────────────────┐  │차기버전 계획반영 버튼 클릭시.  └──────────────────────────────────┘*/function GoCreate(service) {		var trans_date = document.frm.trans_start.value;	var item_id = document.frm.item_id.value;	if( trans_date == null || trans_date == ""){		alert("수송일자를 먼저 선택하고 데이터를 조회 하셔야 계획에 반영이 가능합니다.");		return;	}		if( item_id == null || item_id == ""){		alert("제품 코드를 먼저 입력하고 데이터를 조회 하셔야 계획에 반영이 가능합니다.");		return;
	}
	
		// 다시 확인	if(!confirm("계획에 반영하시겠습니까?"))		return;		doCreate(trans_date, item_id);		}/*******************************************   WiseGrid 초기화 및 설정  *****************************************************//*┌──────────────────────────────────┐  │WiseGrid 초기화  └──────────────────────────────────┘*/function init() {		GridObj = document.WiseGrid;		setProperty(GridObj); 	// 기본 property 설정	setDefault(GridObj);  			// 추가 property 설정	setHeader();   			// Header 설정			}function init2() {		GridObj2 = document.WiseGrid2;		setProperty(GridObj2); 	// 기본 property 설정	setDefault(GridObj2);  			// 추가 property 설정	setHeader2();   			// Header 설정			}/*┌──────────────────────────────────┐  │Property 설정  └──────────────────────────────────┘*/function setDefault(GridObj){		GridObj.bUserContextMenu = true;				//사용자 컨텍스트 메뉴의 사용 여부를 결정한다. 	GridObj.bHDMoving = false;                  	//사용자가 헤더를 드래그해서 컬럼위치를 이동할수 없다.	GridObj.bHDSwapping = false;                	//헤더의 컬럼위치이동 콤보버튼을 비활성화 한다.	GridObj.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj.bRowSelectorIndex = false;				//Row Selector 영역에 Row Index를 보여준다. 	GridObj.strRowBorderStyle = "none";         	//로우의 테두리에 아무것도 나타나지 않는다.	GridObj.nRowSpacing = 0;                    	//RowSpacing값을 정한다. 	GridObj.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	//GridObj.strSelectedCellBgColor = '238|0|238'; //Drag로 선택된 셀의 배경색상을 변경할 수 있다 			// Header Font Setting	GridObj.nHDFontSize = 9;				  	// Font Size 9		// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9		//Hearder 높이	GridObj.nHDLineSize   = 15;   //12		// Grid 행 높이    GridObj.nRowHeight    = 22;    //22        //선택된 셀의 글자색 지정한다.    GridObj.strSelectedCellFgColor = '180|82|205';         //헤더의 라인수를 설정한다.     GridObj.nHDLines = 2;            /* Context Menu 사용자 MENU 추가 */    GridObj.AddUserContextMenuItem("MENU_CELL","MENU01","Row 추가");    }/*┌──────────────────────────────────┐  │해더생성  └──────────────────────────────────┘*/function setHeader() {            commonUtil.getCodeList("job_id", job_id , "gird_header_list",defaultHeader); }function setHeader2() {            commonUtil.getCodeList("job_id", job_id2 , "gird_header_list",defaultHeader2); }/*┌──────────────────────────────────┐  │DB에 등록된 화면 해더 정보를 가져온다.  └──────────────────────────────────┘*/function defaultHeader(result){	var arrHeader = '';		for( var i=0 ;i<result.length ;i++) //전체 Row만큼 반복 한다.	{	    arrHeader = result[i].split('!%!');	    GridObj.AddHeader(arrHeader[1]  ,arrHeader[2]  ,arrHeader[3]  ,arrHeader[4]  ,arrHeader[5]  ,arrHeader[6]);        	}		GridObj.AddGroup("TRANS_PLAN", "변경");			//그리드에 그룹을 등록한다. 	GridObj.AppendHeader("TRANS_PLAN", "TRANS_PLAN_PLT");	GridObj.AppendHeader("TRANS_PLAN", "TRANS_PLAN_QTY");		GridObj.BoundHeader(); //AddHeader를 완료한 후 헤더를 그리드에 바인딩한다. 		GridObj.SetCRUDMode("CRUD", "생성", "수정", "삭제");		GridObj.SetColHide("CRUD", true); 	GridObj.SetColHide("BOX_PER_PLT", true);	GridObj.SetColHide("OLD_SAFE_QTY", true);	GridObj.SetColHide("OLD_BOX_QTY", true);	GridObj.SetColHide("OLD_SRC_LOC", true);	GridObj.SetColHide("SAFE_UPDATE_FLAG", true);	GridObj.SetColHide("PLAN_UPDATE_FLAG", true);	GridObj.SetColHide("UNIT_UPDATE_FLAG", true);		GridObj.SetNumberFormat("TRANS_PLAN_PLT", "###,##0.00"); // 숫자 형식	GridObj.SetNumberFormat("TRANS_PLAN_QTY"  , "###,##0.0");	GridObj.SetNumberFormat("SAFETY_STOCK"  , "###,###,###");	GridObj.SetNumberFormat("MIN_PICK_QTY"  , "###,###,###");	GridObj.SetNumberFormat("MON_QTY"  , "###,###,###");	GridObj.SetNumberFormat("BEFORE_SALE_QTY"  , "###,###,###");	GridObj.SetNumberFormat("SALE_CUM_QTY"  , "###,###,###");	GridObj.SetNumberFormat("TODAY_SALE_PLAN"  , "###,###,###");	GridObj.SetNumberFormat("ORD_QTY"  , "###,###,###");	GridObj.SetNumberFormat("WEEK1_QTY"  , "###,###,###");	GridObj.SetNumberFormat("WEEK3_QTY"  , "###,###,###");	GridObj.SetNumberFormat("TODAY_STOCK"  , "###,###,###");	GridObj.SetNumberFormat("IN_TRANS_QTY"  , "###,###,###");	GridObj.SetNumberFormat("OUT_TRANS_QTY"  , "###,###,###");	GridObj.SetNumberFormat("STOCK_DAY"  , "###,###,###");	GridObj.SetNumberFormat("STOCK_TERM"  , "###,###,###");	GridObj.SetNumberFormat("SALE_QTY2"  , "###,###,###");	GridObj.SetNumberFormat("ORD_QTY2"  , "###,###,###");	GridObj.SetNumberFormat("STOCK_QTY1"  , "###,###,###");	GridObj.SetNumberFormat("REP_QTY"  , "###,###,###");	GridObj.SetNumberFormat("STOCK_QTY2"  , "###,###,###");		///////////////////////	GridObj.SetNumberFormat("EXPORT_QTY1"  , "###,###,###");	GridObj.SetNumberFormat("EXPORT_QTY2"  , "###,###,###");	///////////////////////	           }function defaultHeader2(result){	var arrHeader = '';		for( var i=0 ;i<result.length ;i++) //전체 Row만큼 반복 한다.	{	    arrHeader = result[i].split('!%!');	    GridObj2.AddHeader(arrHeader[1]  ,arrHeader[2]  ,arrHeader[3]  ,arrHeader[4]  ,arrHeader[5]  ,arrHeader[6]);        	}		commonUtil.getSelQeury( "", "", "dailyTransportPlanSchPlan_dateList",{		callback:function(result){									if(result.length > 0){				for( i = 0 ; i < result[0].length ; i++ ){					if( i == 0 ){						GridObj2.AddGroup("HEADER_DATE" + i, result[0][i]);						GridObj2.AppendHeader("HEADER_DATE" + i, "D01");					}					else{			    		GridObj2.AddGroup("HEADER_DATE" + i, result[0][i]);			//그리드에 그룹을 등록한다. 						GridObj2.AppendHeader("HEADER_DATE" + i, "D0" + (i+1) + "SH1");						GridObj2.AppendHeader("HEADER_DATE" + i, "D0" + (i+1) + "SH3");						GridObj2.AppendHeader("HEADER_DATE" + i, "D0" + (i+1) + "SH5");					}				}			}						GridObj2.BoundHeader(); //AddHeader를 완료한 후 헤더를 그리드에 바인딩한다. 						GridObj2.SetColHide("ITEM", true);			GridObj2.SetColFix('PLANT_NAME');		}	});           }/***********************************************   WiseGrid 통신  **********************************************************//*┌──────────────────────────────────┐  │조회  └──────────────────────────────────┘*/function doQuery() {			var servlet_url = Project_name+"/servlet/" + class_path + job_id;		//WiseGrid가 서버에 전송할 mode를 셋팅한다.	GridObj.SetParam("mode", "search");		//-- 서버에 전송할 파라메터 설정 --//	//공장 코드		var item_id = document.frm.item_id.value;	var trans_start = document.frm.trans_start.value;	var version = document.frm.version.value;	var sales_yyyy = document.frm.sales_yyyy.value;	var sales_version = document.frm.sales_version.value;	var seq = document.frm.seq.value;		GridObj.SetParam("item_id", item_id);	GridObj.SetParam("trans_start", trans_start);	GridObj.SetParam("version", version);	GridObj.SetParam("sales_yyyy", sales_yyyy);	GridObj.SetParam("sales_version", sales_version);	GridObj.SetParam("seq", seq);		// user_id	//GridObj.SetParam("user_id", document.frm._user_id.value);		// query_id	GridObj.SetParam("query_id", "rp_01120_outOrderAdjustNew_list");					//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url);}function doQuery2() {			var servlet_url = Project_name+"/servlet/" + class_path + job_id2;		//WiseGrid가 서버에 전송할 mode를 셋팅한다.	GridObj2.SetParam("mode", "search");		//-- 서버에 전송할 파라메터 설정 --//	//공장 코드	var item_id = document.frm.item_id.value;	var trans_start = document.frm.trans_start.value;	var version = document.frm.version.value;	var seq = document.frm.seq.value;		GridObj2.SetParam("item_id", item_id);	GridObj2.SetParam("trans_start", trans_start);	GridObj2.SetParam("version", version);	GridObj2.SetParam("seq", seq);		// user_id	//GridObj.SetParam("user_id", document.frm._user_id.value);		// query_id	GridObj2.SetParam("query_id", "rp_01010_dailyTransportPlanSchPlan_pop");					//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj2.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │저장  └──────────────────────────────────┘*/function doSave(version, seq, trans_date, item_id) { 	var servlet_url = Project_name+"/servlet/" + class_path + job_id;	//WiseGrid가 서버에 전송할 mode를 셋팅한다.	GridObj.SetParam("mode", "save");		//-- 서버에 전송할 파라메터 설정 --//	GridObj.SetParam("version",version);	GridObj.SetParam("seq",seq);	GridObj.SetParam("trans_date",trans_date);	GridObj.SetParam("item_id",item_id);		var stock_type = "";	if(document.frm.stock_type[0].checked == true) stock_type = "base";	else stock_type = "prod";	GridObj.SetParam("stock_type", stock_type);		// user_id	GridObj.SetParam("user_id", document.frm._user_id.value);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "CRUD"); }/*┌──────────────────────────────────┐  │차기버전 계획반영  └──────────────────────────────────┘*/function doCreate(trans_date, item_id) { 	var servlet_url = Project_name+"/servlet/" + class_path + job_id;	//WiseGrid가 서버에 전송할 mode를 셋팅한다.	GridObj.SetParam("mode", "create");		var version = document.frm.version.value;	var seq = document.frm.seq.value;		//-- 서버에 전송할 파라메터 설정 --//	//공장 코드	GridObj.SetParam("version",version);	GridObj.SetParam("seq",seq);	GridObj.SetParam("trans_date",trans_date);	GridObj.SetParam("item_id",item_id);		// user_id	GridObj.SetParam("user_id", document.frm._user_id.value);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "WISEGRIDDATA_ALL"); }/* INSERT */function doInsert() {}/* UPDATE */function doUpdata() {}/* DELET */function doDelete() {}/* CHECK SELECTED */function chkSelected() {}/* LINE INSERT */function doLineInsert() {}/* EXCEL DWON */function excelDown() {}/*******************************************   WiseGrid 통신 후  설정  ******************************************************//*┌──────────────────────────────────────┐  │	WiseGrid 통신 후 Grid 설정 및 실행 Fnc  └──────────────────────────────────────┘*/function GridEndQuery() {			setGrid(GridObj); //WiseGrid 설정				//	var end_mode = GridObj.GetParam("mode");	if(end_mode == "search") { //조회		if(GridObj.GetStatus() == "true") { // 			// 마지막 변경한 Row로 이동			if( rFirst < GridObj.GetRowCount()){				//GridObj.MoveRow(rFirst);				GridObj.SetRowScroll(rFirst);			}					} else	{ 			var error_msg = GridObj.GetMessage(); // 			alert(error_msg);					}	} else if(end_mode == "insert") {			} else if(end_mode == "update") {			} else if(end_mode == "delete") {			}else if(end_mode == "save") {		if(GridObj.GetStatus() == "true") {// 			doQuery();		} else {			var error_msg = GridObj.GetMessage();// 			alert(error_msg);					}	}else if(end_mode == "create"){ //차기버전 계획반영		if(GridObj.GetStatus() == "true") {// 					} else {			var error_msg = GridObj.GetMessage();// 			alert(error_msg);					}	}}function GridEndQuery2() {			setGrid2(GridObj2); //WiseGrid 설정				//	var end_mode = GridObj2.GetParam("mode");	if(end_mode == "search") { //조회		if(GridObj2.GetStatus() == "true") { // 								} else	{ 			var error_msg = GridObj2.GetMessage(); // 			alert(error_msg);					}	} else if(end_mode == "insert") {			} else if(end_mode == "update") {			} else if(end_mode == "delete") {			}else if(end_mode == "save") {		if(GridObj2.GetStatus() == "true") {// 			//GoSearch("");		} else {			var error_msg = GridObj2.GetMessage();// 			alert(error_msg);					}	}else if(end_mode == "trans"){ //전송		if(GridObj2.GetStatus() == "true") {// 			document.frm.checked_po_type[1].checked = true;		} else {			var error_msg = GridObj2.GetMessage();// 			alert(error_msg);					}	}}/*┌──────────────────────────────────┐  │WiseGrid 설정  └──────────────────────────────────┘*/function setGrid(){		// 컬럼 고정	GridObj.SetColFix('DC_NAME');	// 컬럼 그룹	GridObj.SetGroupMerge('DC_NAME,MON_QTY,BEFORE_SALE_QTY,SALE_CUM_QTY,TODAY_SALE_PLAN,ORD_QTY,WEEK1_QTY,WEEK3_QTY,TODAY_STOCK,IN_TRANS_QTY,OUT_TRANS_QTY,STOCK_DAY,STOCK_TERM,SALE_QTY2,ORD_QTY2,STOCK_QTY1,REP_QTY,STOCK_QTY2'); 		// 편집 여부 설정	//GridObj.SetColCellActivation('SP01','disable');		//컬럼 글자색	//GridObj.SetCellFgColor('C38', i, '255|10|10');		// 셀 배경	//GridObj.SetCellBgColor('C02', 1, '10|10|255');		// Get Hidden Value 	//GridObj.GetCellHiddenValue('ITEM_NAME',0) 		// 합계	//GridObj.AddSummaryBar('SUMMARY1', '합계', 'summaryall', 'sum', 'D01A,D01B,D01C,D02A,D02B,D02C,D03A,D03B,D03C,D04A,D05B,D05C,D06A,D06B,D06C,D07A,D07B,D07C,C36'); 	//GridObj.SetSummaryBarColor('SUMMARY1', '0|0|0', '160|160|160'); 				// 컬럼 배경색	GridObj.SetColCellBgColor('SAFETY_STOCK',color_edit_col);//안전재고	GridObj.SetColCellBgColor('TRANS_PLAN_PLT',color_edit_col);//PLT	GridObj.SetColCellBgColor('TRANS_PLAN_QTY',color_edit_col);//BOX	GridObj.SetColCellBgColor('MIN_PICK_QTY',color_edit_col);//최소수송단위        // 마지막 변경한 Row로 이동    //GridObj.MoveRow(rowIndex);        var rowCnt = GridObj.GetRowCount();    for ( i = 0 ; i < rowCnt ; i++ ){    	var dc_name = GridObj.GetCellValue("DC_NAME", i);	    if( dc_name == "전체 합계" || dc_name == "CDC 합계" || dc_name == "RDC 합계" ){	    	GridObj.SetRowBgColor(i, color_tot); // row 배경색	    	GridObj.SetCellFontBold('DC_NAME', i, 'true'); // font 굵기  	    	GridObj.SetCellActivation('SAFETY_STOCK', i, 'disable'); //선택할 수 없고 편집할 수 없다. 	    	GridObj.SetCellActivation('TRANS_PLAN_PLT', i, 'disable'); //선택할 수 없고 편집할 수 없다. 	    	GridObj.SetCellActivation('TRANS_PLAN_QTY', i, 'disable'); //선택할 수 없고 편집할 수 없다. 	    	GridObj.SetCellActivation('SRC_LOC', i, 'disable'); //선택할 수 없고 편집할 수 없다. 	    	GridObj.SetCellActivation('MIN_PICK_QTY', i, 'disable'); //선택할 수 없고 편집할 수 없다. 	    }    }    //    if( GridObj.GetRowCount() > 0 ){//    	GridObj.MoveRow(oldRow);//    }    }function setGrid2(){		// 컬럼 그룹	//GridObj.SetGroupMerge('PLANT_NAME,PROC_NAME'); 		// 컬럼 고정	//GridObj2.SetColFix('PLANT_NAME');		// 편집 여부 설정	//GridObj.SetColCellActivation('SP01','disable');		//컬럼 글자색	//GridObj.SetCellFgColor('C38', i, '255|10|10');		// 셀 배경	//GridObj.SetCellBgColor('C02', 1, '10|10|255');		// Get Hidden Value 	//GridObj.GetCellHiddenValue('ITEM_NAME',0) 		// 합계	GridObj2.AddSummaryBar('SUMMARY1', '전체합계', 'summaryall', 'sum', 'AVAIL,TRANS,STOCK,D01,D02SH1,D02SH3,D02SH5,D03SH1,D03SH3,D03SH5,D04SH1,D04SH3,D04SH5,D05SH1,D05SH3,D05SH5,D06SH1,D06SH3,D06SH5,D07SH1,D07SH3,D07SH5'); 	GridObj2.SetSummaryBarColor('SUMMARY1', '0|0|0', '223|223|223'); 				// 컬럼 배경색	//GridObj.SetColCellBgColor('SAFETY_STOCK',color_edit_col);//안전재고	        // 마지막 변경한 Row로 이동    //GridObj.MoveRow(rowIndex);    	GridObj2.SetNumberFormat("AVAIL", "###,###,###"); // 숫자 형식	GridObj2.SetNumberFormat("TRANS", "###,###,###"); // 숫자 형식	GridObj2.SetNumberFormat("STOCK", "###,###,###"); // 숫자 형식	GridObj2.SetNumberFormat("D01", "###,###,###"); // 숫자 형식	GridObj2.SetNumberFormat("D02SH1", "###,###,###");	GridObj2.SetNumberFormat("D02SH3", "###,###,###");	GridObj2.SetNumberFormat("D02SH5", "###,###,###");	GridObj2.SetNumberFormat("D03SH1", "###,###,###");	GridObj2.SetNumberFormat("D03SH3", "###,###,###");	GridObj2.SetNumberFormat("D03SH5", "###,###,###");	GridObj2.SetNumberFormat("D04SH1", "###,###,###");	GridObj2.SetNumberFormat("D04SH3", "###,###,###");	GridObj2.SetNumberFormat("D04SH5", "###,###,###");	GridObj2.SetNumberFormat("D05SH1", "###,###,###");	GridObj2.SetNumberFormat("D05SH3", "###,###,###");	GridObj2.SetNumberFormat("D05SH5", "###,###,###");	GridObj2.SetNumberFormat("D06SH1", "###,###,###");	GridObj2.SetNumberFormat("D06SH3", "###,###,###");	GridObj2.SetNumberFormat("D06SH5", "###,###,###");	GridObj2.SetNumberFormat("D07SH1", "###,###,###");	GridObj2.SetNumberFormat("D07SH3", "###,###,###");	GridObj2.SetNumberFormat("D07SH5", "###,###,###");    }/*********************************************   WiseGrid Event   *********************************************************/ /*┌──────────────────────────────────┐  │WiseGrid Mouse Over Event  └──────────────────────────────────┘*/function GridMouseOverHandler(strType, strColumnKey, nRow){ };/*┌───────────────────────────────────────┐  │WiseGrid User Context Menu Click Event  └───────────────────────────────────────┘*/function GridUserContextMenuClickHandler(strMenuKey, strMenuItemKey, strColumnKey, nRow){			if( strMenuKey == "MENU_CELL" ){// CELL 클릭시 메뉴				if( strMenuItemKey == "MENU01" ){		// ROW 추가					insertRow( nRow );						}		else {			alert("존재 하지 않은 메뉴입니다.");		}			}};/*┌──────────────────────────────────┐  │WiseGrid Change Combo Event  └──────────────────────────────────┘*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){		oldRow = nRow;};/*┌──────────────────────────────────┐  │WiseGrid Scroll Event  └──────────────────────────────────┘*/function GridRowScrollHandler(nFirstVisibleRowIndex, nEndVisibleRowIndex){	rFirst = nFirstVisibleRowIndex;};//--------------------------------------   main_template 에 정의된 Event ---------------------------------------------------///*┌──────────────────────────────────┐  │WiseGrid Cell Change Event  └──────────────────────────────────┘*/function GridChangeCell(strColumnKey, nRow) {//	setChangeCheckFlag(objBox);	if( strColumnKey == "TRANS_PLAN_PLT" || strColumnKey == "TRANS_PLAN_QTY" ){		// BOX 인 경우		if( strColumnKey == "TRANS_PLAN_QTY" ) {			// PLT 수량 계산			var boxQty = Number(GridObj.GetCellValue("TRANS_PLAN_QTY", nRow));			var boxPerPalet = Number(GridObj.GetCellValue("BOX_PER_PLT", nRow));			var resultQty = Math.round(boxQty*100 / boxPerPalet)/100;			GridObj.SetCellValue("TRANS_PLAN_PLT", nRow, resultQty	);		}		// PLT 인 경우		if( strColumnKey == "TRANS_PLAN_PLT" ) {			// Box 수량 계산			var pltQty = Number(GridObj.GetCellValue("TRANS_PLAN_PLT", nRow));			var boxPerPalet = Number(GridObj.GetCellValue("BOX_PER_PLT", nRow));			var resultQty = Math.round(Math.round(pltQty * boxPerPalet*100)/100,0);			GridObj.SetCellValue("TRANS_PLAN_QTY", nRow, resultQty	);		}				// 변경 플래그		GridObj.SetCellValue("PLAN_UPDATE_FLAG", nRow, "Y");				oldRow = nRow;	}	else if( strColumnKey == "SAFETY_STOCK" ){		// 변경 플래그		GridObj.SetCellValue("SAFE_UPDATE_FLAG", nRow, "Y");				oldRow = nRow;	}	else if( strColumnKey == "MIN_PICK_QTY" ){		// 변경 플래그		GridObj.SetCellValue("UNIT_UPDATE_FLAG", nRow, "Y");				oldRow = nRow;	}}/*┌──────────────────────────────────┐  │WiseGrid Cell Click Event  └──────────────────────────────────┘*/function GridCellClick(strColumnKey, nRow){	var dc_name = GridObj.GetCellValue("DC_NAME", nRow);	if( (strColumnKey == "TRANS_PLAN_PLT" || strColumnKey == "TRANS_PLAN_QTY")		&& ( dc_name != "전체 합계" && dc_name != "CDC 합계" && dc_name != "RDC 합계" ) ){		// 출고장을 선택하지 않고 값을 수정하려고 한 경우..		var dc_id = GridObj.GetCellValue("SRC_LOC", nRow);		if( dc_id == "" || dc_id == null){			alert("PLT, BOX값을 수정하기 전에 출고장을 먼저 선택하여 주십시요.");			GridObj.SetCellFocus('SRC_LOC', nRow, true) 			return;		}		// 출고장 또는 제품코드 데이터가 없는 경우 함수를 빠져나간다		var item_id = document.frm.item_id.value;		if( item_id == null || item_id == "" ){			return		}						replenishPlan.getBoxPerPalet(dc_id, item_id, "rp_01010_dailyTransportPlanSalesInfo_search_box_per_palet_new", { 		//replenishPlan.getBoxPerPalet(DC_SHORT_NAME, item_id, "rp_01010_dailyTransportPlanSalesInfo_search_box_per_palet", { 			callback:function(boxPerPalet){				if( boxPerPalet == null || boxPerPalet == "" ) {					GridObj.SetCellValue("BOX_PER_PLT", nRow, '100');				}				else {					GridObj.SetCellValue("BOX_PER_PLT", nRow, boxPerPalet);				}			}		});		}}/*********************************************   기타 Function   **********************************************************//*┌──────────────────────────────────┐  │그리드의 사이즈 조절 Fnc  └──────────────────────────────────┘*/function setWiseGridAutoResize( tab_h, table_h ){		var maxWidthValue;	var maxHeightValue;		if (document.layers) {		//Nescape		maxWidthValue = window.innerWidth;		maxHeightValue = window.innerHeight;	}	if (document.all) {		//explore		maxWidthValue = document.body.clientWidth;		maxHeightValue = document.body.clientHeight;	} 		var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ; 	var tableHeightValue = Number(maxHeightValue) - Number(table_h) ; 		var search_h = document.frm.search_h.value; 	if( search_menu.style.display == "none" ) 	{ 		tabHeightValue += Number(search_h); 		tableHeightValue += Number(search_h); 	} 		// 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅 	// ==> 화면이 더이상 축소되지 않음 	if( tabHeightValue < 1 ) 		tabHeightValue = 1; 	if( tableHeightValue < 1 ) 		tableHeightValue = 1; 		//tabPage1.style.height = tabHeightValue + "px"; 	//tbMain.style.height = tableHeightValue + "px"; 	document.WiseGrid.height = tableHeightValue + "px"; 	}/*┌──────────────────────────────────┐  │WiseGrid Insert Row Fnc  └──────────────────────────────────┘*/function insertRow( nRow ){		var rowCnt = GridObj.GetRowCount();		if( rowCnt-1 == nRow ){ // 마자막 라인일 경우 		GridObj.InsertRow(-1);	}else{		GridObj.InsertRow(nRow+1);	}		// 기본 데이터 셋팅	GridObj.SetCellValue("DC_NAME"			, nRow+1, GridObj.GetCellValue("DC_NAME"	     , nRow));	//GridObj.SetCellHiddenValue("DC_NAME"	, nRow+1, GridObj.GetCellHiddenValue("DC_NAME", nRow));	GridObj.SetCellHiddenValue("DC_NAME"	, nRow+1, GridObj.GetCellHiddenValue("DC_NAME", nRow));	GridObj.SetCellValue("MON_QTY"			, nRow+1, GridObj.GetCellValue("MON_QTY"          , nRow));	GridObj.SetCellValue("BEFORE_SALE_QTY"	, nRow+1, GridObj.GetCellValue("BEFORE_SALE_QTY"  , nRow));	GridObj.SetCellValue("SALE_CUM_QTY"		, nRow+1, GridObj.GetCellValue("SALE_CUM_QTY"	  , nRow));	GridObj.SetCellValue("TODAY_SALE_PLAN"  , nRow+1, GridObj.GetCellValue("TODAY_SALE_PLAN"  , nRow));	GridObj.SetCellValue("ORD_QTY"		    , nRow+1, GridObj.GetCellValue("ORD_QTY"		  , nRow));	GridObj.SetCellValue("WEEK1_QTY"		, nRow+1, GridObj.GetCellValue("WEEK1_QTY"		  , nRow));	GridObj.SetCellValue("WEEK3_QTY"		, nRow+1, GridObj.GetCellValue("WEEK3_QTY"		  , nRow));	GridObj.SetCellValue("TODAY_STOCK"	    , nRow+1, GridObj.GetCellValue("TODAY_STOCK"	  , nRow));	GridObj.SetCellValue("IN_TRANS_QTY"	    , nRow+1, GridObj.GetCellValue("IN_TRANS_QTY"	  , nRow));	GridObj.SetCellValue("OUT_TRANS_QTY"	, nRow+1, GridObj.GetCellValue("OUT_TRANS_QTY"	  , nRow));	GridObj.SetCellValue("STOCK_DAY"		, nRow+1, GridObj.GetCellValue("STOCK_DAY"		  , nRow));	GridObj.SetCellValue("STOCK_TERM"	    , nRow+1, GridObj.GetCellValue("STOCK_TERM"	      , nRow));	GridObj.SetCellValue("SAFETY_STOCK"	    , nRow+1, GridObj.GetCellValue("SAFETY_STOCK"	  , nRow));	GridObj.SetCellValue("SALE_QTY2"		, nRow+1, GridObj.GetCellValue("SALE_QTY2"		  , nRow));	GridObj.SetCellValue("ORD_QTY2"		    , nRow+1, GridObj.GetCellValue("ORD_QTY2"		  , nRow));	GridObj.SetCellValue("STOCK_QTY1"	    , nRow+1, GridObj.GetCellValue("STOCK_QTY1"	      , nRow));	GridObj.SetCellValue("REP_QTY"		    , nRow+1, GridObj.GetCellValue("REP_QTY"		  , nRow));	//GridObj.SetCellValue("TRANS_PLAN_PLT"   , nRow+1, GridObj.GetCellValue("TRANS_PLAN_PLT"   , nRow));	//GridObj.SetCellValue("TRANS_PLAN_QTY"   , nRow+1, GridObj.GetCellValue("TRANS_PLAN_QTY"   , nRow));	GridObj.SetComboSelectedHiddenValue("SRC_LOC"	, nRow+1, GridObj.GetCellHiddenValue("SRC_LOC"	, nRow));	GridObj.SetCellValue("STOCK_QTY2"	    , nRow+1, GridObj.GetCellValue("STOCK_QTY2"	      , nRow));	GridObj.SetCellValue("MIN_PICK_QTY"	    , nRow+1, GridObj.GetCellValue("MIN_PICK_QTY"	  , nRow));	GridObj.SetCellValue("BOX_PER_PLT"	    , nRow+1, GridObj.GetCellValue("BOX_PER_PLT"	  , nRow));	GridObj.SetCellValue("OLD_SAFE_QTY"	    , nRow+1, GridObj.GetCellValue("OLD_SAFE_QTY"	  , nRow));	GridObj.SetCellValue("OLD_BOX_QTY"	    , nRow+1, GridObj.GetCellValue("OLD_BOX_QTY"	  , nRow));	//GridObj.SetCellValue("OLD_SRC_LOC"	    , nRow+1, GridObj.GetCellValue("OLD_SRC_LOC"	  , nRow));	GridObj.SetCellValue("SAFE_UPDATE_FLAG" , nRow+1, GridObj.GetCellValue("SAFE_UPDATE_FLAG" , nRow));	GridObj.SetCellValue("PLAN_UPDATE_FLAG" , nRow+1, GridObj.GetCellValue("PLAN_UPDATE_FLAG" , nRow));	GridObj.SetCellValue("UNIT_UPDATE_FLAG" , nRow+1, GridObj.GetCellValue("UNIT_UPDATE_FLAG" , nRow));};/*┌─────────────────────────────────────────────────┐  │출고사업장이나 PLT, BOX, 최소수송단위를 수정하였을때,   │수정되었다는 Flag를 남기기 위한 Function  │수정된 Flag를 통해서, DML작업을 실행 유무를 판단.  └─────────────────────────────────────────────────┘*/	//function setChangeCheckFlag(strColumnKey, nRow /*objBox*/){//	//var rowIdx = objBox.parentNode.parentNode.rowIndex;//	// => nRow//	//	// 출고사업장, PLT, BOX 가 수정된 경우.//	if( strColumnKey == "SRC_LOC" || strColumnKey == "TRANS_PLAN_PLT" || strColumnKey == "TRANS_PLAN_QTY"){//		//		if(document.frm.plan_update_flag[rowIdx])//			document.frm.plan_update_flag[rowIdx].value = "Y";//		else//			document.frm.plan_update_flag.value = "Y";//	}//	// 최소수송단위가 수정된 경우.//	else if(objBox.name == "min_trans_qty"){//		//		if(document.frm.unit_update_flag[rowIdx])//			document.frm.unit_update_flag[rowIdx].value = "Y";//		else//			document.frm.unit_update_flag.value = "Y";//	}//	// 안전재고가 변경된 경우.//	else if(objBox.name == "safe_qty"){//		if(document.frm.safe_update_flag[rowIdx])//			document.frm.safe_update_flag[rowIdx].value = "Y";//		else//			document.frm.safe_update_flag.value = "Y";//	}//}/*┌──────────────────────────────────┐  │현재 날짜(yyyymmdd) 추출  Fnc  └──────────────────────────────────┘*///function getdatetime() {//	var today = new Date();//	var year = today.getYear();//	var month = today.getMonth() + 1;//	var day = today.getDate();//	//	if(month < 10)//		month = "0" + month;//		//	if(day < 10)//		day = "0" + day;////	document.frm.to_date.value = year + "" + month + "" + day;//}//------------------------------------------------- 기존의 함수 ------------------------------------------------------//// 제품 검색 popup// create pop-up : search item// code_input : code input(search value) input-box name // w_size : size of popup window width, h_size : size of popup window height ==> optional parameter function openItemSearchPop( code_input, w_size, h_size ) { 	// popup 창의 input box 표시 data : search code 	var code_input = document.getElementById(code_input).value; 	if( !(w_size) ) { 		var w_size = 400; 		var h_size = 400; 	} 		var service_url = "service.do?_moon_service=item_search_popup&code_input=" + code_input; 	service_url += "&_moon_perpage=200&_moon_pagenumber=1"; 		var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=" + w_size + ", height=" + h_size + ", top=0, left=0"; 	var newWin = window.open(service_url, "Code_Search", pop_win_style); 	newWin.focus(); 	}// 제품 입력창에 입력한 값과 일치하는 제품 검사 후, 일치하는 제품이 있으면 제품 코드, 제품 명 표시function getItemName(objBox) {		if( objBox.value == "" || objBox.value == null ) {		document.frm.item_name.value = "";		return;	}	commonUtil.getCodeInfo("input_value", objBox.value, "search_item_id_and_item_name_by_item_input", { 		callback:function(arrList){			// 일치하는 제품 없음			if( arrList.length == 1 ) {				objBox.value = arrList[0][0];				document.frm.item_name.value = arrList[0][1];			}			else {				document.frm.item_name.value = "";				var itemid = objBox.value;				openCodeSearchPop('item_id', 'item_name', '400', '300');				return;			}		}	});	}/********************************************************* ****************** Edit, View Mode  ********************* *********************************************************/// input box 를 Edit Mode 로 변환// onClick//function setEditMode( objTd ) {//	//	if(objTd.childNodes(0).name == "plt_qty" //		|| objTd.childNodes(0).name == "box_qty"//		|| objTd.childNodes(0).name == "min_trans_qty"){//		//		objTd.childNodes(0).focus();//		return;//	}//	//	objTd.childNodes(0).style.display = "none";//	objTd.childNodes(1).style.display = "block";//	objTd.childNodes(1).focus();////	//	objTd.onclick = "";//		//}// input box 를 View Mode 로 변환// onFocusOut//function setViewMode( objBox ) {//	//	//	// select box 인 경우, value 가 아니라 TEXT 를 표시해 줘야 함//	if( objBox.tagName.toUpperCase() == "SELECT" ) {//		if( objBox.value == "" || objBox.value == null ) {//			var strVal = objBox.value;//		}//		else {//			var strVal = objBox.options[objBox.selectedIndex].text;//		}//		var objTd = objBox.parentNode;//	}//	else {//		var strVal = objBox.value;//		var objTd = objBox.parentNode;//	}//	//	if( objTd.align.toUpperCase() == "CENTER" ) {//		objTd.childNodes(0).innerHTML = strVal;//	}//	else if( objTd.align.toUpperCase() == "RIGHT" ) {//		objTd.childNodes(0).innerHTML = strVal + "&nbsp;";//	}//	else {//		objTd.childNodes(0).innerHTML = "&nbsp;" + strVal;//	}//	//	objTd.childNodes(0).style.display = "block";//	objTd.childNodes(1).style.display = "none";//	objTd.onclick = function() { setEditMode(this); };//	//}// PLT, BOX값이 수정되었을때 호출됨.//function onChangeCheck(objBox, flag){//	var strVal = objBox.value;//	//	setChangeCheckFlag(objBox);//	//	// 기본재고상차BOX, 추가재고상차BOX, 생산상차BOX 입력창인 경우, 숫자 체크 & 천단위 구분자 표시//	if( objBox.name == "plt_qty" || objBox.name == "box_qty") {//		if( strVal != "" && strVal != null ) {//			// 숫자 체크//			if( checkNum(objBox, "BLANK") == false ) {//				objSetting(objBox, "", "숫자만 입력하여 주세요.");//				return;//			}//			// 형식이 맞는 경우 천단위 구분자 표시//			else {//				strVal = objBox.value;//				if(objBox.name == "plt_qty")//					objBox.value = fixedPoint(strVal,2);//				else//					objBox.value = strVal;//				strVal = objBox.value;//			}//		}//		else {//			// BOX 인경우.//			if(objBox.name == "box_qty")//				objBox.value = "0";//			else//				objBox.value = "0.00"//		}//		//		// BOX 인 경우//		if( objBox.name == "box_qty" ) {//			// PLT 수량 계산//			calPltQty(objBox);//		}//		//		// PLT 인 경우//		if( objBox.name == "plt_qty" ) {//			// Box 수량 계산//			calBoxQty(objBox);//		}//	}//}//// 출고사업장이나 PLT, BOX, 최소수송단위를 수정하였을때, //// 수정되었다는 Flag를 남기기 위한 Function//// 수정된 Flag를 통해서, DML작업을 실행 유무를 판단.//function setChangeCheckFlag(objBox){//	var rowIdx = objBox.parentNode.parentNode.rowIndex;//	//	// 출고사업장, PLT, BOX 가 수정된 경우.//	if( objBox.name == "src_loc" || objBox.name == "plt_qty" || objBox.name == "box_qty"){//		//		if(document.frm.plan_update_flag[rowIdx])//			document.frm.plan_update_flag[rowIdx].value = "Y";//		else//			document.frm.plan_update_flag.value = "Y";//	}//	// 최소수송단위가 수정된 경우.//	else if(objBox.name == "min_trans_qty"){//		//		if(document.frm.unit_update_flag[rowIdx])//			document.frm.unit_update_flag[rowIdx].value = "Y";//		else//			document.frm.unit_update_flag.value = "Y";//	}//	// 안전재고가 변경된 경우.//	else if(objBox.name == "safe_qty"){//		if(document.frm.safe_update_flag[rowIdx])//			document.frm.safe_update_flag[rowIdx].value = "Y";//		else//			document.frm.safe_update_flag.value = "Y";//	}//}/*********************************************************/// 숫자 input box 에 문자 check // parameter : obj - inbox object , type - default value 또는 소수점 check 유뮤 등의 type 정의 // type - BLANK : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 소수점 허용//        ZERO : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 소수점 허용 //        BLANK_INT : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 소수점은 error 처리( only integer ) //        ZERO_INT : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 소수점은 error 처리( only integer ) //        BLANK_INT_UP : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 음수 & 소수점은 error 처리( only plus integer ) //        ZERO_INT_UP : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 음수 & 소수점은 error 처리( only plus integer ) //        ** type parameter 가 없으면 ZERO(default=0, 소숫점 허용) 와 같음 //function checkNum(obj, type) {////	var i, ch;//	var pointCheck = 0;//	var defaultVal = "0"; //	var alertMsg = "숫자만 입력하여 주세요.";//	var checkType = "POINT"; //	//	// default value 는 공백 //	if( type == "BLANK" || type == "BLANK_INT" || type == "BLANK_INT_UP" ) //		defaultVal = ""; //	//	// 소수점 허용하지 않음 //	if( type == "BLANK_INT" || type == "ZERO_INT" || type == "BLANK_INT_UP" || type == "ZERO_INT_UP" ) //	{ //		if( type == "BLANK_INT_UP" || type == "ZERO_INT_UP" ) //			alertMsg = "자연수만 입력하여 주세요."; //		else //			alertMsg = "정수만 입력하여 주세요."; //		checkType = "INT"; //		pointCheck = 1; //	} //	//	var checkValue = delComma(obj.value).trim();////	if( defaultVal == "0" && ( checkValue == null || checkValue == "" ) )//	{//		//objSetting(obj, defaultVal, alertMsg);//		return false;//	}//	//	for (i=0; i < checkValue.length; i++) {//		//		ch = checkValue.charAt(i);//		//		// invalid value //		if(ch==" ")//		{ //			//objSetting(obj, defaultVal, alertMsg); //			return false;//		}//		//		// valid value//		else if ( ( ch >= 0 && ch <= 9 ) ) //		{ }//		//		// point check //		else if ( ch == '.' ) //		{//			pointCheck += 1;//			// invalid value //			if ( pointCheck > 1 )//			{//				//objSetting(obj, defaultVal, alertMsg); //				return false;//			} //		} //		//		// valid value : minus sign //		else if ( i == 0 && ch == '-' && type != "BLANK_INT_UP" && type != "ZERO_INT_UP" ) //		{ } //		//		// invalid value //		else //		{//			//objSetting(obj, defaultVal, alertMsg); //			return false;//		}//	}//	//	obj.value = checkValue; //	return true;//	//}/********************************************************* ******************** PLT, BOX 계산   ********************* *********************************************************/// BOX 수량이 변경된 경우, PLT 수량을 자동으로 계산 하기 위한 function//function calPltQty(objBox) {//	//	var rowIdx = objBox.parentNode.parentNode.rowIndex;//	if( document.frm.box_per_palet[rowIdx] ) {//		var boxPerPaletStr = document.frm.box_per_palet[rowIdx].value;//		if( objBox.name == "box_qty" ) { // 기본재고상차//			var pltBox = document.frm.plt_qty[rowIdx];//		}//		else {//			return;//		}//	}//	else {//		var boxPerPaletStr = document.frm.box_per_palet.value;//		if( objBox.name == "box_qty" ) { // 기본재고상차//			var pltBox = document.frm.plt_qty;//		}//		else {//			return;//		}//	}//	//	// PALET 당 BOX 수량이 없는 경우 1 로 계산//	if( boxPerPaletStr == null || boxPerPaletStr == "" ) {//		var boxPerPalet = 100;//	}//	else {//		var boxPerPalet = Number(delComma(boxPerPaletStr));//	}//	//	// BOX 입력창이 비어 있는 경우//	if( objBox.value == null || objBox.value == "" ) {//		var pltStr = "";//	}//	else {//		var boxQty = Number(delComma(objBox.value));//		var pltQty = Math.round(boxQty*100 / boxPerPalet)/100;//		var pltStr = numberFormat(pltQty.toString());//	}//	//	pltBox.value = delComma(fixedPoint(pltStr,2));//	//}// PLT 수량이 변경된 경우 BOX 수량을 자동으로 계산하기 위한 function//function calBoxQty(objBox) {//	//	var rowIdx = objBox.parentNode.parentNode.rowIndex;//	if( document.frm.box_per_palet[rowIdx] ) {//		var boxPerPaletStr = document.frm.box_per_palet[rowIdx].value;//		if( objBox.name == "plt_qty" ) { //			var boxPlt = document.frm.box_qty[rowIdx];//		}//		else {//			return;//		}//	}//	else {//		var boxPerPaletStr = document.frm.box_per_palet.value;//		if( objBox.name == "plt_qty" ) { // 기본재고상차//			var boxPlt = document.frm.box_qty;//		}//		else {//			return;//		}//	}//	//	// PALET 당 BOX 수량이 없는 경우 1 로 계산//	if( boxPerPaletStr == null || boxPerPaletStr == "" ) {//		var boxPerPalet = 100;//	}//	else {//		var boxPerPalet = Number(delComma(boxPerPaletStr));//	}//	//	// BOX 입력창이 비어 있는 경우//	if( objBox.value == null || objBox.value == "" ) {//		var boxStr = "";//	}//	else {//		var pltQty = Number(delComma(objBox.value));//		var boxQty = Math.round(Math.round(pltQty * boxPerPalet*100)/100,0);//		var boxStr = numberFormat(boxQty.toString());//	}//	//	boxPlt.value = boxStr;//	//}/*********************************************************/// HTML Grid 의// onMouseOver event 에 따른 배경색 변환 //function bgOver( obj ) { //	//	var rowIdx = obj.rowIndex;//	left_tbody.rows[rowIdx].style.backgroundColor = "#aaaaaa"; //	main_tbody.rows[rowIdx].style.backgroundColor = "#aaaaaa"; //}// HTML Grid 의 // onMouseOut event 에 따른 배경색 변환 //function bgOut( obj ) {//	//	var rowIdx = obj.rowIndex;//	left_tbody.rows[rowIdx].style.backgroundColor = "#ffffff";//	main_tbody.rows[rowIdx].style.backgroundColor = "#ffffff"; //}// 셀 저장 전역변수//var objTdG;// setTimeout 에서 호출하여 시간 지연 후 setEditMode() 실행//function setEditModeTime() {//	//	setEditMode( objTdG );//	//}// TAB key 로 다음 항목 이동//function moveNextBox( objBox ) {//	//	var tableLen = left_tbody.rows.length;//	// 제품코드 셀인 경우//	if( objBox.parentNode.tagName.toUpperCase() == "A" ) {//		var rowIdx = objBox.parentNode.parentNode.parentNode.rowIndex;//	}//	else {//		var rowIdx = objBox.parentNode.parentNode.rowIndex;//	}//	var objName = objBox.name;//	//	// TAB or ENTER//	if( event.keyCode == "9" || event.keyCode == "13" ) {//		// PLT --> BOX//		if( objName == "plt_qty" ) {//			objTdG = main_tbody.rows[rowIdx].cells[12];//		}//		// BOX --> 출고사업장//		else if( objName == "box_qty" ) {//			//			objTdG = main_tbody.rows[rowIdx].cells[14];//		}//		// 출고사업장 --> 최소수송단위//		//else if( objName == "src_loc" ) {//		//	objTdG = left_tbody.rows[rowIdx].cells[14];//		//}//		// 최소수송단위 --> 다음줄 PLT//		else if( objName == "min_trans_qty" ) {//			// 마지막줄 --> 첫줄로 이동//			if( rowIdx+1 == tableLen ) {//				objTdG = left_tbody.rows[0].cells[11];//			}//			// 다음줄의 첫번째 input box 로 이동//			else {//				objTdG = left_tbody.rows[rowIdx+1].cells[11];//			}//		}//		// 그 외의 box 에선 동작 없음//		else {//			return;//		}//		setTimeout(setEditModeTime, 1);//	}//	//}// src_loc(출고장), item_id(제품 코드) 로부터 box_per_palet 찾기// obj 는 select box 또는 input box//function getBoxPerPalet( obj ) {//	//	// 출고장 입력창에서 발생한 event 인지, 제품코드 입력창에서 발생한 event 인지 구분//	if(obj.name == "box_qty"){//		var rowIdx = obj.parentNode.parentNode.rowIndex;//	}//	else if(obj.name == "plt_qty"){//		var rowIdx = obj.parentNode.parentNode.rowIndex;//	}//	else if( obj.name == "src_loc" ) {//		var rowIdx = obj.parentNode.parentNode.rowIndex;//	}//	else if ( obj.name == "item_id" ) {//		var rowIdx = obj.parentNode.parentNode.parentNode.rowIndex;//	}//	else {//		return;//	}//	//	// 출고장, 제품코드 데이터//	if( document.frm.src_loc[rowIdx]) {//		var dc_id = document.frm.src_loc[rowIdx].value;//		var src_loc = document.frm.src_loc[rowIdx];//		var item_id = document.frm.item_id.value;//		var objBoxPerPalet = document.frm.box_per_palet[rowIdx];//		var box_qty = document.frm.box_qty[rowIdx];//		var plt_qty = document.frm.plt_qty[rowIdx];//	}//	else {//		var dc_id = document.frm.src_loc.value;//		var src_loc = document.frm.src_loc;//		var item_id = document.frm.item_id.value;//		var objBoxPerPalet = document.frm.box_per_palet;//		var box_qty = document.frm.box_qty;//		var plt_qty = document.frm.plt_qty;//	}//	//	// 출고장을 선택하지 않고 값을 수정하려고 한 경우..//	if(dc_id == null || dc_id == ""){//		box_qty.value = "0";//		plt_qty.value = "0.00";//		alert("PLT, BOX값을 수정하기 전에 출고장을 먼저 선택하여 주십시요.");//		setEditMode( src_loc.parentNode );//		src_loc.focus();//		return;//	}//	//	// 출고장 또는 제품코드 데이터가 없는 경우 함수를 빠져나간다//	if( dc_id == null || dc_id == "" || item_id == null || item_id == "" ) {//		return;//	}//	//	replenishPlan.getBoxPerPalet(dc_id, item_id, "rp_01010_dailyTransportPlanSalesInfo_search_box_per_palet", { //		callback:function(boxPerPalet){//			if( boxPerPalet == null || boxPerPalet == "" ) {//				objBoxPerPalet.value = 100;//			}//			else {//				objBoxPerPalet.value = boxPerPalet;//			}//		}//	});//}// HTML Grid 화면 resizing//function setHtmlGridAutoResize( tab_h, table_h ){//	//	var leftWidthValue = leftDisplay.style.width.split("px")[0]; //	var topLineHeightValue = topLine.style.height.split("px")[0]; //	//	var maxWidthValue;//	var maxHeightValue;//	//	if (document.layers) {//		//Nescape//		maxWidthValue = window.innerWidth;//		maxHeightValue = window.innerHeight;//	}//	if (document.all) {//		//explore//		maxWidthValue = document.body.clientWidth;//		maxHeightValue = document.body.clientHeight;//	} //	//	var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ; //	var tableHeightValue = Number(maxHeightValue) - Number(table_h) ; //	var leftDiplayHeightValue = Number(maxHeightValue) - Number(table_h) - Number(topLineHeightValue) - 17; //	var mainDiplayHeightValue = Number(maxHeightValue) - Number(table_h) - Number(topLineHeightValue) ; //	//	var search_h = document.frm.search_h.value; //	if( search_menu.style.display == "none" ) //	{ //		tabHeightValue += Number(search_h); //		tableHeightValue += Number(search_h); //		leftDiplayHeightValue += Number(search_h); //		mainDiplayHeightValue += Number(search_h); //	} //	//	var tabWidthValue = Number(maxWidthValue) - 15;//	var tableWidthValue = Number(maxWidthValue) - Number(leftWidthValue) - 1;//	var topLineWidthValue = Number(maxWidthValue) - Number(leftWidthValue) - 39;//	var displayWidthValue = Number(maxWidthValue) - Number(leftWidthValue) - 20;//	//	// 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅 //	// ==> 화면이 더이상 축소되지 않음 //	if( tabHeightValue < 1 ) //		tabHeightValue = 1; //	if( tableHeightValue < 1 ) //		tableHeightValue = 1; //	if( leftDiplayHeightValue < 1 ) //		leftDiplayHeightValue = 1; //	if( mainDiplayHeightValue < 1 ) //		mainDiplayHeightValue = 1; //	//	if( tableWidthValue < 1 ) //		tableWidthValue = 1; //	if( topLineWidthValue < 1 ) //		topLineWidthValue = 1; //	if( displayWidthValue < 1 ) //		displayWidthValue = 1; //	//	tabPage1.style.height = tabHeightValue + "px"; //	tbMain.style.height = tableHeightValue + "px"; //	leftDisplay.style.height = leftDiplayHeightValue + "px"; //	mainDisplay.style.height = mainDiplayHeightValue + "px"; //	//	tabPage1.style.width = tabWidthValue + "px";//	tbMain.width = tableWidthValue + "px"; //	topLine.style.width = topLineWidthValue + "px"; //	mainDisplay.style.width = displayWidthValue + "px";//	//	//tdBLeft.width = (Number(maxWidthValue) - 280).toString() + "px";//	//document.all.gridBLeft.width = (Number(maxWidthValue) - 280).toString() + "px";//	//}// 날짜 형식을 체크하는 함수, return value : 1-맞는 형식, 0-잘못된 형식//function chkDate2(obj) {//	//	var separator = "-"; //	//	var str = obj.value.trim();//	//	if( str == "" || str == null ){//		obj.value = str;//		setViewMode(obj);//		return 1;//	}//	//	str = str.replace(/\//g, '').replace(/-/g, '');//	obj.value = str.substr(0, 4) + separator + str.substr(4, 2) + separator + str.substr(6, 2);//	//	var input = obj.value.trim(); //	//	if ( input.length == 0 ) return 1; // 공백은 skip//	//	var dateType = "yyyy-MM-dd"; //	var inputYear = input.substr(0,4); //	var inputMonth = input.substr(5,2) - 1; //	var inputDate = input.substr(8,2); //	//	if( (input.substr(4,1) != "-" && input.substr(4,1) != "/") || (input.substr(7,1) != "-" && input.substr(7,1) != "/") ) //	{ //		separator = "invalid"; //	}//	//	var resultDate = new Date(inputYear, inputMonth, inputDate); //	if ( resultDate.getFullYear() != inputYear || resultDate.getMonth() != inputMonth || resultDate.getDate() != inputDate || input.length != 10 || separator == "invalid" ) //	{ //		obj.value = ""; //		//obj.select(); //		alertChkDate(input, dateType); //		setEditMode( obj.parentNode );//		return 0; //	} //	else //	{ //		//setViewMode(obj);//		return 1; //	} //	//}// version - seq 분리function setVersions( versions ) {		var verArr = versions.split("!%!");	if( verArr.length == 2 ) {		document.frm.version.value = verArr[0].trim();		document.frm.seq.value = verArr[1].trim();	}	}// 검색//function GoSearch(service) {//	//	// 버전, 입고장, 수송구분 검색 데이터 setting//	var versions = document.frm.plan_version.value;//	if( versions == "" || versions == null ) {//		alert("버전을 선택하세요.");//		return;//	}//	if( document.frm.trans_start.value == "" || document.frm.trans_start.value == null ) {//		alert("수송일자를 입력하여 주십시요.");//		return;//	}//	//	if( document.frm.item_id.value == "" || document.frm.item_id.value == null ) {//		alert("제품코드를 입력하여 주십시요.");//		return;//	}//	//	var verArr = versions.split("!%!");//	if( verArr.length == 2 ) {//		document.frm.version.value 	= verArr[0].trim();//		document.frm.seq.value 		= verArr[1].trim();//	}//	//	// 조회시 WAITING 이미지 보여주기//	viewWait();//	document.frm._moon_service.value = service; //	document.frm._moon_pagenumber.value = "1";//	document.frm.action = "service.do";//	document.frm.target = "_self";//	document.frm.submit();//	//}// 저장 버튼 클릭//function GoSave_old(service) {//	//	var version = document.frm.version.value;//	var seq = document.frm.seq.value;//	var trans_date = document.frm.trans_start.value;//	var item_id = document.frm.item_id.value;//	// 버전, 차수를 선택하지 않은 경우//	if( version == null || version == "" || seq == null || seq == "" ) {//		alert("버전을 먼저 선택하고 데이터 조회 후, 저장이 가능합니다.");//		return;//	}//	//	if( trans_date == null || trans_date == ""){//		alert("수송일자를 먼저 선택하고 데이터 조회 후, 저장이 가능합니다.");//		return;//	}//	//	if( item_id == null || item_id == ""){//		alert("제품 코드를 먼저 입력하고 데이터 조회 후, 저장이 가능합니다.");//		return;//	}//	//	//	// 다시 확인//	if(!confirm("저장하시겠습니까?"))//		return;//		//	viewWait();//	//	frameSetService.location = "service.do?_moon_service=set_service_id&amp;user_service=" + service;//	//	document.frm._moon_service.value = service;//	document.frm.action = "service.do";//	document.frm.target = "_self";//	document.frm.submit();//	//}// 차기버전 계획반영 버튼 클릭시.//function GoCreate(service) {//	//	var trans_date = document.frm.trans_start.value;//	var item_id = document.frm.item_id.value;////	if( trans_date == null || trans_date == ""){//		alert("수송일자를 먼저 선택하고 데이터를 조회 하셔야 계획에 반영이 가능합니다.");//		return;//	}//	//	if( item_id == null || item_id == ""){//		alert("제품 코드를 먼저 입력하고 데이터를 조회 하셔야 계획에 반영이 가능합니다.");//		return;//	}//	//	//	// 다시 확인//	if(!confirm("계획에 반영하시겠습니까?"))//		return;//	//	viewWait();//	//	frameSetService.location = "service.do?_moon_service=set_service_id&amp;user_service=" + service;//	//	document.frm._moon_service.value = service;//	document.frm.action = "service.do";//	document.frm.target = "_self";//	document.frm.submit();//	//}// enter check 용 function enterCheck(frm_name){		if( pressedStrCheck() != false ) { 		if(event.keyCode =='13'){			// 자기화면 갱신			getItemNameSearch(document.frm.item_id, frm_name);			//GoSearch(frm_name);		}	} 	}// 제품 입력창에 입력한 값과 일치하는 제품 검사 후, 일치하는 제품이 있으면 제품 코드, 제품 명 표시function getItemNameSearch(objBox, service) {		if( objBox.value == "" || objBox.value == null ) {		document.frm.item_name.value = "";		return;	}	commonUtil.getCodeInfo("input_value", objBox.value, "search_item_id_and_item_name_by_item_input", { 		callback:function(arrList){			// 일치하는 제품 없음			if( arrList.length == 1 ) {				objBox.value = arrList[0][0];				document.frm.item_name.value = arrList[0][1];			}			else {				document.frm.item_name.value = "";				var itemid = objBox.value;				openCodeSearchPop('item_id', 'item_name', '400', '300');				return;			}			GoSearch(service);		}	});	}/*┌──────────────────────────────────┐  │수송계회 동기화  └──────────────────────────────────┘*/function GoTransPlanSync() {	// 버전, 입고장, 수송구분 검색 데이터 setting	var version = document.frm.version.value;	if( version == "" || version == null ) {		alert("버전을 선택하세요.");		return;	}	var tgt_name;	var sync_flag;	var in_paramKey = "version";	var in_paramCode = version; 			if(!confirm(version+"버전의 의 수송계획을 동기화 합니다. 모든 작업을 끝마치셨습니까?")){				return;			}			//////////////////////////////////////////////////////////			commonUtil.executeQuery(in_paramKey, in_paramCode, "trans_plan_sync_1",{				callback:function(result){					if(result == "SUCCESS"){					}					else{					}				}			});			commonUtil.executeQuery(in_paramKey, in_paramCode, "trans_plan_sync_2", {				callback:function(result){					if(result == "SUCCESS"){						alert(version+"버전의 의 수송계획의 동기화를 끝마쳤습니다.");					}					else{						alert("계획 동기화에 실패 하였습니다 .");					}				}			});		/////////////////////////////////////////////////////////////////}