//############################################################//## Щ煎斜極ID      : sc_13010_set_prod_order_list.vm//## Щ煎斜極貲      : 嶸鱔陛奢 儅骯螃渦 婦葬//## 偃嫦濠          : 掏辨雙//## 偃嫦橾濠        : 2009-07-20//##//## 婦溼 job file   : job_sinc_20_scheduling_04.xml//## 婦溼 query file : query_sinc_20_scheduling_04.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.0        2009-07-20  陴錠辨      create//##//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************//*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 餌檜鍔 褻瞰 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 飛 size 蹴模 衛 飛橉 傘鼠 濛嬴 斜葬萄 觼晦陛 擠熱陛 腎賊 縑楝陛 釭嘎煎 斜 唳辦 鼠褻勒 1煎 撮た         // ==> 飛橉 渦檜鼻 蹴模腎雖 彊擠         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         document.WiseGrid.height = tableHeightValue + "px";             }  //-----------------------------------------             瞪羲 滲熱            ----------------------------------------------////var mode;														// WiseGrid 鱔褐 衛 瞪歎 賅萄(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 憮綰葩 ぬ酈雖(class だ橾 唳煎)var job_id = 'sc_13010_set_prod_order_list';var GridObj ; 													// WiseGrid 偌羹var GridObj2;var GridObj3;var color_tot = '234|234|234';			//м啗 塭檣 寡唳儀var color_edit_col = '255|253|208';var color_sp = '230|222|230'; 			//鏽歲 掘碟摹 寡唳儀var color_select_row = '141|232|141';	//塭檣 摹鷗 寡唳儀var colBg01 = '224|255|224';			//255|255|153var colBg02 = '255|255|255';/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛WiseGrid 螃粽薛お陛 儅撩腎堅 蟾晦音  嫦儅ж朝 							弛  弛JavaScript Event檣 Initialize()蒂 嫡嬴 斜葬萄曖 ④渦蒂 撢たи棻.			弛  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function init() {    	GridObj = document.WiseGrid;		setProperty(GridObj);	//WiseGrid Default撲薑 睡碟 (WiseGrid_Property.jsだ橾 頂縑 摹樹腎橫 氈棻.)	setHeader(GridObj);  	//п渦儅撩 	setDefault();        	//飛 晦獄 撲薑 }      /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛 晦獄 撲薑 睡碟.  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function setDefault() {     GridObj.nHDLineSize         = 16; //Header Size    GridObj.strHDClickAction    = "sortsingle";        //④渦曖 塭檣熱蒂 撲薑и棻.     GridObj.nHDLines = 2;           }       /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛п渦儅撩  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function setHeader(GridObj) {        	GridObj.AddHeader("CRUD"			,"CRUD"       		,"t_text" 	,100    ,50  ,false); 	GridObj.AddHeader("IF_BUTTON"		,"ERP瞪歎"   		,"t_text" 	,20		,0  ,true); //0    	GridObj.AddHeader("DEL_BUTTON"		,"餉薯"				,"t_text" 	,20		,0  ,true); //0 	GridObj.AddHeader("IDU_FLAG"		,"儅撩\n鼻鷓"    		,"t_text" 	,20		,33  ,false); //0 	GridObj.AddHeader("IF_FLAG"			,"瞪歎\n鼻鷓"    		,"t_text" 	,20		,66  ,false); //0    	GridObj.AddHeader("SELECTED"		,"摹鷗"       		,"t_checkbox" 	,2	,31  ,true); //0 	//GridObj.AddHeader("SELECTED"		,"餉薯"       		,"t_checkbox" 	,2	,31  ,true); //0  	    	GridObj.AddHeader("WO_ID"			,"WO_ID"       		,"t_text" 	,100    ,0  ,false);	GridObj.AddHeader("OPER_ID"			,"OPER_ID"     		,"t_text" 	,100    ,0  ,false);	GridObj.AddHeader("PLANT_ID"		,"Ы楠お"       		,"t_text" 	,20		,0  ,false); //0    	GridObj.AddHeader("ITEM_ID"			,"濠營廓"       	,"t_text" 	,400	,70  ,false); //0    	GridObj.AddHeader("ITEM_NAME"		,"濠營貲"       		,"t_text" 	,200	,220 ,false); //0    	GridObj.AddHeader("QTY"				,"啗僩"     		,"t_number" ,20.3	,70  ,false); //0    	GridObj.AddHeader("QTY_UOM"			,"欽嬪"     		  	,"t_text" 	,20		,0  ,false); //0    	GridObj.AddHeader("PROD_VER"		,"儅骯\n幗瞪"       	,"t_text" 	,20		,0  ,false); //0    	// -------------------W+1-------------------------    	GridObj.AddHeader("PROC_ID"			,"剪楚籀_ID"				,"t_text" 	,20		,0  ,false); //0 	GridObj.AddHeader("PROC_ID_NAME"	,"剪楚籀"				,"t_text" 	,20		,90  ,false); //0    	GridObj.AddHeader("LOC_ID"			,"殮轎堅\n盪濰嬪纂_ID"	,"t_text" 	,20		,0  ,false); //0    	GridObj.AddHeader("LOC_NAME"		,"殮轎堅\n盪濰嬪纂"	,"t_text" 	,20		,66  ,false); //0 	GridObj.AddHeader("START_DATE"		,"衛濛橾濠"       	,"t_text" 	,20		,80  ,false); //0   	GridObj.AddHeader("START_TIME"		,"衛濛衛除"    		,"t_text" 	,20		,0  ,false); //0 	GridObj.AddHeader("END_DATE"		,"謙猿橾濠"    		,"t_text" 	,20		,80  ,false); //0 	GridObj.AddHeader("END_TIME"		,"謙猿衛除"    		,"t_text" 	,20		,0  ,false); //0 	// -------------------W+2-------------------------    	GridObj.AddHeader("PROD_PO"			,"儅骯螃渦廓"    	,"t_text" 	,20		,90  ,false); //0    	GridObj.AddHeader("IF_MSGS"			,"瞪歎 詭衛雖"    		,"t_text" 	,300	,400  ,false); //0   	GridObj.BoundHeader();		GridObj.SetCRUDMode("CRUD");  // AD諦 DE陛 撢た 腆 唳辦朝 橈棻.		GridObj.SetColFix('ITEM_NAME');		GridObj.SetNumberFormat("QTY", "###,###,##0");		GridObj.SetColCellAlign('IF_FLAG','center');	GridObj.SetColCellAlign('IDU_FLAG','center');	GridObj.SetColCellAlign('PROD_PO','center');		GridObj.SetColCellAlign('PLANT_ID','center');	GridObj.SetColCellAlign('ITEM_ID','center');	GridObj.SetColCellAlign('QTY_UOM','center');	GridObj.SetColCellAlign('PROD_VER','center');	GridObj.SetColCellAlign('PROC_ID','center');	GridObj.SetColCellAlign('PROC_ID_NAME','center');				GridObj.SetColCellAlign('LOC_ID','center');	GridObj.SetColCellAlign('LOC_NAME','center');	GridObj.SetColCellAlign('START_DATE','center');	GridObj.SetColCellAlign('START_TIME','center');	GridObj.SetColCellAlign('END_DATE','center');	GridObj.SetColCellAlign('END_TIME','center');	//Hidden 鏽歲  	GridObj.SetColHide("CRUD",true);       }   /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛橦 '褻'蒂 援腦賊 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/   function GoSearch()    {       doQuery();   }  /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛橦 '盪濰'蒂 援腦賊 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GoSave  (service) {		//alert("GoSave")	//return;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;    	//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj.SetParam("mode", "save");	// user_id	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("cnfm_date", document.frm.cnfm_date.value);		//WiseGrid檜 憮幗諦 鱔褐衛縑 等檜攪蒂 瞪殖ж朝 詭憮萄殮棲棻. 鱔褐檜 撩奢ж賊 true蒂 奩納桭炴.	GridObj.DoQuery(servlet_url, "CRUD");}         /*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛羅廓簞 斜葬萄曖 褻 蘭葬蒂 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/   function doQuery()    {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       //var cnfm_date = document.all.cnfm_date.value;       var start_date  = document.all.start_date.value;       var end_date   = document.all.end_date.value;              var idu_flag	= document.all.idu_flag.value;       var if_flag	= document.all.if_flag.value;              var scm_charge	= document.all.scm_charge.value;                     //剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )       GridObj.SetParam("mode", "search");       GridObj.SetParam("start_date", start_date);       GridObj.SetParam("end_date", end_date);       GridObj.SetParam("idu_flag", idu_flag);       GridObj.SetParam("if_flag", if_flag);       GridObj.SetParam("scm_charge", scm_charge);       GridObj.DoQuery(servlet_url);   }/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛等檜攪 褻萼 薑鼻瞳戲煎 諫猿腎賊 嫦儅腎朝 Event縑 渠и Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/    function GridEndQuery()     {        var endMode = GridObj.GetParam("mode");        var error_msg = '';                  if(endMode == "search") //褻萼 諫猿脹 唳辦        {            if(GridObj.GetStatus() == "true")             {                           	        	var row_cnt = GridObj.GetRowCount();				var colBGColor='232|245|213';								for( var i=0 ;i<row_cnt ;i++) //瞪羹 Row虜躑 奩犒 и棻.		        {		          // GridObj.SetCellBgColor("PROD_REQ_DATE", i, colBGColor); 		        }		        				//IF_FLAG (瞪歎 諫猿脹 ヶ跡菟 )	        	               				for(var i=0;i<GridObj.GetRowCount();i++) {				// cell儀梃 滲唳					if(GridObj.GetCellValue('IF_FLAG',i) == 'T' ){  // GREEN						GridObj.SetCellBgColor('ITEM_ID', i, '0|191|255');						GridObj.SetCellBgColor('ITEM_NAME', i, '0|191|255');					}else{											}  				}		        		        		                                                                 } else                {                 error_msg = GridObj.GetMessage();                 alert(error_msg);            }        }        else if(endMode == "save") {			if(GridObj.GetStatus() == "true") {// 				GridObj.focus();					} else {				var error_msg = GridObj.GetMessage();// 				alert(error_msg);						}						doQuery()   // 盪濰 諫猿 給嬴螢陽朝 飛橉 營褻 и棻.         }		    }function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {  //pr_qty//alert("strColumnKey+"+strColumnKey);	// if 霞ч醞檣 等檜攪朝 熱薑 碳陛!!	var if_flag	= GridObj.GetCellValue("IF_FLAG", nRow);	if( if_flag == "" || if_flag == null) {	}else{		//alert("檜嘐 瞪歎脹 о跡殮棲棻!!!");		GridObj.SetCellValue(strColumnKey, nRow,  nOldValue);		return;	}		if( strColumnKey == "SELECTED"){		return;	}}function GoIf(){		/*	//EDIT_FLAG	        	               	for(var i=0;i<GridObj.GetRowCount();i++) {		if(GridObj.GetCellValue('EDIT_FLAG',i) == 'Y' ){  // GREEN			alert("item_id"+GridObj.GetCellValue('EDIT_FLAG',i));						}else{					}  	}		return;	*/ 	if(confirm("摹鷗 ж褐 ヶ跡曖 ERP 瞪歎擊 挨匹牮簸睍懂炱?") == 1 ) {			}	else{		return;	}		var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	//var version		= document.all.version.value;    	//剩啖還 高菟擊虜萇棻.( だ塭嘐攪 薑曖 睡碟 )	GridObj.SetParam("mode", "doIf");	GridObj.SetParam("user_id", document.frm._user_id.value);	//GridObj.SetParam("version", version);		//WiseGrid檜 憮幗諦 鱔褐衛縑 等檜攪蒂 瞪殖ж朝 詭憮萄殮棲棻. 鱔褐檜 撩奢ж賊 true蒂 奩納桭炴.	GridObj.DoQuery(servlet_url, "SELECTED");	}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛橦 '盪濰'蒂 援腦賊 轎 Fnc  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GoReg  (service) {			var item_id		= '';		var item_name	= '';		var wo_id		= '';		var	idu_mode	='REG';		//var week_flag	= document.frm.week_flag.value;				//alert(document.frm.week_flag.value);				var service_url = "service.do?_moon_service=sc_13010_set_prod_order_reg_pop";		service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&wo_id=" + wo_id + "&idu_mode=" + idu_mode;	//service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&week_flag=" + week_flag;	//service_url += "&item_id=" + item_id + "&item_name=" + item_name + "&trans_start=" + trans_start + "&version=" + version + "&seq=" + seq;	var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=700, height=330, top=200, left=200";//	var newWin = window.open(service_url, "sc_13010_set_prod_order_reg_pop", pop_win_style);	var newWin = window.open(service_url, "", pop_win_style);	newWin.focus();			}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛飛橦 ヶ跡 廓 渦綰贗葛衛 轎(熱薑飛)  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GoMod  (nRow) {		var item_id		= GridObj.GetCellValue("ITEM_ID", nRow);		var item_name	= GridObj.GetCellValue("ITEM_NAME", nRow);		var wo_id		= GridObj.GetCellValue("WO_ID", nRow);		var qty			= GridObj.GetCellValue("QTY", nRow);		        var prod_ver		= GridObj.GetCellValue("PROD_VER", nRow);        var proc_id			= GridObj.GetCellValue("PROC_ID", nRow);		var proc_id_name	= GridObj.GetCellValue("PROC_ID_NAME", nRow);		var oper_id			= GridObj.GetCellValue("OPER_ID", nRow);		var loc_id			= GridObj.GetCellValue("LOC_ID", nRow);		var loc_name		= GridObj.GetCellValue("LOC_NAME", nRow);	  				var start_date		= GridObj.GetCellValue("START_DATE", nRow);	  		var start_time		= GridObj.GetCellValue("START_TIME", nRow);	  		var end_date		= GridObj.GetCellValue("END_DATE", nRow);	  		var end_time		= GridObj.GetCellValue("END_TIME", nRow);					  		var	idu_flag	= GridObj.GetCellValue("IDU_FLAG", nRow);		var	if_flag		= GridObj.GetCellValue("IF_FLAG", nRow);		var	if_msgs		= GridObj.GetCellValue("IF_MSGS", nRow);		var prod_po		= GridObj.GetCellValue("PROD_PO", nRow);		var	idu_mode	='MOD';		//var week_flag	= document.frm.week_flag.value;			//alert(item_id);		//alert(item_name);			//alert(document.frm.week_flag.value);				var service_url = "service.do?_moon_service=sc_13010_set_prod_order_reg_pop";		service_url += "&item_id_sel=" + item_id + "&item_name_sel=" + item_name + "&wo_id=" + wo_id + "&idu_mode=" + idu_mode + "&qty=" + qty;		service_url += "&prod_ver=" + prod_ver + "&proc_id=" + proc_id + "&proc_id_name=" + proc_id_name + "&oper_id=" + oper_id;		service_url += "&loc_id=" + loc_id + "&loc_name=" + loc_name + "&start_date=" + start_date + "&start_time=" + start_time;		service_url += "&start_date=" + start_date + "&start_time=" + start_time + "&end_date=" + end_date + "&end_time=" + end_time;		service_url += "&if_flag=" + if_flag + "&if_msgs=" + if_msgs + "&prod_po=" + prod_po + "&idu_flag=" + idu_flag;		var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=700, height=330, top=200, left=200";	//	var newWin = window.open(service_url, "sc_13010_set_prod_order_reg_pop", pop_win_style);		var newWin = window.open(service_url, "", pop_win_style);		newWin.focus();								//alert("で機擊 嗨錶爾濠");	}/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 渦綰贗葛  檜漸お  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridCellDblClick(strColumnKey, nRow) {	if(strColumnKey =='ITEM_ID'||strColumnKey =='ITEM_NAME'){				 GoMod(nRow);			}}	/*忙式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式忖  弛斜葬萄曖 錳 贗葛 檜漸お  戌式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式式戎*/function GridCellClick(strColumnKey, nRow) {}	    