//## 프로그램ID      : op_02030_Material_Refreshing_List.js
//## 프로그램명      : 제품별 자재현황 조회 (신규)
//## 변경자자        : 우종균
//## 개발일자        : 2013-01-24 화요일
//##
//## 관련 job file   : job_sinc_30_orderPlanning_03.xml
//## 관련 query file : query_sinc_30_orderPlanning_03.xml
//##
//## REVISIONS
//## VER        DATE        AUTHOR    DESCRIPTION
//## ---------  ----------  --------  ------------------------------------
//## 1.1        2013-01-24  우종균      update
//##
//############################################################
/************************************************************************************************************************************/
/**********************************************  WiseGrid Java Script   *************************************************************/
/************************************************************************************************************************************/

//-----------------------------------------             전역 변수            ----------------------------------------------//
//var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)
var class_path			= "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)
var job_id 				= 'op_02030_Material_Refreshing_List';

var GridObj ; 													// WiseGrid 객체
var GridObj2 ;

var color_tot			= '234|234|234';	//합계 라인 배경색
var color_edit_col		= '255|253|208';


var color_sp			= '230|222|230'; 	//컬럼 구분선 배경색
var color_select_row	= '255|253|208';	//라인 선택 배경색 



/*┌──────────────────────────────────┐
  │그리드의 사이즈 조절 Fnc
  └──────────────────────────────────┘*/
    function setGridAutoResize( tab_h, table_h ){
        
        var maxWidthValue;
        var maxHeightValue;
        
        if (document.layers) {
            //Nescape
            maxWidthValue  = window.innerWidth;
            maxHeightValue = window.innerHeight;
        }
        if (document.all) {
            //explore
            maxWidthValue  = document.body.clientWidth;
            maxHeightValue = document.body.clientHeight;
        } 
        
        var tabHeightValue   = Number(maxHeightValue) - Number(tab_h) ; 
        var tableHeightValue = Number(maxHeightValue) - Number(table_h) ; 
        
        var search_h = document.frm.search_h.value; 
        if( search_menu.style.display == "none" ) 
        { 
            tabHeightValue += Number(search_h); 
            tableHeightValue += Number(search_h);   
        } 
        
        // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅 
        // ==> 화면이 더이상 축소되지 않음 
        if( tabHeightValue < 1 ) 
            tabHeightValue = 1; 
        if( tableHeightValue < 1 ) 
            tableHeightValue = 1;
          
        document.WiseGrid.height = tableHeightValue + "px"; 
        
    }  

/*┌─────────────────────────────────────────────────────────────────────┐
  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│
  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│
  └─────────────────────────────────────────────────────────────────────┘*/
function init() { 
	GridObj = document.WiseGrid;
	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)
	setHeader(GridObj);  	//해더생성 
	setDefault();        	//화면 기본 설정 
}   

function init2() { 
	GridObj2 = document.WiseGrid2;
	setProperty(GridObj2);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)
	setHeader(GridObj2);  	//해더생성 
	setDefault2();        	//화면 기본 설정 
}   


/*┌──────────────────────────────────┐
  │화면 기본 설정 부분.
  └──────────────────────────────────┘*/
function setDefault() { 
	
	GridObj.bRowSelectorIndex		= true;				//Row Selector 영역에 Row Index를 보여준다.
    GridObj.nHDLineSize				= 10; //Header Size
    
    //헤더의 라인수를 설정한다. 
    GridObj.nHDLines				= 2;   
   
    //선택된 셀의 글자색 지정한다.
	GridObj.strSelectedCellFgColor	= '0|0|0';
	GridObj.strSelectedCellBgColor	= '232|232|255'; //Drag로 선택된 셀의 배경색상을 변경할 수 있다
	GridObj.strActiveRowBgColor		= "232|245|213";    //선택된 행의 배경색상을 설정한다.	
    GridObj.strHDClickAction		= "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.
    GridObj.strMouseWheelAction		='page';

	// Cell Font Setting
	GridObj.nCellFontSize			= 9;					// Font Size 9
       
}
       
function setDefault2() { 

	GridObj2.bRowSelectorIndex		= true;				//Row Selector 영역에 Row Index를 보여준다.
    GridObj2.nHDLineSize			= 10; //Header Size
    
    //헤더의 라인수를 설정한다. 
    GridObj2.nHDLines				= 2;   
   
    //선택된 셀의 글자색 지정한다.
	GridObj2.strSelectedCellFgColor = '0|0|0';
	GridObj2.strSelectedCellBgColor = '232|232|255'; //Drag로 선택된 셀의 배경색상을 변경할 수 있다
	GridObj2.strActiveRowBgColor	= "232|245|213";    //선택된 행의 배경색상을 설정한다.	
    GridObj2.strHDClickAction		= "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.
    GridObj2.strMouseWheelAction	='page';

	// Cell Font Setting
	GridObj2.nCellFontSize			= 9;					// Font Size 9
       
}       
       
       
       
       
/*┌──────────────────────────────────┐
  │해더생성
  └──────────────────────────────────┘*/ 
function setHeader(GridObj) {        

    var item_id 	= document.frm.item_id.value;
    var item_name	= document.frm.item_name.value;

 		GridObj.AddHeader("GUBN"			,"단독"   			,"t_text" 		,2			,30  	,false); //0
 		GridObj.AddHeader("SELECTED"		,""   				,"t_checkbox" 	,2			,30  	,true); //0
		GridObj.AddHeader("CONS_ITEM_ID"	,"자재코드"		    ,"t_text"		,100	    ,60     ,false); //0   
		GridObj.AddHeader("CONS_ITEM_NAME"	,"자재명"	       		,"t_text"		,100	    ,190    ,false); //0
		GridObj.AddHeader("MEINS"			,"단위"   			,"t_text"		,100	    ,35     ,false); //0		 	
		GridObj.AddHeader("REQ_QTY"	    	,"천\n소요량"	        ,"t_number"    ,100.3		,70     ,false); //0
		GridObj.AddHeader("TOT"	    		,"재고\n수량"	        ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("CONV_QTY"	    ,"박스\n환산"	        ,"t_number"	   ,100.3		,70     ,false); //0		
		GridObj.AddHeader("PEINH"	    	,"가격\n단위"	        ,"t_number"	   ,100.3		,50     ,false); //0
		GridObj.AddHeader("NETPR"	    	,"단가"	       	    ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("WAERS"	    	,"통화키"		        ,"t_text"	   ,100			,50     ,false); //0
		GridObj.AddHeader("PAY"				,"금액"				,"t_number"	   ,100.3		,70     ,false); //0		
		GridObj.AddHeader("QTY1"	    	,"안양"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("QTY2"	    	,"안성"	   		    ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("QTY3"	    	,"안성(음료)"	        ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("QTY4"	    	,"아산"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("QTY5"	    	,"구미"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("QTY6"	    	,"부산"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("QTY7"	    	,"녹산"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("COM_STOCK"	    ,"계열사\n재고"	   ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj.AddHeader("PROD_CUST_NAME"	,"공급업체"	       	,"t_text"		,1000	    ,190    ,false); //0		
		
		/* 이중 해더 추가 */
		GridObj.AddGroup("HD1",      		"공장별 재고");			//그리드에 그룹을 등록한다. 
		GridObj.AppendHeader("HD1", 	 "QTY1");
		GridObj.AppendHeader("HD1",      "QTY2");
		GridObj.AppendHeader("HD1",      "QTY3");
		GridObj.AppendHeader("HD1", 	 "QTY4");	
		GridObj.AppendHeader("HD1", 	 "QTY5");
		GridObj.AppendHeader("HD1",      "QTY6");
		GridObj.AppendHeader("HD1",      "QTY7");		
		
		/* 저장을 위한 히든 값 */
		
		GridObj.BoundHeader();	
		
		GridObj.SetColFix('CONS_ITEM_NAME');
		
		GridObj.SetColCellAlign('GUBN',					'center');
		GridObj.SetColCellAlign('CONS_ITEM_ID',			'left');
		GridObj.SetColCellAlign('CONS_ITEM_NAME',		'left');		
		GridObj.SetColCellAlign('MEINS',				'center');
		GridObj.SetColCellAlign('REQ_QTY',				'right'); 
		GridObj.SetColCellAlign('TOT',					'right');
		GridObj.SetColCellAlign('CONV_QTY',				'right');		
		GridObj.SetColCellAlign('WAERS',				'center');
		GridObj.SetColCellAlign('PEINH',				'right');
		GridObj.SetColCellAlign('NETPR',				'right');
		GridObj.SetColCellAlign('PAY',					'right');		
		GridObj.SetColCellAlign('QTY1',					'right');
		GridObj.SetColCellAlign('QTY2',					'right');
		GridObj.SetColCellAlign('QTY3',					'right');
		GridObj.SetColCellAlign('QTY4',					'right');
		GridObj.SetColCellAlign('QTY5',					'right');
		GridObj.SetColCellAlign('QTY6',					'right');
		GridObj.SetColCellAlign('QTY7',					'right');		
		GridObj.SetColCellAlign('COM_STOCK',			'right');		
		GridObj.SetColCellAlign('PROD_CUST_NAME',		'left');				 
		  
		GridObj.SetNumberFormat("REQ_QTY",      "###,###.###");
		GridObj.SetNumberFormat("TOT",      	"###,###.###");
		GridObj.SetNumberFormat("CONV_QTY",    	"###,###.###");		
		GridObj.SetNumberFormat("PEINH",      	    "###,###");
		GridObj.SetNumberFormat("NETPR",      	    "###,###");
		GridObj.SetNumberFormat("PAY",    		"###,###.###");		
		GridObj.SetNumberFormat("QTY1",      	"###,###.###");
		GridObj.SetNumberFormat("QTY2",      	"###,###.###");
		GridObj.SetNumberFormat("QTY3",      	"###,###.###");
		GridObj.SetNumberFormat("QTY4",      	"###,###.###");
		GridObj.SetNumberFormat("QTY5",      	"###,###.###");
		GridObj.SetNumberFormat("QTY6",      	"###,###.###");
		GridObj.SetNumberFormat("QTY7",      	"###,###.###");		    
		GridObj.SetNumberFormat("COM_STOCK",	"###,###.###");	
		
}
		
	
/*┌──────────────────────────────────┐
  │해더생성
  └──────────────────────────────────┘*/ 
function setHeader2(GridObj2) {        

	var item_id 	= document.frm.item_id.value;
	var item_name	= document.frm.item_name.value;

		GridObj2.AddHeader("GUBN"			,"단독"   			,"t_text" 		,2			,30  	,false); //0
		GridObj2.AddHeader("SELECTED"		,""   				,"t_checkbox" 	,2			,30  	,true); //0
		GridObj2.AddHeader("CONS_ITEM_ID"	,"자재코드"		    ,"t_text"		,100	    ,60     ,false); //0   
		GridObj2.AddHeader("CONS_ITEM_NAME"	,"자재명"	       		,"t_text"		,100	    ,190    ,false); //0
		GridObj2.AddHeader("MEINS"			,"단위"   			,"t_text"		,100	    ,35     ,false); //0		 	
		GridObj2.AddHeader("REQ_QTY"	    ,"천소요량"	        ,"t_number"    ,100.3		,70     ,false); //0
		GridObj2.AddHeader("TOT"	    	,"재고수량"	        ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("CONV_QTY"	    ,"박스환산"	        ,"t_number"	   ,100.3		,70     ,false); //0		
		GridObj2.AddHeader("PEINH"	    	,"가격\n단위"	        ,"t_number"	   ,100.3		,50     ,false); //0
		GridObj2.AddHeader("NETPR"	    	,"단가"	       	    ,"t_number"	   ,100.3		,55     ,false); //0
		GridObj2.AddHeader("WAERS"	    	,"통화키"		        ,"t_text"	   ,100			,50     ,false); //0
		GridObj2.AddHeader("PAY"			,"금액"				,"t_number"	   ,100.3		,85     ,false); //0				
		GridObj2.AddHeader("QTY1"	    	,"안양"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("QTY2"	    	,"안성"	   		    ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("QTY3"	    	,"안성(음료)"	        ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("QTY4"	    	,"아산"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("QTY5"	    	,"구미"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("QTY6"	    	,"부산"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("QTY7"	    	,"녹산"	       		,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("COM_STOCK"	    ,"계열사\n재고"	   ,"t_number"	   ,100.3		,70     ,false); //0
		GridObj2.AddHeader("PROD_CUST_NAME"	,"공급업체"	       	,"t_text"		,1000	    ,190    ,false); //0		
		
		/* 저장을 위한 히든 값 */
		
		GridObj2.BoundHeader();	
		
		GridObj2.SetColFix('CONS_ITEM_NAME');
		
		GridObj2.SetColCellAlign('GUBN',			  'center');
		GridObj2.SetColCellAlign('CONS_ITEM_ID',		'left');
		GridObj2.SetColCellAlign('CONS_ITEM_NAME',	    'left');
		GridObj2.SetColCellAlign('MEINS',			  'center');
		GridObj2.SetColCellAlign('REQ_QTY',			   'right'); 
		GridObj2.SetColCellAlign('TOT',			       'right');
		GridObj2.SetColCellAlign('CONV_QTY',		   'right');
		GridObj2.SetColCellAlign('WAERS',			  'center');
		GridObj2.SetColCellAlign('PEINH',			   'right');
		GridObj2.SetColCellAlign('NETPR',       	   'right');
		GridObj2.SetColCellAlign('PAY',        		   'right');		
		GridObj2.SetColCellAlign('QTY1',        	   'right');
		GridObj2.SetColCellAlign('QTY2',        	   'right');
		GridObj2.SetColCellAlign('QTY3',        	   'right');
		GridObj2.SetColCellAlign('QTY4',        	   'right');
		GridObj2.SetColCellAlign('QTY5',        	   'right');
		GridObj2.SetColCellAlign('QTY6',        	   'right');
		GridObj2.SetColCellAlign('QTY7',        	   'right');
		GridObj2.SetColCellAlign('PROD_CUST_NAME',	    'left');		
		GridObj2.SetColCellAlign('COM_STOCK',          'right');
		  
		
		GridObj2.SetNumberFormat("REQ_QTY",				"###,###.###");
		GridObj2.SetNumberFormat("TOT",					"###,###.###");
		GridObj2.SetNumberFormat("CONV_QTY",			"###,###.###");		
		GridObj2.SetNumberFormat("PEINH",					"###,###");
		GridObj2.SetNumberFormat("NETPR",					"###,###");
		GridObj2.SetNumberFormat("PAY",				"###,###,###.###");		
		GridObj2.SetNumberFormat("QTY1",			"###,###,###.###");
		GridObj2.SetNumberFormat("QTY2",			"###,###,###.###");
		GridObj2.SetNumberFormat("QTY3",			"###,###,###.###");
		GridObj2.SetNumberFormat("QTY4",			"###,###,###.###");
		GridObj2.SetNumberFormat("QTY5",			"###,###,###.###");
		GridObj2.SetNumberFormat("QTY6",			"###,###,###.###");
		GridObj2.SetNumberFormat("QTY7",			"###,###,###.###");		    
		GridObj2.SetNumberFormat("COM_STOCK",		"###,###,###.###");
}
	

/*┌──────────────────────────────────┐
  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc
  └──────────────────────────────────┘*/
function GridEndQuery() {
	
	var mode		= GridObj.GetParam("mode");
	var error_msg	= '';
	
	
	if(mode == "search") {
		if(GridObj.GetStatus() == "true") {
					
					for(var i=0;i<GridObj.GetRowCount();i++) {
								
								GridObj.SetCellBgColor('GUBN',    			i, '255|253|208');
								GridObj.SetCellBgColor('CONS_ITEM_ID',    	i, '255|253|208');	
								GridObj.SetCellBgColor('CONS_ITEM_NAME',    i, '255|253|208');
								GridObj.SetCellBgColor('MEINS', 			i, '255|253|208');
								GridObj.SetCellBgColor('REQ_QTY', 			i, '255|253|208');
								GridObj.SetCellBgColor('TOT', 				i, '255|253|208');								
								GridObj.SetCellBgColor('CONV_QTY', 			i, '255|253|208');								
								GridObj.SetCellBgColor('PEINH', 			i, '255|253|208');
								GridObj.SetCellBgColor('NETPR', 			i, '255|253|208');
								GridObj.SetCellBgColor('WAERS', 			i, '255|253|208');
								GridObj.SetCellBgColor('PAY', 				i, '255|253|208');								
								GridObj.SetCellBgColor('QTY1', 				i, '255|253|208');
								GridObj.SetCellBgColor('QTY2', 				i, '255|253|208');
								GridObj.SetCellBgColor('QTY3', 				i, '255|253|208');								
								GridObj.SetCellBgColor('QTY4', 				i, '255|253|208');
								GridObj.SetCellBgColor('QTY5', 				i, '255|253|208');
								GridObj.SetCellBgColor('QTY6', 				i, '255|253|208');								
								GridObj.SetCellBgColor('QTY7', 				i, '255|253|208');								
								GridObj.SetCellBgColor('COM_STOCK',    		i, '255|253|208');
								GridObj.SetCellBgColor('PROD_CUST_NAME',    i, '255|253|208');
								
					}

                GridObj.AddSummaryBar('SUMMARY1', '전체합계', 'summaryall', 'sum', 'PAY,QTY1,QTY2,QTY3,QTY4,QTY5,QTY6,QTY7,COM_STOCK');
         	    GridObj.SetSummaryBarColor('SUMMARY1', '0|153|0', color_tot); 
					
		} else { 
					error_msg = GridObj.GetMessage(); 
					alert(error_msg);            
			   }
	
	}
}

function GridEndQuery2() {
	
	var mode		= GridObj2.GetParam("mode");
	var error_msg	= '';
	          
	if(mode == "search2") {
		if(GridObj2.GetStatus() == "true") {

					for(var i=0;i<GridObj2.GetRowCount();i++) {

								GridObj2.SetCellBgColor('GUBN',    			i, '255|253|208');
								GridObj2.SetCellBgColor('CONS_ITEM_ID',    	i, '255|253|208');	
								GridObj2.SetCellBgColor('CONS_ITEM_NAME',   i, '255|253|208');
								GridObj2.SetCellBgColor('MEINS', 			i, '255|253|208');
								GridObj2.SetCellBgColor('REQ_QTY', 			i, '255|253|208');
								GridObj2.SetCellBgColor('TOT', 				i, '255|253|208');
								GridObj2.SetCellBgColor('CONV_QTY', 		i, '255|253|208');									
								GridObj2.SetCellBgColor('PEINH', 			i, '255|253|208');
								GridObj2.SetCellBgColor('NETPR', 			i, '255|253|208');
								GridObj2.SetCellBgColor('WAERS', 			i, '255|253|208');
								GridObj2.SetCellBgColor('PAY', 				i, '255|253|208');
								GridObj2.SetCellBgColor('QTY1', 			i, '255|253|208');
								GridObj2.SetCellBgColor('QTY2', 			i, '255|253|208');
								GridObj2.SetCellBgColor('QTY3', 			i, '255|253|208');	
								GridObj2.SetCellBgColor('QTY4', 			i, '255|253|208');
								GridObj2.SetCellBgColor('QTY5', 			i, '255|253|208');
								GridObj2.SetCellBgColor('QTY6', 			i, '255|253|208');	
								GridObj2.SetCellBgColor('QTY7', 			i, '255|253|208');
								GridObj2.SetCellBgColor('COM_STOCK',    	i, '255|253|208');
								GridObj2.SetCellBgColor('PROD_CUST_NAME',   i, '255|253|208');
								
					}

			                GridObj2.AddSummaryBar('SUMMARY2', '전체합계', 'summaryall', 'sum', 'PAY,QTY1,QTY2,QTY3,QTY4,QTY5,QTY6,QTY7,COM_STOCK');
			         	    GridObj2.SetSummaryBarColor('SUMMARY2', '0|153|0', color_tot); 
 
		} else { 
					error_msg = GridObj2.GetMessage(); 
					alert(error_msg);            
			   }
	}
}


/*┌──────────────────────────────────┐
  │그리드의 원 클릭 이벤트
  └──────────────────────────────────┘*/
               
/*┌──────────────────────────────────┐
  │화면에 '조회'를 누르면 호출 Fnc
  └──────────────────────────────────┘*/
  function GoSearch(service){
    
	GridObj = document.WiseGrid;
	GridObj.ClearGrid();	
	setHeader(GridObj);    
	
	GridObj2.ClearGrid();	
	setHeader(GridObj2)
	
	doQuery();
	
	
    
}
/*┌──────────────────────────────────┐
  │하부 그리드 조회 WD1 더블클릭
  └──────────────────────────────────┘*/
 
   

/*┌──────────────────────────────────┐
  │DW 1 조회 쿼리를 호출 Fnc
  └──────────────────────────────────┘*/
   function doQuery() 
   {
       var item_id	    	= document.all.item_id.value;   
       var item_name	    = document.all.item_name.value;
       var servlet_url      = Project_name+"/servlet/com.wisegrid.admin."+job_id;
       
       //넘겨줄 값들을만든다.( 파라미터 정의 부분 )
		GridObj.SetParam("mode",			 "search");
		GridObj.SetParam("item_id",        item_id);
		GridObj.SetParam("item_name",	item_name);
		
       
	   GridObj.DoQuery(servlet_url);       
   }
   
   function doQuery2(cons_item_id) 
   {
	
       var item_id	    	= document.all.item_id.value;   
       var item_name	    = document.all.item_name.value;
       var servlet_url      = Project_name+"/servlet/com.wisegrid.admin."+job_id;
       
       
       //넘겨줄 값들을만든다.( 파라미터 정의 부분 )
       GridObj2.SetParam("mode",				 "search2");
	   GridObj2.SetParam("item_id",      		   item_id);
	   GridObj2.SetParam("item_name",  			 item_name);
	   GridObj2.SetParam("cons_item_id",      cons_item_id);
	   GridObj2.DoQuery(servlet_url);       
   }

/*┌──────────────────────────────────┐
  │DW 2 조회 쿼리를 호출 Fnc
  └──────────────────────────────────┘*/
	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )

// 셀 저장 전역변수
var objTdG;


// 날짜 검색 POP BTN mouseOver
function overBtn( objBtn ) {
	clickedDateIdx = objBtn.parentNode.parentNode.parentNode.rowIndex;	
}

// 날짜 검색 POP BTN mouseOut
function outBtn( objBtn ) {
	clickedDateIdx = null;	
}

// 제품 입력창에 입력한 값과 일치하는 제품 검사 후, 일치하는 제품이 있으면 제품 코드, 제품 명 표시
function getItemName(objBox) {
	
	if( objBox.value == "" || objBox.value == null ) {
		document.frm.item_name.value = "";
		return;
	}
	commonUtil.getCodeInfo("input_value", objBox.value, "search_item_id_and_item_name_by_item_input", { 
		callback:function(arrList){
			// 일치하는 제품 없음
			if( arrList.length == 1 ) {
				objBox.value = arrList[0][0];
				document.frm.item_name.value = arrList[0][1];
			}
			else if( arrList.length > 1){							
				document.frm.item_name.value = "";
			}
			else {
				return;
			}
		}
	});
	
}

// 제품 검색 popup
// create pop-up : search item
// code_input : code input(search value) input-box name 
// w_size : size of popup window width, h_size : size of popup window height ==> optional parameter 
function openItemSearchPop( code_input, w_size, h_size ) { 

	// popup 창의 input box 표시 data : search code 
	var code_input = document.getElementById(code_input).value; 

	if( !(w_size) ) { 
		var w_size = 400; 
		var h_size = 400; 
	} 
	
	var service_url = "service.do?_moon_service=item_search_popup&code_input=" + code_input; 
	service_url += "&_moon_perpage=200&_moon_pagenumber=1"; 
	
	var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=" + w_size + ", height=" + h_size + ", top=0, left=0"; 
	var newWin = window.open(service_url, "Code_Search", pop_win_style); 
	newWin.focus(); 
	
}


function excelUpload(){
	
	var service_url = "service.do?_moon_service=op_02030_Material_Refreshing_List_excel_reg_pop";  
	var pop_win_style = "titlebar=no, menubar=no, toolbar=no, status=yes, scrollbars=no, resizable=yes, width=895, height=450, top=200, left=200";
	var newWin = window.open(service_url, "", pop_win_style);
	newWin.focus();		
	
}

function GridChangeCell(){ //개체가 없다는 오류 해결 구문(Service.do)
	
}

function GridCellClick(){ //개체가 없다는 오류 해결 구문(Service.do)
	
}


function Dtl_Search(){ //	상세조회
	
	var cons_item_id="";
	var check_cnt = 0;
	
	for(var i=0;i<GridObj.GetRowCount();i++ ) {
		var chk_idx = GridObj.GetCellValue("SELECTED", i);
	
		if(chk_idx=="1"){
			check_cnt ++;
			if(check_cnt == 1){  // 최초로 선택된 로우를 만났을 때
				cons_item_id		= GridObj.GetCellvalue('CONS_ITEM_ID',    	i);
			}
			else {
				cons_item_id	+=	','+GridObj.GetCellvalue('CONS_ITEM_ID',    i);
			}
					
		}else{
			
		}
	}
doQuery2(cons_item_id);					

}

					
// 컬럼 축소 & 확장
function colExtension(obj){
	var GridObj = document.WiseGrid;
	
	if(GridObj.GetColWidth('QTY1')== 40){// true => 숨김 상태
		obj.value = "축소";
		// 숨김 모드 해제
		
		GridObj.SetColWidth("QTY1", 		70);
		GridObj.SetColWidth("QTY2", 		70);		
		GridObj.SetColWidth("QTY3", 		70);
		GridObj.SetColWidth("QTY4", 		70);
		GridObj.SetColWidth("QTY5", 		70);		
		GridObj.SetColWidth("QTY6", 		70);
		GridObj.SetColWidth("QTY7", 		70);
		GridObj.SetColWidth("COM_STOCK",	70);
		
		GridObj.ClearSummaryBar();
		GridObj.ClearGroupMerge();

	}
	else{
		obj.value = "확대";
		//숨김모드
		
		GridObj.SetColWidth("QTY1", 		40);
		GridObj.SetColWidth("QTY2", 		40);		
		GridObj.SetColWidth("QTY3", 		40);
		GridObj.SetColWidth("QTY4", 		40);
		GridObj.SetColWidth("QTY5", 		40);		
		GridObj.SetColWidth("QTY6", 		40);
		GridObj.SetColWidth("QTY7", 		40);
		GridObj.SetColWidth("COM_STOCK",	40);
		
	}

	if(GridObj2.GetColWidth('QTY1')== 40){// true => 숨김 상태
		obj.value = "축소";
		// 숨김 모드 해제
		
		GridObj2.SetColWidth("QTY1",		70);
		GridObj2.SetColWidth("QTY2",		70);		
		GridObj2.SetColWidth("QTY3",		70);
		GridObj2.SetColWidth("QTY4",		70);
		GridObj2.SetColWidth("QTY5",		70);		
		GridObj2.SetColWidth("QTY6",		70);
		GridObj2.SetColWidth("QTY7",		70);
		GridObj2.SetColWidth("COM_STOCK",	70);
		
		GridObj2.ClearSummaryBar();
		GridObj2.ClearGroupMerge();
		
	}
	else{
		obj.value = "확대";
		//숨김모드
		
		GridObj2.SetColWidth("QTY1", 		40);
		GridObj2.SetColWidth("QTY2", 		40);		
		GridObj2.SetColWidth("QTY3", 		40);
		GridObj2.SetColWidth("QTY4", 		40);
		GridObj2.SetColWidth("QTY5", 		40);		
		GridObj2.SetColWidth("QTY6", 		40);
		GridObj2.SetColWidth("QTY7", 		40);
		GridObj2.SetColWidth("COM_STOCK",	40);
	}


}
					
   /* EXCEL ???? */
   function excelDown() {
       var GridObj = document.WiseGrid; 
       GridObj.ExcelExport("", "", true, true);
   }					
					
