//## 프로그램명      : SCM품목추적조회//## 개발자          : 남웅용//## 개발일자        : 2009-07-16//##//## 관련 job file   : job_op_02010_Long_Term_Planning_list.xml//## 관련 query file : query_op_02010_Long_Term_Planning_list.xml//##//## REVISIONS//## VER        DATE        AUTHOR    DESCRIPTION//## ---------  ----------  --------  ------------------------------------//## 1.0        2009-07-16  남웅용      create//##//############################################################/************************************************************************************************************************************//**********************************************  WiseGrid Java Script   *************************************************************//************************************************************************************************************************************///-----------------------------------------             전역 변수            ----------------------------------------------////var mode;														// WiseGrid 통신 시 전송 모드(search, save, ... etc)var class_path = "com.wisegrid.admin.";							// 서블릿 패키지(class 파일 경로)var job_id = 'op_02010_Long_Term_Planning_list_Hawa';var GridObj ; 													// WiseGrid 객체var GridObj2;var GridObj3;//var GridObj4;//var GridObj5;Fvar color_tot = '234|234|234';			//합계 라인 배경색var color_edit_col = '255|253|208';var color_sp = '230|222|230'; 			//컬럼 구분선 배경색var color_select_row = '141|232|141';	//라인 선택 배경색var colBg01 = '224|255|224';			//255|255|153var colBg02 = '255|255|255';/*┌──────────────────────────────────┐  │그리드의 사이즈 조절 Fnc  └──────────────────────────────────┘*/    function setGridAutoResize( tab_h, table_h ){                var maxWidthValue;        var maxHeightValue;                if (document.layers) {            //Nescape            maxWidthValue = window.innerWidth;            maxHeightValue = window.innerHeight;        }        if (document.all) {            //explore            maxWidthValue = document.body.clientWidth;            maxHeightValue = document.body.clientHeight;        }                 var tabHeightValue = Number(maxHeightValue) - Number(tab_h) ;         var tableHeightValue = Number(maxHeightValue) - Number(table_h) ;                 var search_h = document.frm.search_h.value;         if( search_menu.style.display == "none" )         {             tabHeightValue += Number(search_h);             tableHeightValue += Number(search_h);         }                 // 화면 size 축소 시 화면이 너무 작아 그리드 크기가 음수가 되면 에러가 나므로 그 경우 무조건 1로 세팅         // ==> 화면이 더이상 축소되지 않음         if( tabHeightValue < 1 )             tabHeightValue = 1;         if( tableHeightValue < 1 )             tableHeightValue = 1;                 //tabPage1.style.height = tabHeightValue + "px";         //tbMain.style.height = tableHeightValue + "px";         //document.WiseGrid.height = tableHeightValue + "px";         document.WiseGrid2.height = tableHeightValue - document.WiseGrid.height + "px";        //document.WiseGrid3.height = tableHeightValue - document.WiseGrid.height + "px";             }  /*┌─────────────────────────────────────────────────────────────────────┐  │WiseGrid 오브젝트가 생성되고 초기화된 후 발생하는 							│  │JavaScript Event인 Initialize()를 받아 그리드의 헤더를 셋팅한다.			│  └─────────────────────────────────────────────────────────────────────┘*/function init() { 	GridObj = document.WiseGrid;	setProperty(GridObj);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader(GridObj);  	//해더생성 	setDefault();        	//화면 기본 설정 }   function init2() {	GridObj2 = document.WiseGrid2;	setProperty(GridObj2);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader2(GridObj2);  	//해더생성 	setDefault2();        	//화면 기본 설정 }   function init3() {	GridObj3 = document.WiseGrid3;	setProperty(GridObj3);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader3(GridObj3);  	//해더생성 	setDefault3();        	//화면 기본 설정 }function init4() {	GridObj4 = document.WiseGrid4;	setProperty(GridObj4);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader4(GridObj4);  	//해더생성 	setDefault4();        	//화면 기본 설정 }   function init5() {	GridObj5 = document.WiseGrid5;	setProperty(GridObj5);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader5(GridObj5);  	//해더생성 	setDefault5();        	//화면 기본 설정 }function init6() {	GridObj6 = document.WiseGrid6;	setProperty(GridObj6);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader6(GridObj6);  	//해더생성 	setDefault6();        	//화면 기본 설정 }   function init7() {	GridObj7 = document.WiseGrid7;	setProperty(GridObj7);	//WiseGrid Default설정 부분 (WiseGrid_Property.js파일 내에 선언되어 있다.)	setHeader7(GridObj7);  	//해더생성 	setDefault7();        	//화면 기본 설정 }      /*┌──────────────────────────────────┐  │화면 기본 설정 부분.  └──────────────────────────────────┘*/function setDefault() { 	GridObj.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj.nHDLineSize         = 10; //Header Size        //헤더의 라인수를 설정한다.     GridObj.nHDLines = 2;              //선택된 셀의 글자색 지정한다.    GridObj.strSelectedCellFgColor = '180|82|205';    GridObj.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.     GridObj.strHDClickAction    = "sortsingle";       	// Cell Font Setting	GridObj.nCellFontSize = 9;					// Font Size 9	//GridObj.strCellFontName = '맑은 고딕';     }function setDefault2() { 	GridObj2.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj2.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj2.nHDLineSize         = 12; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    //헤더의 라인수를 설정한다.     GridObj2.nHDLines = 2;            //선택된 셀의 글자색 지정한다.    GridObj2.strSelectedCellFgColor = '180|82|205';    GridObj2.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj2.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	// Cell Font Setting	GridObj2.nCellFontSize = 9;					// Font Size 9	//GridObj2.strCellFontName = '맑은 고딕'; }function setDefault3() { 	GridObj3.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,.  	GridObj3.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj3.nHDLineSize         = 20; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    //선택된 셀의 글자색 지정한다.    GridObj3.strSelectedCellFgColor = '180|82|205';    GridObj3.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj3.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj3.nCellFontSize = 9;					// Font Size 9}function setDefault4() {  	GridObj4.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj4.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj4.nHDLineSize         = 12; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";     GridObj4.bStatusbarVisible = false;				// status bar visible 상태바 설정             //선택된 셀의 글자색 지정한다.    GridObj4.strSelectedCellFgColor = '180|82|205';    GridObj4.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj4.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj4.nCellFontSize = 9;					// Font Size 9}function setDefault5() { 	GridObj5.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj5.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj5.nHDLineSize         = 12; //Header Size    GridObj5.bStatusbarVisible = false;				// status bar visible        //GridObj2.strHDClickAction    = "sortsingle";    //선택된 셀의 글자색 지정한다.    GridObj5.strSelectedCellFgColor = '180|82|205';    GridObj5.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj5.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj5.nCellFontSize = 9;					// Font Size 9}function setDefault6() { 	GridObj6.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj6.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj6.nHDLineSize         = 12; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    GridObj6.bStatusbarVisible = false;				// status bar visible    //선택된 셀의 글자색 지정한다.    GridObj6.strSelectedCellFgColor = '180|82|205';    GridObj6.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	//GridObj6.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj6.nCellFontSize = 9;					// Font Size 9}function setDefault7() { 	GridObj7.bRowSelectorVisible = false;        		//로우 셀렉터를 WiseGrid에서 숨긴다,. 	GridObj7.bRowSelectorIndex = true;				//Row Selector 영역에 Row Index를 보여준다.    GridObj7.nHDLineSize         = 12; //Header Size    //GridObj2.strHDClickAction    = "sortsingle";    //선택된 셀의 글자색 지정한다.    GridObj7.strSelectedCellFgColor = '180|82|205';    GridObj7.strHDClickAction = "select";        	//클릭한 컬럼의 셀을 선택가능하게 한다.	GridObj7.strActiveRowBgColor = "170|170|170";    //선택된 행의 배경색상을 설정한다.	GridObj7.nCellFontSize = 9;					// Font Size 9		GridObj7.strHDClickAction    = "sortsingle";}       /*┌──────────────────────────────────┐  │해더생성  └──────────────────────────────────┘*/ function setHeader(GridObj) {        	//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	GridObj.AddHeader("CRUD"			,"CRUD"       	,"t_text" 		,100    ,60  ,false);  	GridObj.AddHeader("SELECTED"		," "       	,"t_checkbox" 		,2		,22  ,true); //0    	GridObj.AddHeader("IF_FLAG"			,"전송\n상태"     ,"t_text" 		,100	,38  ,true); //0   		//GridObj.SetColHide("CRUD", true); 	GridObj.AddHeader("ITEM_ID"			,"품목번호"       ,"t_text" 	,20		,60  ,false); //0    	GridObj.AddHeader("ITEM_NAME"		,"품목명"      	,"t_text" 	,100	,170 ,false); //0     	GridObj.AddHeader("TERM_VAL"		,"유통\n기한"     ,"t_number" ,100.3	,40  ,false); //0    	GridObj.AddHeader("LEAD_TIME"		,"리드\n타임"     ,"t_number" ,100.3	,40  ,false); //0 	GridObj.AddHeader("BASE_UOM"		,"기본\n단위"     ,"t_text" 	,100	,40  ,false); //0    	GridObj.AddHeader("BASE_STOCK"		,"현재고"      	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("PROG_STOCK"		,"진행중\n재고"   ,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("TOT_STOCK"		,"총재고"      	,"t_number" ,100.3	,70  ,false); //0 	GridObj.AddHeader("SEL_DMD"			,"선택\n구분"     ,"t_combo"	,100	,0  ,true); //0	 	GridObj.AddHeader("STD_STOCK"		,"기준\n재고"     ,"t_number" ,100.3	,0  ,true); //0    	GridObj.AddHeader("SAFETY_STOCK"	,"안전\n재고"     ,"t_number" ,100.3	,60  ,true); //0    	GridObj.AddHeader("SAFETY_FACTOR"	,"안전\n계수"     ,"t_number" ,100.3	,0  ,true); //0    	GridObj.AddHeader("AVG_QTY"			,"평균"      	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("STD_DEV"			,"표준\n편차"     ,"t_number" ,100.3	,40  ,false); //0    	GridObj.AddHeader("SALES_MEAN_3MONTH"	,"3개월\n평균" 	,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("LAST_YEAR"		,"전년\n동월"     ,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("USE_CUM_MONTH"	,"당월\n누계"     ,"t_number" ,100.3	,60  ,false); //0    	GridObj.AddHeader("MIN_LOT_SIZE"	,"최소\n발주량"   ,"t_number" ,100.3	,50  ,false); //0    	GridObj.AddHeader("PR_DATE_NO"		,"발주\n시기"		,"t_number" ,100.3	,0  ,true); //0    	GridObj.AddHeader("CONTAINER_BOX"	,"컨테이너\nBOX"	,"t_number" ,100.3	,65  ,true); //0  	GridObj.AddHeader("PR_QTY"			,"PR\n수량"      ,"t_number" ,100.3	,60  ,true); //0    	GridObj.AddHeader("ENTR_DATE"		,"입고일"      	,"t_text" 	,100	,65  ,true); //0  	//    	GridObj.AddHeader("EDIT_FLAG"		,"EDIT_FLAG"    ,"t_text" 	,100	,0  ,true); //0  	GridObj.AddHeader("PR_NO"			,"PR 번호"     	,"t_text" 	,100	,60  ,true); //0    	GridObj.AddHeader("IF_MSGS"			,"IF 메세지"      ,"t_text" 	,100	,220  ,true); //0   	GridObj.BoundHeader();		//GridObj.SetNumberFormat("IPGO"  , "#,##0");    GridObj.SetColCellAlign('ITEM_ID','center');     GridObj.SetColCellAlign('ITEM_NAME','left');     GridObj.SetColCellAlign('BASE_UOM','right');     //GridObj.SetColCellAlign('SEL_DMD','center'); 	GridObj.SetColFix('ITEM_NAME');	GridObj.SetColCellBgColor('SEL_DMD',color_edit_col);//기준재고	GridObj.SetColCellBgColor('STD_STOCK',color_edit_col);//기준재고	GridObj.SetColCellBgColor('SAFETY_STOCK',color_edit_col);//안전재고	GridObj.SetColCellBgColor('SAFETY_FACTOR',color_edit_col);//안전계수 		GridObj.SetColCellBgColor('PR_DATE_NO',color_edit_col);//안전계수 		GridObj.SetColCellBgColor('PR_QTY',color_edit_col);//안전계수 		GridObj.SetColCellBgColor('ENTR_DATE',color_edit_col);//안전계수    GridObj.SetNumberFormat("BASE_STOCK"  , "#,##0");    GridObj.SetNumberFormat("PROG_STOCK"  , "#,##0");    GridObj.SetNumberFormat("TOT_STOCK"  , "#,##0");    GridObj.SetNumberFormat("STD_STOCK"  , "#,##0");    GridObj.SetNumberFormat("SAFETY_STOCK"  , "#,##0");    GridObj.SetNumberFormat("AVG_QTY"  , "#,##0");    GridObj.SetNumberFormat("SALES_MEAN_3MONTH"  , "#,##0");    GridObj.SetNumberFormat("SAFETY_STOCK"  , "#,##0");    GridObj.SetNumberFormat("LAST_YEAR"  , "#,##0");    GridObj.SetNumberFormat("USE_CUM_MONTH"  , "#,##0");    GridObj.SetNumberFormat("PR_QTY"  , "#,##0");            //GridObj.bCellFontBold = true; 		GridObj.SetCRUDMode("CRUD");  // AD와 DE가 셋팅 될 경우는 없다.	//Hidden 컬럼	GridObj.SetColHide("CRUD",true);}/*┌──────────────────────────────────┐  │WiseGrid Change Combo Event  └──────────────────────────────────┘*/function GridChangeComboHandler(strColumnKey, nRow, nOldIndex, nNewIndex){		    var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);    document.all.sel_dmd.value = sel_dmd;    document.all.sel_item_id.value = sel_item_id;        doQuery3();			};function GridChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {			//ENTR_DATE	if( strColumnKey == "ENTR_DATE"){		return;	}	// if 진행중인 데이터는 수정 불가!!	var if_flag	= GridObj.GetCellValue("IF_FLAG", nRow);	if( if_flag == "" || if_flag == null) {	}else{		alert("확정된 항목은 수정하실수 없습니다!");		GridObj.SetCellValue(strColumnKey, nRow,  nOldValue);		return;	}			if( strColumnKey == "SELECTED"){		return;	}	var version		= document.all.version.value;	    //var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);	//alert("sel_dmd="+sel_dmd);	//alert("sel_item_id="+sel_item_id);    //document.all.sel_dmd.value = sel_dmd;    //document.all.sel_item_id.value = sel_item_id;    var std_stock = GridObj.GetCellValue("STD_STOCK", nRow); //기준재고    var tot_stock = GridObj.GetCellValue("TOT_STOCK", nRow); //총재고    	//alert("std_stock="+std_stock);	//alert("tot_stock="+tot_stock);    var sales_mean_3month = GridObj.GetCellValue("SALES_MEAN_3MONTH", nRow); //3개월 평균    var avg_qty = GridObj.GetCellValue("AVG_QTY", nRow); //평균 (12개월)    var last_year = GridObj.GetCellValue("LAST_YEAR", nRow); //전년동월    var lead_time = GridObj.GetCellValue("LEAD_TIME", nRow); //리드타임    var safety_stock = GridObj.GetCellValue("SAFETY_STOCK", nRow); //평균 (12개월)        var pr_date_no = GridObj.GetCellValue("PR_DATE_NO", nRow); //발주시기     	// 1) 안전재고 변경	// 	안전재고 = 리드타임 * 변경된 기준재고 * 1	if(strColumnKey == "SAFETY_STOCK"){			}else{		safety_stock = Math.round(lead_time * std_stock * 1)/1;	}			// 2) 발주시기 변경	//    발주시기 = (총재고-안전재고)/기준재고 -> 소숫점 첫째자리까지	// 3) 입고시기 변경	pr_date_no = Math.round(((tot_stock-safety_stock)/std_stock)*10)/10;		//alert("safety_stock="+safety_stock);	//alert("pr_date_no="+pr_date_no);			pr_date_no_temp = Math.round((pr_date_no*30));		//alert("pr_date_no_temp="+pr_date_no_temp);		var result;		commonUtil.toDate(version,'YYYY-MM-DD','DAY', pr_date_no_temp ,{		callback:function(result){		// result값이 입고시기이다.		 entr_date =  	result;		//alert("entr_date="+entr_date);		GridObj.SetCellValue("ENTR_DATE", nRow,  entr_date);    		}		});						//GridObj.SetCellValue("PR_DATE_NO", nRow,  pr_date_no);    	GridObj.SetCellValue("SAFETY_STOCK", nRow,  safety_stock);    	GridObj.SetCellValue("STD_STOCK", nRow,  std_stock);	//GridEndQuery() // 입고 시기 별 cell 색갈 재설정	}function calPrDateNo(nRow){ // 변경된 정보(기준재고,안전제고)를 반영하여 입고 시기를 조절..	//alert("calPrDateNo 시작");	var version		= document.all.version.value;	    var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);	//alert("sel_dmd="+sel_dmd);	//alert("sel_item_id="+sel_item_id);    document.all.sel_dmd.value = sel_dmd;    document.all.sel_item_id.value = sel_item_id;    var std_stock = GridObj.GetCellValue("STD_STOCK", nRow); //기준재고    var tot_stock = GridObj.GetCellValue("TOT_STOCK", nRow); //총재고    	//alert("std_stock="+std_stock);	//alert("tot_stock="+tot_stock);    var sales_mean_3month = GridObj.GetCellValue("SALES_MEAN_3MONTH", nRow); //3개월 평균    var avg_qty = GridObj.GetCellValue("AVG_QTY", nRow); //평균 (12개월)    var last_year = GridObj.GetCellValue("LAST_YEAR", nRow); //전년동월        var lead_time = GridObj.GetCellValue("LEAD_TIME", nRow); //리드타임    var safety_stock = GridObj.GetCellValue("SAFETY_STOCK", nRow); //평균 (12개월)        var pr_date_no = GridObj.GetCellValue("PR_DATE_NO", nRow); //발주시기             var entr_date = GridObj.GetCellValue("ENTR_DATE", nRow); //발주시기         	// 1) 안전재고 변경	// 	안전재고 = 리드타임 * 변경된 기준재고 * 1	safety_stock = Math.round(lead_time * std_stock * 1)/1;		// 2) 발주시기 변경	//    발주시기 = (총재고-안전재고)/기준재고 -> 소숫점 첫째자리까지	// 3) 입고시기 변경	pr_date_no = Math.round(((tot_stock-safety_stock)/std_stock)*10)/10;		//alert("safety_stock="+safety_stock);	//alert("pr_date_no="+pr_date_no);			pr_date_no_temp = Math.round((pr_date_no*30));		//alert("pr_date_no_temp="+pr_date_no_temp);		var result;		commonUtil.toDate(version,'YYYY-MM-DD','DAY', pr_date_no_temp ,{		callback:function(result){		// result값이 입고시기이다.		 entr_date =  	result;		//alert("entr_date="+entr_date);		GridObj.SetCellValue("ENTR_DATE", nRow,  entr_date);    		}		});						GridObj.SetCellValue("PR_DATE_NO", nRow,  pr_date_no);    	GridObj.SetCellValue("SAFETY_STOCK", nRow,  safety_stock);    	GridObj.SetCellValue("STD_STOCK", nRow,  std_stock);	GridEndQuery() // 입고 시기 별 cell 색갈 재설정}function Grid3ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {			if(nRow == 0){		alert("재고 정보는 수정할수 없습니다");		GridObj3.SetCellValue(strColumnKey, nRow,  nOldValue);	}		cal_dw3(nRow)		//alert("strColumnKey="+strColumnKey);	//alert("nRow="+nRow);}   function setHeader2(GridObj2) {          	GridObj2.AddHeader("ITEM_ID"	,"품목번호"      	,"t_text" 	,10			,0  ,false); //0     	GridObj2.AddHeader("ITEM_NAME"	,"품목명"       	,"t_text" 	,100		,0  ,false); //0     	GridObj2.AddHeader("PR_NO"		,"PR번호"       	,"t_text" 	,100		,70  ,false); //0     	GridObj2.AddHeader("PR_REL"		,"PR릴리즈"      	,"t_text" 	,100		,60  ,false); //0     	GridObj2.AddHeader("PR_QTY"		,"PR수량"       	,"t_number" ,100.3		,60  ,false); //0     	GridObj2.AddHeader("PO_NO"		,"PO번호"      	,"t_text" 	,100		,70  ,false); //0      	GridObj2.AddHeader("PO_SEQ"		,"PO\n순번"   	,"t_text" 	,100		,40  ,false); //0     	GridObj2.AddHeader("PO_DATE"	,"PO일자"       	,"t_text" 	,100		,60  ,false); //0     	GridObj2.AddHeader("PO_QTY"		,"PO수량"       	,"t_number" ,100.3		,57  ,false); //0     	GridObj2.AddHeader("CREDIT"		,"신용장\n개설일" 	,"t_text" 	,100		,60  ,false); //0     	GridObj2.AddHeader("UNSHIP_QTY"	,"미선적량"      	,"t_number" ,100.3		,60  ,false); //0     	GridObj2.AddHeader("SHIP_QTY"	,"선적량"       	,"t_number" ,100.3		,60  ,false); //0     	GridObj2.AddHeader("BL_NO"		,"HOUSE\nBL_NO"  ,"t_text" 	,100		,52  ,false); //0     	GridObj2.AddHeader("PORT"		,"입항일/\n실입항일" ,"t_text" 	,100	,60  ,false); //0     	GridObj2.AddHeader("TONG"		,"통관일"       	,"t_text" 	,100		,60  ,false); //0     	GridObj2.AddHeader("IPGO"		,"입고일"       	,"t_text" 	,100		,60 ,false); //0     	GridObj2.AddHeader("DATE_FLAG"	,"DATE_FLAG"    ,"t_text" 	,100		,0 ,false); //0   	 	    	GridObj2.BoundHeader();		//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	//GridObj.SetColHide("CRUD", true); 		//GridObj.SetColHDCheckBoxVisible('SELECTED',true,true);	//GridObj.SetCRUDMode("CRUD", "AD", "UP", "DE");	//GridObj.SetColHide("CRUD", true); 	//GridObj.SetColHDCheckBoxVisible('SELECTED',true,true);    //GridObj2.SetColCellAlign('DEL_RANK','right');     GridObj2.SetColCellAlign('ITEM_ID','center');     GridObj2.SetColCellAlign('PR_NO','center');     GridObj2.SetColCellAlign('PR_REL','center');     GridObj2.SetColCellAlign('PO_SEQ','center');     GridObj2.SetColCellAlign('PO_DATE','center');     GridObj2.SetColCellAlign('BL_NO','center');     GridObj2.SetColCellAlign('CREDIT','center');     GridObj2.SetColCellAlign('PORT','center');     GridObj2.SetColCellAlign('TONG','center');     GridObj2.SetColCellAlign('IPGO','center');             GridObj2.SetNumberFormat("PR_QTY"  , "#,##0");    GridObj2.SetNumberFormat("PO_QTY"  , "#,##0");    GridObj2.SetNumberFormat("UNSHIP_QTY"  , "#,##0");    GridObj2.SetNumberFormat("SHIP_QTY"  , "#,##0");    //GridObj2.SetColCellAlign('SELECTED','center');     	//GridObj2.SetColFix('PR_NO');}   function setHeader3(GridObj3) {               	var header_length = 0, j;		var item_id = document.all.sel_item_id.value;		commonUtil.getSelQeury( "item_id", item_id, "op_02010_Long_Term_Planning_list_dw3_Hawa_header",{		callback:function(result){		  	GridObj3.AddHeader("ITEM_ID"	,"품목번호"      	,"t_text" 	,10			,0  ,false); //0   		  	GridObj3.AddHeader("ITEM_NAME"	,"품목명"       	,"t_text" 	,100		,0  ,false); //0    		  	GridObj3.AddHeader("SELECTED"	," "       	,"t_checkbox" 	,2		,22  ,true); //0   		  	GridObj3.AddHeader("SEL_GUBN"	,"구분코드"      	,"t_text" 	,100.3		,0  ,false); //0   		  	GridObj3.AddHeader("SEL_NAME"	,"구분"       	,"t_text" 	,100.3		,85,false); //0   			for(var i=0 ; i < 22 ; i++){  //19				if(i < result.length) {					GridObj3.AddHeader(result[i][1]	,result[i][0]       	,"t_number" 	,100.3	,result[i][2]  ,false);    				} 					else {					j = strToNum(i)+strToNum(1);					if(i < 22) { //19						GridObj3.AddHeader(result[i][1]	,result[i][0]     	,"t_number" 	,100.3	,79  ,false);					}					else {						GridObj3.AddHeader(result[i][1]	,result[i][0]       ,"t_number" 	,100.3	,79  ,false);					}				}			}		 			  	GridObj3.AddHeader("TP_FLAG"	,"타임팬스"      	,"t_number" ,100.3		,0  ,false); //0   						GridObj3.BoundHeader(); //AddHeader를 완료한 후 헤더를 그리드에 바인딩한다. 					    GridObj3.SetColCellAlign('SEL_NAME','left'); 			GridObj3.SetColFix('SEL_NAME');			GridObj3.SetColHDBgColor('MON_M00','253|228|229');			GridObj3.SetColCellBgColor('MON_M00','253|228|229');//PLT						GridObj3.SetColCellRadio('SELECTED',true);						GridObj3.SetNumberFormat("MON_P15"  , "#,##0");			GridObj3.SetNumberFormat("MON_P14"  , "#,##0");			GridObj3.SetNumberFormat("MON_P13"  , "#,##0");			GridObj3.SetNumberFormat("MON_P12"  , "#,##0");			GridObj3.SetNumberFormat("MON_P11"  , "#,##0");			GridObj3.SetNumberFormat("MON_P10"  , "#,##0");			GridObj3.SetNumberFormat("MON_P09"  , "#,##0");			GridObj3.SetNumberFormat("MON_P08"  , "#,##0");			GridObj3.SetNumberFormat("MON_P07"  , "#,##0");			GridObj3.SetNumberFormat("MON_P06"  , "#,##0");			GridObj3.SetNumberFormat("MON_P05"  , "#,##0");			GridObj3.SetNumberFormat("MON_P04"  , "#,##0");			GridObj3.SetNumberFormat("MON_P03"  , "#,##0");			GridObj3.SetNumberFormat("MON_P02"  , "#,##0");			GridObj3.SetNumberFormat("MON_P01"  , "#,##0");			GridObj3.SetNumberFormat("MON_M00"  , "#,##0");			GridObj3.SetNumberFormat("MON_M01"  , "#,##0");			GridObj3.SetNumberFormat("MON_M02"  , "#,##0");			GridObj3.SetNumberFormat("MON_M03"  , "#,##0");			GridObj3.SetNumberFormat("MON_M04"  , "#,##0");			GridObj3.SetNumberFormat("MON_M05"  , "#,##0");			GridObj3.SetNumberFormat("MON_M06"  , "#,##0");								}	});   }function setHeader4(GridObj4) {                 	GridObj4.AddHeader("ITEM_ID"	,"품목번호"      	,"t_text" 	,10		,0  ,false); //0     	GridObj4.AddHeader("ITEM_NAME"	,"품목명"       	,"t_text" 	,100		,0  ,false); //0     		var header_length = 0, j;		commonUtil.getSelQeury( "", "", "op_02010_Long_Term_Planning_list_dw4_header",{		callback:function(result){			for(var i=0 ; i < 10 ; i++){				if(i < result.length) {					GridObj4.AddHeader("MM_"+i+"_QTY"	,result[0][i]       	,"t_number" 	,500.10	,90  ,false);    				} 					else {					j = strToNum(i)+strToNum(1);					if(i < 19) {						GridObj4.AddHeader("MM_"+i+"_QTY"	,result[0][i]       	,"t_number" 	,500.10	,90  ,false);					}					else {						GridObj4.AddHeader("MM_"+i+"_QTY"	,result[0][i]       	,"t_number" 	,500.10	,90  ,false);					}				}			}		 				GridObj4.BoundHeader(); //AddHeader를 완료한 후 헤더를 그리드에 바인딩한다. 					    GridObj4.SetColCellAlign('ITEM_ID','center'); 					GridObj4.SetColHDBgColor('MM_3_QTY','253|228|229');						GridObj4.SetNumberFormat("MM_0_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_1_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_2_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_3_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_4_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_5_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_6_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_7_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_8_QTY"  , "#,##0");			GridObj4.SetNumberFormat("MM_9_QTY"  , "#,##0");					}	});  	}function setHeader5(GridObj5) {                 	GridObj5.AddHeader("CUST_TYPE_CODE"	,"거래처유형번호"	,"t_text" 	,10		,0  ,false); //0     	GridObj5.AddHeader("CUST_TYPE"		,"거래처유형"  	,"t_text" 	,100	,82  ,false); //0    	GridObj5.AddHeader("NOW_SEL_BOX"	,"당월실적"    	,"t_number" ,100.3	,72  ,false); //0      	GridObj5.AddHeader("NOW_GOAE_BOX"	,"당월목표"    	,"t_number" ,100.3	,72  ,false); //0    	GridObj5.AddHeader("PRE_SEL_BOX"	,"전월실적"    	,"t_number" ,100.3	,72  ,false); //0    	GridObj5.AddHeader("PRE_GOAE_BOX"	,"전월목표"    	,"t_number" ,100.3	,72  ,false); //0       	GridObj5.BoundHeader();	    GridObj5.SetNumberFormat("NOW_SEL_BOX"  , "#,##0");    GridObj5.SetNumberFormat("NOW_GOAE_BOX"  , "#,##0");    GridObj5.SetNumberFormat("PRE_SEL_BOX"  , "#,##0");    GridObj5.SetNumberFormat("PRE_GOAE_BOX"  , "#,##0");    //GridObj3.SetColCellAlign('BRAND_CODE','center');     //GridObj5.SetColCellAlign('ITEM_ID','center');     //GridObj5.SetColCellAlign('GUBN','center');     //GridObj5.SetColCellAlign('YYYY_MM','center');         } function setHeader6(GridObj6) {                 	GridObj6.AddHeader("ITEM_ID"	,"품목번호"  	,"t_text" 	,10		,0  ,false); //0     	GridObj6.AddHeader("ITEM_NAME"	,"품목명"  	,"t_text" 	,100	,170  ,false); //0    	GridObj6.AddHeader("G_ZONE"		,"G"  		,"t_number" ,100.7	,75  ,false); //0    	GridObj6.AddHeader("Y_ZONE"		,"Y"  		,"t_number" ,100.7	,75  ,false); //0    	GridObj6.AddHeader("R_ZONE"		,"R"      	,"t_number" ,100.7	,75 ,false); //0   	GridObj6.BoundHeader();		//GridObj3.SetNumberFormat("CHGO"  , "#,##0");    //GridObj3.SetColCellAlign('BRAND_CODE','center');     GridObj6.SetColCellAlign('ITEM_ID','center');     //GridObj6.SetColCellAlign('END_DATE','center');     GridObj6.SetNumberFormat("G_ZONE"  , "#,##0");    GridObj6.SetNumberFormat("Y_ZONE"  , "#,##0");    GridObj6.SetNumberFormat("R_ZONE"  , "#,##0");    //GridObj6.SetNumberFormat("PLT_QTY"  , "#,##0");    	//GridObj6.SetColHDBgColor('BOX_QTY','253|228|229');	//GridObj6.SetColHDBgColor('PLT_QTY','253|228|229');}function setHeader7(GridObj7) {                 	//GridObj7.AddHeader("CONS_ITEM_ID"	,"품목번호"  	,"t_text" 	,10		,0  ,false); //0     	//GridObj7.AddHeader("CONS_ITEM_NAME"	,"품목명"  	,"t_text" 	,100	,0  ,false); //0     	GridObj7.AddHeader("MONTH"		,"월"  		,"t_text" 	,10		,34  ,false); //0     	GridObj7.AddHeader("GOAL_YM0"	,"10목표"  	,"t_number"	,100.3	,43  ,false); //0    	GridObj7.AddHeader("SELL_YM0"	,"10실적"	,"t_number" ,100.3	,43 ,false); //0     	GridObj7.AddHeader("GOAL_YM1"	,"09목표"  	,"t_number"	,100.3	,43  ,false); //0    	GridObj7.AddHeader("SELL_YM1"	,"09실적"	,"t_number" ,100.3	,43 ,false); //0     	GridObj7.AddHeader("GOAL_YM2"	,"08목표"  	,"t_number"	,100.3	,43  ,false); //0    	GridObj7.AddHeader("SELL_YM2"	,"08실적"	,"t_number" ,100.3	,43 ,false); //0     	GridObj7.AddHeader("GOAL_YM3"	,"07목표"  	,"t_number"	,100.3	,43  ,false); //0    	GridObj7.AddHeader("SELL_YM4"	,"07실적"	,"t_number" ,100.3	,43 ,false); //0   	GridObj7.BoundHeader();		//GridObj3.SetNumberFormat("CHGO"  , "#,##0");     //GridObj3.SetColCellAlign('BRAND_CODE','center');     //GridObj7.SetColCellAlign('ITEM_ID','center');     //GridObj7.SetNumberFormat("PROD_QTY"  , "#,##0");    //GridObj7.SetNumberFormat("USE_QTY"  , "#,##0");}	// 컬럼 고정function setGrid(){	//GridObj2.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT	GridObj.SetColFix('ITEM_NAME');}function setGrid2(){	GridObj2.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT	//GridObj2.SetGroupMerge('ITEM_ID,ITEM_NAME');		}function setGrid5(){	//GridObj5.SetColCellBgColor('DEL_PLT',color_edit_col);//PLT			//GridObj5.SetGroupMerge('ITEM_NAME');	}function setGrid3(){	//GridObj3.SetColCellBgColor('PLT_QTY',color_edit_col);//PLT			}/*┌──────────────────────────────────┐  │데이터 조회가 정상적으로 완료되면 발생되는 Event에 대한 Fnc  └──────────────────────────────────┘*/function GridEndQuery(){	    var endMode = GridObj.GetParam("mode");    var error_msg = '';              if(endMode == "search") //조회가 완료된 경우    {        if(GridObj.GetStatus() == "true")         {		  GridObj.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'BASE_STOCK,PROG_STOCK,TOT_STOCK,STD_STOCK,SAFETY_STOCK,SALES_MEAN_3MONTH,LAST_YEAR,USE_CUM_MONTH,CONTAINER_BOX,PR_QTY');		  GridObj.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot);         	                    				for(var i=0;i<GridObj.GetRowCount();i++) {			// cell색깔 변경				if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(2) ){  // GREEN					GridObj.SetCellBgColor('PR_DATE_NO', i, '200|255|110');				}else if(GridObj.GetCellValue('PR_DATE_NO',i) > Number(1) && GridObj.GetCellValue('PR_DATE_NO',i) <= Number(2)){  // YELLOW					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|255|0');				}				else if(GridObj.GetCellValue('PR_DATE_NO',i) <= Number(1)){ // RED					GridObj.SetCellBgColor('PR_DATE_NO', i, '255|0|0'); 				}							GridObj.SetCellFontBold('TOT_STOCK', i, 'true'); // font 굵기			GridObj.SetCellFontBold('PR_DATE_NO', i, 'true'); // font 굵기			}						//EDIT_FLAG	        	               			for(var i=0;i<GridObj.GetRowCount();i++) {			// cell색깔 변경				if(GridObj.GetCellValue('EDIT_FLAG',i) == 'Y' ){  // GREEN					GridObj.SetCellBgColor('ITEM_ID', i, '0|191|255');					GridObj.SetCellBgColor('ITEM_NAME', i, '0|191|255');				}else{									}  			}				        	                                        } else            {             error_msg = GridObj.GetMessage();             alert(error_msg);            		}    }else{ // 삭제, 전송 상태일시 메인그리드 제조회       	GoSearch();    }	}function GridEndQuery2() {		var mode = GridObj2.GetParam("mode");	var error_msg = '';	          	if(mode == "search2") {		if(GridObj2.GetStatus() == "true") {		  GridObj2.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'PR_QTY,PO_QTY,UNSHIP_QTY,SHIP_QTY');		  GridObj2.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot); 		}		else { 			error_msg = GridObj2.GetMessage(); 			alert(error_msg);            		}	}		// cell색깔 변경  : 입고예정일이 미래인 항목들 cell색깔 = BLUE!!	for(var i=0;i<GridObj2.GetRowCount();i++) {		if(GridObj2.GetCellValue('DATE_FLAG',i) == Number(1) ){  // GREEN			GridObj2.SetCellBgColor('IPGO', i, '0|191|255'); //0-191-255		}	}	 	}function GridEndQuery3() {		var mode = GridObj3.GetParam("mode");	var error_msg = '';	          	if(mode == "search3") {		if(GridObj3.GetStatus() == "true") { 			document.all.btn_2.value = "축소";			colExtension()								cal_dw3();									                          		}		else { 			error_msg = GridObj3.GetMessage(); 			alert(error_msg);            		}	}	var header_length = 0, j;	/* TP_FLAG 확인후 세팅 */	var item_id = document.all.sel_item_id.value;		commonUtil.getSelQeury( "item_id", item_id, "op_02010_Long_Term_Planning_list_dw3_header",{	callback:function(arrList){		for(var i=0 ; i < 22 ; i++){   // for(var i=0 ; i < 22 ; i++){			if(arrList[i][3] == "true") {				//alert(arrList[i][1]+"="+arrList[i][3])				//GridObj3.SetColCellActivation(arrList[i][1],"edit");				GridObj3.SetColCellBgColor(arrList[i][1],color_edit_col);//PLT							} 				else {				//alert(arrList[i][1]+"="+arrList[i][3])				GridObj3.SetColCellBgColor(arrList[i][1],"255|255|255");//PLT								GridObj3.SetColCellActivation(arrList[i][1],"activatenoedit");			}		}///////////////////////////////////////////////				for(var i=0 ; i < 22 ; i++){   // for(var i=0 ; i < 22 ; i++){			if(arrList[i][4] == "true") {				//alert(arrList[i][1]+"="+arrList[i][3])				GridObj3.SetColCellActivation(arrList[i][1],"edit");				//GridObj3.SetColCellBgColor(arrList[i][1],color_edit_col);//PLT							} 				else {				//alert(arrList[i][1]+"="+arrList[i][3])				GridObj3.SetColCellBgColor(arrList[i][1],"255|255|255");//PLT								GridObj3.SetColCellActivation(arrList[i][1],"activatenoedit");			}		}			}	}	);				}function GridEndQuery4() {		var mode = GridObj4.GetParam("mode");	var error_msg = '';	          	if(mode == "search4") {		if(GridObj4.GetStatus() == "true") {                           		}		else { 			error_msg = GridObj4.GetMessage(); 			alert(error_msg);            		}	}}function GridEndQuery5() {		var mode = GridObj5.GetParam("mode");	var error_msg = '';	          	if(mode == "search5") {		if(GridObj5.GetStatus() == "true") {      		     //GridObj5.SetGroupMerge(	'ITEM_ID,ITEM_NAME');		}		else { 			error_msg = GridObj5.GetMessage(); 			alert(error_msg);            		}	}		//doQuery3();	//doQuery4();	//alert("nRow="+nRow)	setGrid5();}function GridEndQuery6() {		var mode = GridObj6.GetParam("mode");	var error_msg = '';	          	if(mode == "search6") {		if(GridObj6.GetStatus() == "true") {					  		  //GridObj6.SetGroupMerge(	'ITEM_ID,ITEM_NAME,PLANT');		  		  //GridObj6.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'G_ZONE,Y_ZONE,R_ZONE');		  //GridObj6.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot); 		  		}		else { 			error_msg = GridObj6.GetMessage(); 			alert(error_msg);            		}	}	}function GridEndQuery7() {		var mode = GridObj7.GetParam("mode");	var error_msg = '';	          	if(mode == "search7") {		if(GridObj7.GetStatus() == "true") {                           		  //GridObj7.AddSummaryBar('SUMMARY', '합계', 'summaryall', 'sum', 'PROD_QTY,USE_QTY');		  //GridObj7.SetSummaryBarColor('SUMMARY', '255|0|0', color_tot); 		}		else { 			error_msg = GridObj7.GetMessage(); 			alert(error_msg);            		}	}} /*┌──────────────────────────────────┐  │DW 3 전개제고 연산  └──────────────────────────────────┘*/function cal_dw3(nRow) {				        	//alert("nRow11="+nRow)				// 소요량 row / 입고 row  판단	for(var i=0;i<GridObj3.GetRowCount();i++) {		if(GridObj3.GetCellValue('SEL_NAME',i) == "6.사용자" ){  // GREEN			GridObj3.SetCellBgColor('SEL_NAME', i, '0|191|255');			var req_row = i;		}else if(GridObj3.GetCellValue('SEL_NAME',i) == "입고량" ){  // GREEN			GridObj3.SetCellBgColor('SEL_NAME', i, '0|191|255');			var ipgo_row = i;		}else{		 		}	}						var	hd_name;	var start_idx	= 0;	var last_idx	= 6;		var base_stock	= 0;	var req_qty		= 0;	var ipgo_qty	= 0;	var next_stock;		var start_hd_name = 'MON_M00';		hd_name = start_hd_name;	hd_name_1 = start_hd_name.substr(0,6);	hd_name_2 = start_hd_name.substr(6,7);				// 사용자 6	// 입고량 7		base_stock	= Number(GridObj3.GetCellValue(start_hd_name, 0));		req_qty		= Number(GridObj3.GetCellValue(start_hd_name, req_row));		ipgo_qty	= Number(GridObj3.GetCellValue(start_hd_name, ipgo_row));		next_stock	= Math.round(base_stock - req_qty + ipgo_qty);		//alert("base_stock="+base_stock);			//alert("ipgo_qty="+ipgo_qty);			//alert("req_qty="+req_qty);			//alert("next_stock="+next_stock);	 	for (i=0; i < 6 ; i++) {		hd_name_2 = Number(hd_name_2)+Number(1);		hd_name = hd_name_1+hd_name_2;		GridObj3.SetCellValue(hd_name, 0,  next_stock);					//alert("hd_name="+hd_name);			//alert("base_stock="+base_stock);			base_stock	= Number(GridObj3.GetCellValue(hd_name, 0));		req_qty		= Number(GridObj3.GetCellValue(hd_name, req_row));		ipgo_qty	= Number(GridObj3.GetCellValue(hd_name, ipgo_row));		next_stock = Math.round(base_stock - req_qty + ipgo_qty);		 	}}	/*┌──────────────────────────────────┐  │그리드의 원 클릭 이벤트  └──────────────────────────────────┘*/function GridCellClick(strColumnKey, nRow) {}	// 컬럼 축소 & 확장function colExtension(obj){	var GridObj3 = document.WiseGrid3;		//init3();		//alert(GridObj3.GetColWidth('MON_P12'));	//alert("obj.value="+obj.value);	var value = document.all.btn_2.value 	if(value == "확대"){// true => 숨김 상태	//alert(11);		document.all.btn_2.value = "축소";		// 숨김 모드 해제		GridObj3.SetColWidth("MON_P15", 70);		GridObj3.SetColWidth("MON_P14", 70);		GridObj3.SetColWidth("MON_P13", 70);		GridObj3.SetColWidth("MON_P12", 70);		GridObj3.SetColWidth("MON_P11", 70);		GridObj3.SetColWidth("MON_P10", 70);		GridObj3.SetColWidth("MON_P09", 70);		GridObj3.SetColWidth("MON_P08", 70);		GridObj3.SetColWidth("MON_P07", 70);		GridObj3.SetColWidth("MON_P06", 70);		GridObj3.SetColWidth("MON_P05", 70);		GridObj3.SetColWidth("MON_P04", 70);		GridObj3.SetColWidth("MON_P03", 70);	}	else{		//alert(22);		document.all.btn_2.value = "확대";		//숨김모드		GridObj3.SetColWidth("MON_P15", 1);		GridObj3.SetColWidth("MON_P14", 1);		GridObj3.SetColWidth("MON_P13", 1);		GridObj3.SetColWidth("MON_P12", 1);		GridObj3.SetColWidth("MON_P11", 1);		GridObj3.SetColWidth("MON_P10", 1);		GridObj3.SetColWidth("MON_P09", 1);		GridObj3.SetColWidth("MON_P08", 1);		GridObj3.SetColWidth("MON_P07", 1);		GridObj3.SetColWidth("MON_P06", 1);		GridObj3.SetColWidth("MON_P05", 1);		GridObj3.SetColWidth("MON_P04", 1);		GridObj3.SetColWidth("MON_P03", 1);	}}               /*┌──────────────────────────────────┐  │화면에 '조회'를 누르면 호출 Fnc  └──────────────────────────────────┘*/   function GoSearch(service)    {    doQuery();    //init2();    //init3()    //doQuery2();		//doQuery3();	GridObj2.ClearGrid( ); 	setHeader2(GridObj2);		GridObj3.ClearGrid( ); 	setHeader3(GridObj3);		//GridObj4.ClearGrid( ); 	//setHeader4(GridObj4);		GridObj5.ClearGrid( ); 	setHeader5(GridObj5);		GridObj6.ClearGrid( ); 	setHeader6(GridObj6);		GridObj7.ClearGrid( ); 	setHeader7(GridObj7);					//var yyyy_mm = document.all.sysdate.value;	//document.all.from_mm.value = yyyy_mm;	//document.all.to_mm.value = yyyy_mm;		   } /*┌──────────────────────────────────┐  │하부 그리드 조회 WD1 더블클릭  └──────────────────────────────────┘*/function GridCellDblClick(strColumnKey, nRow){     	var yyyy_mm = document.all.sysdate.value;	//document.all.from_mm.value = yyyy_mm;	//document.all.to_mm.value = yyyy_mm;			// DW1 재조회시 DW3 초기화	//setHeader3(GridObj3);    var sel_dmd	= GridObj.GetCellHiddenValue("SEL_DMD", nRow);    var sel_item_id = GridObj.GetCellValue("ITEM_ID", nRow);    document.all.sel_dmd.value = sel_dmd;    document.all.sel_item_id.value = sel_item_id;	doQuery2(nRow);		// doQuery3 은 다이나믹 해더 때문에 DW5 번 종료후 실행	doQuery3(nRow);		//doQuery4(nRow);		doQuery5(nRow);		doQuery6(nRow);		//doQuery7(nRow);		    	}           /*┌──────────────────────────────────┐  │DW 1 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/   function doQuery()    {       var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;       var version		= document.all.version.value;       var item_type	= document.all.item_type.value;       var sales_cat02	= document.all.sales_cat02.value;              //넘겨줄 값들을만든다.( 파라미터 정의 부분 )       GridObj.SetParam("mode", "search");       GridObj.SetParam("version", version);       GridObj.SetParam("sales_cat02", sales_cat02);       GridObj.SetParam("item_type"	, item_type);       GridObj.DoQuery(servlet_url);   }/*┌──────────────────────────────────┐  │DW 2 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery2(nRow) {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);		//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj2.SetParam("mode", "search2");	GridObj2.SetParam("item_id", item_id);	GridObj2.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 3 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery3(nRow) {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= document.all.sel_item_id.value;    var version	= document.all.version.value;    var work_date	= document.all.sysdate.value;	    var sel_dmd	= document.all.sel_dmd.value;    	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj3.SetParam("mode", "search3");	GridObj3.SetParam("item_id", item_id);	GridObj3.SetParam("version", version);	GridObj3.SetParam("work_date", work_date);	GridObj3.SetParam("sel_dmd", sel_dmd);	GridObj3.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 4 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery4(nRow) {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= document.all.sel_item_id.value;	//var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj4.SetParam("mode", "search4");	GridObj4.SetParam("item_id", item_id);	GridObj4.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 5 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery5(nRow) {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);    var work_date	= document.all.work_date.value;	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj5.SetParam("mode", "search5");	GridObj5.SetParam("work_date", work_date);	GridObj5.SetParam("item_id", item_id);	GridObj5.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 6 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery6(nRow) {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= GridObj.GetCellValue("ITEM_ID", nRow);	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj6.SetParam("mode", "search6");	GridObj6.SetParam("item_id", item_id);	GridObj6.DoQuery(servlet_url);}/*┌──────────────────────────────────┐  │DW 7 조회 쿼리를 호출 Fnc  └──────────────────────────────────┘*/function doQuery7(nRow) {	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var item_id	= document.all.sel_item_id.value;    var work_date	= document.all.work_date.value;	//	var from_mm	= document.all.from_mm.value;//	var to_mm	= document.all.to_mm.value;	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj7.SetParam("mode", "search7");	GridObj7.SetParam("item_id", item_id);	GridObj7.SetParam("work_date", work_date);	//GridObj7.SetParam("from_mm", from_mm);	//GridObj7.SetParam("to_mm", to_mm);	GridObj7.DoQuery(servlet_url);}   // 셀 저장 전역변수var objTdG;// setTimeout 에서 호출하여 시간 지연 후 setEditMode() 실행function setEditModeTime() {		setEditMode( objTdG );	}// popup 조회 이미지 mouseOver// popup 을 띄우기 위해 제품 코드 영역을 벗어난 경우 viewMode 변환 방지를 위한 flag 설정function overImg( objImg ) {		popImgIdx = objImg.parentNode.parentNode.parentNode.rowIndex;	}// popup 조회 이미지 mouseOut// popup 을 띄우기 위해 제품 코드 영역을 벗어난 경우 viewMode 변환 방지를 위한 flag 설정function outImg( objImg ) {		popImgIdx = null;	}// 날짜 검색 POP BTN mouseOverfunction overBtn( objBtn ) {	clickedDateIdx = objBtn.parentNode.parentNode.parentNode.rowIndex;	}// 날짜 검색 POP BTN mouseOutfunction outBtn( objBtn ) {		clickedDateIdx = null;	}// 숫자 input box 에 문자 check // parameter : obj - inbox object , type - default value 또는 소수점 check 유뮤 등의 type 정의 // type - BLANK : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 소수점 허용//        ZERO : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 소수점 허용 //        BLANK_INT : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 소수점은 error 처리( only integer ) //        ZERO_INT : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 소수점은 error 처리( only integer ) //        BLANK_INT_UP : 사용자가 잘못된 값을 입력했을 때 default value 를 공백으로 반환, 음수 & 소수점은 error 처리( only plus integer ) //        ZERO_INT_UP : 사용자가 잘못된 값을 입력했을 때 default value 를 0 으로 반환, 음수 & 소수점은 error 처리( only plus integer ) //        ** type parameter 가 없으면 ZERO(default=0, 소숫점 허용) 와 같음 function checkNum(obj, type) {	var i, ch;	var pointCheck = 0;	var defaultVal = "0"; 	var alertMsg = "숫자만 입력하여 주세요.";	var checkType = "POINT"; 		// default value 는 공백 	if( type == "BLANK" || type == "BLANK_INT" || type == "BLANK_INT_UP" ) 		defaultVal = ""; 		// 소수점 허용하지 않음 	if( type == "BLANK_INT" || type == "ZERO_INT" || type == "BLANK_INT_UP" || type == "ZERO_INT_UP" ) 	{ 		if( type == "BLANK_INT_UP" || type == "ZERO_INT_UP" ) 			alertMsg = "자연수만 입력하여 주세요."; 		else 			alertMsg = "정수만 입력하여 주세요."; 		checkType = "INT"; 		pointCheck = 1; 	} 		var checkValue = delComma(obj.value).trim();	if( defaultVal == "0" && ( checkValue == null || checkValue == "" ) )	{		//objSetting(obj, defaultVal, alertMsg);		return false;	}		for (i=0; i < checkValue.length; i++) {				ch = checkValue.charAt(i);				// invalid value 		if(ch==" ")		{ 			//objSetting(obj, defaultVal, alertMsg); 			return false;		}				// valid value		else if ( ( ch >= 0 && ch <= 9 ) ) 		{ }				// point check 		else if ( ch == '.' ) 		{			pointCheck += 1;			// invalid value 			if ( pointCheck > 1 )			{				//objSetting(obj, defaultVal, alertMsg); 				return false;			} 		} 				// valid value : minus sign 		else if ( i == 0 && ch == '-' && type != "BLANK_INT_UP" && type != "ZERO_INT_UP" ) 		{ } 				// invalid value 		else 		{			//objSetting(obj, defaultVal, alertMsg); 			return false;		}	}		obj.value = checkValue; 	return true;	}function DW4_DblClick(strColumnKey, nRow){		yyyy_mm =  GridObj4.getColHDText(strColumnKey);		//alert(yyyy_mm);	//var yyyy_mm = GridObj5.GetCellValue("YYYY_MM", nRow);	if(yyyy_mm == null || yyyy_mm == ""){		return;			} else{		document.all.from_mm.value = yyyy_mm;		document.all.to_mm.value = yyyy_mm;		doQuery7();	}	}function DW5_DblClick(strColumnKey, nRow){		var yyyy_mm = GridObj5.GetCellValue("YYYY_MM", nRow);	if(yyyy_mm == null || yyyy_mm == ""){//alert("널");		return;			} else{//alert("안널");		document.all.from_mm.value = yyyy_mm;		document.all.to_mm.value = yyyy_mm;		doQuery7();	}	}function doChange_mm(obj){		var from_mm = document.all.from_mm.value;	var to_mm = document.all.to_mm.value;		var from_mm_1	= from_mm.substr(0,4);	var from_mm_2	= from_mm.substr(5,6);	var to_mm_1		= to_mm.substr(0,4);	var to_mm_2		= to_mm.substr(5,6);			//Number(hd_name_2)+Number(1);		if(obj.name == 'pre_mm'){ // 이전달		from_mm_2	= Number(from_mm_2) - Number(1);		to_mm_2		= Number(to_mm_2) - Number(1);					// 해가 넘어간다면...			if(from_mm_2 == 0){				from_mm_1 = Number(from_mm_1) - Number(1);				from_mm_2 = 12;			}else{							}			if(to_mm_2 == 0){				to_mm_1 = Number(to_mm_1) - Number(1);				to_mm_2 = 12;			}else{							}				if(from_mm_2 < 10){			from_mm = from_mm_1 +'-0'+ from_mm_2;		}else{			from_mm = from_mm_1 +'-'+  from_mm_2;		}				if(to_mm_2 < 10){			to_mm = to_mm_1 +'-0'+ to_mm_2;		}else{			to_mm = to_mm_1  +'-'+  to_mm_2;		}			}else{ //다음달		from_mm_2	= Number(from_mm_2) + Number(1);		to_mm_2		= Number(to_mm_2) + Number(1);			// 해가 넘어간다면...			if(from_mm_2 == 13){				from_mm_1 = Number(from_mm_1) + Number(1);				from_mm_2 = 1;			}else{							}			if(to_mm_2 == 13){				to_mm_1 = Number(to_mm_1) + Number(1);				to_mm_2 = 1;			}else{							}		if(from_mm_2 < 10){			from_mm = from_mm_1 +'-0'+ from_mm_2;		}else{			from_mm = from_mm_1 +'-'+  from_mm_2;		}				if(to_mm_2 < 10){			to_mm = to_mm_1 +'-0'+ to_mm_2;		}else{			to_mm = to_mm_1  +'-'+  to_mm_2;		}			}		document.all.from_mm.value = from_mm; 	document.all.to_mm.value = to_mm; 		}//--------------------------------------   main_template 에 정의된 Event ---------------------------------------------------///*┌──────────────────────────────────┐  │WiseGrid Cell Change Event  └──────────────────────────────────┘*/function Grid2ChangeCell(strColumnKey, nRow, nOldValue, nNewValue) {		var del_plt = GridObj2.GetCellValue("PLT_QTY", nRow);	if(strColumnKey == "DEL_PLT"){		if(nNewValue > 0){			GridObj2.SetCellValue("SELECTED", nRow, "1");		}else{			GridObj2.SetCellValue("SELECTED", nRow, "0");		}	}	if(strColumnKey == "SELECTED"){		if(nNewValue == "1"){			GridObj2.SetCellValue("DEL_PLT", nRow, del_plt)					}else{			GridObj2.SetCellValue("DEL_PLT", nRow, "0")					}	}}// 저장function GoSave(service) {	var GridObj = document.WiseGrid;	mode = "save";	doSave();	};// 저장function doSave() { 	var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var version		= document.all.version.value;			    	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode", "save");	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("version", version);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "SELECTED");	   return;}function GoDelete(){			if(confirm("선택 하신 품목을 삭제하시겠습니까?") == 1 ) {					}		else{			return;		}			var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var version		= document.all.version.value;    	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode", "delete");	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("version", version);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "SELECTED");	}function GoIf(){		//EDIT_FLAG check	        	               	//for(var i=0;i<GridObj.GetRowCount();i++) {	// cell색깔 변경		//if(GridObj.GetCellValue('SELECTED',i) == 'Y' ){  // GREEN							//alert("SELECTED");						//}else{				//alert("UN_SELECTED");		//}  	//}	//return;	// if 진행중인 데이터는 수정 불가!!	//var if_flag	= GridObj.GetCellValue("IF_FLAG", nRow);	//if( if_flag == "" || if_flag == null) {	//}else{		//alert("확정된 항목은 수정하실수 없습니다!");		//GridObj.SetCellValue(strColumnKey, nRow,  nOldValue);		//return;	//}	/				//if(confirm("선택 하신 품목의 ERP 전송을 확정하시겠습니까?") == 1 ) {					//}		//else{			//return;		//}		var GridObj = document.WiseGrid;	var servlet_url = Project_name+"/servlet/com.wisegrid.admin."+job_id;	var version		= document.all.version.value;    	//넘겨줄 값들을만든다.( 파라미터 정의 부분 )	GridObj.SetParam("mode", "doIf");	GridObj.SetParam("user_id", document.frm._user_id.value);	GridObj.SetParam("version", version);		//WiseGrid이 서버와 통신시에 데이터를 전달하는 메서드입니다. 통신이 성공하면 true를 반환합니다.	GridObj.DoQuery(servlet_url, "SELECTED");	}