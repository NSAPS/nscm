<?xml version="1.0" encoding="EUC-KR"?>
<queries>

<!--
=====================================================================================================
	유통가공 >>분석정보>>유통가공 작업장별 계획 대비 실적  조회
=====================================================================================================
--> 

	<!--유통가공 작업장별 계획 대비 실적  조회-->
	<query id="sc_13050_set_prod_planVsActualResultByPlant_list">
#if("$!{selected_type}" == "2")	<!--중분류 시작-->    
	#if("$!{checked_uom}" =="BOX") <!-- 수량-->
SELECT *
FROM	(
		SELECT	T2.SALES_CAT03,
				F_GET_CODE_NAME('SALES_CAT3',T2.SALES_CAT03),
				T1.GUBN,
		       	SUM(MTS_AN_QTY)		MTS_AN_QTY,		       	
	        	SUM(MTS_PO_QTY)		MTS_PO_QTY,		        
		        SUM(DY_QTY)			DY_QTY,		      
		        SUM(TK_QTY)			TK_QTY,
		        SUM(SAMBO_QTY)		SAMBO_QTY,
		        SUM(TOT)			TOT
		FROM	(    
	            SELECT IL.ITEM_ID,
	                   IL.ITEM_NAME,
	                   IL.SPEC, 
	                   IL.GUBN,
	                   IL.ST,
	                   NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,	                  
	                   NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,	                   
	                   NVL(PL.DY_QTY,0)		DY_QTY,	                   
	                   NVL(PL.TK_QTY,0)		TK_QTY,
	                   NVL(PL.SAMBO_QTY,0)	SAMBO_QTY,
	                   NVL(PL.TOT,0)		TOT
	            FROM   (
	                    SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
	                    FROM    (
	                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                            FROM 	ITEM_MST	IM,
	                                   (
	                                    SELECT  DISTINCT IC.LOC_ID,
	                                    				 IC.ITEM_ID,
	                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                    FROM    ITEM_CAPA IC,
	                                            (
	                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                            FROM    MBOM BM, ITEM_MST IM
	                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                            AND     BM.PLANT_ID = '1300'
	                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                            --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                            ) IM
	                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                    AND		IC.LOC_ID !='8922'
	                                    )IP
		                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
		                    --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                    AND	IM.ITEM_ID	IN (
	                    						SELECT	ITEM_ID
						                        FROM IF_SET_PROD_ORDER
						                        WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
						                        AND		LOC_ID	!= '8922' 
						                        AND		IDU_FLAG = 'I'
						                        UNION	ALL
						            			SELECT	ITEM_ID
						                        FROM V_SET_PROD_PO_MES
						                        WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
						                        AND		LOC_ID	!= '8922'
		                    					)
		                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                             ) IT,
	                        (
	                        SELECT  '계획' AS GUBN, 1 ST
	                        FROM    DUAL
	                        UNION   ALL
	                        SELECT  '실적' AS GUBN, 2 ST
	                        FROM    DUAL
	                        UNION   ALL
	                        SELECT  '차이' AS GUBN, 3 ST
	                        FROM    DUAL
	                        ) GB
	         )IL,
	               (
	                SELECT  IO.ITEM_ID, '계획' GUBN,
	                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	AS 	MTS_AN_QTY,	                        
	                         SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	AS 	MTS_PO_QTY,	                         
	                         SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,	                         
	                         SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,	                         
	                         SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
	                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	                        
	                        +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	                       
	                        +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
		                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                                FROM    MBOM BM, ITEM_MST IM
		                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                                AND     BM.PLANT_ID 	= '1300'
		                                AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                              --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ			= '10'
		                AND		IO.IDU_FLAG 	= 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,		                         
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,		                         
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,		                         
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))		                        
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))		                       
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		                        
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
		                        SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
		                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                                FROM    MBOM BM, ITEM_MST IM
		                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                                AND     BM.PLANT_ID 	= '1300'
		                                AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                               -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID
		                AND		VP.LOC_ID  		=	IP.LOC_ID
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                UNION ALL
		                SELECT  PB.ITEM_ID, '차이'GUBN ,
		                		SUM(MTS_AN_QTY)		MTS_AN_QTY,		                		
		                        SUM(MTS_PO_QTY)		MTS_PO_QTY,		                		
		                        SUM(DY_QTY)			DY_QTY,		                        
		                        SUM(TK_QTY)			TK_QTY,
		                        SUM(SAMBO_QTY)		SAMBO_QTY,
		                        SUM(TOT)			TOT
		                FROM
		                    	(
		                          SELECT  IO.ITEM_ID, '계획' GUBN,
		                                  (-1)*(
			                                  		 SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
			                                  		+SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))
		                                  		)	AS 	MTS_AN_QTY,												                                  		
		                                  (-1)*(
			                                  		 SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
			                                  		+SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))
		                                  		)	AS 	MTS_PO_QTY,										
										(-1)*SUM(DECODE(IO.LOC_ID,				'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,										
										(-1)*SUM(DECODE(IO.LOC_ID,				'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
										(-1)*SUM(DECODE(IO.LOC_ID,				'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                                  (-1)*(
			                                  		SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
					                               +SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))					                           
					                               +SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
					                               +SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))					                              
					                               +SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))					                               
					                               +SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))
					                               +SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))
				                               )	AS	TOT
		                          FROM		IF_SET_PROD_ORDER  IO,
		                    				(
					                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
					                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
					                        FROM    ITEM_CAPA IC,
		                                            (
	                                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                                FROM    MBOM BM, ITEM_MST IM
	                                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                                AND     BM.PLANT_ID 	= '1300'
	                                                AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                               -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                            ) IM
					                        WHERE   IC.ITEM_ID = IM.ITEM_ID
					                        AND		IC.LOC_ID !='8922'
		                    				)IP
		                WHERE	IO.ITEM_ID	=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  	=	IP.LOC_ID(+)
		                AND		IO.SEQ		= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
						UNION	ALL
		                SELECT  VP.ITEM_ID, '실적'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,		                       
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,		                        
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,		                        
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))		                      
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                            (
		                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
		                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                                FROM    ITEM_CAPA IC,
		                                                    (
		                                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                                                    FROM    MBOM BM, ITEM_MST IM
		                                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                                                    AND     BM.PLANT_ID 	= '1300'
		                                                    AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                                                    --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                                    ) IM
		                                WHERE   IC.ITEM_ID = IM.ITEM_ID
		                                AND		IC.LOC_ID !='8922'
		                                )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                    ) PB
		                GROUP BY	PB.ITEM_ID
	                    ) PL
	            WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
	            AND		IL.GUBN		=   PL.GUBN(+)
		)	T1,
	    ITEM_MST T2
		WHERE	T1.ITEM_ID	= T2.ITEM_ID
		GROUP   BY		T2.SALES_CAT03,
				T1.GUBN,
		        T1.ST
		UNION ALL
		SELECT	'',
				'',
				T1.GUBN,
		        SUM(MTS_AN_QTY)		MTS_AN_QTY,		        
		        SUM(MTS_PO_QTY)		MTS_PO_QTY,		        
		        SUM(DY_QTY)			DY_QTY,		        
		        SUM(TK_QTY)			TK_QTY,
		        SUM(SAMBO_QTY)		SAMBO_QTY,
		        SUM(TOT)			TOT
		FROM	(
		            SELECT IL.ITEM_ID,
		                   IL.ITEM_NAME,
		                   IL.SPEC,
		                   IL.GUBN,
		                   IL.ST,
		                   NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,		              
		                   NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,		                   
		                   NVL(PL.DY_QTY,0)		DY_QTY,		                  
		                   NVL(PL.TK_QTY,0)		TK_QTY,
		                   NVL(PL.SAMBO_QTY,0)	SAMBO_QTY,
		                   NVL(PL.TOT,0)		TOT
		            FROM   (
		                    SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
		                    FROM    (
	                                SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                                FROM 	ITEM_MST	IM,
	                                   (
                                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                        FROM    ITEM_CAPA IC,
                                                (
                                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                                FROM    MBOM BM, ITEM_MST IM
                                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                                AND     BM.PLANT_ID = '1300'
                                                AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                                --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                                ) IM
                                        WHERE   IC.ITEM_ID = IM.ITEM_ID
                                        AND		IC.LOC_ID !='8922'
	                                  )IP
		                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
		                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                    AND		IM.ITEM_ID	IN (
	                                                SELECT	ITEM_ID
	                                                FROM IF_SET_PROD_ORDER
	                                                WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                                AND		LOC_ID	!= '8922'
	                                                AND		IDU_FLAG = 'I'
	                                                UNION	ALL
	                                                SELECT	ITEM_ID
	                                                FROM V_SET_PROD_PO_MES
	                                                WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                                AND		LOC_ID	!= '8922'
		                                            )
		                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                        ) IT,
		                        (
	                            SELECT  '계획 합계' AS GUBN, 1 ST
	                            FROM    DUAL
	                            UNION   ALL
	                            SELECT  '실적 합계' AS GUBN, 2 ST
	                            FROM    DUAL
	                            UNION   ALL
	                            SELECT  '차이 합계' AS GUBN, 3 ST
	                            FROM    DUAL
		                        ) GB
		               )IL,
		               (
		                SELECT  IO.ITEM_ID, '계획 합계' GUBN,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	AS 	MTS_AN_QTY,		                       
		                         SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	AS 	MTS_PO_QTY,		                        
		                         SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,		                        
		                         SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))		                    
		                        +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))		                       
		                        +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))		                       
		                        +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
	                                    (
	                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                    FROM    MBOM BM, ITEM_MST IM
	                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                    AND     BM.PLANT_ID 	= '1300'
	                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                    --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                    ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ			= '10'
		                AND		IO.IDU_FLAG 	= 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,		                        
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,		                        
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,		                       
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))		                    
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))		                       
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		                     
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
                            (
                            SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                            FROM    ITEM_CAPA IC,
                                    (
                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                    FROM    MBOM BM, ITEM_MST IM
                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                    AND     BM.PLANT_ID 	= '1300'
                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                    ) IM
                            WHERE   IC.ITEM_ID = IM.ITEM_ID
                            AND		IC.LOC_ID !='8922'
                             )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID
		                AND		VP.LOC_ID  		=	IP.LOC_ID
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                UNION ALL
		                SELECT  PB.ITEM_ID, '차이 합계'GUBN ,
		                		SUM(MTS_AN_QTY)		MTS_AN_QTY,		                		
		                        SUM(MTS_PO_QTY)		MTS_PO_QTY,	                			
		                        SUM(DY_QTY)			DY_QTY,		                      
		                        SUM(TK_QTY)			TK_QTY,
		                        SUM(SAMBO_QTY)		SAMBO_QTY,
		                        SUM(TOT)			TOT
		                FROM
		                    (
	                          SELECT  IO.ITEM_ID, '계획 합계' GUBN,
	                                  (-1)*(
		                                  		 SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
		                                  		+SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))
	                                  		)	AS 	MTS_AN_QTY,										                               		
	                                  (-1)*(
		                                  		 SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
		                                  		+SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))
	                                  		)	AS 	MTS_PO_QTY,										
										(-1)*SUM(DECODE(IO.LOC_ID,			'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,										
										(-1)*SUM(DECODE(IO.LOC_ID,			'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
										(-1)*SUM(DECODE(IO.LOC_ID,			'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
	                                  (-1)*(
		                                  		SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
				                               +SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))				                              
				                               +SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
				                               +SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))				                              
				                               +SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))				                             
				                               +SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))
				                               +SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))
			                               )	AS	TOT
	                          FROM		IF_SET_PROD_ORDER  IO,
					                    (
					                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
					                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
					                        FROM    ITEM_CAPA IC,
			                                        (
			                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
			                                        FROM    MBOM BM, ITEM_MST IM
			                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
			                                        AND     BM.PLANT_ID 	= '1300'
			                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
			                                        --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
			                                        ) IM
					                        WHERE   IC.ITEM_ID = IM.ITEM_ID
					                        AND		IC.LOC_ID !='8922'
					                    )IP
		                WHERE	IO.ITEM_ID	=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  	=	IP.LOC_ID(+)
		                AND		IO.SEQ		= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
						UNION	ALL
		                SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,		                      
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,		                      
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,		                        
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))		                
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		                       
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
								SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
								        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
								FROM    ITEM_CAPA IC,
								        (
								        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
								        FROM    MBOM BM, ITEM_MST IM
								        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
								        AND     BM.PLANT_ID 	= '1300'
								        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
								        --AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
								        ) IM
								WHERE   IC.ITEM_ID = IM.ITEM_ID
								AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                    ) PB
		                GROUP BY	PB.ITEM_ID
		    		) PL
			        WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
		           AND		IL.GUBN		=   PL.GUBN(+)
			)	T1,
		    ITEM_MST T2
		WHERE	T1.ITEM_ID	= T2.ITEM_ID
		GROUP   BY T1.GUBN
		UNION ALL
     <!--달성율(%) 로직 추가-->
	    SELECT	'',
	            '',                
	            '달성율(%)'GUBN,
	            DECODE(SUM(P_MTS_AN_QTY	)	,0	,1,		ROUND((SUM(A_MTS_AN_QTY)	/	SUM(P_MTS_AN_QTY)	)  	,2))*100		MTS_AN_QTY,	           
	            DECODE(SUM(P_MTS_PO_QTY	)	,0	,1,		ROUND((SUM(A_MTS_PO_QTY)	/	SUM(P_MTS_PO_QTY)	)	,2))*100		MTS_PO_QTY,	            
	            DECODE(SUM(P_DY_QTY		)	,0	,1,		ROUND((SUM(A_DY_QTY)		/	SUM(P_DY_QTY)		)	,2))*100		DY_QTY,	            
	            DECODE(SUM(P_TK_QTY		)	,0	,1,		ROUND((SUM(A_TK_QTY)		/	SUM(P_TK_QTY)		)	,2))*100		TK_QTY,
	            DECODE(SUM(P_SAMBO_QTY	)	,0	,1,		ROUND((SUM(A_SAMBO_QTY)		/	SUM(P_SAMBO_QTY)	)	,2))*100		SAMBO_QTY,
	            DECODE(SUM(P_TOT		)	,0	,1,		ROUND((SUM(A_TOT)			/	SUM(P_TOT)			)	,2))*100		TOT
	    FROM	(
	            SELECT  IO.ITEM_ID, ' 계획' GUBN,        
	                     (SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_AN_QTY,	                     
	                     (SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_PO_QTY,
	                      SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	P_DY_QTY,
	                      SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	P_TK_QTY,                                                                
	                      SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_SAMBO_QTY,                                                    
	                      SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))	                    
	                     +SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))	                  
	                     +SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	                     
	                     +SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_TOT,
	                    0		A_MTS_AN_QTY,	                
	                    0		A_MTS_PO_QTY,	                
	                    0		A_DY_QTY,	                 
	                    0		A_TK_QTY,
	                    0		A_SAMBO_QTY,
	                    0		A_TOT
	            FROM IF_SET_PROD_ORDER  IO,
	                 (
	                 SELECT		DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                 FROM		ITEM_CAPA IC,
	                            (
	                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                            FROM    MBOM BM, ITEM_MST IM
	                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                            AND     BM.PLANT_ID 	= '1300'
	                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                            
	                            ) IM
	                 WHERE   IC.ITEM_ID = IM.ITEM_ID
	                 AND		IC.LOC_ID !='8922'
	                 )IP
	            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
	            AND		IO.LOC_ID  		=	IP.LOC_ID(+)
	            AND		IO.SEQ	= '10'
	            AND		IO.IDU_FLAG = 'I'
	            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	            GROUP BY	IO.ITEM_ID
	            UNION ALL
	            SELECT	VP.ITEM_ID, ' 실적'GUBN,
	                    0		P_MTS_AN_QTY,	                  
	                    0		P_MTS_PO_QTY,	                    
	                    0		P_DY_QTY,	                 
	                    0		P_TK_QTY,
	                    0		P_SAMBO_QTY,
	                    0        P_TOT,
	                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_AN_QTY,	                  
	                     SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_PO_QTY,	                   
	                     SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_DY_QTY,	                     
	                     SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TK_QTY,
	                     SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_SAMBO_QTY,
	                    --총계--                        	                        
	                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	                   	
	                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	                   	
	                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
	                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TOT 
	            FROM	V_SET_PROD_PO_MES  VP,
	                    CAL_MST	   		CM,
	                    (
	                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                    FROM    ITEM_CAPA IC,
	                            (
	                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                            FROM    MBOM BM, ITEM_MST IM
	                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                            AND     BM.PLANT_ID 	= '1300'
	                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                            
	                            ) IM
	                    WHERE   IC.ITEM_ID = IM.ITEM_ID
	                    AND		IC.LOC_ID !='8922'
	                 )IP
	            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
	            AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
	            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
	            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	            GROUP BY	VP.ITEM_ID                    
	            )
		<!--달성률 로직 끝-->
	)
	ORDER 
	BY		1,
        CASE GUBN
            WHEN '계획' THEN '1'
            WHEN '실적' THEN '2'
            WHEN '차이' THEN '3'
            WHEN '계획 합계' THEN '4'
            WHEN '실적 합계' THEN '5'
            WHEN '차이 합계' THEN '6'
            ELSE '9'
        END  			
	#else <!-- 작업비-->	
	SELECT *
    FROM	(
            SELECT	T2.SALES_CAT03,
                    F_GET_CODE_NAME('SALES_CAT3',T2.SALES_CAT03),
                    T1.GUBN,
                    SUM(MTS_AN_QTY)		MTS_AN_QTY,                  
                    SUM(MTS_PO_QTY)		MTS_PO_QTY,                    
                    SUM(DY_QTY)			DY_QTY,                   
                    SUM(TK_QTY)			TK_QTY,
                    SUM(SAMBO_QTY)		SAMBO_QTY,
                    SUM(TOT)			TOT       
            FROM	(    
					SELECT IL.ITEM_ID, 
                           IL.ITEM_NAME,
                           IL.SPEC, 
                           IL.GUBN, 
                           IL.ST,
                           NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,                          
                           NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,                          
                           NVL(PL.DY_QTY,0)		DY_QTY,                            
                           NVL(PL.TK_QTY,0)		TK_QTY, 
                           NVL(PL.SAMBO_QTY,0)	SAMBO_QTY, 
                           NVL(PL.TOT,0)		TOT
					FROM	(
                            SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
                            FROM    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
                                    FROM 	ITEM_MST			IM,
                                           (                    
                                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                            FROM    ITEM_CAPA IC, 
                                                    (
                                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                                    FROM    MBOM BM, ITEM_MST IM
                                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                                    AND     BM.PLANT_ID = '1300'
                                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000') 
                                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                
                                                    ) IM
                                            WHERE   IC.ITEM_ID = IM.ITEM_ID     
                                            AND		IC.LOC_ID !='8922'
                                          )IP
                                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                                             
                                    AND		IM.ITEM_ID	IN (
                                                            SELECT	ITEM_ID
                                                            FROM	IF_SET_PROD_ORDER
                                                            WHERE	START_DATE	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
                                                            AND		LOC_ID	!= '8922'
                                                            AND		IDU_FLAG = 'I'
                                                            UNION	ALL
                                                            SELECT	ITEM_ID
                                                            FROM V_SET_PROD_PO_MES
                                                            WHERE	START_DTTM	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                                                            AND		LOC_ID	!= '8922'
                                                            )

                                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC          
                                    ) IT,     
                                    (
                                    SELECT  '계획' AS GUBN, 1 ST
                                    FROM    DUAL
                                    UNION   ALL
                                    SELECT  '실적' AS GUBN, 2 ST
                                    FROM    DUAL            
                                    UNION   ALL
                                    SELECT  '차이' AS GUBN, 3 ST
                                    FROM    DUAL
                                    ) GB    
                           )IL,  
                           (
                            SELECT  IO.ITEM_ID, '계획 ' GUBN,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,								
                                    (SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,                                  
                                    SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,                                   
                                    SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))                                   
                                    +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))                                    	
                                    +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))                                   
                                    +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
                                    +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
									(
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                                                                        
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                  )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                            
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                            
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST  
                            UNION ALL
                            SELECT  VP.ITEM_ID, '실적 'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,                                 
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,                                   
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	                                    
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                    
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))                                    
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))                                  	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))                                   
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
                            FROM V_SET_PROD_PO_MES	VP,
                                 SET_PROD_MST		SM2,
                                 CAL_MST			CM,
								(
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                        
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                            AND		VP.ITEM_ID		=	SM2.ITEM_ID
                            AND		VP.PROD_VER		= 	SM2.PROD_VER
                            AND		VP.PROD_VER		= 	IP.PROD_VER                            
                            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	VP.ITEM_ID, SM2.BOX_COST
                            UNION ALL                            
                            SELECT  PB.ITEM_ID, '차이 'GUBN ,
                                    PB.BOX_COST,
                                    SUM(MTS_AN_QTY)		MTS_AN_QTY,                                
                                    SUM(MTS_PO_QTY)		MTS_PO_QTY,                                   
                                    SUM(DY_QTY)			DY_QTY,                                   
                                    SUM(TK_QTY)			TK_QTY,
                                    SUM(SAMBO_QTY)		SAMBO_QTY,
                                    SUM(TOT)			TOT
                            FROM	
								(   
								SELECT  IO.ITEM_ID, '계획 ' GUBN,
										DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
										(-1)*(SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
											 +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,																		 
										(-1)*(SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
											 +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,									
										(-1)*SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,											
										(-1)*SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
										(-1)*SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                    
										(-1)*(SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
											+SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)) 										
											+SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
											+SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))												
											+SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))												
											+SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
											+SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
									(
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                    
                                                                                        
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                  )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                            
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                            
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST  
                            UNION	ALL                  
							SELECT  VP.ITEM_ID, '실적 'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                            
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))                                    	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
						FROM	V_SET_PROD_PO_MES	VP,
								SET_PROD_MST		SM2,
								CAL_MST				CM,
                                (
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')       
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                 )IP
                        WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                        AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                        AND		VP.ITEM_ID		=	SM2.ITEM_ID
                        AND		VP.PROD_VER		= 	SM2.PROD_VER
                        AND		VP.PROD_VER		= 	IP.PROD_VER                                    
                        AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                        AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                        AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                        GROUP BY	VP.ITEM_ID, SM2.BOX_COST                
                            ) PB
                        GROUP BY	PB.ITEM_ID, PB.BOX_COST            
                        ) PL        
                        WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
                        AND		IL.GUBN		=   PL.GUBN(+)
                )	T1,
                ITEM_MST T2
            WHERE	T1.ITEM_ID	= T2.ITEM_ID        
            GROUP   BY		T2.SALES_CAT03, 
                            T1.GUBN, T1.ST                            
            <!-- 계획량/실적량/차이량 합계 컬럼 추가-->
            UNION ALL          
            SELECT	'',
                    '',
                    T1.GUBN,
                    SUM(MTS_AN_QTY)		MTS_AN_QTY,                  
                    SUM(MTS_PO_QTY)		MTS_PO_QTY,                    
                    SUM(DY_QTY)			DY_QTY,                   
                    SUM(TK_QTY)	  		TK_QTY,
                    SUM(SAMBO_QTY)	  	SAMBO_QTY,
                    SUM(TOT)	  		TOT
            FROM	(    
                        SELECT IL.ITEM_ID, 
                               IL.ITEM_NAME, 
                               IL.SPEC, 
                               IL.GUBN, 
                               IL.ST,
                               NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,                              
                               NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,                                
                               NVL(PL.DY_QTY,0)		DY_QTY,                                
                               NVL(PL.TK_QTY,0)		TK_QTY, 
                               NVL(PL.SAMBO_QTY,0)	SAMBO_QTY, 
                               NVL(PL.TOT,0)		TOT
                        FROM   (
                                SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
                                FROM    (
                                        SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
                                        FROM 	ITEM_MST			IM,
                                               (                    
                                                SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                                FROM    ITEM_CAPA IC, 
                                                        (
                                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                                        FROM    MBOM BM, ITEM_MST IM
                                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                                        AND     BM.PLANT_ID = '1300'
                                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                  
                                                        ) IM
                                                WHERE   IC.ITEM_ID = IM.ITEM_ID     
                                                AND		IC.LOC_ID !='8922'
                                              )IP
                                WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
                              --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')	
                                AND		IM.ITEM_ID	IN (
                                                        SELECT	ITEM_ID
                                                        FROM	IF_SET_PROD_ORDER
                                                        WHERE	START_DATE	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
                                                        AND		LOC_ID	!= '8922'
                                                        AND		IDU_FLAG = 'I'
                                                        UNION	ALL
                                                        SELECT	ITEM_ID
                                                        FROM	V_SET_PROD_PO_MES
                                                        WHERE	START_DTTM	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                                                        AND		LOC_ID	!= '8922'
                                                        )
                                GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC          
                                    ) IT,     
                                    (
                                    SELECT  '계획 합계' AS GUBN, 1 ST
                                    FROM    DUAL
                                    UNION   ALL
                                    SELECT  '실적 합계' AS GUBN, 2 ST
                                    FROM    DUAL            
                                    UNION   ALL
                                    SELECT  '차이 합계' AS GUBN, 3 ST
                                    FROM    DUAL
                                    ) GB    
                           )IL,  
                           (
                            SELECT  IO.ITEM_ID, '계획 합계' GUBN,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,                                   
                                    (SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,                                   
                                    SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	                                    
                                    SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                    
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))                                   
                                    +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))                                   
                                    +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))                                   	
                                    +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
                                    +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
									(
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                  )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                            
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                            
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST
                            UNION ALL
                            SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,                                 
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,                                 
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	                                  
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                    
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))                                   
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))                                   
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))                              	
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
                            FROM V_SET_PROD_PO_MES	VP,
                                 SET_PROD_MST		SM2,
                                 CAL_MST	   		CM,
								(
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                 )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                            AND		VP.ITEM_ID		=	SM2.ITEM_ID
                            AND		VP.PROD_VER		= 	SM2.PROD_VER
                            AND		VP.PROD_VER		= 	IP.PROD_VER                            
                            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	VP.ITEM_ID, SM2.BOX_COST
                            UNION ALL
                            SELECT  PB.ITEM_ID, '차이 합계'GUBN ,
                                    PB.BOX_COST,	--2012-07-24 추가--
                                    SUM(MTS_AN_QTY)		MTS_AN_QTY,                                   
                                    SUM(MTS_PO_QTY)  	MTS_PO_QTY,                                  
                                    SUM(DY_QTY)	  	 	DY_QTY,                                 
                                    SUM(TK_QTY)	  	 	TK_QTY,
                                    SUM(SAMBO_QTY)	  	SAMBO_QTY,
                                    SUM(TOT)		 	TOT
                            FROM	
                                (   
                                 SELECT  IO.ITEM_ID, '계획 합계' GUBN,
                                         DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                        (-1)*(	SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
											 	+SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,																				 	
										(-1)*(	SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
											 	+SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,                                        
                                        (-1)*	SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,                                      
                                        (-1)*	SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                        (-1)*	SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                        (-1)*(	 SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
                                             	+SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))                                            
                                             	+SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
                                             	+SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))                                             	
                                             	+SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))                                             	
                                             	+SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
                                             	+SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER  IO,
                                    SET_PROD_MST		SM2,
                                    (
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                         --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                    )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                                
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER
                                
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST  
                            UNION	ALL                  
                            SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,                                  
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,                                
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                        
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))                               
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))                                   	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))                                   
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
                            FROM V_SET_PROD_PO_MES	VP,
                                 SET_PROD_MST		SM2,
                                 CAL_MST	   		CM,
                                (
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                 )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                            AND		VP.ITEM_ID		=	SM2.ITEM_ID
                            AND		VP.PROD_VER		= 	SM2.PROD_VER
                            AND		VP.PROD_VER		= 	IP.PROD_VER
                            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	VP.ITEM_ID, SM2.BOX_COST 
                                ) PB
                            GROUP BY	PB.ITEM_ID, PB.BOX_COST            
                        ) PL
                        WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
                       AND		IL.GUBN		=   PL.GUBN(+)
                )	T1,
                ITEM_MST T2
            WHERE	T1.ITEM_ID	= T2.ITEM_ID
            GROUP   BY T1.GUBN
            UNION ALL
             <!--달성율(%) 로직 추가-->
            SELECT	'',
                    '',                
                    '달성율(%)'GUBN,
                    DECODE(SUM(P_MTS_AN_QTY	)	,0	,1,		ROUND((SUM(A_MTS_AN_QTY)	/	SUM(P_MTS_AN_QTY)	)  	,2))*100		MTS_AN_QTY,                    
                    DECODE(SUM(P_MTS_PO_QTY	)	,0	,1,		ROUND((SUM(A_MTS_PO_QTY)	/	SUM(P_MTS_PO_QTY)	)	,2))*100		MTS_PO_QTY,                   
                    DECODE(SUM(P_DY_QTY		)	,0	,1,		ROUND((SUM(A_DY_QTY)		/	SUM(P_DY_QTY)		)	,2))*100		DY_QTY,                  
                    DECODE(SUM(P_TK_QTY		)	,0	,1,		ROUND((SUM(A_TK_QTY)		/	SUM(P_TK_QTY)		)	,2))*100		TK_QTY,
                    DECODE(SUM(P_SAMBO_QTY	)	,0	,1,		ROUND((SUM(A_SAMBO_QTY)		/	SUM(P_SAMBO_QTY)	)	,2))*100		SAMBO_QTY,
                    DECODE(SUM(P_TOT		)	,0	,1,		ROUND((SUM(A_TOT)			/	SUM(P_TOT)			)	,2))*100		TOT
            FROM	(
                    SELECT  IO.ITEM_ID, ' 계획' GUBN,        
                             (SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_AN_QTY,
                             (SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_PO_QTY,
                              SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	P_DY_QTY, 
                              SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	P_TK_QTY,                                                                
                              SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_SAMBO_QTY,                                                    
                              SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))                           
                             +SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))                            
                             +SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_TOT,
                            0		A_MTS_AN_QTY,                        
                            0		A_MTS_PO_QTY,                         
                            0		A_DY_QTY,                      
                            0		A_TK_QTY,
                            0		A_SAMBO_QTY,
                            0       A_TOT
                    FROM IF_SET_PROD_ORDER  IO,
                         (
                         SELECT		DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                         FROM		ITEM_CAPA IC,
                                    (
                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                    FROM    MBOM BM, ITEM_MST IM
                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                    AND     BM.PLANT_ID 	= '1300'
                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                    ) IM
                         WHERE   IC.ITEM_ID = IM.ITEM_ID
                         AND		IC.LOC_ID !='8922'
                         )IP
                    WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                    AND		IO.LOC_ID  		=	IP.LOC_ID(+)
                    AND		IO.SEQ	= '10'
                    AND		IO.IDU_FLAG = 'I'
                    AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                    GROUP BY	IO.ITEM_ID
                    UNION ALL
                    SELECT	VP.ITEM_ID, ' 실적'GUBN,
                            0		P_MTS_AN_QTY,                           
                            0		P_MTS_PO_QTY,                           
                            0		P_DY_QTY,                           
                            0		P_TK_QTY,
                            0		P_SAMBO_QTY,
                            0        P_TOT,
                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_AN_QTY,                             
                             SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_PO_QTY,                
                             SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_DY_QTY,                           
                             SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TK_QTY,
                             SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_SAMBO_QTY,
                            --총계--                        	                        
                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                         
                            +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                           	
                            +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                           
                            +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                            +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TOT 
                    FROM	V_SET_PROD_PO_MES  VP,
                            CAL_MST	   		CM,
                            (
                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                            FROM    ITEM_CAPA IC,
                                    (
                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                    FROM    MBOM BM, ITEM_MST IM
                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                    AND     BM.PLANT_ID 	= '1300'
                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                    ) IM
                            WHERE   IC.ITEM_ID = IM.ITEM_ID
                            AND		IC.LOC_ID !='8922'
                         )IP
                    WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                    AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
                    AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                    AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                    GROUP BY	VP.ITEM_ID                    
                    )
            )  
            ORDER	BY		1,
                      CASE GUBN
                            WHEN '계획' THEN '1'
                            WHEN '실적' THEN '2'
                            WHEN '차이' THEN '3'
                            WHEN '계획 합계' THEN '4'
                            WHEN '실적 합계' THEN '5'
                            WHEN '차이 합계' THEN '6'
                            ELSE '9'
                        END     
	#end
#elseif("$!{selected_type}" == "3")
    #if("$!{checked_uom}" =="BOX") <!-- 대분류 수량-->
SELECT *
FROM	(
		SELECT	T2.SALES_CAT01,
				F_GET_CODE_NAME('SALES_CAT1',T2.SALES_CAT01),
				T1.GUBN,
		       	SUM(MTS_AN_QTY)  	MTS_AN_QTY,		    
	        	SUM(MTS_PO_QTY)  	MTS_PO_QTY,		  
		        SUM(DY_QTY)	  		DY_QTY,		        
		        SUM(TK_QTY)	  		TK_QTY,
		        SUM(SAMBO_QTY)	  	SAMBO_QTY,
		        SUM(TOT)	  		TOT
		FROM	(    
	            SELECT IL.ITEM_ID,
	                   IL.ITEM_NAME,
	                   IL.SPEC, 
	                   IL.GUBN,
	                   IL.ST,
	                   NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,	                   
	                   NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,	                
	                   NVL(PL.DY_QTY,0)		DY_QTY,	                 
	                   NVL(PL.TK_QTY,0)		TK_QTY,
	                   NVL(PL.SAMBO_QTY,0)	SAMBO_QTY,
	                   NVL(PL.TOT,0)		TOT
	            FROM   (
	                    SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
	                    FROM    (
	                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                            FROM 	ITEM_MST	IM,
	                                   (
	                                    SELECT  DISTINCT IC.LOC_ID,
	                                    				 IC.ITEM_ID,
	                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                    FROM    ITEM_CAPA IC,
	                                            (
	                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                            FROM    MBOM BM, ITEM_MST IM
	                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                            AND     BM.PLANT_ID = '1300'
	                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                            ) IM
	                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                    AND		IC.LOC_ID !='8922'
	                                    )IP
		                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
		                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                    AND	IM.ITEM_ID	IN (
	                    						SELECT	ITEM_ID
						                        FROM IF_SET_PROD_ORDER
						                        WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
						                        AND		LOC_ID	!= '8922' 
						                        AND		IDU_FLAG = 'I'
						                        UNION	ALL
						            			SELECT	ITEM_ID
						                        FROM V_SET_PROD_PO_MES
						                        WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
						                        AND		LOC_ID	!= '8922'
		                    					)
		                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                             ) IT,
	                        (
	                        SELECT  '계획' AS GUBN, 1 ST
	                        FROM    DUAL
	                        UNION   ALL
	                        SELECT  '실적' AS GUBN, 2 ST
	                        FROM    DUAL
	                        UNION   ALL
	                        SELECT  '차이' AS GUBN, 3 ST
	                        FROM    DUAL
	                        ) GB
	         )IL,
	               (
	                SELECT  IO.ITEM_ID, '계획' GUBN,
	                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	AS 	MTS_AN_QTY,
	                       
	                         SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	AS 	MTS_PO_QTY,
	                       
	                         SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
	           
	                         SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
	                         SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
	                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
	                        
	                        +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
	                        
	                        +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
	                       
	                        +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
	                        +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
		                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                                FROM    MBOM BM, ITEM_MST IM
		                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                                AND     BM.PLANT_ID 	= '1300'
		                                AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                              --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ			= '10'
		                AND		IO.IDU_FLAG 	= 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,		                        
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,		                       
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,		                       
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))		                  
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))		                    
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
		                        SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
		                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                                FROM    MBOM BM, ITEM_MST IM
		                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                                AND     BM.PLANT_ID 	= '1300'
		                                AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                             --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID
		                AND		VP.LOC_ID  		=	IP.LOC_ID
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                UNION ALL
		                SELECT  PB.ITEM_ID, '차이'GUBN ,
		                		SUM(MTS_AN_QTY)  	MTS_AN_QTY,		                		
		                        SUM(MTS_PO_QTY)  	MTS_PO_QTY,		                	
		                        SUM(DY_QTY)	  	 	DY_QTY,		                      
		                        SUM(TK_QTY)	  	 	TK_QTY,
		                        SUM(SAMBO_QTY)	  	SAMBO_QTY,
		                        SUM(TOT)		 	TOT
		                FROM
		                    	(
		                          SELECT  IO.ITEM_ID, '계획' GUBN,
		                                  (-1)*(
			                                  		 SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
			                                  		+SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))
		                                  		)	AS 	MTS_AN_QTY,
		                                  (-1)*(
			                                  		 SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
			                                  		+SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))
		                                  		)	AS 	MTS_PO_QTY,
		                                
		                                  (-1)*SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
		                                  
		                                  (-1)*SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                                  (-1)*SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                                  (-1)*(
			                                  		SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
					                               +SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))					                              
					                               +SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
					                               +SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))					                             
					                               +SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))					                              
					                               +SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))
					                               +SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))
				                               )	AS	TOT
		                          FROM		IF_SET_PROD_ORDER  IO,
		                    				(
					                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
					                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
					                        FROM    ITEM_CAPA IC,
		                                            (
	                                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                                FROM    MBOM BM, ITEM_MST IM
	                                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                                AND     BM.PLANT_ID 	= '1300'
	                                                AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                              --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                            ) IM
					                        WHERE   IC.ITEM_ID = IM.ITEM_ID
					                        AND		IC.LOC_ID !='8922'
		                    				)IP
		                WHERE	IO.ITEM_ID	=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  	=	IP.LOC_ID(+)
		                AND		IO.SEQ		= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
						UNION	ALL
		                SELECT  VP.ITEM_ID, '실적'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                   
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                   
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                     
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                     
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))
		                    
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                            (
		                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
		                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                                FROM    ITEM_CAPA IC,
		                                                    (
		                                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                                                    FROM    MBOM BM, ITEM_MST IM
		                                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                                                    AND     BM.PLANT_ID 	= '1300'
		                                                    AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                                    ) IM
		                                WHERE   IC.ITEM_ID = IM.ITEM_ID
		                                AND		IC.LOC_ID !='8922'
		                                )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                    ) PB
		                GROUP BY	PB.ITEM_ID
	                    ) PL
	            WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
	            AND		IL.GUBN		=   PL.GUBN(+)
		)	T1,
	    ITEM_MST T2
		WHERE	T1.ITEM_ID	= T2.ITEM_ID
		GROUP   BY		T2.SALES_CAT01,
				T1.GUBN,
		        T1.ST
		UNION ALL
		SELECT	'',
				'',
				T1.GUBN,
		        SUM(MTS_AN_QTY)  	MTS_AN_QTY,		      
		        SUM(MTS_PO_QTY)  	MTS_PO_QTY,		       
		        SUM(DY_QTY)	  	 	DY_QTY,		      
		        SUM(TK_QTY)	  	 	TK_QTY,
		        SUM(SAMBO_QTY)	  	SAMBO_QTY,
		        SUM(TOT)	  	 	TOT
		FROM	(
		            SELECT IL.ITEM_ID,
		                   IL.ITEM_NAME,
		                   IL.SPEC,
		                   IL.GUBN,
		                   IL.ST,
		                   NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,		                  
		                   NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,		         
		                   NVL(PL.DY_QTY,0)		DY_QTY,		                 
		                   NVL(PL.TK_QTY,0)		TK_QTY,
		                   NVL(PL.SAMBO_QTY,0)	SAMBO_QTY,
		                   NVL(PL.TOT,0)		TOT
		            FROM   (
		                    SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
		                    FROM    (
	                                SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                                FROM 	ITEM_MST	IM,
	                                   (
                                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                        FROM    ITEM_CAPA IC,
                                                (
                                                SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                                FROM    MBOM BM, ITEM_MST IM
                                                WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                                AND     BM.PLANT_ID = '1300'
                                                AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                             --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                                ) IM
                                        WHERE   IC.ITEM_ID = IM.ITEM_ID
                                        AND		IC.LOC_ID !='8922'
	                                  )IP
		                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
		                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                    AND		IM.ITEM_ID	IN (
	                                                SELECT	ITEM_ID
	                                                FROM IF_SET_PROD_ORDER
	                                                WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                                AND		LOC_ID	!= '8922'
	                                                AND		IDU_FLAG = 'I'
	                                                UNION	ALL
	                                                SELECT	ITEM_ID
	                                                FROM V_SET_PROD_PO_MES
	                                                WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                                AND		LOC_ID	!= '8922'
		                                            )
		                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                        ) IT,
		                        (
	                            SELECT  '계획 합계' AS GUBN, 1 ST
	                            FROM    DUAL
	                            UNION   ALL
	                            SELECT  '실적 합계' AS GUBN, 2 ST
	                            FROM    DUAL
	                            UNION   ALL
	                            SELECT  '차이 합계' AS GUBN, 3 ST
	                            FROM    DUAL
		                        ) GB
		               )IL,
		               (
		                SELECT  IO.ITEM_ID, '계획 합계' GUBN,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	AS 	MTS_AN_QTY,
		                 
		                         SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	AS 	MTS_PO_QTY,
		                        
		                         SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
		                
		                         SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
		                     
		                        +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
		                      
		                        +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
		                      
		                        +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
	                                    (
	                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                    FROM    MBOM BM, ITEM_MST IM
	                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                    AND     BM.PLANT_ID 	= '1300'
	                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                    ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ			= '10'
		                AND		IO.IDU_FLAG 	= 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                    
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                   
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                       
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
                            (
                            SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                            FROM    ITEM_CAPA IC,
                                    (
                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                    FROM    MBOM BM, ITEM_MST IM
                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                    AND     BM.PLANT_ID 	= '1300'
                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                    ) IM
                            WHERE   IC.ITEM_ID = IM.ITEM_ID
                            AND		IC.LOC_ID !='8922'
                             )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID
		                AND		VP.LOC_ID  		=	IP.LOC_ID
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                UNION ALL
		                SELECT  PB.ITEM_ID, '차이 합계'GUBN ,
		                		SUM(MTS_AN_QTY)  	MTS_AN_QTY,		                	
		                        SUM(MTS_PO_QTY)  	MTS_PO_QTY,		                		
		                        SUM(DY_QTY)	  	 	DY_QTY,		                      
		                        SUM(TK_QTY)	  	 	TK_QTY,
		                        SUM(SAMBO_QTY)	  	SAMBO_QTY,
		                        SUM(TOT)		 	TOT
		                FROM
		                    (
	                          SELECT  IO.ITEM_ID, '계획 합계' GUBN,
	                                  (-1)*(
		                                  		 SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
		                                  		+SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))
	                                  		)	AS 	MTS_AN_QTY,
	                                  	
	                                  (-1)*(
		                                  		 SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
		                                  		+SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))
	                                  		)	AS 	MTS_PO_QTY,
	                              
	                                  (-1)*SUM(DECODE(IO.LOC_ID,			'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
	                               
	                                  (-1)*SUM(DECODE(IO.LOC_ID,			'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
	                                  (-1)*SUM(DECODE(IO.LOC_ID,			'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
	                                  (-1)*(
		                                  		SUM(DECODE(IO.LOC_ID,		'7100'		,NVL(IO.QTY,0)	,0))
				                               +SUM(DECODE(IO.LOC_ID,		'7101'		,NVL(IO.QTY,0)	,0))
				                              
				                               +SUM(DECODE(IO.LOC_ID,		'7500'		,NVL(IO.QTY,0)	,0))
				                               +SUM(DECODE(IO.LOC_ID,		'7501'		,NVL(IO.QTY,0)	,0))
				                              
				                               +SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))
				                              
				                               +SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))
				                               +SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))
			                               )	AS	TOT
	                          FROM		IF_SET_PROD_ORDER  IO,
					                    (
					                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
					                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
					                        FROM    ITEM_CAPA IC,
			                                        (
			                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
			                                        FROM    MBOM BM, ITEM_MST IM
			                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
			                                        AND     BM.PLANT_ID 	= '1300'
			                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
			                                     --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
			                                        ) IM
					                        WHERE   IC.ITEM_ID = IM.ITEM_ID
					                        AND		IC.LOC_ID !='8922'
					                    )IP
		                WHERE	IO.ITEM_ID	=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  	=	IP.LOC_ID(+)
		                AND		IO.SEQ		= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
						UNION	ALL
		                SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                      
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                       
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                     
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                       
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))
		                       
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
								SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID,
								        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
								FROM    ITEM_CAPA IC,
								        (
								        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
								        FROM    MBOM BM, ITEM_MST IM
								        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
								        AND     BM.PLANT_ID 	= '1300'
								        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
								     --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
								        ) IM
								WHERE   IC.ITEM_ID = IM.ITEM_ID
								AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                    ) PB
		                GROUP BY	PB.ITEM_ID
		    		) PL
			        WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
		           AND		IL.GUBN		=   PL.GUBN(+)
			)	T1,
		    ITEM_MST T2
		WHERE	T1.ITEM_ID	= T2.ITEM_ID
		GROUP   BY T1.GUBN
		UNION ALL
     <!--달성율(%) 로직 추가-->
	    SELECT	'',
	            '',                
	            '달성율(%)'GUBN,
	            DECODE(SUM(P_MTS_AN_QTY	)	,0	,1,		ROUND((SUM(A_MTS_AN_QTY)	/	SUM(P_MTS_AN_QTY)	)  	,2))*100		MTS_AN_QTY,
	            DECODE(SUM(P_MTS_PO_QTY	)	,0	,1,		ROUND((SUM(A_MTS_PO_QTY)	/	SUM(P_MTS_PO_QTY)	)	,2))*100		MTS_PO_QTY,
	            
	            DECODE(SUM(P_DY_QTY		)	,0	,1,		ROUND((SUM(A_DY_QTY)		/	SUM(P_DY_QTY)		)	,2))*100		DY_QTY,
	           
	            DECODE(SUM(P_TK_QTY		)	,0	,1,		ROUND((SUM(A_TK_QTY)		/	SUM(P_TK_QTY)		)	,2))*100		TK_QTY,
	            DECODE(SUM(P_SAMBO_QTY	)	,0	,1,		ROUND((SUM(A_SAMBO_QTY)		/	SUM(P_SAMBO_QTY)	)	,2))*100		SAMBO_QTY,
	            DECODE(SUM(P_TOT		)	,0	,1,		ROUND((SUM(A_TOT)			/	SUM(P_TOT)			)	,2))*100		TOT
	    FROM	(
	            SELECT  IO.ITEM_ID, ' 계획' GUBN,        
	                     (SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_AN_QTY,
	                     
	                     (SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_PO_QTY,                            	                                
	                                                                                   
	                      SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	P_DY_QTY,                                                                
	                                                                                    
	                      SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	P_TK_QTY,                                                                
	                      SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_SAMBO_QTY,                                                    
	                      SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
	                     
	                     +SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
	                     
	                     +SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))
	                     
	                     +SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
	                     +SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_TOT,
	                    0		A_MTS_AN_QTY,
	                  
	                    0		A_MTS_PO_QTY,
	                  
	                    0		A_DY_QTY,
	                   
	                    0		A_TK_QTY,
	                    0		A_SAMBO_QTY,
	                    0        A_TOT
	            FROM IF_SET_PROD_ORDER  IO,
	                 (
	                 SELECT		DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                 FROM		ITEM_CAPA IC,
	                            (
	                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                            FROM    MBOM BM, ITEM_MST IM
	                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                            AND     BM.PLANT_ID 	= '1300'
	                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                            
	                            ) IM
	                 WHERE   IC.ITEM_ID = IM.ITEM_ID
	                 AND		IC.LOC_ID !='8922'
	                 )IP
	            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
	            AND		IO.LOC_ID  		=	IP.LOC_ID(+)
	            AND		IO.SEQ	= '10'
	            AND		IO.IDU_FLAG = 'I'
	            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	            GROUP BY	IO.ITEM_ID
	            UNION ALL
	            SELECT	VP.ITEM_ID, ' 실적'GUBN,
	                    0		P_MTS_AN_QTY,
	                   
	                    0		P_MTS_PO_QTY,
	                   
	                    0		P_DY_QTY,
	                    
	                    0		P_TK_QTY,
	                    0		P_SAMBO_QTY,
	                    0        P_TOT,
	                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_AN_QTY,
	                    
	                     SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_PO_QTY,
	                    
	                     SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_DY_QTY,
	                     
	                     SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TK_QTY,
	                     SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_SAMBO_QTY,
	                    --총계--                        	                        
	                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
	                   
	                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
	                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
	                  	
	                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
	                   
	                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
	                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TOT 
	            FROM	V_SET_PROD_PO_MES	VP,
	                    CAL_MST				CM,
	                    (
	                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                    FROM    ITEM_CAPA IC,
	                            (
	                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                            FROM    MBOM BM, ITEM_MST IM
	                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                            AND     BM.PLANT_ID 	= '1300'
	                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                         --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                            
	                            ) IM
	                    WHERE   IC.ITEM_ID = IM.ITEM_ID
	                    AND		IC.LOC_ID !='8922'
	                 )IP
	            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
	            AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
	            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
	            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	            GROUP BY	VP.ITEM_ID                    
	            )
		<!--달성률 로직 끝-->
	)
	ORDER 
	BY		1,
        CASE GUBN
            WHEN '계획' THEN '1'
            WHEN '실적' THEN '2'
            WHEN '차이' THEN '3'
            WHEN '계획 합계' THEN '4'
            WHEN '실적 합계' THEN '5'
            WHEN '차이 합계' THEN '6'
            ELSE '9'
        END  			
	#else <!-- 작업비-->
	SELECT *
    FROM	(
            SELECT	T2.SALES_CAT01,
                    F_GET_CODE_NAME('SALES_CAT1',T2.SALES_CAT01),
                    T1.GUBN,
                    SUM(MTS_AN_QTY)  	MTS_AN_QTY,                 
                    SUM(MTS_PO_QTY)  	MTS_PO_QTY,                   
                    SUM(DY_QTY)	  		DY_QTY,                   
                    SUM(TK_QTY)	  		TK_QTY,
                    SUM(SAMBO_QTY)	  	SAMBO_QTY,
                    SUM(TOT)	  		TOT       
            FROM	(    
					SELECT IL.ITEM_ID, 
                           IL.ITEM_NAME,
                           IL.SPEC, 
                           IL.GUBN, 
                           IL.ST,
                           NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,
                           
                           NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,
                          
                           NVL(PL.DY_QTY,0)		DY_QTY, 
                           
                           NVL(PL.TK_QTY,0)		TK_QTY, 
                           NVL(PL.SAMBO_QTY,0)		SAMBO_QTY, 
                           NVL(PL.TOT,0)		TOT
					FROM	(
                            SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
                            FROM    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
                                    FROM 	ITEM_MST			IM,
                                           (                    
                                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                            FROM    ITEM_CAPA IC, 
                                                    (
                                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                                    FROM    MBOM BM, ITEM_MST IM
                                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                                    AND     BM.PLANT_ID = '1300'
                                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000') 
                                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                
                                                    ) IM
                                            WHERE   IC.ITEM_ID = IM.ITEM_ID     
                                            AND		IC.LOC_ID !='8922'
                                          )IP
                                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                                             
                                    AND		IM.ITEM_ID	IN (
                                                            SELECT	ITEM_ID
                                                            FROM	IF_SET_PROD_ORDER
                                                            WHERE	START_DATE	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
                                                            AND		LOC_ID	!= '8922'
                                                            AND		IDU_FLAG = 'I'
                                                            UNION	ALL
                                                            SELECT	ITEM_ID
                                                            FROM	V_SET_PROD_PO_MES
                                                            WHERE	START_DTTM	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                                                            AND		LOC_ID	!= '8922'
                                                            )

                                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC          
                                    ) IT,     
                                    (
                                    SELECT  '계획' AS GUBN, 1 ST
                                    FROM    DUAL
                                    UNION   ALL
                                    SELECT  '실적' AS GUBN, 2 ST
                                    FROM    DUAL            
                                    UNION   ALL
                                    SELECT  '차이' AS GUBN, 3 ST
                                    FROM    DUAL
                                    ) GB    
                           )IL,  
                           (
                            SELECT  IO.ITEM_ID, '계획 ' GUBN,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
                                    
                                    (SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                                    
                                    SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                                   
                                    SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                    
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)) 
                                  
                                    +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	
                                   	
                                    +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))		
                                  
                                    +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
                                    +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
									(
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                                                                        
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                  )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                            
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                            
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST  
                            UNION ALL
                            SELECT  VP.ITEM_ID, '실적 'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
                              
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                             
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                              
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                    
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                                
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                                 	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                                	
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
                            FROM V_SET_PROD_PO_MES	VP,
                                 SET_PROD_MST		SM2,
                                 CAL_MST			CM,
								(
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                        
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                            AND		VP.ITEM_ID		=	SM2.ITEM_ID
                            AND		VP.PROD_VER		= 	SM2.PROD_VER
                            AND		VP.PROD_VER		= 	IP.PROD_VER                            
                            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	VP.ITEM_ID, SM2.BOX_COST
                            UNION ALL                            
                            SELECT  PB.ITEM_ID, '차이 'GUBN ,
                                    PB.BOX_COST,
                                    SUM(MTS_AN_QTY)  	MTS_AN_QTY,
                                 
                                    SUM(MTS_PO_QTY)  	MTS_PO_QTY,
                             
                                    SUM(DY_QTY)	  	 	DY_QTY,
                                  
                                    SUM(TK_QTY)	  	 	TK_QTY,
                                    SUM(SAMBO_QTY)	  	 	SAMBO_QTY,
                                    SUM(TOT)		 	TOT
                            FROM	
								(   
								SELECT  IO.ITEM_ID, '계획 ' GUBN,
										DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
										(-1)*(SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
											 +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
										
										(-1)*(SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
											 +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
										
										(-1)*SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
									
										(-1)*SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
										(-1)*SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                    
										(-1)*(SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
											+SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)) 
											
											+SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
											+SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	
											
											+SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))		
											
											+SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
											+SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
									(
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                    
                                                                                        
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                  )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                            
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                            
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST  
                            UNION	ALL                  
							SELECT  VP.ITEM_ID, '실적 'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
                                  
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                               
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                                 
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,                                            
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                                  
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                                   	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                                   
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
						FROM	V_SET_PROD_PO_MES	VP,
								SET_PROD_MST		SM2,
								CAL_MST				CM,
                                (
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')       
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                 )IP
                        WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                        AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                        AND		VP.ITEM_ID		=	SM2.ITEM_ID
                        AND		VP.PROD_VER		= 	SM2.PROD_VER
                        AND		VP.PROD_VER		= 	IP.PROD_VER                                    
                        AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                        AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                        AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                        GROUP BY	VP.ITEM_ID, SM2.BOX_COST                
                            ) PB
                        GROUP BY	PB.ITEM_ID, PB.BOX_COST            
                        ) PL        
                        WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
                        AND		IL.GUBN		=   PL.GUBN(+)
                )	T1,
                ITEM_MST T2
            WHERE	T1.ITEM_ID	= T2.ITEM_ID        
            GROUP   BY		T2.SALES_CAT01, 
                            T1.GUBN, T1.ST                            
            <!-- 계획량/실적량/차이량 합계 컬럼 추가-->
            UNION ALL          
            SELECT	'',
                    '',
                    T1.GUBN,
                    SUM(MTS_AN_QTY)  	MTS_AN_QTY,
                   
                    SUM(MTS_PO_QTY)  	MTS_PO_QTY,
            
                    SUM(DY_QTY)	  	 	DY_QTY,
               
                    SUM(TK_QTY)	  		TK_QTY,
                    SUM(SAMBO_QTY)	  		SAMBO_QTY,
                    SUM(TOT)	  		TOT
            FROM	(    
                        SELECT IL.ITEM_ID, 
                               IL.ITEM_NAME, 
                               IL.SPEC, 
                               IL.GUBN, 
                               IL.ST,
                               NVL(PL.MTS_AN_QTY,0)	MTS_AN_QTY,
                              
                               NVL(PL.MTS_PO_QTY,0)	MTS_PO_QTY,
                              
                               NVL(PL.DY_QTY,0)		DY_QTY, 
                            
                               NVL(PL.TK_QTY,0)		TK_QTY, 
                               NVL(PL.SAMBO_QTY,0)	SAMBO_QTY, 
                               NVL(PL.TOT,0)		TOT
                        FROM   (
                                SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN, ST
                                FROM    (
                                        SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
                                        FROM 	ITEM_MST			IM,
                                               (                    
                                                SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                                FROM    ITEM_CAPA IC, 
                                                        (
                                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                                        FROM    MBOM BM, ITEM_MST IM
                                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                                        AND     BM.PLANT_ID = '1300'
                                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                  
                                                        ) IM
                                                WHERE   IC.ITEM_ID = IM.ITEM_ID     
                                                AND		IC.LOC_ID !='8922'
                                              )IP
                                WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
                              --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')	
                                AND		IM.ITEM_ID	IN (
                                                        SELECT	ITEM_ID
                                                        FROM	IF_SET_PROD_ORDER
                                                        WHERE	START_DATE	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
                                                        AND		LOC_ID	!= '8922'
                                                        AND		IDU_FLAG = 'I'
                                                        UNION	ALL
                                                        SELECT	ITEM_ID
                                                        FROM	V_SET_PROD_PO_MES
                                                        WHERE	START_DTTM	BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                                                        AND		LOC_ID	!= '8922'
                                                        )
                                GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC          
                                    ) IT,     
                                    (
                                    SELECT  '계획 합계' AS GUBN, 1 ST
                                    FROM    DUAL
                                    UNION   ALL
                                    SELECT  '실적 합계' AS GUBN, 2 ST
                                    FROM    DUAL            
                                    UNION   ALL
                                    SELECT  '차이 합계' AS GUBN, 3 ST
                                    FROM    DUAL
                                    ) GB    
                           )IL,  
                           (
                            SELECT  IO.ITEM_ID, '계획 합계' GUBN,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
                       
                                    (SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))+
                                    SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                                
                                    SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                                 
                                    SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                    
                                    (SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
                                  
                                    +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
                                    +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	
                                   	
                                    +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))		
                                    
                                    +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
                                    +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
									(
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                  )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                            
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                            
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST
                            UNION ALL
                            SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
                              
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                                 
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                              
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                    
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                                  
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                               	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                                  
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
                            FROM V_SET_PROD_PO_MES	VP,
                                 SET_PROD_MST		SM2,
                                 CAL_MST	   		CM,
								(
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                 )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                            AND		VP.ITEM_ID		=	SM2.ITEM_ID
                            AND		VP.PROD_VER		= 	SM2.PROD_VER
                            AND		VP.PROD_VER		= 	IP.PROD_VER                            
                            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	VP.ITEM_ID, SM2.BOX_COST
                            UNION ALL
                            SELECT  PB.ITEM_ID, '차이 합계'GUBN ,
                                    PB.BOX_COST,	--2012-07-24 추가--
                                    SUM(MTS_AN_QTY)  	MTS_AN_QTY,
                                   
                                    SUM(MTS_PO_QTY)  	MTS_PO_QTY,
                                   
                                    SUM(DY_QTY)	  	 	DY_QTY,
                                
                                    SUM(TK_QTY)	  	 	TK_QTY,
                                    SUM(SAMBO_QTY)	  	SAMBO_QTY,
                                    SUM(TOT)		 	TOT
                            FROM	
                                (   
                                 SELECT  IO.ITEM_ID, '계획 합계' GUBN,
                                         DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                        (-1)*(	SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
											 	+SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
								
										(-1)*(	SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
											 	+SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                                  
                                        (-1)*	SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                                     
                                        (-1)*	SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                        (-1)*	SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                        (-1)*(	 SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
                                             	+SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0)) 
                                         
                                             	+SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
                                             	+SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	
                                         	
                                             	+SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))		
                                             	
                                             	+SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	 
                                             	+SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT  
                            FROM	IF_SET_PROD_ORDER	IO,
                                    SET_PROD_MST		SM2,
                                    (
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                    )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)                                
                            AND		IO.ITEM_ID		=	SM2.ITEM_ID
                            AND		IO.PROD_VER		= 	SM2.PROD_VER                                
                            AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		IO.SEQ			= '10'
                            AND		IO.IDU_FLAG 	= 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	IO.ITEM_ID, SM2.BOX_COST  
                            UNION	ALL                  
                            SELECT  VP.ITEM_ID, '실적 합계'GUBN ,
                                    DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
                              
                                    (SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
                                
                                    SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
                           
                                    SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
                                    SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
                                        
                                    (SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                               
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                                  
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                                  
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0)))* NVL(SM2.BOX_COST,0)	AS	TOT 
                            FROM V_SET_PROD_PO_MES	VP,
                                 SET_PROD_MST		SM2,
                                 CAL_MST	   		CM,
                                (
                                SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                FROM    ITEM_CAPA IC,
                                        (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                        ) IM
                                WHERE   IC.ITEM_ID = IM.ITEM_ID
                                AND		IC.LOC_ID !='8922'
                                 )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+)                       
                            AND		VP.ITEM_ID		=	SM2.ITEM_ID
                            AND		VP.PROD_VER		= 	SM2.PROD_VER
                            AND		VP.PROD_VER		= 	IP.PROD_VER
                            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                            GROUP BY	VP.ITEM_ID, SM2.BOX_COST 
                                ) PB
                            GROUP BY	PB.ITEM_ID, PB.BOX_COST            
                        ) PL
                        WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
                       AND		IL.GUBN		=   PL.GUBN(+)
                )	T1,
                ITEM_MST T2
            WHERE	T1.ITEM_ID	= T2.ITEM_ID
            GROUP   BY T1.GUBN
            UNION ALL
             <!--달성율(%) 로직 추가-->
            SELECT	'',
                    '',                
                    '달성율(%)'GUBN,
                    DECODE(SUM(P_MTS_AN_QTY	)	,0	,1,		ROUND((SUM(A_MTS_AN_QTY)	/	SUM(P_MTS_AN_QTY)	)  	,2))*100		MTS_AN_QTY,
                 
                    DECODE(SUM(P_MTS_PO_QTY	)	,0	,1,		ROUND((SUM(A_MTS_PO_QTY)	/	SUM(P_MTS_PO_QTY)	)	,2))*100		MTS_PO_QTY,
                 
                    DECODE(SUM(P_DY_QTY		)	,0	,1,		ROUND((SUM(A_DY_QTY)		/	SUM(P_DY_QTY)		)	,2))*100		DY_QTY,
                  
                    DECODE(SUM(P_TK_QTY		)	,0	,1,		ROUND((SUM(A_TK_QTY)		/	SUM(P_TK_QTY)		)	,2))*100		TK_QTY,
                    DECODE(SUM(P_SAMBO_QTY	)	,0	,1,		ROUND((SUM(A_SAMBO_QTY)		/	SUM(P_SAMBO_QTY)	)	,2))*100		SAMBO_QTY,
                    DECODE(SUM(P_TOT		)	,0	,1,		ROUND((SUM(A_TOT)			/	SUM(P_TOT)			)	,2))*100		TOT
            FROM	(
                    SELECT  IO.ITEM_ID, ' 계획' GUBN,        
                             (SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_AN_QTY,    
                      
                             (SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_PO_QTY,                            	                                
                                                                                      
                              SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	P_DY_QTY,                                                                
                                                                                       
                              SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	P_TK_QTY,                                                                
                              SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_SAMBO_QTY,                                                    
                              SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
                            
                             +SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
                            
                             +SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))
                            
                             +SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
                             +SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_TOT,
                            0		A_MTS_AN_QTY,
                           
                            0		A_MTS_PO_QTY,
                    
                            0		A_DY_QTY,
                          
                            0		A_TK_QTY,
                            0		A_SAMBO_QTY,
                            0        A_TOT
                    FROM IF_SET_PROD_ORDER  IO,
                         (
                         SELECT		DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                         FROM		ITEM_CAPA IC,
                                    (
                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                    FROM    MBOM BM, ITEM_MST IM
                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                    AND     BM.PLANT_ID 	= '1300'
                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                    ) IM
                         WHERE   IC.ITEM_ID = IM.ITEM_ID
                         AND	 IC.LOC_ID !='8922'
                         )IP
                    WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                    AND		IO.LOC_ID  		=	IP.LOC_ID(+)
                    AND		IO.SEQ	= '10'
                    AND		IO.IDU_FLAG = 'I'
                    AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                    GROUP BY	IO.ITEM_ID
                    UNION ALL
                    SELECT	VP.ITEM_ID, ' 실적'GUBN,
                            0		P_MTS_AN_QTY,
                         
                            0		P_MTS_PO_QTY,
                           
                            0		P_DY_QTY,
                  
                            0		P_TK_QTY,
                            0		P_SAMBO_QTY,
                            0        P_TOT,
                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_AN_QTY,
                          
                             SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_PO_QTY,
                          
                             SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_DY_QTY,
                         
                             SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TK_QTY,
                             SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_SAMBO_QTY,
                            --총계--                        	                        
                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                         
                            +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                       	
                            +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                          	
                            +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                            +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TOT 
                    FROM	V_SET_PROD_PO_MES	VP,
                            CAL_MST				CM,
                            (
                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                            FROM    ITEM_CAPA IC,
                                    (
                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                    FROM    MBOM BM, ITEM_MST IM
                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                    AND     BM.PLANT_ID 	= '1300'
                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
                                    ) IM
                            WHERE   IC.ITEM_ID = IM.ITEM_ID
                            AND		IC.LOC_ID !='8922'
                         )IP
                    WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                    AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
                    AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                    AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
                    GROUP BY	VP.ITEM_ID                    
                    )
            )  
            ORDER	BY		1,
                      CASE GUBN
                            WHEN '계획' THEN '1'
                            WHEN '실적' THEN '2'
                            WHEN '차이' THEN '3'
                            WHEN '계획 합계' THEN '4'
                            WHEN '실적 합계' THEN '5'
                            WHEN '차이 합계' THEN '6'
                            ELSE '9'
                        END        
	#end
#else<!--제품별 -->
    	#if("$!{checked_uom}" =="BOX") <!-- 수량-->
SELECT *
FROM	(	    
	    SELECT IL.ITEM_ID,
	           IL.ITEM_NAME,
	           IL.SPEC,
	           IL.GUBN,
	           SUM(NVL(PL.MTS_AN_QTY,0))	MTS_AN_QTY,
	       
	           SUM(NVL(PL.MTS_PO_QTY,0))	MTS_PO_QTY,
	     
	           SUM(NVL(PL.DY_QTY,0))		DY_QTY,
	        
	           SUM(NVL(PL.TK_QTY,0))		TK_QTY,
	           SUM(NVL(PL.SAMBO_QTY,0))		SAMBO_QTY,
	           SUM(NVL(PL.TOT,0))			TOT
	    FROM   (
	            SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN
	            FROM    (
	                        SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                        FROM 	ITEM_MST			IM,
		                           (
	                                SELECT  DISTINCT IC.lOC_ID,
	                                				 IC.ITEM_ID,
	                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                FROM    ITEM_CAPA IC,
	                                        (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID = '1300'
                                            AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                        ) IM
	                                WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                AND		IC.LOC_ID !='8922'
		                          )IP
	            WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
	          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	            AND IM.ITEM_ID	   IN (
				            			SELECT	ITEM_ID
				                        FROM IF_SET_PROD_ORDER
				                        WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'    
				                        AND		LOC_ID	!= '8922' 
				                        AND		IDU_FLAG = 'I'
				                        UNION	ALL
				            			SELECT	ITEM_ID
				                        FROM V_SET_PROD_PO_MES
				                        WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
				                        AND		LOC_ID	!= '8922' 
	            					   )
	            GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                ) IT,
	                (
	                    SELECT  '계획' AS GUBN
	                    FROM    DUAL
	                    UNION   ALL
	                    SELECT  '실적' AS GUBN
	                    FROM    DUAL
	                    UNION   ALL
	                    SELECT  '차이' AS GUBN
	                    FROM    DUAL
	                ) GB
	       )IL,
	       (
	        SELECT  IO.ITEM_ID, '계획' GUBN,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	AS 	MTS_AN_QTY,
		                        
		                         SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	AS 	MTS_PO_QTY,
		                        
		                         SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
		       
		                         SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
		                       
		                        +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
		                       
		                        +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
		                       
		                        +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                     )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ	= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적'GUBN,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                      
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                    
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                       
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                       
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                   
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))
		                     
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
	                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                            FROM    ITEM_CAPA IC,
	                                    (
	                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                    FROM    MBOM BM, ITEM_MST IM
	                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                    AND     BM.PLANT_ID 	= '1300'
	                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                    ) IM
	                            WHERE   IC.ITEM_ID = IM.ITEM_ID
	                            AND		IC.LOC_ID !='8922'
		                     )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                UNION ALL
		                SELECT PB.ITEM_ID, '차이'GUBN,
		                        SUM(MTS_AN_QTY) MTS_AN_QTY,
		                     
		                        SUM(MTS_PO_QTY) MTS_PO_QTY,
		       
		                        SUM(DY_QTY) 	DY_QTY,
		                       
		                        SUM(TK_QTY) 	TK_QTY,
		                        SUM(SAMBO_QTY) 	SAMBO_QTY,
		                        SUM(TOT) 		TOT
		                FROM
		                    (
		                    	SELECT  IO.ITEM_ID, '계획' GUBN,
		                                (-1)*(
			                                	  SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
			                                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
		                                      )	AS 	MTS_AN_QTY,
		                             
		                                (-1)*(
			                                	  SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
			                                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
		                                      )	AS 	MTS_PO_QTY,
		                      
		                                (-1)*SUM(DECODE(IO.LOC_ID,				'1811'			,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
		                               
		                                (-1)*SUM(DECODE(IO.LOC_ID,				'1841'			,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                                (-1)*SUM(DECODE(IO.LOC_ID,				'1813'			,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                                (-1)*(
		                                		 SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
		                                     	+SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
		                                     
		                                		+SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
		                                     	+SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
		                                	
		                                     	+SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))
		                                     
		                                     	+SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
		                                     	+SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))
		                                     )	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ	= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적'GUBN,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                        
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                       
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                     
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
		                     
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
		                    	
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
		                       	
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT 
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
	                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                            FROM    ITEM_CAPA IC,
	                                    (
	                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                    FROM    MBOM BM, ITEM_MST IM
	                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                    AND     BM.PLANT_ID 	= '1300'
	                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                    ) IM
	                            WHERE   IC.ITEM_ID = IM.ITEM_ID
	                            AND		IC.LOC_ID !='8922'
		                     )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                       )PB
		                GROUP BY	PB.ITEM_ID
	            ) PL
	    WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
	    AND		IL.GUBN		=   PL.GUBN(+)
	    GROUP BY	IL.ITEM_ID, IL.ITEM_NAME, IL.SPEC, IL.GUBN
	    UNION ALL
		SELECT	'',
		        '',
		        '',
				T1.GUBN ,
				SUM(NVL(T1.MTS_AN_QTY,0))	MTS_AN_QTY,
				
		        SUM(NVL(T1.MTS_PO_QTY,0))	MTS_PO_QTY,
		    
		        SUM(NVL(T1.DY_QTY,0))		DY_QTY,
		      
		        SUM(NVL(T1.TK_QTY,0))		TK_QTY,
		        SUM(NVL(T1.SAMBO_QTY,0))	SAMBO_QTY,
		        SUM(NVL(T1.TOT,0))			TOT
		FROM
				(
		         SELECT    IL.ITEM_ID,
		                   IL.ITEM_NAME,
		                   IL.SPEC,
		                   IL.GUBN,
		                   SUM(NVL(PL.MTS_AN_QTY,0))	MTS_AN_QTY,
		                 
		                   SUM(NVL(PL.MTS_PO_QTY,0))	MTS_PO_QTY,
		          
		                   SUM(NVL(PL.DY_QTY,0))		DY_QTY,
		                  
		                   SUM(NVL(PL.TK_QTY,0))		TK_QTY,
		                   SUM(NVL(PL.SAMBO_QTY,0))		SAMBO_QTY,
		                   SUM(NVL(PL.TOT,0))			TOT
		            FROM   (
		                    SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN
		                    FROM    (
		                                SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                                FROM 	ITEM_MST			IM,
		                                   		(
		                                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                                        FROM    ITEM_CAPA IC,
		                                                (
	                                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                                    FROM    MBOM BM, ITEM_MST IM
	                                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                                    AND     BM.PLANT_ID = '1300'
	                                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                                ) IM
		                                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                                        AND		LOC_ID	!= '8922'
		                                  		)IP
		                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
		                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                    AND		IM.ITEM_ID	IN (
	                                                SELECT	ITEM_ID
	                                                FROM IF_SET_PROD_ORDER
	                                                WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                                AND		LOC_ID	!= '8922'
	                                                AND		IDU_FLAG = 'I'
	                                                UNION	ALL
	                                                SELECT	ITEM_ID
	                                                FROM V_SET_PROD_PO_MES
	                                                WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                                AND		LOC_ID	!= '8922'                                        
		                                            )
		                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                        ) IT,
		                        (
		                            SELECT  '계획 합계' AS GUBN
		                            FROM    DUAL
		                            UNION   ALL
		                            SELECT  '실적 합계' AS GUBN
		                            FROM    DUAL
		                            UNION   ALL
		                            SELECT  '차이 합계' AS GUBN
		                            FROM    DUAL
		                        ) GB
		               )IL,
		               (
		                SELECT  IO.ITEM_ID, '계획 합계' GUBN,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))	AS 	MTS_AN_QTY,
		                     
		                         SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))	AS 	MTS_PO_QTY,
		                   
		                        SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
		          
		                        SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                        SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
		                    
		                        +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
		                  
		                        +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
		                
		                        +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
		                        +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                     --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ	= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적 합계'GUBN,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                        
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                      
		                         SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                       
		                         SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))
		                      
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
	                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                            FROM    ITEM_CAPA IC,
	                                    (
	                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                    FROM    MBOM BM, ITEM_MST IM
	                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                    AND     BM.PLANT_ID 	= '1300'
	                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                    ) IM
	                            WHERE   IC.ITEM_ID = IM.ITEM_ID
	                            AND		IC.LOC_ID !='8922'
		                     )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	VP.ITEM_ID
		                UNION ALL
		                SELECT PB.ITEM_ID, '차이 합계'GUBN,
		                        SUM(MTS_AN_QTY) MTS_AN_QTY,
		                        
		                        SUM(MTS_PO_QTY) MTS_PO_QTY,
		                  
		                        SUM(DY_QTY) 	DY_QTY,
		                      
		                        SUM(TK_QTY) 	TK_QTY,
		                        SUM(SAMBO_QTY) 	SAMBO_QTY,
		                        SUM(TOT) 		TOT
		                FROM
		                    (
		                    	SELECT  IO.ITEM_ID, '계획 합계' GUBN,
		                                (-1)*(
			                                	   SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
			                                      +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
		                                      )	AS 	MTS_AN_QTY,
		                               
		                                (-1)*(
			                                	   SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
			                                      +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
		                                      )	AS 	MTS_PO_QTY,
		                               
		                                (-1)*SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	DY_QTY,
		                               
		                                (-1)*SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	TK_QTY,
		                                (-1)*SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	SAMBO_QTY,
		                                (-1)*(
		                                		 SUM(DECODE(IO.LOC_ID,		'7100'			,NVL(IO.QTY,0)	,0))
		                                     	+SUM(DECODE(IO.LOC_ID,		'7101'			,NVL(IO.QTY,0)	,0))
		                                    
		                                		+SUM(DECODE(IO.LOC_ID,		'7500'			,NVL(IO.QTY,0)	,0))
		                                     	+SUM(DECODE(IO.LOC_ID,		'7501'			,NVL(IO.QTY,0)	,0))
		                                		
		                                     	+SUM(DECODE(IO.LOC_ID,		'1811'			,NVL(IO.QTY,0)	,0))
		                                     	
		                                     	+SUM(DECODE(IO.LOC_ID,		'1841'			,NVL(IO.QTY,0)	,0))
		                                     	+SUM(DECODE(IO.LOC_ID,		'1813'			,NVL(IO.QTY,0)	,0))
		                                     )	AS	TOT
		                FROM IF_SET_PROD_ORDER  IO,
		                     (
		                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                        FROM    ITEM_CAPA IC,
		                                (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID 	= '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                      --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                ) IM
		                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                        AND		IC.LOC_ID !='8922'
		                      )IP
		                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                AND		IO.SEQ	= '10'
		                AND		IO.IDU_FLAG = 'I'
		                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                GROUP BY	IO.ITEM_ID
		                UNION ALL
		                SELECT  VP.ITEM_ID, '실적 합계'GUBN,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_AN_QTY,
		                      
		                         SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	MTS_PO_QTY,
		                   
		                        SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	DY_QTY,
		                 
		                        SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TK_QTY,
		                        SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	SAMBO_QTY,
		                         SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
		                   
		                        +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
		                        +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
		                   	
		                        +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
		                      	
		                        +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
		                        +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	TOT 
		                FROM V_SET_PROD_PO_MES  VP,
		                     CAL_MST	   		CM,
		                     (
	                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                            FROM    ITEM_CAPA IC,
	                                    (
	                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                    FROM    MBOM BM, ITEM_MST IM
	                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                    AND     BM.PLANT_ID 	= '1300'
	                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                 --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                    ) IM
	                            WHERE   IC.ITEM_ID = IM.ITEM_ID
	                            AND		IC.LOC_ID !='8922'
		                     )IP
		                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		                AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
		                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}' 
		                GROUP BY	VP.ITEM_ID
		                       )PB
		                GROUP BY	PB.ITEM_ID
		                    ) PL
		            WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
		            AND		IL.GUBN		=   PL.GUBN(+)
		            GROUP BY IL.ITEM_ID, IL.ITEM_NAME, IL.SPEC, IL.GUBN
		            UNION ALL
                    <!-- 달성율(%) 로직 추가-->
                    SELECT	'',
                            '',
                            '',
                            '달성율(%)'GUBN,
                            DECODE(SUM(P_MTS_AN_QTY	)	,0	,1,		ROUND((SUM(A_MTS_AN_QTY)	/	SUM(P_MTS_AN_QTY)	)  	,2))*100		MTS_AN_QTY,
                        
                            DECODE(SUM(P_MTS_PO_QTY	)	,0	,1,		ROUND((SUM(A_MTS_PO_QTY)	/	SUM(P_MTS_PO_QTY)	)	,2))*100		MTS_PO_QTY,
                           
                            DECODE(SUM(P_DY_QTY		)	,0	,1,		ROUND((SUM(A_DY_QTY)		/	SUM(P_DY_QTY)		)	,2))*100		DY_QTY,
                      
                            DECODE(SUM(P_TK_QTY		)	,0	,1,		ROUND((SUM(A_TK_QTY)		/	SUM(P_TK_QTY)		)	,2))*100		TK_QTY,
                            DECODE(SUM(P_SAMBO_QTY	)	,0	,1,		ROUND((SUM(A_SAMBO_QTY)		/	SUM(P_SAMBO_QTY)	)	,2))*100		SAMBO_QTY,
                            DECODE(SUM(P_TOT		)	,0	,1,		ROUND((SUM(A_TOT)			/	SUM(P_TOT)			)	,2))*100		TOT
                    FROM	(
                            SELECT  IO.ITEM_ID, ' 계획' GUBN,        
                                     (SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
                                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_AN_QTY, 
                                     
                                     (SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
                                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_PO_QTY,                            	                                
                                                                                           
                                      SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	P_DY_QTY,                                                                
                                                                                              
                                      SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	P_TK_QTY,                                                                
                                      SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_SAMBO_QTY,                                                    
                                      SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
                                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
                                   
                                     +SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
                                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
                          
                                     +SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))
                                   
                                     +SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
                                     +SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_TOT,
                                    0		A_MTS_AN_QTY,                                 
                                    0		A_MTS_PO_QTY,                           
                                    0		A_DY_QTY,                     
                                    0		A_TK_QTY,
                                    0		A_SAMBO_QTY,
                                    0       A_TOT
                            FROM IF_SET_PROD_ORDER  IO,
                                 (
                                 SELECT		DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                 FROM		ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                            
                                            ) IM
                                 WHERE   IC.ITEM_ID = IM.ITEM_ID
                                 AND		IC.LOC_ID !='8922'
                                 )IP
                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)
                            AND		IO.SEQ	= '10'
                            AND		IO.IDU_FLAG = 'I'
                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}' 
                            GROUP BY	IO.ITEM_ID
                            UNION ALL
                            SELECT	VP.ITEM_ID, ' 실적'GUBN,
                                    0		P_MTS_AN_QTY,                                   
                                    0		P_MTS_PO_QTY,                            
                                    0		P_DY_QTY,                                
                                    0		P_TK_QTY,
                                    0		P_SAMBO_QTY,
                                    0       P_TOT,
                                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_AN_QTY,                                  
                                     SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_PO_QTY,                                 
                                     SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_DY_QTY,                                   
                                     SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TK_QTY,
                                     SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_SAMBO_QTY,
                                    --총계--                        	                        
                                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
                                    
                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
                                   	
                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
                                    
                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TOT 
                            FROM	V_SET_PROD_PO_MES	VP,
                                    CAL_MST				CM,
                                    (
                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
                                    FROM    ITEM_CAPA IC,
                                            (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                            
                                            ) IM
                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
                                    AND		IC.LOC_ID !='8922'
                                 )IP
                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
                            AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
                            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}' 
                            GROUP BY	VP.ITEM_ID                    
                            )
			) T1
		GROUP BY T1.GUBN 
		)										
	    ORDER			<!-- 달성율(%) 정렬 -->
	    BY		ITEM_ID,
	            case GUBN
	                when '계획' then '1'
	                when '실적' then '2'
	                when '차이' then '3'
	                when '계획 합계' then '4'
	                when '실적 합계' then '5'
	                when '차이 합계' then '6'
	                else '9'
	            end    	<!-- 달성율(%) 정렬  끝--> 	 	  
		#else <!-- 작업비-->	
SELECT *
FROM	(		
		SELECT IL.ITEM_ID, 
		       IL.ITEM_NAME, 
		       IL.SPEC, 
		       IL.GUBN, 
		       SUM(NVL(PL.MTS_AN_QTY,0))	MTS_AN_QTY,
		      
		       SUM(NVL(PL.MTS_PO_QTY,0))	MTS_PO_QTY,
		   
		       SUM(NVL(PL.DY_QTY,0))		DY_QTY, 
		     
		       SUM(NVL(PL.TK_QTY,0))		TK_QTY, 
		       SUM(NVL(PL.SAMBO_QTY,0))		SAMBO_QTY, 
		       SUM(NVL(PL.TOT,0))			TOT
		FROM   (
		        SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN
		        FROM    (
	                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	                    FROM 	ITEM_MST			IM,
	                       		(                    
	                            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                            FROM    ITEM_CAPA IC, 
	                                    (
                                        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                        FROM    MBOM BM, ITEM_MST IM
                                        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                        AND     BM.PLANT_ID = '1300'
                                        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                     --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                
	                                    ) IM
	                            WHERE   IC.ITEM_ID = IM.ITEM_ID     
	                            AND		LOC_ID	!= '8922' 
	                      		)IP
		        WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
		       -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')	
		        AND		IM.ITEM_ID	IN (			
	                                    SELECT	ITEM_ID
	                                    FROM IF_SET_PROD_ORDER
	                                    WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'   
	                                    AND		LOC_ID	!= '8922' 
	                                    AND		IDU_FLAG = 'I'	  	
	                                    UNION	ALL
	                                    SELECT	ITEM_ID
	                                    FROM V_SET_PROD_PO_MES
	                                    WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
	                                    AND		LOC_ID	!= '8922'                                         
		                                )
		
		        GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC          
		            ) IT,     
		            (
	                SELECT  '계획' AS GUBN
	                FROM    DUAL
	                UNION   ALL
	                SELECT  '실적' AS GUBN
	                FROM    DUAL            
	                UNION   ALL
	                SELECT  '차이' AS GUBN
	                FROM    DUAL
		            ) GB    
		   )IL,  
		   (
		    SELECT  IO.ITEM_ID, '계획' GUBN,
		            DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
		            (
			             SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
			            +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
		            )* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
		         
		            (
			             SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
			            +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
			        )* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
		     
		            SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	DY_QTY,
		   
		            SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	TK_QTY,
		            SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
		            (
			            SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
			            +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
			           
			            +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
			            +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
			           
			            +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
			            
			            +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
			            +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))
		            )	*NVL(SM2.BOX_COST,0)	AS	TOT  
		    FROM IF_SET_PROD_ORDER  IO,
		    	 SET_PROD_MST		SM2,	
		         (
		            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,	    
		                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME	
		            FROM    ITEM_CAPA IC,
		                    (
                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                            FROM    MBOM BM, ITEM_MST IM
                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                            AND     BM.PLANT_ID 	= '1300'
                            AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                           -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                    ) IM
		            WHERE   IC.ITEM_ID = IM.ITEM_ID
		            AND		IC.LOC_ID !='8922'
		          )IP
		    WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		    AND		IO.LOC_ID  		=	IP.LOC_ID(+) 	
		    AND		IO.ITEM_ID		=	SM2.ITEM_ID		
		    AND		IO.PROD_VER		= 	SM2.PROD_VER
		    AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')		     
		    AND		IO.SEQ			= '10'
		    AND		IO.IDU_FLAG 	= 'I'
		    AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		    GROUP BY	IO.ITEM_ID, SM2.BOX_COST
		    UNION ALL
		    SELECT  VP.ITEM_ID, '실적'GUBN ,
		    		DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
		            (
		             SUM(DECODE(IP.LOC_ID,			'7100'		,NVL(VP.COMPL_QTY,0)	,0))
		            +SUM(DECODE(IP.LOC_ID,			'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		            )* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
		          
		            (
			             SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		            )* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
	
		            SUM(DECODE(IP.LOC_ID,			'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
		          
		            SUM(DECODE(IP.LOC_ID,			'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
		            SUM(DECODE(IP.LOC_ID,			'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
		            (
			             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
			            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
			         
			            +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
			       	
			            +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
			           
			            +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
			            +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))
		            )* NVL(SM2.BOX_COST,0)	AS	TOT
		    FROM V_SET_PROD_PO_MES  VP,
		    	 SET_PROD_MST		SM2,
		         CAL_MST	   		CM,
		         (
					SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID, IC.PROD_VER,
					        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
					FROM    ITEM_CAPA IC,
					        (
		                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
		                    FROM    MBOM BM, ITEM_MST IM
		                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
		                    AND     BM.PLANT_ID 	= '1300'
		                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
		                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
					         ) IM
					WHERE   IC.ITEM_ID = IM.ITEM_ID
					AND		IC.LOC_ID !='8922'
		         )IP
		    WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		    AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		    AND		VP.ITEM_ID		=	SM2.ITEM_ID
		    AND		IP.PROD_VER		= 	SM2.PROD_VER
		    AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
		    AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		    AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		    GROUP BY	VP.ITEM_ID, SM2.BOX_COST
		    UNION ALL
		    SELECT  PL.ITEM_ID, '차이'GUBN ,
		    		PL.BOX_COST,
		            SUM(NVL(PA.MTS_AN_QTY,0))   - SUM(NVL(PL.MTS_AN_QTY,0))		AS  MTS_AN_QTY,
		           
		            SUM(NVL(PA.MTS_PO_QTY,0))   - SUM(NVL(PL.MTS_PO_QTY,0))		AS  MTS_PO_QTY,
		          
		            SUM(NVL(PA.DY_QTY,0)) 	 	- SUM(NVL(PL.DY_QTY,0))			AS  DY_QTY,
		         
		            SUM(NVL(PA.TK_QTY,0)) 	 	- SUM(NVL(PL.TK_QTY,0))			AS  TK_QTY,
		            SUM(NVL(PA.SAMBO_QTY,0)) 	- SUM(NVL(PL.SAMBO_QTY,0))		AS  SAMBO_QTY,
		            SUM(NVL(PA.TOT,0))		 	- SUM(NVL(PL.TOT,0))			AS	TOT_QTY
		    FROM	
		        (   
				  SELECT  IO.ITEM_ID, '계획' GUBN,
						  DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
				        (
				            SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
				            +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
				        )	* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
				 
				        
				        (
				            SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
				            +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
				        )	* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
				      
				        SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	DY_QTY,
				
				        SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	TK_QTY,
				        SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
				        (
				            SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
				            +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
				           
				            +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
				            +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
				       
				            +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
				           
				            +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
				            +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))
				        )	* NVL(SM2.BOX_COST,0)	AS	TOT
				  FROM		IF_SET_PROD_ORDER  IO,
				  			SET_PROD_MST	   SM2,	
							(
				            SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
				                    F_GET_DC_NAME(IC.LOC_ID) DC_NAME
				            FROM    ITEM_CAPA IC,
				                    (
				                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
				                    FROM    MBOM BM, ITEM_MST IM
				                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
				                    AND     BM.PLANT_ID 	= '1300'
				                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
				                 --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
				                    ) IM
				            WHERE   IC.ITEM_ID = IM.ITEM_ID
				            AND		IC.LOC_ID !='8922'
							)IP
		    WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
		    AND		IO.LOC_ID  		=	IP.LOC_ID(+)	
		    AND		IO.ITEM_ID		=	SM2.ITEM_ID		
		    AND		IO.PROD_VER		= 	SM2.PROD_VER
		    AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')	
		    AND		IO.SEQ			= '10'
		    AND		IO.IDU_FLAG 	= 'I'	
		    AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		    GROUP BY	IO.ITEM_ID,	SM2.BOX_COST
		           )PL,
		        (                      
		            SELECT  VP.ITEM_ID, '실적'GUBN ,
		                	DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
		                    (
			                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))+
			                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                    )* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
		                  
		                    (
			                     SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                    )* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
		                 
		                    SUM(DECODE(IP.LOC_ID,			'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
		       
		                    SUM(DECODE(IP.LOC_ID,			'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
		                    SUM(DECODE(IP.LOC_ID,			'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
		                    (
			                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
			                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
			                  
			                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
			              
			                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
			                  	
			                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
			                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))
		                    )* NVL(SM2.BOX_COST,0)	AS	TOT
		            FROM V_SET_PROD_PO_MES	VP,
		            	 SET_PROD_MST		SM2,
		                 CAL_MST			CM,
		                 (
							SELECT  DISTINCT IC.ITEM_ID, IC.LOC_ID, IC.PROD_VER,
							        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
							FROM    ITEM_CAPA IC,
							        (
				                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
				                    FROM    MBOM BM, ITEM_MST IM
				                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
				                    AND     BM.PLANT_ID 	= '1300'
				                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
				                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
							        ) IM
							WHERE   IC.ITEM_ID = IM.ITEM_ID
							AND		IC.LOC_ID !='8922'
		                 )IP
		            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
		            AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
		            AND		VP.ITEM_ID		=	SM2.ITEM_ID
		            AND		IP.PROD_VER		= 	SM2.PROD_VER
		            AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
		            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
		            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		            GROUP BY	VP.ITEM_ID, SM2.BOX_COST
		        )PA
		    WHERE	PL.ITEM_ID	=	PA.ITEM_ID(+)
		    AND		PL.BOX_COST	=	PA.BOX_COST(+)
		    GROUP BY	PL.ITEM_ID, PL.BOX_COST               
		        ) PL        
		WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)                        
		AND		IL.GUBN		=   PL.GUBN(+)
		GROUP BY IL.ITEM_ID, IL.ITEM_NAME, IL.SPEC, IL.GUBN
		UNION ALL
		SELECT		'',
			        '',
			        '',
					T1.GUBN,
					SUM(NVL(T1.MTS_AN_QTY,0))	MTS_AN_QTY,
					
			        SUM(NVL(T1.MTS_PO_QTY,0))	MTS_PO_QTY,
			
			        SUM(NVL(T1.DY_QTY,0))		DY_QTY,
			    
			        SUM(NVL(T1.TK_QTY,0))		TK_QTY,
			        SUM(NVL(T1.SAMBO_QTY,0))		SAMBO_QTY,
			        SUM(NVL(T1.TOT,0))			TOT
			FROM
					(
			         SELECT    IL.ITEM_ID,
			                   IL.ITEM_NAME,
			                   IL.SPEC,
			                   IL.GUBN,
			                   SUM(NVL(PL.MTS_AN_QTY,0))	MTS_AN_QTY,
			                 
			                   SUM(NVL(PL.MTS_PO_QTY,0))	MTS_PO_QTY,
			                 
			                   SUM(NVL(PL.DY_QTY,0))		DY_QTY,
			                  
			                   SUM(NVL(PL.TK_QTY,0))		TK_QTY,
			                   SUM(NVL(PL.SAMBO_QTY,0))		SAMBO_QTY,
			                   SUM(NVL(PL.TOT,0))			TOT
			            FROM   (
			                    SELECT  IT.ITEM_ID, IT.ITEM_NAME, IT.SPEC, GB.GUBN
			                    FROM    (
		                                SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
		                                FROM 	ITEM_MST			IM,
												(
		                                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
		                                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
		                                        FROM    ITEM_CAPA IC,
		                                                (
	                                                    SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                                    FROM    MBOM BM, ITEM_MST IM
	                                                    WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                                    AND     BM.PLANT_ID = '1300'
	                                                    AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                                  --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
		                                                ) IM
		                                        WHERE   IC.ITEM_ID = IM.ITEM_ID
		                                        AND		LOC_ID	!= '8922'
			                             )IP
			                    WHERE	IM.ITEM_ID		=	IP.ITEM_ID(+)
			                   -- AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
			                    AND		IM.ITEM_ID	IN (
		                                                SELECT	ITEM_ID
		                                                FROM IF_SET_PROD_ORDER
		                                                WHERE	START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                                                AND		LOC_ID	!= '8922'
		                                                AND		IDU_FLAG = 'I'
		                                                UNION	ALL
		                                                SELECT	ITEM_ID
		                                                FROM V_SET_PROD_PO_MES
		                                                WHERE	START_DTTM BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
		                                                AND		LOC_ID	!= '8922'                                        
			                                            )
			                    GROUP BY	IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC
			                        ) IT,
			                        (
			                            SELECT  '계획 합계' AS GUBN
			                            FROM    DUAL
			                            UNION   ALL
			                            SELECT  '실적 합계' AS GUBN
			                            FROM    DUAL
			                            UNION   ALL
			                            SELECT  '차이 합계' AS GUBN
			                            FROM    DUAL
			                        ) GB
			               )IL,
			               (
			                SELECT  IO.ITEM_ID, '계획 합계' GUBN,
		                            DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
		                            (
			                             SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
			                            +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
		                            )	* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
		                            
		                            (
			                             SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
			                            +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
		                            )	* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
		                        
		                            SUM(DECODE(IO.LOC_ID,		'1811'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	DY_QTY,
		                          
		                            SUM(DECODE(IO.LOC_ID,		'1841'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	TK_QTY,
		                            SUM(DECODE(IO.LOC_ID,		'1813'		,NVL(IO.QTY,0)	,0))	* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
		                            (
			                             SUM(DECODE(IO.LOC_ID,	'7100'		,NVL(IO.QTY,0)	,0))
			                            +SUM(DECODE(IO.LOC_ID,	'7101'		,NVL(IO.QTY,0)	,0))
			                     
			                            +SUM(DECODE(IO.LOC_ID,	'7500'		,NVL(IO.QTY,0)	,0))
			                            +SUM(DECODE(IO.LOC_ID,	'7501'		,NVL(IO.QTY,0)	,0))
			                    
			                            +SUM(DECODE(IO.LOC_ID,	'1811'		,NVL(IO.QTY,0)	,0))
			                          
			                            +SUM(DECODE(IO.LOC_ID,	'1841'		,NVL(IO.QTY,0)	,0))
			                            +SUM(DECODE(IO.LOC_ID,	'1813'		,NVL(IO.QTY,0)	,0))
		                            )	* NVL(SM2.BOX_COST,0)	AS	TOT                    
			                FROM IF_SET_PROD_ORDER  IO,
		                    	 SET_PROD_MST		SM2,
			                     (
			                        SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
			                                F_GET_DC_NAME(IC.LOC_ID) DC_NAME
			                        FROM    ITEM_CAPA	IC,
			                                (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                         --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
			                                ) IM
			                        WHERE   IC.ITEM_ID = IM.ITEM_ID
			                        AND		IC.LOC_ID !='8922'
			                      )IP
			                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
			                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
		                    AND		IO.ITEM_ID		=	SM2.ITEM_ID		
		                    AND		IO.PROD_VER		= 	SM2.PROD_VER
		                    AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')	
			                AND		IO.SEQ		= '10'
			                AND		IO.IDU_FLAG = 'I'
			                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
			                GROUP BY	IO.ITEM_ID, SM2.BOX_COST
			                UNION ALL
			                SELECT  VP.ITEM_ID, '실적 합계'GUBN,
		                            DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
		                            (
			                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
			                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                            )* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
		                            
		                            (
			                             SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                            )* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
		                   
		                            SUM(DECODE(IP.LOC_ID,			'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
		                   
		                            SUM(DECODE(IP.LOC_ID,			'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
		                            SUM(DECODE(IP.LOC_ID,			'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
		                            (
			                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
			                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
			                          
			                            +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
			                        
			                            +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
			                           	
			                            +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
			                            +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))
		                            )* NVL(SM2.BOX_COST,0)	AS	TOT
			                FROM	V_SET_PROD_PO_MES	VP,
		                    		SET_PROD_MST		SM2,
			                    	CAL_MST	   			CM,
			                        (
	                                SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID, IC.PROD_VER,
	                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                FROM    ITEM_CAPA IC,
	                                        (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                          --  AND		(IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                        ) IM
	                                WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                AND		IC.LOC_ID !='8922'
			                        )IP
			                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
			                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                    AND		VP.ITEM_ID		=	SM2.ITEM_ID
		                    AND		IP.PROD_VER		= 	SM2.PROD_VER
		                    AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
			                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
			                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
			                GROUP BY	VP.ITEM_ID, SM2.BOX_COST
			                UNION ALL
			                SELECT	PB.ITEM_ID, '차이 합계'GUBN, 
		                    	   	PB.BOX_COST,	
									SUM(MTS_AN_QTY) MTS_AN_QTY,
									
									SUM(MTS_PO_QTY) MTS_PO_QTY,
									
									SUM(DY_QTY) 	DY_QTY,
									
									SUM(TK_QTY) 	TK_QTY,
									SUM(SAMBO_QTY) 	SAMBO_QTY,
									SUM(TOT) 		TOT
			                FROM
			                    (
			                    	SELECT  IO.ITEM_ID, '계획 합계' GUBN,
		                            		DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
			                                (-1)*(
			                                		 SUM(DECODE(IO.LOC_ID,	'7100'	,NVL(IO.QTY,0)	,0))
		                            			  	+SUM(DECODE(IO.LOC_ID,	'7101'	,NVL(IO.QTY,0)	,0))
		                            			 ) *  NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY,
		                            			 
			                                (-1)*(
			                                		 SUM(DECODE(IO.LOC_ID,	'7500'	,NVL(IO.QTY,0)	,0))
		                            			 	+SUM(DECODE(IO.LOC_ID,	'7501'	,NVL(IO.QTY,0)	,0))
		                            			 )  *  NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,
			                      
			                                (-1)*SUM(DECODE(IO.LOC_ID,		'1811'	,NVL(IO.QTY,0)	,0))  *  NVL(SM2.BOX_COST,0)	AS	DY_QTY,
			                            
			                                (-1)*SUM(DECODE(IO.LOC_ID,		'1841'	,NVL(IO.QTY,0)	,0))  *  NVL(SM2.BOX_COST,0)	AS	TK_QTY,
			                                (-1)*SUM(DECODE(IO.LOC_ID,		'1813'	,NVL(IO.QTY,0)	,0))  *  NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
			                                (-1)*(
			                                		 SUM(DECODE(IO.LOC_ID,		'7100'			,NVL(IO.QTY,0)	,0))
			                                     	+SUM(DECODE(IO.LOC_ID,		'7101'			,NVL(IO.QTY,0)	,0))
			                                	
			                                		+SUM(DECODE(IO.LOC_ID,		'7500'			,NVL(IO.QTY,0)	,0))
			                                     	+SUM(DECODE(IO.LOC_ID,		'7501'			,NVL(IO.QTY,0)	,0))
			                                		
			                                     	+SUM(DECODE(IO.LOC_ID,		'1811'			,NVL(IO.QTY,0)	,0))
			                                     
			                                     	+SUM(DECODE(IO.LOC_ID,		'1841'			,NVL(IO.QTY,0)	,0))
			                                     	+SUM(DECODE(IO.LOC_ID,		'1813'			,NVL(IO.QTY,0)	,0))
		                                          ) *	NVL(SM2.BOX_COST,0)	AS	TOT
			                		FROM	IF_SET_PROD_ORDER  IO,
		                    	 			SET_PROD_MST		SM2,
						                     (
												SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID, 
												        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
												FROM    ITEM_CAPA IC,
												        (
												        SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
												        FROM    MBOM BM, ITEM_MST IM
												        WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
												        AND     BM.PLANT_ID 	= '1300'
												        AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
												     --   AND		(IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
												        ) IM
												WHERE   IC.ITEM_ID = IM.ITEM_ID
												AND		IC.LOC_ID !='8922'
						                      )IP
			                WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
			                AND		IO.LOC_ID  		=	IP.LOC_ID(+)
							AND		IO.ITEM_ID		=	SM2.ITEM_ID
		                    AND		IO.PROD_VER		= 	SM2.PROD_VER
		                    AND		IO.START_DATE BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
			                AND		IO.SEQ	= '10'
			                AND		IO.IDU_FLAG = 'I'
			                AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
			                GROUP BY	IO.ITEM_ID, SM2.BOX_COST
			                UNION ALL
			                SELECT  VP.ITEM_ID, '실적 합계'GUBN,
		                            DECODE(SM2.BOX_COST,'0','1',NVL(SM2.BOX_COST,0)) BOX_COST,
		                            (
			                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))+
			                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))
		                            )* NVL(SM2.BOX_COST,0)	AS 	MTS_AN_QTY, 
		                        
		                            (
			                             SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))+
			                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))
		                            )* NVL(SM2.BOX_COST,0)	AS 	MTS_PO_QTY,		                            
		                    
		                            SUM(DECODE(IP.LOC_ID,			'1811'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	DY_QTY,	
		                        
		                            SUM(DECODE(IP.LOC_ID,			'1841'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	TK_QTY,	 
		                            SUM(DECODE(IP.LOC_ID,			'1813'		,NVL(VP.COMPL_QTY,0)	,0))* NVL(SM2.BOX_COST,0)	AS	SAMBO_QTY,
		                            (
			                             SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
			                            +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
			                            
			                            +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
			                            +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
			                        
			                            +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
			                          
			                            +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
			                            +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))
		                            )* NVL(SM2.BOX_COST,0)	AS	TOT
			                FROM	V_SET_PROD_PO_MES	VP,
		                    	 	SET_PROD_MST		SM2,
			                     	CAL_MST				CM,
			                        (
	                                SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID, IC.PROD_VER,
	                                        F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                FROM    ITEM_CAPA IC,
	                                        (
                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
                                            FROM    MBOM BM, ITEM_MST IM
                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
                                            AND     BM.PLANT_ID 	= '1300'
                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
                                         --   AND		(IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')
	                                        ) IM
	                                WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                AND		IC.LOC_ID !='8922'
			                        )IP
			                WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
			                AND		VP.LOC_ID  		=	IP.LOC_ID(+)
		                    AND		VP.ITEM_ID		=	SM2.ITEM_ID
		                    AND		IP.PROD_VER		= 	SM2.PROD_VER
		                    AND		VP.START_DTTM BETWEEN SM2.START_DATE AND NVL(SM2.END_DATE,'9999-12-31')
			                AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
			                AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}'
			                GROUP BY	VP.ITEM_ID, SM2.BOX_COST
			                       )PB
			                GROUP BY	PB.ITEM_ID, PB.BOX_COST
			                    ) PL
			            WHERE	IL.ITEM_ID	=	PL.ITEM_ID(+)
			            AND		IL.GUBN		=   PL.GUBN(+)
			            GROUP BY IL.ITEM_ID, IL.ITEM_NAME, IL.SPEC, IL.GUBN
			            <!-- 달성율(%) 로직 추가-->
	                    UNION	ALL
	                    SELECT	'',
	                            '',
	                            '',
	                            '달성율(%)'GUBN,
	                            DECODE(SUM(P_MTS_AN_QTY	)	,0	,1,		ROUND((SUM(A_MTS_AN_QTY)	/	SUM(P_MTS_AN_QTY)	)  	,2))*100		MTS_AN_QTY,
	                           
	                            DECODE(SUM(P_MTS_PO_QTY	)	,0	,1,		ROUND((SUM(A_MTS_PO_QTY)	/	SUM(P_MTS_PO_QTY)	)	,2))*100		MTS_PO_QTY,
	                           
	                            DECODE(SUM(P_DY_QTY		)	,0	,1,		ROUND((SUM(A_DY_QTY)		/	SUM(P_DY_QTY)		)	,2))*100		DY_QTY,
	                           
	                            DECODE(SUM(P_TK_QTY		)	,0	,1,		ROUND((SUM(A_TK_QTY)		/	SUM(P_TK_QTY)		)	,2))*100		TK_QTY,
	                            DECODE(SUM(P_SAMBO_QTY	)	,0	,1,		ROUND((SUM(A_SAMBO_QTY)		/	SUM(P_SAMBO_QTY)	)	,2))*100		SAMBO_QTY,
	                            DECODE(SUM(P_TOT		)	,0	,1,		ROUND((SUM(A_TOT)			/	SUM(P_TOT)			)	,2))*100		TOT
	                    FROM	(
	                            SELECT  IO.ITEM_ID, ' 계획' GUBN,        
	                                     (SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
	                                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_AN_QTY,  
	                            
	                                     (SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
	                                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0)))	AS 	P_MTS_PO_QTY,                            	                                
	                                                                                                  
	                                      SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))	AS	P_DY_QTY,                                                                
	                                                                                             
	                                      SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))	AS	P_TK_QTY,                                                                
	                                      SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_SAMBO_QTY,                                                    
	                                      SUM(DECODE(IO.LOC_ID,			'7100'			,NVL(IO.QTY,0)	,0))
	                                     +SUM(DECODE(IO.LOC_ID,			'7101'			,NVL(IO.QTY,0)	,0))
	                                    
	                                     +SUM(DECODE(IO.LOC_ID,			'7500'			,NVL(IO.QTY,0)	,0))
	                                     +SUM(DECODE(IO.LOC_ID,			'7501'			,NVL(IO.QTY,0)	,0))
	                            
	                                     +SUM(DECODE(IO.LOC_ID,			'1811'			,NVL(IO.QTY,0)	,0))
	                                     
	                                     +SUM(DECODE(IO.LOC_ID,			'1841'			,NVL(IO.QTY,0)	,0))
	                                     +SUM(DECODE(IO.LOC_ID,			'1813'			,NVL(IO.QTY,0)	,0))	AS	P_TOT,
	                                    0		A_MTS_AN_QTY,
	                                  
	                                    0		A_MTS_PO_QTY,
	                        
	                                    0		A_DY_QTY,
	                                 
	                                    0		A_TK_QTY,
	                                    0		A_SAMBO_QTY,
	                                    0        A_TOT
	                            FROM IF_SET_PROD_ORDER  IO,
	                                 (
	                                 SELECT		DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                 FROM		ITEM_CAPA IC,
	                                            (
	                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                            FROM    MBOM BM, ITEM_MST IM
	                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                            AND     BM.PLANT_ID 	= '1300'
	                                            AND    (IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                         --   AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                            
	                                            ) IM
	                                 WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                 AND		IC.LOC_ID !='8922'
	                                 )IP
	                            WHERE	IO.ITEM_ID		=	IP.ITEM_ID(+)
	                            AND		IO.LOC_ID  		=	IP.LOC_ID(+)
	                            AND		IO.SEQ	= '10'
	                            AND		IO.IDU_FLAG = 'I'
	                            AND		IO.START_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}' 
	                            GROUP BY	IO.ITEM_ID
	                            UNION ALL
	                            SELECT	VP.ITEM_ID, ' 실적'GUBN,
	                                    0		P_MTS_AN_QTY,
	                                   
	                                    0		P_MTS_PO_QTY,
	                                   
	                                    0		P_DY_QTY,
	                              
	                                    0		P_TK_QTY,
	                                    0		P_SAMBO_QTY,
	                                    0        P_TOT,
	                                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
	                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_AN_QTY,
	                                     
	                                     SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
	                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	AS 	A_MTS_PO_QTY,
	                                    
	                                     SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_DY_QTY,
	                                    
	                                     SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TK_QTY,
	                                     SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_SAMBO_QTY,
	                                    --총계--                        	                        
	                                     SUM(DECODE(IP.LOC_ID,		'7100'		,NVL(VP.COMPL_QTY,0)	,0))
	                                    +SUM(DECODE(IP.LOC_ID,		'7101'		,NVL(VP.COMPL_QTY,0)	,0)) 
	                                   
	                                    +SUM(DECODE(IP.LOC_ID,		'7500'		,NVL(VP.COMPL_QTY,0)	,0))
	                                    +SUM(DECODE(IP.LOC_ID,		'7501'		,NVL(VP.COMPL_QTY,0)	,0))	
	                                   
	                                    +SUM(DECODE(IP.LOC_ID,		'1811'		,NVL(VP.COMPL_QTY,0)	,0))		
	                                  
	                                    +SUM(DECODE(IP.LOC_ID,		'1841'		,NVL(VP.COMPL_QTY,0)	,0))	 
	                                    +SUM(DECODE(IP.LOC_ID,		'1813'		,NVL(VP.COMPL_QTY,0)	,0))	AS	A_TOT 
	                            FROM	V_SET_PROD_PO_MES  VP,
	                                    CAL_MST	   		CM,
	                                    (
	                                    SELECT  DISTINCT IC.LOC_ID, IC.ITEM_ID,
	                                            F_GET_DC_NAME(IC.LOC_ID) DC_NAME
	                                    FROM    ITEM_CAPA IC,
	                                            (
	                                            SELECT  DISTINCT BM.PROD_ITEM_ID ITEM_ID
	                                            FROM    MBOM BM, ITEM_MST IM
	                                            WHERE   BM.PROD_ITEM_ID = IM.ITEM_ID
	                                            AND     BM.PLANT_ID 	= '1300'
	                                            AND		(IM.SELL_STOP_DATE > TO_CHAR(SYSDATE,'YYYYMMDD') OR IM.SELL_STOP_DATE = '00000000')
	                                          --  AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')                                            
	                                            ) IM
	                                    WHERE   IC.ITEM_ID = IM.ITEM_ID
	                                    AND		IC.LOC_ID !='8922'
	                                 )IP
	                            WHERE	VP.ITEM_ID		=	IP.ITEM_ID(+)
	                            AND		VP.LOC_ID  		=	IP.LOC_ID(+) 
	                            AND		VP.START_DTTM  	=	CM.CAL_DATE(+)
	                            AND		CM.CAL_DATE BETWEEN '$!{in_fr_date}'	AND	'$!{in_to_date}' 
	                            GROUP BY	VP.ITEM_ID
	                            ) 
				) T1
			GROUP BY T1.GUBN 
			<!--ORDER BY 1,2,3,4-->
		)										
	    ORDER			<!-- 달성율(%) 정렬 -->
	    BY		ITEM_ID,
	            case GUBN
	                when '계획' then '1'
	                when '실적' then '2'
	                when '차이' then '3'
	                when '계획 합계' then '4'
	                when '실적 합계' then '5'
	                when '차이 합계' then '6'
	                else '9'
	            end    	<!-- 달성율(%) 정렬  끝-->			
		#end
#end
	</query>
	
		<!-- DC기준정보 리스트 -->
	<query id="dc_loc_list">	
	
	
		SELECT  DC.DC_ID, DC.DC_SHORT_NAME
		  FROM  DC_MST DC
		  		,(SELECT '4' SS FROM DUAL)
		 WHERE  DC.MADE_TYPE != 'DE'
		 ORDER  BY DC.DC_ID
		 		 
		 
	</query>		
		
<!--
=====================================================================================================
 끝  
=====================================================================================================
--> 	
</queries>	