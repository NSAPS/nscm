<?xml version="1.0" encoding="EUC-KR"?>
<queries>	

<!--
=====================================================================================================
	공통 쿼리
=====================================================================================================
-->

	<!-- 콤보박스:공장 리스트조회 --> 
	<query id="combo_plant_list">
	
			SELECT	HR.HID, HR.HID_NAME
			FROM	HRCHY HR
			WHERE	HR.LVL_TYPE = '공장'
      		AND  	HR.MADE_TYPE != 'DE'
      	    ORDER  	BY HR.HID
      				
	</query>
	
	<!-- 원가부문 리스트 -->
	<query id="combo_won_list">
	
			SELECT  DISTINCT
			        VH.PLANT_ID, VH.TEAM_ID, VH.TEAM_NAME
			FROM    V_HRCHY_PROC VH
			ORDER   BY VH.PLANT_ID, VH.TEAM_ID
			
			/*
			SELECT  HR.HTYPE, HR.HID, HR.HID_NAME
			  FROM  HRCHY HR, (SELECT 'AA' AS A FROM DUAL) A
			 WHERE  HR.MADE_TYPE != 'DE'
			   AND  HR.LVL_TYPE = '원가부문'
			 ORDER  BY HR.HID
			*/
	
	</query>
	
	<!-- 라인 리스트 -->
	<query id="combo_line_list">
	
			SELECT  HR.HTYPE AS PLANT_ID,
                    HR.PARENT_HID AS TEAM_ID,
                    HR.HID AS LINE_ID,
                    HR.HID_NAME AS LINE_NAME
            FROM    HRCHY HR, DUAL A
            WHERE   HR.LVL_TYPE = '라인'
            ORDER	BY HR.HID   
	
	</query>
	
	<!-- 제품분류 리스트 -->
	<query id="combo_division_list">
		
			SELECT  CD, CD_NAME
			FROM    CODE_MST, DUAL A
			WHERE   CD_GRP = 'DIVISION'
			ORDER   BY CD	
	
	</query>

	<!-- 그리드 헤더에 날짜를 표시하기 위한 리스트-->	
	<query id="grid_dates">
	
			SELECT  (CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+0, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+0, 'MM/DD (DY)') END) D01
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+1, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+1, 'MM/DD (DY)') END) D02
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+2, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+2, 'MM/DD (DY)') END) D03
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+3, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+3, 'MM/DD (DY)') END) D04
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+4, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+4, 'MM/DD (DY)') END) D05
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+5, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+5, 'MM/DD (DY)') END) D06
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+6, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+6, 'MM/DD (DY)') END) D07
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+7, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+7, 'MM/DD (DY)') END) D08
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+8, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+8, 'MM/DD (DY)') END) D09
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+9, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+9, 'MM/DD (DY)') END) D10
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+10, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+10, 'MM/DD (DY)') END) D11
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+11, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+11, 'MM/DD (DY)') END) D12
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+12, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+12, 'MM/DD (DY)') END) D13
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+13, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+13, 'MM/DD (DY)') END) D14
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+14, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+14, 'MM/DD (DY)') END) D15
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+15, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+15, 'MM/DD (DY)') END) D16
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+16, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+16, 'MM/DD (DY)') END) D17
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+17, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+17, 'MM/DD (DY)') END) D18
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+18, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+18, 'MM/DD (DY)') END) D19
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+19, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+19, 'MM/DD (DY)') END) D20
			        ,(CASE WHEN '$!{sdate} ' = ' ' THEN TO_CHAR(SYSDATE+20, 'MM/DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdate}','YYYY-MM-DD')+20, 'MM/DD (DY)') END) D21
			FROM 	DUAL

	</query>
	
	<!-- 선택한 제품의 작업장(포장) 리스트 -->
	<query id="daily_analysis_popup_proc_list">
	
			SELECT  DISTINCT IC.PROC_ID, HR.PROC_NAME
			FROM  	ITEM_CAPA IC, V_LAST_PROC_LIST HR
			WHERE  	IC.MADE_TYPE != 'DE'
			--AND	HR.MADE_BY != 'DE'
			AND  	HR.PLANT_ID = '$!{plant_id}'
			--AND  	HR.LVL_TYPE = '작업장'
			--AND  	HR.CAT = '포장'
			AND  	IC.ITEM_ID = '$!{item_id}'
			AND  	IC.PLANT_ID = '$!{plant_id}'
			AND  	IC.PROC_ID = HR.PROC_ID
			ORDER  	BY HR.PROC_NAME
	
	</query>
	
	<!-- 콤보박스:영업품종분류1 리스트조회 --> 
	<query id="combo_sales_cat1_list">
	
			SELECT  CM.CD, CM.CD_NAME
			FROM  	CODE_MST CM, (SELECT 'AA' A FROM DUAL) A
			WHERE  	CM.MADE_TYPE != 'DE'
			AND  	CM.CD_GRP = 'SALES_CAT1'
			ORDER  	BY CM.CD_NAME  
      				
	</query>
	
    <!-- 콤보박스:영업품종분류2 리스트조회 -->  
	<query id="combo_sales_cat2_list">
	
			SELECT  CM.CD, CM.CD_NAME
			FROM  	CODE_MST CM, (SELECT 'BB' A FROM DUAL) B
			WHERE  	CM.MADE_TYPE != 'DE'
			AND  	CM.CD_GRP = 'SALES_CAT2'
			ORDER  	BY CM.CD_NAME
      				
	</query>
	
	
	<!-- 콤보박스:품종특성분류 리스트조회 --> 
	<query id="combo_cat01_list">
	
			SELECT	DISTINCT(IM.CAT01)
			FROM	ITEM_MST IM
			WHERE	IM.CAT01 IS NOT NULL
			ORDER	BY IM.CAT01
      				
	</query>
	
	<!-- 품목 타입 구분 -->
	<query id="item_type_list"> 
			
			SELECT 	CM.CD, CM.CD_NAME
			FROM 	CODE_MST CM
			WHERE 	CM.MADE_TYPE != 'DE'
			AND 	CM.CD_GRP = 'ITYPE'
			ORDER 	BY CAT01
			
	</query>

<!--
=====================================================================================================
	생산계획 >> 일간 생산계획
=====================================================================================================
--> 

	<!-- 
	=======================
		공통 쿼리 
	=======================
	--> 
	
	<!-- 콤보박스:version 리스트조회 --> 
	<query id="combo_version_list">
	
            SELECT  EB.PLANT_ID, PV.VERSION, PV.SEQ, PV.STATUS                    
            FROM  	PLAN_VERSION_LOG PV, ENGN_BAT_MST EB
            WHERE  	PV.MADE_TYPE != 'DE'
            AND  	EB.MADE_TYPE != 'DE'
		    AND  	PV.PERIOD_TYPE = 'DAILY'
		    AND  	PV.PERIOD_TYPE = EB.PERIOD_TYPE 
		    AND  	PV.CAT_ID = EB.CAT_ID
		    AND  	PV.SUB_CAT = EB.SUB_CAT
		    AND  	PV.CAT_ID = 'PS'
		    AND  	PV.SEQ IS NOT NULL
		    --AND 	PV.STATUS = '23'                       
		    ORDER  	BY EB.PLANT_ID, PV.VERSION DESC, PV.SEQ DESC 
      				
	</query>
	
	<!-- 콤보박스:작업장 리스트조회 --> 
	<query id="combo_proc_list">
	
			SELECT  VH.PLANT_ID, VH.TEAM_ID, VH.PROC_ID, VH.PROC_NAME
			FROM  	V_LAST_PROC_LIST VH
			--WHERE 	VH.CAT = '포장'
			ORDER  	BY VH.PLANT_ID, VH.TEAM_ID, VH.PROC_ID, VH.PROC_NAME
      				
	</query>
	
	<!-- 
	=======================
		일간 생산계획 조회 
	=======================
	--> 
	
	<!-- 일간 생산 계획 조회 --> 
	<query id="sc_11010_dailyProductionPlant_list">			
		
            SELECT  HR.PLANT_NAME, HR.TEAM_NAME, HR.PROC_ID, HR.PROC_NAME, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC, DECODE(MTO_MTS_TYPE,'0001','MTO','MTS'), DS.VERSION, DS.SEQ 
                     ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                    /* 생산일별, SHIFT별 합계 */
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D01A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D01B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D01C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D02A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D02B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D02C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D03A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D03B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D03C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D04A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D04B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D04C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D05A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D05B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D05C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D06A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D06B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D06C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D07A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D07B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D07C 
                    /*
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D08A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D08B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D08C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D09A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D09B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D09C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D10A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D10B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D10C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D11A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D11B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D11C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D12A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D12B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D12C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D13A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D13B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D13C
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D14A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D14B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D14C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D15A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D15B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D15C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D16A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D16B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D16C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D17A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D17B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D17C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D18A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D18B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D18C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D19A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D19B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D19C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D20A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D20B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D20C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D21A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D21B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) D21C
                    */
                     ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                    /* 제품별 합계 */  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)             
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)        
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    /*
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)          
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)  
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN #if("$!{checked_uom}" == "box") DS.SHIFT_QTY #else DS.SHIFT_QTY * NVL(IM.QTY,1) #end ELSE 0 END) TOT
                    */
                    , IM.RECIPE_TYPE
            FROM    DAILY_SCH_PLAN_SHIFT DS, ITEM_MST IM, V_HRCHY_PROC HR
            WHERE   DS.CAT_ID = 'PS'
            AND     HR.CAT = '포장' -- 포장단 작업장(라인의 마지막 작업장)
            AND     HR.PLANT_ID    = DS.PLANT_ID
            AND     HR.PROC_ID = DS.PROC_ID
            AND     DS.ITEM_ID = IM.ITEM_ID 
            AND     DS.VERSION = '$!{version}'  
            AND     DS.SEQ = '$!{seq}'
            AND     HR.PLANT_ID = '$!{selected_plant}'--공장
            [AND    HR.TEAM_ID = '${selected_won}']--원가부문
            [AND    HR.PROC_ID = '${selected_proc}']--작업장
        #if("$!{checked_multi}" == "visual")
            AND     IM.MULTI_FLAG = 'V' -- VISUAL
        #elseif("$!{checked_multi}" == "multi")
            AND     IM.MULTI_FLAG = 'M' -- MULTI
        #elseif("$!{checked_multi}" == "normal")
            AND     IM.MULTI_FLAG IS NULL -- 전체
        #end    
            [AND    IM.SALES_CAT01 = '${selected_hr_type1}'] --SALES_CAT1(영업품종 분류1)
            [AND    IM.SALES_CAT02 = '${selected_hr_type}'] --SALES_CAT2(영업품종 분류2)
            AND     DS.PROD_DATES BETWEEN REPLACE(REPLACE('$!{sdate}','/',''),'-','') 
                                  AND     TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') -- 3주치
            [AND    IM.CAT01 = '${selected_cat01}'] -- 품종특성 
            GROUP   BY HR.PLANT_NAME, HR.TEAM_NAME, HR.PROC_ID, HR.PROC_NAME, IM.RECIPE_TYPE, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC, MTO_MTS_TYPE, DS.VERSION, DS.SEQ
            --ORDER   BY HR.PLANT_NAME, HR.TEAM_NAME, HR.PROC_ID, HR.PROC_NAME, IM.RECIPE_TYPE, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.LINE_ID, DS.VERSION, DS.SEQ    	
			ORDER	BY 1, 2, 3, 4, 5, IM.RECIPE_TYPE, 6, 7, 8, 9, 10 
			
	</query>
	
	<!-- 일간 생산 계획 조회 : 상세정보 --> 
	<query id="sc_11010_dailyProductionPlantDetailInfo_list">
	
            /* 
                수량 더블클릭 시 생산계획 DETAIL 정보
            */
            SELECT  IM.ITEM_NAME, DS.ITEM_ID, IM.SPEC, DS.WO_ID, DS.PROC_ID, DS.PRIORITY, 
                    TO_CHAR(DS.START_DTTM,'YYYY-MM-DD HH24:MI:SS') START_DTTM, 
                    TO_CHAR(DS.END_DTTM,'YYYY-MM-DD HH24:MI:SS') END_DTTM, 
                    CM.CD_NAME, IM.CAT01, 
                    TRIM(DS.ORD_NO) ORD_NO
            FROM    DAILY_SCH_PLAN_SHIFT DS, ITEM_MST IM, CODE_MST CM    
            WHERE   DS.ITEM_ID = IM.ITEM_ID(+)
            AND     IM.SALES_CAT02 = CM.CD(+)
            AND     CM.CD_GRP(+) = 'SALES_CAT2'
            AND     DS.CAT_ID = 'PS'                    
            AND     DS.PLANT_ID = '$!{plant_id}'                    
            AND     DS.VERSION = '$!{version}'
            AND     DS.SEQ = '$!{seq}'              
            AND     DS.ITEM_ID = '$!{item_id}'
            AND     DS.PROC_ID = '$!{proc_id}'
            AND     DS.PROD_DATES = '$!{prod_dates}'
            AND     DS.SHIFT_TYPE = '$!{shift_type}'
            ORDER   BY IM.ITEM_NAME, DS.ITEM_ID, IM.SPEC, DS.WO_ID, DS.PROC_ID, DS.PRIORITY, 
                       DS.START_DTTM		
	
	</query>
	
	<!-- 일간 생산 계획 조회 : POPUP -->
	<query id="sc_11010_dailyProductionPlant_popup">
	
			SELECT  DP.WO_ID, 
			        HR.PROC_NAME,
			        TO_CHAR(DS.START_DTTM, 'YYYY-MM-DD')    START_DATE,
			        TO_CHAR(DS.START_DTTM, 'HH24MISS')      START_MIN,
			        TO_CHAR(DS.END_DTTM, 'YYYY-MM-DD')      END_DATE,
			        TO_CHAR(DS.END_DTTM, 'HH24MISS' )       END_MIN,
			        DS.SHIFT_TYPE,
			        DS.SHIFT_QTY,
			        DS.ITEM_ID,
			        IM.ITEM_NAME
			FROM    DAILY_SCH_PLAN_SHIFT    DS,
			        (    
			        /*
			            해당 공장의 작업장 리스트
			        */ 
			        SELECT  HR.HID PROC_ID, HR.HID_NAME PROC_NAME
			        FROM    HRCHY HR
			        WHERE   HR.MADE_TYPE != 'DE'
			        AND     HR.HTYPE = '$!{plant_id}'
			        )   HR,
			        (
			        /*
			            해당 조건의 WO_ID 리스트
			        */
			        SELECT  DS.CAT_ID, DS.PLANT_ID, DS.VERSION, DS.SEQ, DS.WO_ID
			        FROM    DAILY_SCH_PLAN_SHIFT DS
			        WHERE   DS.MADE_TYPE != 'DE'
			        AND     DS.CAT_ID = 'PS'
			        AND     DS.PLANT_ID = '$!{plant_id}'
			        AND     DS.PROC_ID = '$!{proc_id}'
			        AND     DS.ITEM_ID = '$!{item_id}'
			        AND     DS.VERSION = '$!{version}'
			        AND     DS.SEQ = '$!{seq}'
			        AND     DS.PROD_DATES BETWEEN REPLACE(REPLACE('$!{sdate}','/',''),'-','') 
			                              AND     TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD')
			        [AND    DS.PROD_DATES = '${prod_dates}']
			        [AND    DS.SHIFT_TYPE = '${shift_type}']
			        )   DP, 
			        ITEM_MST    IM
			WHERE   DS.VERSION = DP.VERSION
			AND     DS.SEQ     = DP.SEQ
			AND     DS.CAT_ID  = DP.CAT_ID
			AND     DS.PLANT_ID = DP.PLANT_ID
			AND     DS.WO_ID    = DP.WO_ID  
			AND     DS.PROC_ID = HR.PROC_ID(+)
			AND     DS.ITEM_ID = IM.ITEM_ID(+)
			ORDER   BY 3, 4, 7
	
	</query> 	
		
	<!--
	======================================================================
		유통가공품 생산계획 조회
	======================================================================
	-->
	
	<!-- 유통가공품 생산계획 조회 -->
	<query id="sc_11050_dailyEtcPlan_list">
	
			SELECT  CM.CD_NAME, SE.ITEM_ID, IM.ITEM_NAME, IM.SPEC, SE.PLANT_ID, SE.DC_ID 
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+0 THEN SE.QTY  ELSE 0 END) 
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+1 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+2 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+3 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+4 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+5 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+6 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+7 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+8 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+9 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+10 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+11 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+12 THEN SE.QTY  ELSE 0 END) 
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+13 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+14 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+15 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+16 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+17 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+18 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+19 THEN SE.QTY  ELSE 0 END)
                    + SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+20 THEN SE.QTY  ELSE 0 END) TOT
                    -------------------------------------------------------------------------------------------------
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+0 THEN SE.QTY  ELSE 0 END) D01
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+1 THEN SE.QTY  ELSE 0 END) D02
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+2 THEN SE.QTY  ELSE 0 END) D03
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+3 THEN SE.QTY  ELSE 0 END) D04
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+4 THEN SE.QTY  ELSE 0 END) D05
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+5 THEN SE.QTY  ELSE 0 END) D06
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+6 THEN SE.QTY  ELSE 0 END) D07
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+7 THEN SE.QTY  ELSE 0 END) D08
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+8 THEN SE.QTY  ELSE 0 END) D09
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+9 THEN SE.QTY  ELSE 0 END) D10
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+10 THEN SE.QTY  ELSE 0 END) D11
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+11 THEN SE.QTY  ELSE 0 END) D12
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+12 THEN SE.QTY  ELSE 0 END) D13 
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+13 THEN SE.QTY  ELSE 0 END) D14
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+14 THEN SE.QTY  ELSE 0 END) D15
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+15 THEN SE.QTY  ELSE 0 END) D16
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+16 THEN SE.QTY  ELSE 0 END) D17
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+17 THEN SE.QTY  ELSE 0 END) D18
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+18 THEN SE.QTY  ELSE 0 END) D19
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+19 THEN SE.QTY  ELSE 0 END) D20
                    , SUM(CASE WHEN SE.PROD_DATES = TO_DATE('$!{sdate}','YYYY-MM-DD')+20 THEN SE.QTY  ELSE 0 END) D21
			  FROM  SCH_ETC_PLAN SE, ITEM_MST IM
			  		, (	SELECT  CM.CD, CM.CD_NAME
			  			  FROM  CODE_MST CM
			  			 WHERE  CM.MADE_TYPE != 'DE'
			  			   AND  CM.CD_GRP = 'ETC_PLANT' ) CM  -- 유통가공품 생산 공장
			 WHERE  SE.MADE_TYPE != 'DE'
			   AND  IM.MADE_TYPE != 'DE'
			   AND  SE.ITEM_ID = IM.ITEM_ID(+)
			   AND  SE.PLANT_ID = CM.CD(+)
			   AND  SE.PERIOD_TYPE = 'DAILY'
			   AND  SE.VERSION = '$!{selected_version}' --계획버전
			  [AND  SE.PLANT_ID = '${selected_plant}'] --공장
			   AND  SE.PROD_DATES BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{sdate}','YYYY-MM-DD')+20 --기간
			 GROUP  BY CM.CD_NAME, SE.ITEM_ID, IM.ITEM_NAME, IM.SPEC, SE.PLANT_ID, SE.DC_ID
			 ORDER  BY CM.CD_NAME, SE.ITEM_ID, IM.ITEM_NAME, IM.SPEC, SE.PLANT_ID, SE.DC_ID
	
	</query>
	
	<!-- 계획버전 리스트 -->
	<query id="etc_combo_version_list">
	
            SELECT  PVL.VERSION, ROWNUM NUM, PVL.STATUS
              FROM  (
			          SELECT  PV.VERSION, PV.STATUS
			            FROM  PLAN_VERSION_LOG PV
			           WHERE  PV.MADE_TYPE != 'DE'
                         AND  PV.PERIOD_TYPE = 'DAILY'
			             AND  PV.CAT_ID = 'ES'
			             AND  PV.VERSION IS NOT NULL
			             --AND  PV.STATUS = '23'
			           ORDER  BY PV.VERSION DESC
			        ) PVL
			 WHERE  ROWNUM &lt; 21 	
	
	</query>
	
	<!-- 공장 리스트-->
	<query id="etc_combo_plant_list">
	
			SELECT  SE.VERSION, CM.CD, CM.CD_NAME
			  FROM  (   SELECT  DISTINCT SE.VERSION, SE.PLANT_ID 
			              FROM  SCH_ETC_PLAN SE
			             WHERE  SE.MADE_TYPE != 'DE' ) SE
			        , (    SELECT  CM.CD, CM.CD_NAME
			                 FROM  CODE_MST CM
			                WHERE  CM.MADE_TYPE != 'DE'
			                  AND  CM.CD_GRP = 'ETC_PLANT' ) CM               
			 WHERE  SE.PLANT_ID = CM.CD
	
	</query>
	
	<!-- 유통가공품 생산계획 조회 : 참조정보 -->
	<query id="sc_11050_dailyEtcPlanReferenceInfo_list">
	
			SELECT  MB.PROD_ITEM_ID, IMA.ITEM_NAME, MB.CONS_ITEM_ID, IMB.ITEM_NAME || ' X ' || MB.CONS_QTY/MB.PROD_QTY CONS_NAME
			        , (MB.CONS_QTY/MB.PROD_QTY)*'$!{tot}' NEED_QTY, NVL(ES.QTY, 0) NOW_QTY
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+0 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D01
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+1 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D02
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+2 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D03
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+3 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D04
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+4 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D05
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+5 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D06
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+6 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D07
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+7 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D08
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+8 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D09
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+9 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D10
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+10 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D11
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+11 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D12
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+12 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D13
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+13 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D14
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+14 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D15
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+15 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D16
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+16 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D17
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+17 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D18
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+18 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D19
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+19 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D20
			        , (CASE WHEN TP.TRANS_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+20 AND TP.TRANS_DATE > SYSDATE THEN TP.ADD_STK_QTY ELSE 0 END) D21	
			  FROM  MBOM MB, ITEM_MST IMA, ITEM_MST IMB
			        , ( SELECT  TP.TRANS_DATE, TP.TGT_LOC, TP.ITEM_ID, TP.ADD_STK_QTY
			              FROM  TRANS_PLAN TP
			             WHERE  TP.MADE_TYPE != 'DE'
			               AND  TP.TGT_LOC = '$!{dc_id}'
			               AND  TP.VERSION = ( SELECT MAX(VERSION) FROM TRANS_PLAN ) ) TP -- 예상재고
			        , ( SELECT  ES.ITEM_ID, ES.QTY
			              FROM  ERP_STOCK ES
			             WHERE  ES.MADE_TYPE != 'DE'   
			               AND  ES.LOC_ID = '$!{dc_id}'
			               AND  ES.USABLE_DATE = TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD') ) ES -- 현재재고
			 WHERE  MB.MADE_TYPE != 'DE'
			   AND  IMA.MADE_TYPE != 'DE'
			   AND  IMB.MADE_TYPE != 'DE'
			   AND  MB.PLANT_ID = '$!{plant_id}'
			   AND  MB.CONS_ITEM_ID = TP.ITEM_ID(+)
			   AND  MB.PROD_ITEM_ID = '$!{item_id}'
			   AND  MB.PROD_ITEM_ID = IMA.ITEM_ID(+)
			   AND  MB.CONS_ITEM_ID = IMB.ITEM_ID(+)
			   AND  MB.CONS_ITEM_ID = ES.ITEM_ID(+)
			   AND  MB.CONS_ITEM_TYPE != 'HAWA'
			                                         
			UNION                                  
			SELECT  MB.PROD_ITEM_ID, IMA.ITEM_NAME, MB.CONS_ITEM_ID, IMB.ITEM_NAME || ' X ' || MB.CONS_QTY/MB.PROD_QTY CONS_NAME
			        , (MB.CONS_QTY/MB.PROD_QTY)*'$!{tot}' NEED_QTY, NVL(ES.QTY, 0) NOW_QTY
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+0 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D01
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+1 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D02
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+2 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D03
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+3 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D04
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+4 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D05
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+5 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D06
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+6 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D07
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+7 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D08
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+8 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D09
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+9 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D10
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+10 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D11
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+11 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D12
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+12 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D13
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+13 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D14
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+14 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D15
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+15 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D16
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+16 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D17
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+17 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D18
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+18 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D19
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+19 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D20
			        , (CASE WHEN MS.AVAIL_DATE = TO_DATE('$!{sdate}','YYYY-MM-DD')+20 AND MS.AVAIL_DATE > SYSDATE THEN MS.QTY ELSE 0 END) D21
			  FROM  MBOM MB, ITEM_MST IMA, ITEM_MST IMB
			        , ( SELECT  MS.AVAIL_DATE, MS.LOC_ID, MS.ITEM_ID, MS.QTY
			              FROM  MAT_STORE_PLAN MS
			             WHERE  MS.MADE_TYPE != 'DE'
			               AND  MS.LOC_ID = '$!{dc_id}'
			               AND  MS.IF_DTTM = ( SELECT MAX(IF_DTTM) FROM MAT_STORE_PLAN ) ) MS -- 예상재고
			        , ( SELECT  ES.ITEM_ID, ES.QTY
			              FROM  ERP_STOCK ES
			             WHERE  ES.MADE_TYPE != 'DE'   
			               AND  ES.LOC_ID = '$!{dc_id}'
			               AND  ES.USABLE_DATE = TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD') ) ES -- 현재재고
			 WHERE  MB.MADE_TYPE != 'DE'
			   AND  IMA.MADE_TYPE != 'DE'
			   AND  IMB.MADE_TYPE != 'DE'
			   AND  MB.PLANT_ID = '$!{plant_id}'
			   AND  MB.CONS_ITEM_ID = MS.ITEM_ID(+)
			   AND  MB.PROD_ITEM_ID = '$!{item_id}'
			   AND  MB.PROD_ITEM_ID = IMA.ITEM_ID(+)
			   AND  MB.CONS_ITEM_ID = IMB.ITEM_ID(+)
			   AND  MB.CONS_ITEM_ID = ES.ITEM_ID(+)
			   AND  MB.CONS_ITEM_TYPE = 'HAWA'
			------------------------------------------------------------------------------------------------------------------
			 ORDER  BY 2, 4
	</query>
	
	<!--
	======================================================================
		생산계획 대비 생산실적 조회
	======================================================================
	-->
	
	<!-- 생산계획 대비 생산실적 조회 -->
	<query id="sc_11040_planVsActualResult_list" paging="true">
	
           with V_LST
              as (
                    SELECT  DS.PLANT_NAME, DS.PROC_ID, DS.PROC_NAME, DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC,
                            (PL01+PL02+PL03+PL04+PL05+PL06+PL07+PL08+PL09+PL10+PL11+PL12+PL13+PL14+PL15
                            +PL16+PL17+PL18+PL19+PL20+PL21) AS TOT_PL, -- 생산 계획량 합계
                            NVL((PO01+PO02+PO03+PO04+PO05+PO06+PO07+PO08+PO09+PO10+PO11+PO12+PO13+PO14+PO15
                            +PO16+PO17+PO18+PO19+PO20+PO21),0) AS TOT_PO, -- 실적량 합계
                            NVL(CASE
                                WHEN (PO01+PO02+PO03+PO04+PO05+PO06+PO07+PO08+PO09+PO10+PO11+PO12+PO13+PO14+PO15
                                      +PO16+PO17+PO18+PO19+PO20+PO21) = 0
                                THEN
                                        0
                                ELSE
                                        DECODE((PL01+PL02+PL03+PL04+PL05+PL06+PL07+PL08+PL09+PL10+PL11+PL12+PL13+PL14+PL15
                                        +PL16+PL17+PL18+PL19+PL20+PL21),0,0,
										(PO01+PO02+PO03+PO04+PO05+PO06+PO07+PO08+PO09+PO10+PO11+PO12+PO13+PO14+PO15
                                        +PO16+PO17+PO18+PO19+PO20+PO21)/
                                        (PL01+PL02+PL03+PL04+PL05+PL06+PL07+PL08+PL09+PL10+PL11+PL12+PL13+PL14+PL15
                                        +PL16+PL17+PL18+PL19+PL20+PL21) * 100)
                                END,0)     TOT_RATE, -- 합계 비율
                            PL01, NVL(PO01,0) as A01 , NVL(RATE01,0) as R01 , -- 계획량, 실적량, 비율
                            PL02, NVL(PO02,0) as A02 , NVL(RATE02,0) as R02 ,                        
                            PL03, NVL(PO03,0) as A03 , NVL(RATE03,0) as R03 ,                        
                            PL04, NVL(PO04,0) as A04 , NVL(RATE04,0) as R04 ,                        
                            PL05, NVL(PO05,0) as A05 , NVL(RATE05,0) as R05 ,                        
                            PL06, NVL(PO06,0) as A06 , NVL(RATE06,0) as R06 ,                        
                            PL07, NVL(PO07,0) as A07 , NVL(RATE07,0) as R07 ,                        
                            PL08, NVL(PO08,0) as A08 , NVL(RATE08,0) as R08 ,                        
                            PL09, NVL(PO09,0) as A09 , NVL(RATE09,0) as R09 ,                        
                            PL10, NVL(PO10,0) as A10,  NVL(RATE10,0) as R10,                        
                            PL11, NVL(PO11,0) as A11,  NVL(RATE11,0) as R11,                        
                            PL12, NVL(PO12,0) as A12,  NVL(RATE12,0) as R12,                        
                            PL13, NVL(PO13,0) as A13,  NVL(RATE13,0) as R13,                        
                            PL14, NVL(PO14,0) as A14,  NVL(RATE14,0) as R14,                        
                            PL15, NVL(PO15,0) as A15,  NVL(RATE15,0) as R15,                        
                            PL16, NVL(PO16,0) as A16,  NVL(RATE16,0) as R16,                        
                            PL17, NVL(PO17,0) as A17,  NVL(RATE17,0) as R17,                        
                            PL18, NVL(PO18,0) as A18,  NVL(RATE18,0) as R18,                        
                            PL19, NVL(PO19,0) as A19,  NVL(RATE19,0) as R19,                        
                            PL20, NVL(PO20,0) as A20,  NVL(RATE20,0) as R20,                        
                            PL21, NVL(PO21,0) as A21,  NVL(RATE21,0) as R21                         
                    FROM    (
                                SELECT  DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC, DS.PLANT_NAME, DS.PROC_ID, DS.PROC_NAME,
                                        /* 생산일자 별 계획량, 실적량, 비율 */
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL01,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO01,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE01,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL02,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO02,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE02,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL03,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO03,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE03,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL04,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO04,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE04,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL05,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO05,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE05,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL06,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO06,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE06,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL07,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO07,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE07,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL08,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO08,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE08,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL09,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO09,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE09,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL10,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO10,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE10,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL11,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO11,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE11,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL12,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO12,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE12,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL13,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO13,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE13,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL14,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO14,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE14,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL15,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO15,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE15,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL16,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO16,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE16,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL17,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO17,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE17,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL18,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO18,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE18,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL19,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO19,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE19,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL20,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO20,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE20,
                                        ----------------------------------------------------------------------------------------------------------------
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL21,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO21,
                                        DECODE(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.QTY ELSE 0 END),0,0,
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
                                        SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100) AS RATE21
                                        ----------------------------------------------------------------------------------------------------------------
                                FROM    (
                                        SELECT  S1.ITEM_ID      ITEM_ID,
                                                S2.ITEM_NAME    ITEM_NAME,
                                                S2.SPEC         SPEC,
                                                S3.PLANT_NAME   PLANT_NAME,
                                                S1.PROC_ID      PROC_ID,
                                                S4.PROC_NAME    PROC_NAME,
                                                S1.PROD_DATES   PROD_DATES,
                                                SUM(PLAN_BOX)   QTY,
                                                SUM(REST_BOX)   COMPL_QTY
                                        FROM    (
                                                /* ERP 생산계획 FROM MES */
                                                SELECT  T1.START_DATE       PROD_DATES,
                                                        T1.PLANT_ID         PLANT_ID,
                                                        T1.PROC_ID          PROC_ID,
                                                        T1.ITEM_ID	        ITEM_ID,
                                                        SUM(T1.QTY)    		PLAN_BOX,
                                                        0                   REST_BOX
                                                FROM    V_IF_MES_SCH_PLAN    T1,
                                                        ITEM_MST    T2,
                                                        (
                                                         /* 마지막 공정정보 */
                                                        SELECT  S1.PLANT_ID,
                                                                S1.ITEM_ID,
                                                                S1.PROD_VER,
                                                                MAX(S1.PROC_ID)    PROC_ID
                                                        FROM    ITEM_CAPA    S1,
                                                                (
                                                                SELECT  PLANT_ID, ITEM_ID, PROD_VER, MAX(OPER_ID) OPER_ID
                                                                FROM    ITEM_CAPA
                                                                GROUP
                                                                BY      PLANT_ID, ITEM_ID, PROD_VER
                                                                )        S2
                                                        WHERE   S1.MADE_TYPE != 'DE'
                                                        AND     S1.PLANT_ID   = S2.PLANT_ID
                                                        AND     S1.ITEM_ID    = S2.ITEM_ID
                                                        AND     S1.PROD_VER   = S2.PROD_VER
                                                        AND     S1.OPER_ID    = S2.OPER_ID
                                                        GROUP
                                                        BY      S1.PLANT_ID,S1.ITEM_ID,    S1.PROD_VER
                                                        )            T3
                                                WHERE   T1.PLANT_ID        = T3.PLANT_ID
                                                AND     T1.ITEM_ID    = T2.ITEM_ID
                                                AND     T1.START_DATE    BETWEEN TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD'),'YYYYMMDD')
                                                                                    AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD')
                                                AND     T1.ITEM_ID    	= T3.ITEM_ID
                                                AND     T1.PROC_ID      = T3.PROC_ID
                                                GROUP
                                                BY      T1.START_DATE,
                                                        T1.PLANT_ID,
                                                        T1.PROC_ID,
                                                        T1.ITEM_ID
                                                UNION   ALL
                                                /* MES생산실적 */
                                                SELECT  T1.WORK_DATE    PROD_DATES,
                                                        T1.PLANT        PLANT_ID,
                                                        T1.WC            PROC_ID,
                                                        T1.MATR_CODE    ITEM_ID,
                                                        0                    PLAN_BOX,
                                                        SUM(T1.WORK_QTY)            REST_BOX
                                                FROM    PP30T110        T1,
                                                        ITEM_MST        T2,
                                                        (
                                                         /* 마지막 공정정보 */
                                                        SELECT  S1.PLANT_ID,
                                                                S1.ITEM_ID,
                                                                S1.PROD_VER,
                                                                MAX(S1.PROC_ID)    PROC_ID
                                                        FROM    ITEM_CAPA    S1,
                                                                (
                                                                SELECT  PLANT_ID, ITEM_ID, PROD_VER, MAX(OPER_ID) OPER_ID
                                                                FROM    ITEM_CAPA
                                                                GROUP
                                                                BY      PLANT_ID, ITEM_ID, PROD_VER
                                                                )        S2
                                                        WHERE   S1.MADE_TYPE != 'DE'
                                                        AND     S1.PLANT_ID    = S2.PLANT_ID
                                                        AND     S1.ITEM_ID    = S2.ITEM_ID
                                                        AND     S1.PROD_VER = S2.PROD_VER
                                                        AND     S1.OPER_ID    = S2.OPER_ID
                                                        GROUP
                                                        BY      S1.PLANT_ID,S1.ITEM_ID,    S1.PROD_VER
                                                        )            T3
                                                WHERE   T1.MATR_CODE    = T2.ITEM_ID
                                                AND     T1.PLANT        = T3.PLANT_ID
                                                AND     T1.MATR_CODE    = T3.ITEM_ID
                                                AND     T1.WC           = T3.PROC_ID
                                                AND     T1.WORK_DATE    BETWEEN TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD'),'YYYYMMDD')
                                                                                   AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD')
                                                GROUP
                                                BY      T1.WORK_DATE,
                                                        T1.PLANT,
                                                        T1.WC,
                                                        T1.MATR_CODE
                                                )            S1,
                                                ITEM_MST    S2,
                                                (
                                                SELECT  HID            PLANT_ID,
                                                        HID_NAME    PLANT_NAME
                                                FROM    HRCHY
                                                WHERE   LVL_TYPE    = '공장'
                                                )        S3,
                                                (
                                                SELECT  HTYPE        PLANT_ID,
                                                        HID            PROC_ID,
                                                        HID_NAME    PROC_NAME
                                                FROM    HRCHY
                                                WHERE   LVL_TYPE    = '작업장'
                                                )        S4
                                        WHERE   S1.PLANT_ID    = S3.PLANT_ID
                                        AND     S1.PLANT_ID    = S4.PLANT_ID
                                        AND     S1.ITEM_ID    = S2.ITEM_ID
                                        AND     S1.PROC_ID      = S4.PROC_ID
                                        AND     S1.PLANT_ID = '$!{selected_plant}'
                                        [AND    S1.ITEM_ID LIKE '%${item_id}%']  
                                        [AND    S2.ITEM_NAME LIKE '%${item_name}%']
                                        GROUP
                                        BY      S1.ITEM_ID,
                                                S2.ITEM_NAME,
                                                S2.SPEC,
                                                S3.PLANT_NAME,
                                                S1.PROC_ID,
                                                S4.PROC_NAME,
                                                S1.PROD_DATES
                                        ) DS
                                GROUP   BY   DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC, DS.PLANT_NAME, DS.PROC_ID, DS.PROC_NAME
                            ) DS
                )
                select PLANT_NAME ,PROC_ID ,
                case when seq=1 then PROC_NAME
                	 when seq=2 then '소계'
                	 when seq=3 then '총계'
                end  PROC_NAME 
                ,ITEM_ID ,ITEM_NAME ,SPEC 
          ,to_char(TOT_PL,'FM999,999,999') as TOT_PL
          ,to_char(TOT_PO,'FM999,999,999') as TOT_PO 
          ,to_char(case when SEQ=2 then sum(case when seq=1 then TOT_RATE end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and TOT_RATE!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)     when SEQ=3 then sum(case when seq=3 then TOT_RATE end) over( partition by PLANT_NAME  order by 1)/sum(case when SEQ=1 and TOT_RATE!=0 then 1 end) over( partition by PLANT_NAME  order by 1)    else TOT_RATE end,'FM999,990.0') as TOT_RATE
          ,to_char(PL01,'FM999,999,999') as PL01     ,to_char(A01,'FM999,999,999') as A01    ,to_char(case when SEQ=2 then sum(case when seq=1 then R01 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R01!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R01) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R01!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R01 end,'FM999,990.0') as R01
          ,to_char(PL02,'FM999,999,999') as PL02     ,to_char(A02,'FM999,999,999') as A02    ,to_char(case when SEQ=2 then sum(case when seq=1 then R02 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R02!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R02) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R02!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R02 end,'FM999,990.0') as R02
          ,to_char(PL03,'FM999,999,999') as PL03     ,to_char(A03,'FM999,999,999') as A03    ,to_char(case when SEQ=2 then sum(case when seq=1 then R03 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R03!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R03) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R03!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R03 end,'FM999,990.0') as R03
          ,to_char(PL04,'FM999,999,999') as PL04     ,to_char(A04,'FM999,999,999') as A04    ,to_char(case when SEQ=2 then sum(case when seq=1 then R04 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R04!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R04) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R04!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R04 end,'FM999,990.0') as R04
          ,to_char(PL05,'FM999,999,999') as PL05     ,to_char(A05,'FM999,999,999') as A05    ,to_char(case when SEQ=2 then sum(case when seq=1 then R05 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R05!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R05) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R05!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R05 end,'FM999,990.0') as R05
          ,to_char(PL06,'FM999,999,999') as PL06     ,to_char(A06,'FM999,999,999') as A06    ,to_char(case when SEQ=2 then sum(case when seq=1 then R06 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R06!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R06) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R06!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R06 end,'FM999,990.0') as R06
          ,to_char(PL07,'FM999,999,999') as PL07     ,to_char(A07,'FM999,999,999') as A07    ,to_char(case when SEQ=2 then sum(case when seq=1 then R07 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R07!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R07) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R07!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R07 end,'FM999,990.0') as R07
          ,to_char(PL08,'FM999,999,999') as PL08     ,to_char(A08,'FM999,999,999') as A08    ,to_char(case when SEQ=2 then sum(case when seq=1 then R08 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R08!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R08) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R08!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R08 end,'FM999,990.0') as R08
          ,to_char(PL09,'FM999,999,999') as PL09     ,to_char(A09,'FM999,999,999') as A09    ,to_char(case when SEQ=2 then sum(case when seq=1 then R09 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R09!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R09) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R09!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R09 end,'FM999,990.0') as R09
          ,to_char(PL10,'FM999,999,999') as PL10     ,to_char(A10,'FM999,999,999') as A10    ,to_char(case when SEQ=2 then sum(case when seq=1 then R10 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R10!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R10) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R10!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R10 end,'FM999,990.0') as R10
          ,to_char(PL11,'FM999,999,999') as PL11     ,to_char(A11,'FM999,999,999') as A11    ,to_char(case when SEQ=2 then sum(case when seq=1 then R11 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R11!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R11) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R11!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R11 end,'FM999,990.0') as R11
          ,to_char(PL12,'FM999,999,999') as PL12     ,to_char(A12,'FM999,999,999') as A12    ,to_char(case when SEQ=2 then sum(case when seq=1 then R12 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R12!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R12) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R12!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R12 end,'FM999,990.0') as R12
          ,to_char(PL13,'FM999,999,999') as PL13     ,to_char(A13,'FM999,999,999') as A13    ,to_char(case when SEQ=2 then sum(case when seq=1 then R13 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R13!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R13) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R13!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R13 end,'FM999,990.0') as R13
          ,to_char(PL14,'FM999,999,999') as PL14     ,to_char(A14,'FM999,999,999') as A14    ,to_char(case when SEQ=2 then sum(case when seq=1 then R14 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R14!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R14) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R14!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R14 end,'FM999,990.0') as R14
          ,to_char(PL15,'FM999,999,999') as PL15     ,to_char(A15,'FM999,999,999') as A15    ,to_char(case when SEQ=2 then sum(case when seq=1 then R15 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R15!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R15) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R15!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R15 end,'FM999,990.0') as R15
          ,to_char(PL16,'FM999,999,999') as PL16     ,to_char(A16,'FM999,999,999') as A16    ,to_char(case when SEQ=2 then sum(case when seq=1 then R16 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R16!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R16) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R16!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R16 end,'FM999,990.0') as R16
          ,to_char(PL17,'FM999,999,999') as PL17     ,to_char(A17,'FM999,999,999') as A17    ,to_char(case when SEQ=2 then sum(case when seq=1 then R17 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R17!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R17) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R17!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R17 end,'FM999,990.0') as R17
          ,to_char(PL18,'FM999,999,999') as PL18     ,to_char(A18,'FM999,999,999') as A18    ,to_char(case when SEQ=2 then sum(case when seq=1 then R18 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R18!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R18) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R18!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R18 end,'FM999,990.0') as R18
          ,to_char(PL19,'FM999,999,999') as PL19     ,to_char(A19,'FM999,999,999') as A19    ,to_char(case when SEQ=2 then sum(case when seq=1 then R19 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R19!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R19) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R19!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R19 end,'FM999,990.0') as R19
          ,to_char(PL20,'FM999,999,999') as PL20     ,to_char(A20,'FM999,999,999') as A20    ,to_char(case when SEQ=2 then sum(case when seq=1 then R20 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R20!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R20) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R20!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R20 end,'FM999,990.0') as R20
          ,to_char(PL21,'FM999,999,999') as PL21     ,to_char(A21,'FM999,999,999') as A21    ,to_char(case when SEQ=2 then sum(case when seq=1 then R21 end) over( partition by PLANT_NAME ,PROC_ID order by 1)/sum(case when SEQ=1 and R21!=0 then 1 end) over( partition by PLANT_NAME ,PROC_ID order by 1)      when SEQ=3 then sum(R21) over( partition by PLANT_NAME order by 1)/sum(case when SEQ=1 and R21!=0 then 1 end) over( partition by PLANT_NAME order by 1)    else R21 end,'FM999,990.0') as R21
      from (    
            select case when grouping(LST.PLANT_NAME)||grouping(LST.PROC_ID)||grouping(LST.PROC_NAME)||grouping(LST.ITEM_ID)||grouping(LST.ITEM_NAME)||grouping(LST.SPEC)='000000' then 1
                        when grouping(LST.PLANT_NAME)||grouping(LST.PROC_ID)||grouping(LST.PROC_NAME)||grouping(LST.ITEM_ID)||grouping(LST.ITEM_NAME)||grouping(LST.SPEC)='001111' then 2  
                        when grouping(LST.PLANT_NAME)||grouping(LST.PROC_ID)||grouping(LST.PROC_NAME)||grouping(LST.ITEM_ID)||grouping(LST.ITEM_NAME)||grouping(LST.SPEC)='011111' then 3  
                    end  as SEQ
                  ,LST.PLANT_NAME ,LST.PROC_ID ,LST.PROC_NAME ,LST.ITEM_ID ,LST.ITEM_NAME ,LST.SPEC 
                  ,sum(LST.TOT_PL) as TOT_PL       ,sum(LST.TOT_PO) as TOT_PO       ,sum(LST.TOT_RATE) as TOT_RATE
                  ,sum(LST.PL01  ) as PL01         ,sum(LST.A01   ) as A01          ,sum(LST.R01     ) as R01     
                  ,sum(LST.PL02  ) as PL02         ,sum(LST.A02   ) as A02          ,sum(LST.R02     ) as R02     
                  ,sum(LST.PL03  ) as PL03         ,sum(LST.A03   ) as A03          ,sum(LST.R03     ) as R03     
                  ,sum(LST.PL04  ) as PL04         ,sum(LST.A04   ) as A04          ,sum(LST.R04     ) as R04     
                  ,sum(LST.PL05  ) as PL05         ,sum(LST.A05   ) as A05          ,sum(LST.R05     ) as R05     
                  ,sum(LST.PL06  ) as PL06         ,sum(LST.A06   ) as A06          ,sum(LST.R06     ) as R06     
                  ,sum(LST.PL07  ) as PL07         ,sum(LST.A07   ) as A07          ,sum(LST.R07     ) as R07     
                  ,sum(LST.PL08  ) as PL08         ,sum(LST.A08   ) as A08          ,sum(LST.R08     ) as R08     
                  ,sum(LST.PL09  ) as PL09         ,sum(LST.A09   ) as A09          ,sum(LST.R09     ) as R09     
                  ,sum(LST.PL10  ) as PL10         ,sum(LST.A10   ) as A10          ,sum(LST.R10     ) as R10     
                  ,sum(LST.PL11  ) as PL11         ,sum(LST.A11   ) as A11          ,sum(LST.R11     ) as R11     
                  ,sum(LST.PL12  ) as PL12         ,sum(LST.A12   ) as A12          ,sum(LST.R12     ) as R12     
                  ,sum(LST.PL13  ) as PL13         ,sum(LST.A13   ) as A13          ,sum(LST.R13     ) as R13     
                  ,sum(LST.PL14  ) as PL14         ,sum(LST.A14   ) as A14          ,sum(LST.R14     ) as R14     
                  ,sum(LST.PL15  ) as PL15         ,sum(LST.A15   ) as A15          ,sum(LST.R15     ) as R15     
                  ,sum(LST.PL16  ) as PL16         ,sum(LST.A16   ) as A16          ,sum(LST.R16     ) as R16     
                  ,sum(LST.PL17  ) as PL17         ,sum(LST.A17   ) as A17          ,sum(LST.R17     ) as R17     
                  ,sum(LST.PL18  ) as PL18         ,sum(LST.A18   ) as A18          ,sum(LST.R18     ) as R18     
                  ,sum(LST.PL19  ) as PL19         ,sum(LST.A19   ) as A19          ,sum(LST.R19     ) as R19     
                  ,sum(LST.PL20  ) as PL20         ,sum(LST.A20   ) as A20          ,sum(LST.R20     ) as R20     
                  ,sum(LST.PL21  ) as PL21         ,sum(LST.A21   ) as A21          ,sum(LST.R21     ) as R21     
              from V_LST LST
             group by cube(LST.PLANT_NAME ,LST.PROC_ID ,LST.PROC_NAME ,LST.ITEM_ID ,LST.ITEM_NAME ,LST.SPEC)
             having grouping(LST.PLANT_NAME)||grouping(LST.PROC_ID)||grouping(LST.PROC_NAME)||grouping(LST.ITEM_ID)||grouping(LST.ITEM_NAME)||grouping(LST.SPEC)='000000'
                 or grouping(LST.PLANT_NAME)||grouping(LST.PROC_ID)||grouping(LST.PROC_NAME)||grouping(LST.ITEM_ID)||grouping(LST.ITEM_NAME)||grouping(LST.SPEC)='001111'
                 or grouping(LST.PLANT_NAME)||grouping(LST.PROC_ID)||grouping(LST.PROC_NAME)||grouping(LST.ITEM_ID)||grouping(LST.ITEM_NAME)||grouping(LST.SPEC)='011111'
           )
     order by PLANT_NAME ,PROC_ID ,SEQ ,PROC_NAME ,ITEM_ID ,ITEM_NAME ,SPEC 	        
			 
	</query>
	
	<!--
	======================================================================
		제품별 생산계획 대비 생산실적 조회
	======================================================================
	-->
	
	<!-- 제품별 생산계획 대비 생산실적 조회 -->
	<query id="sc_11040_planVsActualResultByItem_list" paging="true">
		
			SELECT  DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC, DS.PLANT_NAME, DS.PROC_ID, DS.PROC_NAME,
			        (PL01+PL02+PL03+PL04+PL05+PL06+PL07+PL08+PL09+PL10+PL11+PL12+PL13+PL14+PL15
			        +PL16+PL17+PL18+PL19+PL20+PL21) AS TOT_PL, -- 생산 계획량 합계
			        NVL((PO01+PO02+PO03+PO04+PO05+PO06+PO07+PO08+PO09+PO10+PO11+PO12+PO13+PO14+PO15
			        +PO16+PO17+PO18+PO19+PO20+PO21),0) AS TOT_PO, -- 실적량 합계
			        NVL(CASE 
			            WHEN (PO01+PO02+PO03+PO04+PO05+PO06+PO07+PO08+PO09+PO10+PO11+PO12+PO13+PO14+PO15
			                  +PO16+PO17+PO18+PO19+PO20+PO21) = 0
			            THEN 
			                    0
			            ELSE
			                    (PO01+PO02+PO03+PO04+PO05+PO06+PO07+PO08+PO09+PO10+PO11+PO12+PO13+PO14+PO15
			                    +PO16+PO17+PO18+PO19+PO20+PO21)/
			                    (PL01+PL02+PL03+PL04+PL05+PL06+PL07+PL08+PL09+PL10+PL11+PL12+PL13+PL14+PL15
			                    +PL16+PL17+PL18+PL19+PL20+PL21) * 100
			            END,0)     TOT_RATE, -- 합계 비율
			        PL01, NVL(PO01,0), NVL(RATE01,0), -- 계획량, 실적량, 비율
			        PL02, NVL(PO02,0), NVL(RATE02,0),
			        PL03, NVL(PO03,0), NVL(RATE03,0),
			        PL04, NVL(PO04,0), NVL(RATE04,0),
			        PL05, NVL(PO05,0), NVL(RATE05,0),
			        PL06, NVL(PO06,0), NVL(RATE06,0),
			        PL07, NVL(PO07,0), NVL(RATE07,0),
			        PL08, NVL(PO08,0), NVL(RATE08,0),
			        PL09, NVL(PO09,0), NVL(RATE09,0),
			        PL10, NVL(PO10,0), NVL(RATE10,0),
			        PL11, NVL(PO11,0), NVL(RATE11,0),
			        PL12, NVL(PO12,0), NVL(RATE12,0),
			        PL13, NVL(PO13,0), NVL(RATE13,0),
			        PL14, NVL(PO14,0), NVL(RATE14,0),
			        PL15, NVL(PO15,0), NVL(RATE15,0),
			        PL16, NVL(PO16,0), NVL(RATE16,0),
			        PL17, NVL(PO17,0), NVL(RATE17,0),
			        PL18, NVL(PO18,0), NVL(RATE18,0),
			        PL19, NVL(PO19,0), NVL(RATE19,0),
			        PL20, NVL(PO20,0), NVL(RATE20,0),
			        PL21, NVL(PO21,0), NVL(RATE21,0)        
			FROM    (
			        SELECT  DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC, DS.PLANT_NAME, DS.PROC_ID, DS.PROC_NAME,
			                /* 생산일자 별 계획량, 실적량, 비율 */
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL01,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO01,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE01,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL02,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO02,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE02,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL03,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO03,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE03,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL04,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO04,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE04,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL05,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO05,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE05,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL06,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO06,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE06,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL07,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO07,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE07,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL08,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO08,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE08,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL09,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO09,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE09,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL10,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO10,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE10,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL11,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO11,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE11,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL12,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO12,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE12,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL13,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO13,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE13,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL14,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO14,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE14,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL15,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO15,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE15,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL16,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO16,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE16,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL17,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO17,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE17,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL18,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO18,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE18,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL19,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO19,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE19,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL20,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO20,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE20,
			                ----------------------------------------------------------------------------------------------------------------
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.QTY ELSE 0 END) PL21,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.COMPL_QTY ELSE 0 END) PO21,
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DECODE(DS.QTY,0,0,DS.COMPL_QTY) ELSE NULL END)/
			                SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DECODE(DS.QTY,0,1,DS.QTY) ELSE 0 END) * 100 AS RATE21
			                ----------------------------------------------------------------------------------------------------------------
			        FROM    (
                             SELECT    S1.ITEM_ID        ITEM_ID,
                                    S2.ITEM_NAME    ITEM_NAME,
                                    S2.SPEC            SPEC,
                                    S3.PLANT_NAME    PLANT_NAME,
                                    S1.PROC_ID        PROC_ID,
                                    S4.PROC_NAME    PROC_NAME,
                                    S1.PROD_DATES    PROD_DATES,
                                    SUM(PLAN_BOX)    QTY,
                                    SUM(REST_BOX)    COMPL_QTY
                            FROM    (
                                    /* ERP 생산계획 FROM MES */
                                    SELECT    T1.PFROM_DATE        PROD_DATES,
                                            T1.PLANT            PLANT_ID,
                                            T1.WC                PROC_ID,
                                            T4.MATR_CODE        ITEM_ID,
                                            SUM(T1.PLAN_QTY)    PLAN_BOX,
                                            0                    REST_BOX
                                    FROM    PP20T120    T1,
                                            PP20T110    T4,
                                            ITEM_MST    T2,
                                            (
                                             /* 마지막 공정정보 */
                                             SELECT    S1.PLANT_ID,
                                                    S1.ITEM_ID,
                                                    S1.PROD_VER,
                                                    MAX(S1.PROC_ID)    PROC_ID
                                            FROM    ITEM_CAPA    S1,
                                                    (
                                                    SELECT    PLANT_ID, ITEM_ID, PROD_VER, MAX(OPER_ID) OPER_ID
                                                    FROM    ITEM_CAPA
                                                    GROUP
                                                    BY        PLANT_ID, ITEM_ID, PROD_VER
                                                    )        S2
                                            WHERE   S1.MADE_TYPE != 'DE'
                                            AND		S1.PLANT_ID    = S2.PLANT_ID
                                            AND     S1.ITEM_ID    = S2.ITEM_ID
                                            AND     S1.PROD_VER = S2.PROD_VER
                                            AND     S1.OPER_ID    = S2.OPER_ID
                                            GROUP
                                            BY        S1.PLANT_ID,S1.ITEM_ID,    S1.PROD_VER
                                            )            T3
                                    WHERE      T1.ORDER_NO     = T4.ORDER_NO
                                    AND        T1.ORDER_NUM    = T4.ORDER_NUM
                                    AND        T1.PLANT        = T3.PLANT_ID
                                    AND        T4.MATR_CODE    = T2.ITEM_ID
                                    AND        T1.PFROM_DATE    BETWEEN TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD'),'YYYYMMDD') 
			                                                AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD')
                                    AND        T4.MATR_CODE    = T3.ITEM_ID
                                    AND        T1.WC           = T3.PROC_ID
                                    AND		   T4.ORDER_STAT != 'TECO'
                                    AND		   T4.ORDER_STAT != 'DLFL'
                                    GROUP
                                    BY        T1.PFROM_DATE,
                                            T1.PLANT,
                                            T1.WC,
                                            T4.MATR_CODE
                                    UNION    ALL
                                    /* MES생산실적 */
                                    SELECT    T1.WORK_DATE    PROD_DATES,
                                            T1.PLANT        PLANT_ID,
                                            T1.WC            PROC_ID,
                                            T1.MATR_CODE    ITEM_ID,
                                            0                    PLAN_BOX,
                                            SUM(T1.WORK_QTY)            REST_BOX
                                    FROM    PP30T110        T1,
                                            ITEM_MST        T2,
                                            (
                                             /* 마지막 공정정보 */
                                             SELECT    S1.PLANT_ID,
                                                    S1.ITEM_ID,
                                                    S1.PROD_VER,
                                                    MAX(S1.PROC_ID)    PROC_ID
                                            FROM    ITEM_CAPA    S1,
                                                    (
                                                    SELECT    PLANT_ID, ITEM_ID, PROD_VER, MAX(OPER_ID) OPER_ID
                                                    FROM    ITEM_CAPA
                                                    GROUP
                                                    BY        PLANT_ID, ITEM_ID, PROD_VER
                                                    )        S2
                                            WHERE   S1.MADE_TYPE != 'DE'
                                            AND		S1.PLANT_ID    = S2.PLANT_ID
                                            AND     S1.ITEM_ID    = S2.ITEM_ID
                                            AND     S1.PROD_VER = S2.PROD_VER
                                            AND     S1.OPER_ID    = S2.OPER_ID
                                            GROUP
                                            BY        S1.PLANT_ID,S1.ITEM_ID,    S1.PROD_VER
                                            )            T3
                                    WHERE      T1.MATR_CODE    = T2.ITEM_ID
                                    AND        T1.PLANT        = T3.PLANT_ID
                                    AND        T1.MATR_CODE    = T3.ITEM_ID
                                    AND        T1.WC            = T3.PROC_ID
                                    AND        T1.WORK_DATE    BETWEEN TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD'),'YYYYMMDD') 
			                                                AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD')
                                    GROUP
                                    BY        T1.WORK_DATE,
                                            T1.PLANT,
                                            T1.WC,
                                            T1.MATR_CODE
                                    )            S1,
                                    ITEM_MST    S2,
                                    (
                                    SELECT    HID            PLANT_ID,
                                            HID_NAME    PLANT_NAME
                                    FROM    HRCHY
                                    WHERE    LVL_TYPE    = '공장'
                                    )        S3,
                                    (
                                    SELECT    HTYPE        PLANT_ID,
                                            HID            PROC_ID,
                                            HID_NAME    PROC_NAME
                                    FROM    HRCHY
                                    WHERE    LVL_TYPE    = '작업장'
                                    )        S4
                            WHERE    S1.PLANT_ID    = S3.PLANT_ID
                            AND        S1.PLANT_ID    = S4.PLANT_ID
                            AND        S1.ITEM_ID    = S2.ITEM_ID
                            AND		S1.PROC_ID	= S4.PROC_ID
                            AND         S1.PLANT_ID = '$!{selected_plant}'
                            [AND         S1.ITEM_ID LIKE '%${item_id}%']
                            [AND         S2.ITEM_NAME LIKE '%${item_name}%']
                            GROUP
                            BY        S1.ITEM_ID,
                                    S2.ITEM_NAME,
                                    S2.SPEC,
                                    S3.PLANT_NAME,
                                    S1.PROC_ID,
                                    S4.PROC_NAME,
                                    S1.PROD_DATES
			                ) DS
			        GROUP   BY   DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC, DS.PLANT_NAME, DS.PROC_ID, DS.PROC_NAME        
			        ) DS
		
	</query>
	
<!--
=====================================================================================================
	생산계획 >> 일간 반제품 생산계획
=====================================================================================================
--> 
	
	<!-- 
	===========================
		공통 쿼리 
	===========================
	--> 
	
	<!-- 콤보박스:version 리스트조회(반제품 계획) --> 
	<query id="semi_combo_version_list"> 
	
			SELECT  PVL.VERSION, PVL.SEQ, ROWNUM NUM, PVL.STATUS
			  FROM  (
			          SELECT  PV.VERSION, PV.SEQ, PV.STATUS
			            FROM  PLAN_VERSION_LOG PV
			           WHERE  PV.MADE_TYPE != 'DE'
			             AND  PV.PERIOD_TYPE = 'DAILY'
			             AND  PV.CAT_ID = 'SS'
			             AND  PV.VERSION IS NOT NULL
			             AND  PV.SEQ IS NOT NULL
                         --AND  PV.STATUS = '23'
			           ORDER  BY PV.VERSION DESC, PV.SEQ DESC
			        ) PVL, DUAL
			 WHERE  ROWNUM &lt; 21
      				
	</query>
	
	<!-- 콤보박스:공장 리스트조회(반제품 계획) -->
	<query id="semi_combo_plant_list">
	
            SELECT  DISTINCT DS.VERSION, DS.SEQ, DS.PLANT_ID, HR.HID_NAME
              FROM  DAILY_SCH_PLAN_SHIFT DS, HRCHY HR 
             WHERE  DS.PLANT_ID = HR.HTYPE
               AND  DS.MADE_TYPE != 'DE'
               AND  HR.MADE_TYPE != 'DE'
               AND  HR.LVL_TYPE = '공장'
               AND  DS.CAT_ID = 'SS'
             ORDER  BY VERSION DESC
	
	</query>
	
	<!-- 콤보박스:반제품 종류 리스트조회(반제품 계획) -->
	<query id="semi_combo_type">
	
			SELECT  DISTINCT IM.CAT02
			  FROM  ITEM_MST IM
			 WHERE  IM.CAT02 IS NOT NULL
			 ORDER  BY IM.CAT02
	
	</query>	
	
	<!-- 
	===========================
		일간 반제품 생산 계획 조회 
	===========================
	--> 
	
	<!-- 일간 반제품 생산 계획 조회 --> 
	<query id="sc_12010_dailySemifinishedProductionPlant_list">
	
			SELECT  DS.PLANT_ID, HR.PLANT_NAME, HR.TEAM_NAME, HR.PROC_ID, HR.PROC_NAME, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)             
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)        
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)          
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END)
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END)  
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) 
                    + SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) TOT 
                    -----------------------------------------------------------------------------------------------------------------------------------------------------
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D01A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D01B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D01C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D02A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D02B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D02C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D03A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D03B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D03C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D04A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D04B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D04C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D05A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D05B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D05C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D06A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D06B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D06C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D07A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D07B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D07C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D08A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D08B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D08C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D09A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D09B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D09C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D10A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D10B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D10C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D11A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D11B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D11C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D12A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D12B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D12C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D13A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D13B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D13C
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D14A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D14B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D14C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D15A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D15B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D15C   
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D16A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D16B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D16C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D17A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D17B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D17C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D18A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D18B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D18C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D19A  
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D19B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D19C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D20A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D20B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D20C 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '1' THEN  DS.SHIFT_QTY  ELSE 0 END) D21A 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '3' THEN  DS.SHIFT_QTY  ELSE 0 END) D21B 
                    , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD') AND DS.SHIFT_TYPE = '5' THEN  DS.SHIFT_QTY  ELSE 0 END) D21C                               
              FROM  DAILY_SCH_PLAN_SHIFT DS, ITEM_MST IM, V_LAST_PROC_LIST HR     
             WHERE	DS.MADE_TYPE != 'DE'
               --AND  HR.CAT = '포장'
     		   AND  DS.PLANT_ID = HR.PLANT_ID
     		   AND  DS.LINE_ID = HR.LINE_ID
     		   AND  DS.PROC_ID = HR.PROC_ID
               AND  DS.ITEM_ID = IM.ITEM_ID(+)
               AND  DS.CAT_ID = 'SS' 
               AND  DS.VERSION ='$!{version}' AND DS.SEQ = '$!{seq}'
              [AND  DS.PLANT_ID = '${selected_plant}'] --공장
              [AND  HR.TEAM_ID = '${selected_won}'] --원가부문
              [AND  DS.PROC_ID = '${selected_proc}']  --작업장
              [AND  IM.CAT02 = '${selected_type}']   
               AND  DS.PROD_DATES BETWEEN REPLACE(REPLACE('$!{sdate}','/',''),'-','') AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD')                       
             GROUP  BY DS.PLANT_ID, HR.PLANT_NAME, HR.TEAM_NAME, HR.PROC_ID, HR.PROC_NAME, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
             --ORDER  BY DS.PLANT_ID, HR.PLANT_NAME, HR.TEAM_NAME, HR.PROC_ID, HR.PROC_NAME, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
			 ORDER	BY 1,2,3,4,5,6,7,8,9
	
	</query>
	
	<!-- 일간 반제품 생산 계획 조회: 이고계획 조회 --> 
	<query id="sc_12010_dailySemifinishedProductionPlantTransPlan_list">
	
			SELECT  ES.PLANT_ID, ES.TGT_PLANT, ES.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, ES.QTY_UOM
			        , SUM(CASE WHEN ST.LOC_ID = ES.TGT_PLANT AND ST.ITEM_ID = ES.ITEM_ID THEN ST.QTY ELSE 0 END) TOT
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+0) THEN  ES.QTY  ELSE 0 END) D01
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+1) THEN  ES.QTY  ELSE 0 END) D02
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+2) THEN  ES.QTY  ELSE 0 END) D03
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+3) THEN  ES.QTY  ELSE 0 END) D04
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+4) THEN  ES.QTY  ELSE 0 END) D05
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+5) THEN  ES.QTY  ELSE 0 END) D06
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+6) THEN  ES.QTY  ELSE 0 END) D07
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+7) THEN  ES.QTY  ELSE 0 END) D08
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+8) THEN  ES.QTY  ELSE 0 END) D09
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+9) THEN  ES.QTY  ELSE 0 END) D10
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+10) THEN  ES.QTY  ELSE 0 END) D11
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+11) THEN  ES.QTY  ELSE 0 END) D12
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+12) THEN  ES.QTY  ELSE 0 END) D13
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+13) THEN  ES.QTY  ELSE 0 END) D14
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+14) THEN  ES.QTY  ELSE 0 END) D15
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+15) THEN  ES.QTY  ELSE 0 END) D16
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+16) THEN  ES.QTY  ELSE 0 END) D17
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+17) THEN  ES.QTY  ELSE 0 END) D18
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+18) THEN  ES.QTY  ELSE 0 END) D19
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+19) THEN  ES.QTY  ELSE 0 END) D20
			        , SUM(CASE WHEN ES.TRANS_DATE = (TO_DATE('$!{sdate}','YYYY-MM-DD')+20) THEN  ES.QTY  ELSE 0 END) D21        
			  FROM  ERP_STO ES, ITEM_MST IM, ERP_STOCK ST
			 WHERE  ES.MADE_TYPE != 'DE'
			   AND  IM.MADE_TYPE != 'DE'
			   AND  ES.ITEM_ID = IM.ITEM_ID(+)
			   AND  ES.TGT_PLANT = ST.LOC_ID(+)
			   AND  ES.PLANT_ID = '$!{selected_plant}'
			  [AND  IM.CAT02 = '${selected_type}']
			 GROUP  BY  ES.PLANT_ID, ES.TGT_PLANT, ES.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, ES.QTY_UOM
			 ORDER  BY  ES.PLANT_ID, ES.TGT_PLANT, ES.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, ES.QTY_UOM
	
	</query>

	<!-- 일간 생산 계획 조회 : POPUP -->
	<query id="sc_12010_dailySemifinishedProductionPlant_popup">
	
			SELECT  DP.WO_ID, 
			        HR.PROC_NAME,
			        TO_CHAR(DS.START_DTTM, 'YYYY-MM-DD') START_DATE,
			        TO_CHAR(DS.START_DTTM, 'HH24MISS') START_MIN,
			        TO_CHAR(DS.END_DTTM, 'YYYY-MM-DD') END_DATE,
			        TO_CHAR(DS.END_DTTM, 'HH24MISS' ) END_MIN,
			        DS.SHIFT_TYPE,
			        DS.SHIFT_QTY,
			        DS.ITEM_ID,
			        IM.ITEM_NAME
			FROM   DAILY_SCH_PLAN_SHIFT DS,
			       (     
			       SELECT  HR.HID PROC_ID, HR.HID_NAME PROC_NAME
			                              FROM  HRCHY HR
			                             WHERE  HR.MADE_TYPE != 'DE'
			                               AND  HR.HTYPE = '$!{plant_id}'
			       ) HR,
			       (
			       SELECT   DS.CAT_ID, DS.PLANT_ID, DS.VERSION, DS.SEQ, DS.WO_ID
			       FROM     DAILY_SCH_PLAN_SHIFT DS
			       WHERE    DS.MADE_TYPE != 'DE'
			       AND      DS.CAT_ID = 'SS'
			       AND  	DS.PLANT_ID = '$!{plant_id}'
				   --AND  	DS.LINE_ID = '$!{line_id}'
				   AND  	DS.PROC_ID = '$!{proc_id}'
				   AND  	DS.ITEM_ID = '$!{item_id}'
				   AND  	DS.VERSION = '$!{version}'
				   AND  	DS.SEQ = '$!{seq}'
				   AND  	DS.PROD_DATES BETWEEN REPLACE(REPLACE('$!{sdate}','/',''),'-','') AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20, 'YYYYMMDD')
				  [AND  	DS.PROD_DATES = '${prod_dates}']
				  [AND  	DS.SHIFT_TYPE = '${shift_type}']
			       ) DP, ITEM_MST IM
			WHERE  DS.VERSION = DP.VERSION
			AND    DS.SEQ     = DP.SEQ
			AND    DS.CAT_ID  = DP.CAT_ID
			AND    DS.PLANT_ID = DP.PLANT_ID
			AND    DS.WO_ID    = DP.WO_ID  
			AND    DS.PROC_ID = HR.PROC_ID(+)
			AND    DS.ITEM_ID = IM.ITEM_ID(+)
		    ORDER  BY 3,4,7
	
	</query> 
		
<!--	
=====================================================================================================
	생산계획 >> 일간 공장할당 계획
=====================================================================================================
--> 

	<!-- 
	=======================
		공통 쿼리
	=======================
	-->
	
	<!-- 콤보박스:version 리스트조회(공장할당 계획) --> 
	<query id="plant_alloc_combo_version_list">
	
			SELECT  PVL.VERSION, PVL.SEQ, ROWNUM NUM, PVL.STATUS
			  FROM  (
			          SELECT  PV.VERSION, PV.SEQ, PV.STATUS
			            FROM  PLAN_VERSION_LOG PV, (SELECT 'A' FROM DUAL) A
			           WHERE  PV.MADE_TYPE != 'DE'
			             AND  PV.PERIOD_TYPE = 'DAILY'
			             AND  PV.CAT_ID = 'FA'
			             AND  PV.VERSION IS NOT NULL
			             --AND  PV.SEQ IS NOT NULL
                         --AND  PV.STATUS = '23'
			           ORDER  BY PV.VERSION DESC, PV.SEQ DESC
			        ) PVL
			 WHERE  ROWNUM &lt; 21
      				
	</query>
	
	<!-- 콤보박스:공장 리스트조회(공장할당 계획) -->
	<query id="plant_alloc_combo_plant_list">
	
            SELECT  DISTINCT PA.VERSION, PA.SEQ, PA.PLANT_ID, HR.HID_NAME
              FROM  PLANT_ALLOC_PLAN PA, HRCHY HR 
             WHERE  PA.PLANT_ID = HR.HID(+)
               AND  PA.MADE_TYPE != 'DE'
               AND  HR.MADE_TYPE != 'DE'
               AND  HR.LVL_TYPE = '공장'            
             ORDER  BY HR.HID_NAME
	
	</query>
	
	<!-- 콤보박스:품종분류2 리스트조회 -->  
	<query id="plant_alloc_combo_sales_cat2_list">
	
			SELECT  CM.CD, CM.CD_NAME
			  FROM  CODE_MST CM, (SELECT 'BB' A FROM DUAL) B
			 WHERE  CM.MADE_TYPE != 'DE'
			   AND  CM.CD_GRP = 'SALES_CAT2'
			 ORDER  BY CM.CD_NAME
      				
	</query>	 
	
	<!-- 
	=======================
		계획 결과 조회
	=======================
	--> 
	
	<!-- 계획 결과 조회  --> 
	<query id="sc_10010_dailyPlantAllocationPlan_list" paging="true">	
	
			SELECT  IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.HID_NAME
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+0 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)			        
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+1 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+2 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+3 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+4 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+5 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+6 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+7 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+8 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+9 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+10 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+11 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+12 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+13 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+14 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+15 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+16 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+17 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+18 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+19 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+20 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) TOT
			        ------------------------------------------------------------------------------------------------------------------------------------------------------------------
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+0 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D01
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+1 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D02
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+2 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D03
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+3 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D04
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+4 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D05
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+5 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D06
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+6 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D07
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+7 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D08
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+8 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D09
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+9 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D10
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+10 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D11
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+11 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D12
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+12 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D13
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+13 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D14
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+14 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D15
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+15 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D16
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+16 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D17
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+17 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D18
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+18 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D19
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+19 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D20
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+20 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D21 
			  FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_MST IM
                    , (	SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.CD_GRP = 'SALES_CAT2'
                    ) CD
                    , (	SELECT  HID, HID_NAME
                    	  FROM  HRCHY
                    	 WHERE  MADE_TYPE != 'DE'
                    	   AND  LVL_TYPE = '공장' ) HR
			 WHERE  PA.ITEM_ID = IM.ITEM_ID(+)
               AND  IM.SALES_CAT02 = CD.CD(+)
               AND  PA.PLANT_ID = HR.HID
               AND  PA.VERSION = '$!{version}' 
              [AND  PA.SEQ = '${seq}']
			  [AND  PA.PLANT_ID = '${selected_plant}']
			   AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdate}', 'YYYY-MM-DD') AND TO_DATE('$!{sdate}','YYYY-MM-DD')+20
			 #if("$!{checked_multi}" == "visual")
			   AND  IM.MULTI_FLAG = 'V'
			 #elseif("$!{checked_multi}" == "multi")
			   AND  IM.MULTI_FLAG = 'M'
			 #elseif("$!{checked_multi}" == "normal")
			   AND  IM.MULTI_FLAG IS NULL
			 #end	
			  [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --SALES_CAT1
              [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --SALES_CAT2   
			  [AND  IM.CAT01 = '${selected_cat01}']
			 GROUP  BY IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.HID_NAME
			 ORDER  BY IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.HID_NAME
	
	</query>
	
	<!-- 
	===========================
		일간 공장할당계획 분석
	===========================
	--> 
	
	<!-- 일간 공장할당계획 분석  --> 
	<query id="sc_10030_dailyPlantAllocationPlanAnalysis_list" paging="true">	
	
			SELECT  IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, PA.PLANT_ID, HR.HID_NAME	
		        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+0 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)			        
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+1 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+2 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+3 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+4 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+5 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+6 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+7 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+8 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+9 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+10 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+11 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+12 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+13 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+14 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+15 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+16 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+17 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+18 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+19 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+20 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) TOT
			        -----------------------------------------------------------------------------------------------------------------------------------------------------------------
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+0 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D01
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+1 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D02
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+2 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D03
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+3 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D04
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+4 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D05
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+5 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D06
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+6 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D07
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+7 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D08
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+8 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D09
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+9 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D10
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+10 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D11
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+11 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D12
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+12 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D13
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+13 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D14
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+14 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D15
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+15 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D16
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+16 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D17
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+17 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D18
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+18 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D19
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+19 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D20
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+20 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D21 
			  FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_MST IM 
                    , (	SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.CD_GRP = 'SALES_CAT2'
                    ) CD
                    , (	SELECT  HID, HID_NAME
                    	  FROM  HRCHY
                    	 WHERE  MADE_TYPE != 'DE'
                    	   AND  LVL_TYPE = '공장' ) HR
			 WHERE  PA.ITEM_ID = IM.ITEM_ID(+)
               AND  IM.SALES_CAT02 = CD.CD(+)
               AND  PA.PLANT_ID = HR.HID
               AND  PA.VERSION = '$!{version}' 
              [AND  PA.SEQ = '${seq}']
			  [AND  PA.PLANT_ID = '${selected_plant}']
			   AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdate}', 'YYYY-MM-DD') AND TO_DATE('$!{sdate}','YYYY-MM-DD')+20
			 #if("$!{checked_multi}" == "visual")
			   AND  IM.MULTI_FLAG = 'V'
			 #elseif("$!{checked_multi}" == "multi")
			   AND  IM.MULTI_FLAG = 'M'
			 #elseif("$!{checked_multi}" == "normal")
			   AND  IM.MULTI_FLAG IS NULL
			 #end	
			  [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --SALES_CAT1
              [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --SALES_CAT2   
			  [AND  IM.CAT01 = '${selected_cat01}']
			   AND  NOT EXISTS ( SELECT VERSION FROM PLANT_ALLOC_PLAN_TEMP WHERE MADE_TYPE != 'DE' AND VERSION = '$!{version}')
			 GROUP  BY IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, PA.PLANT_ID, HR.HID_NAME	
			 
			 UNION
			SELECT  IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, PA.PLANT_ID, HR.HID_NAME	
				    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+0 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)			        
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+1 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+2 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+3 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+4 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+5 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+6 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+7 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+8 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+9 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+10 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+11 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
			        + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+12 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) 
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+13 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+14 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+15 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+16 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+17 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+18 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+19 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END)
                    + SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+20 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) TOT
			        -----------------------------------------------------------------------------------------------------------------------------------------------------------------
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+0 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D01
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+1 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D02
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+2 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D03
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+3 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D04
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+4 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D05
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+5 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D06
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+6 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D07
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+7 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D08
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+8 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D09
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+9 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D10
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+10 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D11
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+11 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D12
			        , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+12 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D13
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+13 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D14
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+14 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D15
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+15 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D16
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+16 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D17
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+17 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D18
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+18 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D19
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+19 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D20
                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdate}', 'YYYY-MM-DD')+20 THEN #if("$!{checked_uom}" == "box") PA.QTY #else PA.QTY * NVL(IM.QTY,1) #end ELSE 0 END) D21 
			  FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN_TEMP
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_MST IM 
                    , (	SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.CD_GRP = 'SALES_CAT2'
                    ) CD
                    , (	SELECT  HID, HID_NAME
                    	  FROM  HRCHY
                    	 WHERE  MADE_TYPE != 'DE'
                    	   AND  LVL_TYPE = '공장' ) HR
			 WHERE  PA.ITEM_ID = IM.ITEM_ID(+)
               AND  IM.SALES_CAT02 = CD.CD(+)
               AND  PA.PLANT_ID = HR.HID 
               AND  PA.VERSION = '$!{version}'
              [AND  PA.SEQ = '${seq}']
			  [AND  PA.PLANT_ID = '${selected_plant}']
			   AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdate}', 'YYYY-MM-DD') AND TO_DATE('$!{sdate}','YYYY-MM-DD')+20
			 #if("$!{checked_multi}" == "visual")
			   AND  IM.MULTI_FLAG = 'V'
			 #elseif("$!{checked_multi}" == "multi")
			   AND  IM.MULTI_FLAG = 'M'
			 #elseif("$!{checked_multi}" == "normal")
			   AND  IM.MULTI_FLAG IS NULL
			 #end	
			  [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --SALES_CAT1
              [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --SALES_CAT2   
			  [AND  IM.CAT01 = '${selected_cat01}']			   
			 GROUP  BY IM.SALES_CAT02, CD.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, PA.PLANT_ID, HR.HID_NAME			 
			 ------------------------------------------------------------------------------------------------------------------------
			 ORDER  BY 1, 2, 3, 4, 5, 6
	
	</query>
	
	<!-- 선택한 아이템의 할당 가능 공장 리스트 -->
	<query id="plant_alloc_analysis_combo_plant_list">
	
			SELECT  ID.PLANT_ID, HR.HID_NAME
			  FROM  ITEM_DTL ID
			        , ( SELECT  HR.HID, HR.HID_NAME
			              FROM  HRCHY HR
			             WHERE  HR.MADE_TYPE != 'DE'
			               AND  HR.LVL_TYPE = '공장' ) HR
			 WHERE  ID.MADE_TYPE != 'DE'
			   AND  ID.PLANT_ID = HR.HID(+)
			   AND  ID.ITEM_ID = '$!{item_id}'
			   AND  HR.HID_NAME IS NOT NULL
			   AND	ID.PLANT_ID != '1300'
			 ORDER  BY HR.HID_NAME
	
	</query>
	
	<!-- 일간 공장할당정책 분석: POPUP -->
	<query id="sc_10030_dailyPlantAllocationPlanAnalysis_popup" >
	
			SELECT  PA.VERSION, PA.SEQ, PA.PLANT_ID, HR.HID_NAME, PA.ITEM_ID, IM.ITEM_NAME, TO_CHAR(PA.DUE_DATE,'YYYY-MM-DD') DUE_DATE, PA.QTY, PA.QTY_UOM, PA.ORDER_INFO
			  FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA
			        , ( SELECT  HR.HID, HR.HID_NAME
			              FROM  HRCHY HR
			             WHERE  HR.MADE_TYPE != 'DE'
			               AND  HR.LVL_TYPE = '공장' ) HR  
			        , ( SELECT  IM.ITEM_ID, IM.ITEM_NAME
            			  FROM  ITEM_MST IM
            			 WHERE  IM.MADE_TYPE != 'DE' ) IM            
			 WHERE  PA.MADE_TYPE != 'DE'
			   AND  PA.VERSION = '$!{version}'
			  [AND  PA.PLANT_ID = '${plant_id}']
			   AND  PA.ITEM_ID = '$!{item_id}'
			   AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdate}', 'YYYY-MM-DD') AND TO_DATE('$!{sdate}','YYYY-MM-DD')+20
			  [AND     PA.DUE_DATE = TO_DATE('${due_date}','YYYYMMDD')]
			   AND  PA.PLANT_ID = HR.HID(+)
			   AND  PA.ITEM_ID = IM.ITEM_ID(+)
			   AND  NOT EXISTS ( SELECT VERSION FROM PLANT_ALLOC_PLAN_TEMP WHERE MADE_TYPE != 'DE' AND VERSION = '$!{version}' )
			 
			 UNION
			SELECT  PA.VERSION, PA.SEQ, PA.PLANT_ID, HR.HID_NAME, PA.ITEM_ID, IM.ITEM_NAME, TO_CHAR(PA.DUE_DATE,'YYYY-MM-DD') DUE_DATE, PA.QTY, PA.QTY_UOM, PA.ORDER_INFO
			  FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN_TEMP
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA
			        , ( SELECT  HR.HID, HR.HID_NAME
			              FROM  HRCHY HR
			             WHERE  HR.MADE_TYPE != 'DE'
			               AND  HR.LVL_TYPE = '공장' ) HR  
			        , ( SELECT  IM.ITEM_ID, IM.ITEM_NAME
            			  FROM  ITEM_MST IM
            			 WHERE  IM.MADE_TYPE != 'DE' ) IM  			                          
			 WHERE  PA.MADE_TYPE != 'DE'
			   AND  PA.VERSION = '$!{version}'
			  [AND  PA.PLANT_ID = '${plant_id}']
			   AND  PA.ITEM_ID = '$!{item_id}'
			   AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdate}', 'YYYY-MM-DD') AND TO_DATE('$!{sdate}','YYYY-MM-DD')+20
			  [AND     PA.DUE_DATE = TO_DATE('${due_date}','YYYYMMDD')]
			   AND  PA.PLANT_ID = HR.HID(+)  
			   AND  PA.ITEM_ID = IM.ITEM_ID(+) 
			 ORDER  BY 10, 7, 3
	
	</query>
	
	<!-- 01. PLANT_ALLOC_PLAN 테이블에서 선택된 버전 전체 데이터 PLANT_ALLOC_PLAN_TEMP 테이블로 INSERT -->
	<query id="sc_10030_dailyPlantAllocationPlanAnalysis_popup_save_01">
	
			INSERT  INTO PLANT_ALLOC_PLAN_TEMP(VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY, QTY_UOM, ORDER_INFO
					, ISMODIFIED, MADE_TYPE, MADE_DTTM, MADE_BY)
			SELECT  PA.VERSION AS VERSION
			        , PA.SEQ AS SEQ
			        , PA.PLANT_ID AS PLANT_ID
			        , PA.ITEM_ID AS ITEM_ID
			        , PA.DUE_DATE AS DUE_DATE
			        , PA.QTY AS QTY
			        , PA.QTY_UOM AS QTY_UOM
			        , PA.ORDER_INFO AS ORDER_INFO
			        , 'N' AS ISMODIFIED
			        , 'AD' AS MADE_TYPE
			        , SYSDATE AS MADE_DTTM
			        , '$!{_user_id}' AS MADE_BY
			  FROM  (   SELECT  PA.VERSION, PA.SEQ, PA.PLANT_ID, PA.ITEM_ID, PA.DUE_DATE, PA.QTY, PA.QTY_UOM, PA.ORDER_INFO
			              FROM  PLANT_ALLOC_PLAN PA
			             WHERE  PA.MADE_TYPE != 'DE'
			               AND  PA.VERSION = '$!{version}' ) PA -- 계획버전
			 WHERE  NOT EXISTS (    SELECT  PT.VERSION
			                          FROM  PLANT_ALLOC_PLAN_TEMP PT
			                         WHERE  PT.MADE_TYPE != 'DE'
			                           AND  PT.VERSION = '$!{version}' )
	
	</query>
	
	<!-- 02. 변경된 항목을 PLANT_ALLOC_PLAN_TEMP 테이블에 UPDATE -->
	<query id="sc_10030_dailyPlantAllocationPlanAnalysis_popup_save_02" fix="" iterator="input_plant_id input_due_date input_qty s_version s_seq s_plant_id s_item_id s_due_date s_order_info checkModify">
	
			UPDATE  PLANT_ALLOC_PLAN_TEMP PT
			   SET  PT.PLANT_ID = '$!{input_plant_id}' --공장
			        , PT.DUE_DATE = TO_DATE('$!{input_due_date}','YYYY-MM-DD') --납기일
			        , PT.QTY = '$!{input_qty}'
			        , PT.ISMODIFIED = 'Y' --수정여부
			 WHERE  PT.VERSION = '$!{s_version}'
			   AND  PT.SEQ = '$!{s_seq}'
			   AND  PT.PLANT_ID = '$!{s_plant_id}'
			   AND  PT.ITEM_ID = '$!{s_item_id}'
			   AND  PT.DUE_DATE = TO_DATE('$!{s_due_date}','YYYY-MM-DD')
			   AND  PT.ORDER_INFO = '$!{s_order_info}'
			   AND  '$!{checkModify}' = 'Y' --체크박스 선택여부
	
	</query>
	
<!--	
=====================================================================================================
	생산계획 >> 계획정책
=====================================================================================================
--> 
	
	<!-- 
	=======================
		공장할당정책
	=======================
	-->
	
	<!-- 공장할당 정책 조회01 :배분율  -->
	<query id="sc_03030_plantAllocationPolicy_list_01">

			SELECT  CM.CD_GRP, CM.CD, CM.CD_NAME, CM.CAT01
			  FROM  CODE_MST CM
			 WHERE  CM.MADE_TYPE != 'DE' AND CM.CD_GRP = 'ALLOC_POLICY' AND CM.CD = 'ALLOC_RATE'
	
	</query>
	
	<!-- 공장할당 정책 조회02 :비용  -->
	<query id="sc_03030_plantAllocationPolicy_list_02">

            SELECT  CM1.CD_GRP, CM1.CD, CM1.CD_NAME, CM1.CAT01, CM2.CD, CM2.CD_NAME, CM2.CAT01
              FROM  CODE_MST CM1, CODE_MST CM2                      
             WHERE  CM1.MADE_TYPE != 'DE' 
               AND  CM1.CD = CM2.CD_GRP(+) 
               AND  CM1.CD_GRP = 'ALLOC_POLICY' 
               AND  CM1.CD = 'ALLOC_COST'
	
	</query>
	
	<!-- 공장할당 정책 조회03 :최소배분량 -->
	<query id="sc_03030_plantAllocationPolicy_list_03">

			SELECT  CM.CD_GRP, CM.CD, CM.CD_NAME, CM.CAT01
			  FROM  CODE_MST CM
			 WHERE  CM.MADE_TYPE != 'DE' AND CM.CD_GRP = 'ALLOC_POLICY' AND CM.CD = 'MIN_ALLOC_QTY'
	
	</query>
	
	<!-- 공장할당 정책: 제품별 공장할당 정보 -->
	<query id="sc_03030_plantAllocationPolicyItem_list" paging="true"> 
			<!-- 완제품이고 공장이 2개 이상에서 생산 되는 제품만 -->
            SELECT  CM.CD_NAME, ID.ITEM_ID, IM.ITEM_NAME, IM.SPEC, ID.PLANT_ID, ID.ALLOC_RATE, ID.MIN_ALLOC_QTY, IM.BASE_UOM
                    , ID.REAL_FIX_COST, ID.REAL_CHG_COST, ID.STD_FIX_COST, ID.STD_CHG_COST
              FROM  (
                        SELECT  ID.ITEM_ID, COUNT(ID.PLANT_ID) CNT
                          FROM  ITEM_DTL ID
                         WHERE  ID.MADE_TYPE != 'DE'
                           AND  ID.ITYPE = 'FERT'
                         GROUP  BY ID.ITEM_ID
                    ) DTL, ITEM_DTL ID, ITEM_MST IM, CODE_MST CM 
             WHERE  DTL.ITEM_ID = ID.ITEM_ID(+)
               AND  ID.ITEM_ID = IM.ITEM_ID(+)
               AND  IM.SALES_CAT02 = CM.CD(+)
               AND  ID.MADE_TYPE != 'DE'
               AND  IM.MADE_TYPE != 'DE'
               AND  CM.MADE_TYPE != 'DE'                
               AND  CM.CD_GRP = 'SALES_CAT2' 
               AND  DTL.CNT &gt; 1
              [AND  IM.SALES_CAT02 = '${selected_sales_cat2}']
              [AND  ID.ITEM_ID LIKE '%${item_id}%']
              [AND  IM.ITEM_NAME LIKE '%${item_name}%']
             ORDER  BY ID.ITEM_ID, ID.PLANT_ID
	
	</query>
	
	<!-- 콤보박스: 품종분류2 리스트조회 -->
	<query id="plant_alloc_policy_combo_sales_cat2_list"> 	

            SELECT  CM.CD, CM.CD_NAME
              FROM  CODE_MST CM, (SELECT 'A' A FROM DUAL) A
             WHERE  CM.MADE_TYPE != 'DE'
               AND  CM.CD_GRP = 'SALES_CAT2'
             ORDER  BY CM.CD_NAME	
      		   
	</query>
	
	<!-- 공장할당정책 : 저장 01(배분율)-->
	<query id="sc_03030_plantAllocationPolicy_list_save_01">
	
			UPDATE  CODE_MST CM
			   SET  CM.CAT01 = '$!{alloc_rate_cat01}'
			 WHERE  CM.MADE_TYPE != 'DE' AND CM.CD_GRP = 'ALLOC_POLICY' AND CM.CD = 'ALLOC_RATE'	
	
	</query>
	
	<!-- 공장할당정책 : 저장 02(비용)-->
	<query id="sc_03030_plantAllocationPolicy_list_save_02">
	
			UPDATE  CODE_MST CM
			   SET  CM.CAT01 = '$!{alloc_cost_cat01}'
			 WHERE  CM.MADE_TYPE != 'DE' 
			   AND  CM.CD_GRP = 'ALLOC_POLICY' 
			   AND  CM.CD = 'ALLOC_COST'	
	
	</query>
	
	<!-- 공장할당정책 : 저장 03(최소배분량)-->
	<query id="sc_03030_plantAllocationPolicy_list_save_03">
	
			UPDATE  CODE_MST CM
			   SET  CM.CAT01 = '$!{min_alloc_qty}'
			 WHERE  CM.MADE_TYPE != 'DE' AND CM.CD_GRP = 'ALLOC_POLICY' AND CM.CD = 'MIN_ALLOC_QTY'	
	
	</query>
	
	<!-- 공장할당정책 : 저장 04(비용하위)-->
	<query id="sc_03030_plantAllocationPolicy_list_save_04" iterator="alloc_cost_kind_cat01 alloc_cost_kind_cd">
	
			UPDATE  CODE_MST CM
			   SET  CM.CAT01 = '$!{alloc_cost_kind_cat01}'
			 WHERE  CM.MADE_TYPE != 'DE' AND CM.CD_GRP = 'ALLOC_COST' AND CM.CD = '$!{alloc_cost_kind_cd}'	
	
	</query>
	
	<!-- 제품별 공장할당계획 정보(Popup): 저장 --> 
	<query id="sc_03030_plantAllocationPolicy_popup_save" fix="item_id" iterator="alloc_rate min_qty plant_id">
	
			UPDATE  ITEM_DTL ID
			   SET  ID.ALLOC_RATE = '$!{alloc_rate}', ID.MIN_ALLOC_QTY = '$!{min_qty}'
			 WHERE  ID.ITYPE = 'FERT' AND ID.MADE_TYPE != 'DE' AND ID.ITEM_ID = '$!{item_id}' AND ID.PLANT_ID = '$!{plant_id}'
		
	</query>

	<!--
	======================================================================
		품목-생산라인 선호도 관리
	======================================================================
	-->
	
	<!-- 품목-생산라인 선호도 조회 -->
	<query id="sc_03050_itemPreference_list" paging="true">
	
			SELECT  VH.PLANT_NAME, CA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IC.LINE_ID, VH.LINE_NAME, IL.DESCRIPTION, IL.PRIORITY, IL.USE_FLAG
			  FROM  (   SELECT  PLANT_ID, ITEM_ID, ITEM_TYPE
			              FROM  ITEM_CAPA
			             WHERE  MADE_TYPE != 'DE'
			               AND  PLANT_ID = '$!{selected_plant}' --공장
			             GROUP  BY PLANT_ID, ITEM_TYPE, ITEM_ID
			            HAVING  COUNT(DISTINCT LINE_ID) > 1
			             ORDER  BY PLANT_ID, ITEM_TYPE, ITEM_ID ) CA
			        , ( SELECT  PLANT_ID, ITEM_ID, LINE_ID
			              FROM  ITEM_CAPA
			             WHERE  MADE_TYPE != 'DE'
			               AND  PLANT_ID = '$!{selected_plant}' --공장
			             GROUP  BY PLANT_ID, ITEM_ID, LINE_ID ) IC
			        , ( SELECT  DISTINCT VH.PLANT_NAME, VH.TEAM_NAME, VH.LINE_ID, VH.LINE_NAME
			              FROM  V_HRCHY_PROC VH
			             WHERE  VH.PLANT_ID = '$!{selected_plant}' ) VH --공장              
			        , ITEM_MST IM, ITEM_LINE_PRIORITY IL
			 WHERE  CA.ITEM_ID = IC.ITEM_ID(+)
			   AND  IC.LINE_ID = VH.LINE_ID(+)-- HRCHY에 정의 되어 있지 않은 라인이 ITEM_CAPA에 들어 있음
			   AND  CA.ITEM_ID = IM.ITEM_ID
			   AND  IC.PLANT_ID = IL.PLANT_ID(+)
			   AND  IC.ITEM_ID = IL.ITEM_ID(+)
			   AND  IC.LINE_ID = IL.LINE_ID(+)
			  [AND  CA.ITEM_ID LIKE '%${item_id}%']
			  [AND  IM.ITEM_NAME LIKE '%${item_name}%']
			 ORDER  BY CA.PLANT_ID, CA.ITEM_ID, IC.LINE_ID
	
	</query>
	
	<!-- 정책 리스트 -->
	<query id="line_priority_list">
	
		SELECT  CM.CD, CM.CD_NAME
		FROM    CODE_MST CM, DUAL
		WHERE   CM.CD_GRP = 'LINE_PRIORITY'
		ORDER   BY CM.CD
	
	</query>
	
	<!-- 01. 화면에 있는 DATA DELETE -->
	<query id="sc_03050_itemPreference_list_save_01">
	
            DELETE  ITEM_LINE_PRIORITY IL
             WHERE  IL.PLANT_ID = '$!{stored_plant}'
              [AND  IL.ITEM_ID LIKE '%${stored_item}%']
	
	</query>
	
	<!-- 02. 화면에 있는 DATA INSERT -->
	<query id="sc_03050_itemPreference_list_save_02" fix="stored_plant _user_id" iterator="dp_item_id line_id priority use_flag policy">
	
            INSERT  INTO ITEM_LINE_PRIORITY( PLANT_ID, ITEM_ID, LINE_ID, PRIORITY, USE_FLAG, DESCRIPTION, MADE_TYPE, MADE_DTTM, MADE_BY )
            SELECT  '$!{stored_plant}' AS PLANT_ID                    
                    , '$!{dp_item_id}' AS ITEM_ID
                    , '$!{line_id}' AS LINE_ID
                    , '$!{priority}' AS PRIORITY
                    , NVL('$!{use_flag}', 'Y') AS USE_FLAG 
                    , '$!{policy}' AS DESCRIPTION                   
                    , 'AD' AS MADE_TYPE
                    , SYSDATE AS MADE_DTTM
                    , '$!{_user_id}' AS MADE_BY
              FROM  DUAL
             WHERE  NOT EXISTS (    SELECT  IL.PLANT_ID, IL.ITEM_ID, IL.LINE_ID
                                      FROM  ITEM_LINE_PRIORITY IL
                                     WHERE  IL.MADE_TYPE != 'DE'
                                       AND  IL.PLANT_ID = '$!{stored_plant}'
                                       AND  IL.ITEM_ID = '$!{dp_item_id}' 
                                       AND  IL.LINE_ID = '$!{line_id}')			                            
               AND  '$!{priority}' IS NOT NULL -- 우선순위 없음면 저장 안함
	
	</query>

	<!-- 
	==============================================
		생산라인-품목 투입 우선순위 관리
	==============================================
	-->
	
	<!-- 생산라인-품목 투입 우선순위 조회  -->
	<query id="sc_03060_itemLineSeqPreference_list" paging="true">
	
			SELECT  DISTINCT VH.PLANT_NAME, VH.TEAM_NAME, IC.LINE_ID, VH.LINE_NAME, IC.ITEM_ID, IM.ITEM_NAME, IM.SPEC, SL.PRIORITY
			  FROM  ITEM_MST IM
                    , ( SELECT  IC.PLANT_ID, IC.LINE_ID
                          FROM  ITEM_CAPA IC
                         WHERE  IC.MADE_TYPE != 'DE'
                           AND  IC.PLANT_ID = '$!{selected_plant}' -- 공장
                          [AND  IC.LINE_ID = '${selected_line}']
                         GROUP  BY IC.PLANT_ID, IC.LINE_ID
                        HAVING  COUNT(DISTINCT IC.ITEM_ID) &gt; 1 ) IL	-- 2개 이상 제품을 생산하는 라인
                    , ( SELECT  IC.PLANT_ID, IC.LINE_ID, IC.ITEM_ID
                          FROM  ITEM_CAPA IC
                         WHERE  IC.MADE_TYPE != 'DE'
                           AND  IC.PLANT_ID = '$!{selected_plant}' -- 공장
                          [AND  IC.LINE_ID = '${selected_line}']                          
                         GROUP  BY IC.PLANT_ID, IC.LINE_ID, IC.ITEM_ID ) IC	
			        , ( SELECT  DISTINCT VH.PLANT_ID, VH.PLANT_NAME, VH.TEAM_ID, VH.TEAM_NAME, VH.LINE_ID, VH.LINE_NAME
			              FROM  V_HRCHY_PROC VH
			             WHERE  VH.PLANT_ID = '$!{selected_plant}' --공장
			              [AND  VH.TEAM_ID = '${selected_won}'] ) VH --원가부문 -- HRCHY정보
			        , ( SELECT  SL.PLANT_ID, SL.LINE_ID, SL.ITEM_ID, SL.PRIORITY
			              FROM  SAME_LINE_ITEM_PRIORITY SL
			             WHERE  SL.MADE_TYPE != 'DE'
			               AND  SL.PLANT_ID = '$!{selected_plant}' ) SL --공장  -- 우선순위 정보
			 WHERE  IM.MADE_TYPE != 'DE'
			   AND  IL.PLANT_ID = IC.PLANT_ID
               AND  IL.LINE_ID = IC.LINE_ID
               AND  IC.LINE_ID = VH.LINE_ID
               AND  IC.ITEM_ID = IM.ITEM_ID(+)
               AND  IC.LINE_ID = SL.LINE_ID(+)
               AND  IC.ITEM_ID = SL.ITEM_ID(+)            
             ORDER  BY IC.LINE_ID, IC.ITEM_ID
	
	</query>
	
	<!-- 01. 화면에 있는 DATA DELETE -->
	<query id="sc_03060_itemLineSeqPreference_list_save_01">
	
			DELETE  SAME_LINE_ITEM_PRIORITY SL
			 WHERE  SL.PLANT_ID = '$!{stored_plant}'
			   AND  SL.LINE_ID IN ( SELECT  DISTINCT LINE_ID 
			                          FROM  V_HRCHY_PROC 
			                         WHERE  PLANT_ID = '$!{stored_plant}'                           
			                          [AND  TEAM_ID = '${stored_won}']
			                          [AND  LINE_ID = '${stored_line}'] )
	
	</query>
	
	<!-- 02. 화면에 있는 DATA INSERT -->
	<query id="sc_03060_itemLineSeqPreference_list_save_02" fix="stored_plant _user_id" iterator="line_id item_id priority">
	
			INSERT  INTO SAME_LINE_ITEM_PRIORITY( PLANT_ID, LINE_ID, ITEM_ID, PRIORITY, MADE_TYPE, MADE_DTTM, MADE_BY )
			SELECT  '$!{stored_plant}' AS PLANT_ID
			        , '$!{line_id}' AS LINE_ID
			        , '$!{item_id}' AS ITEM_ID
			        , '$!{priority}' AS PRIORITY
			        , 'AD' AS MADE_TYPE
			        , SYSDATE AS MADE_DTTM
			        , '$!{_user_id}' AS MADE_BY
			  FROM  DUAL
			 WHERE  NOT EXISTS (    SELECT  SL.PLANT_ID, SL.LINE_ID, SL.ITEM_ID
			                          FROM  SAME_LINE_ITEM_PRIORITY SL
			                         WHERE  SL.MADE_TYPE != 'DE'
			                           AND  SL.PLANT_ID = '$!{stored_plant}'
			                           AND  SL.LINE_ID = '$!{line_id}'
			                           AND  SL.ITEM_ID = '$!{item_id}' ) 
               AND  '$!{priority}' IS NOT NULL -- 우선순위 없음면 저장 안함
	
	</query>
		
<!--	
=====================================================================================================
	생산계획 >> 제약조건
=====================================================================================================
--> 
	
	<!-- 
	=======================
		멀티포장 동시제약
	=======================
	-->
	
	<!-- 멀티포장 동시제약  -->	
	<query id="sc_02010_simultaneousOperationConstraint_list">
	
			SELECT  EP.PLANT_ID, HR1.HID_NAME, EP.LINE_ID, HR2.HID_NAME, EP.PROC_ID, HR3.HID_NAME
					, EP.ITEM_ID, IM.ITEM_NAME, IM.SPEC, EP.EXCL_PROC_ID, HR4.HID_NAME, EP.MC_TYPE, CM.MC_NAME
			  FROM  EXCL_PROC EP,			         
			        (
			        	SELECT  HR.HID, HR.HID_NAME
			        	  FROM	HRCHY HR
			        	 WHERE	HR.MADE_TYPE != 'DE' AND HR.HTYPE = '$!{selected_plant}' AND HR.LVL_TYPE = '공장'
			        ) HR1,			        
			        ITEM_MST IM,
			        (
				        SELECT	HR.HID, HR.HID_NAME
				          FROM	HRCHY HR
				         WHERE	HR.MADE_TYPE != 'DE' AND HR.HTYPE = '$!{selected_plant}' AND HR.LVL_TYPE = '라인'
			        ) HR2,
			        (
				        SELECT	HR.HID, HR.HID_NAME
				          FROM	HRCHY HR
				         WHERE	HR.MADE_TYPE != 'DE' AND HR.HTYPE = '$!{selected_plant}' AND HR.LVL_TYPE = '작업장' AND HR.CAT = '포장'
			        ) HR3,
			        HRCHY HR4,
                    (
                    SELECT  CD AS MC_CODE, CD_NAME AS MC_NAME
                    FROM    CODE_MST
                    WHERE   CD_GRP = 'EXCL_PROC'  
                    )  CM      			        
			 WHERE  EP.MADE_TYPE != 'DE' 
			   AND  EP.PLANT_ID = HR1.HID(+)
			   AND  EP.ITEM_ID = IM.ITEM_ID(+)
			   AND  EP.LINE_ID = HR2.HID(+)
			   AND  EP.PROC_ID = HR3.HID(+)
			   AND  EP.EXCL_PROC_ID = HR4.HID(+)
			   AND  HR4.HTYPE = '$!{selected_plant}'
	           AND  EP.PLANT_ID = '$!{selected_plant}' 
	          [AND  EP.LINE_ID = '${selected_line}']		        
	          [AND  EP.ITEM_ID LIKE '%${search_item_id}%']
	          [AND  IM.ITEM_NAME LIKE '%${search_item_name}%']
	           AND  EP.MC_TYPE = CM.MC_CODE
	
	</query>
		
	<!-- 콤보박스: 공장 리스트grid -->
	<query id="sim_oper_combo_plant_list">
	
            SELECT  HR.HID, HR.HID_NAME
              FROM  HRCHY HR, DUAL
             WHERE  HR.LVL_TYPE = '공장' 
               AND  HR.MADE_TYPE != 'DE'
             ORDER  BY HR.HID_NAME
	
	</query>
	
	<!-- 콤보박스: 생산 라인 리스트 -->
	<query id="sim_oper_combo_line_list">
	
            SELECT  HR.HID AS LINE_ID,
            		HR.HID_NAME AS LINE_NAME,
            		HR.HTYPE AS PLANT_ID                   
            FROM    HRCHY HR, DUAL
            WHERE   HR.LVL_TYPE = '라인'
            ORDER   BY HR.HTYPE, HR.HID 
	
	</query>
	
	<!-- 콤보박스: 제품 리스트 -->
	<query id="sim_oper_combo_item_list"> 
			<!-- 공장별 생산 제품 중 완제품, 멀티인 제품만 -->
             SELECT  IM.ITEM_ID, IM.ITEM_NAME, ID.PLANT_ID
               FROM  ITEM_MST IM, ITEM_DTL ID
              WHERE  IM.ITEM_ID = ID.ITEM_ID(+)
                AND  IM.MADE_TYPE != 'DE'
                AND  ID.MADE_TYPE != 'DE'
                AND  IM.ITYPE = 'FERT'
                AND  IM.MULTI_FLAG = 'M'
              ORDER  BY IM.ITEM_NAME
              
	</query>
	
	<!-- 콤보박스: 포장기리스트 -->
	<query id="sim_oper_combo_proc_list">
	
			SELECT  VH.PROC_ID, VH.PROC_NAME
			  FROM  V_HRCHY_PROC VH
			 WHERE  VH.PLANT_ID = '$!{plant_id}'   
			   AND  VH.LINE_ID = '$!{line_id}'
			   AND  VH.CAT = '포장'
			 ORDER  BY VH.PROC_ID
			
	</query>	
	
	<!--콤보박스: 동시가동 불가호기 리스트-->
	<query id="sim_oper_combo_excl_proc_list">	
				
            SELECT  VH.PROC_ID, VH.PROC_NAME
              FROM  V_HRCHY_PROC VH
             WHERE  VH.PLANT_ID = '$!{selected_plant}'
               AND  VH.CAT = '포장'    
             ORDER  BY VH.PROC_ID
	
	</query> 
	
	<!--콤보박스: 작업특징 리스트 -->
	<query id="sim_oper_combo_mc_list">
	
            SELECT  CD AS MC_CODE, CD_NAME AS MC_NAME
            FROM    CODE_MST, DUAL
            WHERE   CD_GRP = 'EXCL_PROC'
            ORDER	BY CD	
	
	</query>
	
	<!-- 멀티포장 동시제약:저장 -->
	<!-- 01. 검색된 조건의 데이터를 DB에서 모두 삭제 -->
	<query id="sc_02010_simultaneousOperationConstraint_list_save_01">
				
			DELETE  EXCL_PROC
			 WHERE  PLANT_ID = '$!{stored_plant}'
			  [AND  LINE_ID = '${selected_line}']
			  [AND  ITEM_ID = '${selected_item}']
   
	</query>	
	
	<!-- 멀티포장 동시제약:저장 -->
	<!-- 02. 화면에 있는 데이터를 모두 INSERT -->
	<query id="sc_02010_simultaneousOperationConstraint_list_save_02" fix="_user_id" iterator="plant_id item_id line_id proc_id excl_proc_id mc_type">
	
			INSERT  INTO EXCL_PROC( PLANT_ID, ITEM_ID, LINE_ID, PROC_ID, EXCL_PROC_ID, MC_TYPE, MADE_TYPE, MADE_DTTM, MADE_BY )
			SELECT  '$!{plant_id}' AS PLANT_ID
			        , '$!{item_id}' AS ITEM_ID
			        , '$!{line_id}' AS LINE_ID
			        , '$!{proc_id}' AS PROC_ID
			        , '$!{excl_proc_id}' AS EXCL_PROC_ID
			        , '$!{mc_type}' AS MC_TYPE
			        , 'AD' AS MADE_TYPE
			        , SYSDATE AS MADE_DTTM
			        , '$!{_user_id}' AS MADE_BY
			  FROM  DUAL
			 WHERE  NOT EXISTS (
			            SELECT  PLANT_ID
			              FROM  EXCL_PROC EP
			             WHERE  EP.PLANT_ID = '$!{plant_id}'
			               AND  EP.ITEM_ID = '$!{item_id}'
			               AND  EP.LINE_ID = '$!{line_id}'
			               AND  EP.PROC_ID = '$!{proc_id}'
			               AND  EP.EXCL_PROC_ID = '$!{excl_proc_id}'
			               AND	EP.MC_TYPE = '$!{mc_type}'
			        )
	
	</query>
	
	<!-- 멀티포장 동시제약:삭제(화면에 있는 데이이터 모두 삭제 -->
	<query id="sc_02010_simultaneousOperationConstraint_list_del" fix="" iterator="plant_id item_id line_id proc_id excl_proc_id mc_type">
				
			DELETE  EXCL_PROC
			WHERE  	PLANT_ID = '$!{plant_id}'
			AND		ITEM_ID = '$!{item_id}'
			AND		LINE_ID = '$!{line_id}'
			AND		PROC_ID = '$!{proc_id}'
			AND		EXCL_PROC_ID = '$!{excl_proc_id}'
			AND		MC_TYPE = '$!{mc_type}'
   
	</query>
	
<!--	
=====================================================================================================
	생산계획 >> 생산계획
=====================================================================================================
--> 

	<!-- 
	=============================
		공통 쿼리
	=============================
	-->

	<!-- 콤보박스 : 영업품종분류1 리스트 -->
	<query id="month_combo_sales_cat1_list">
	
            SELECT  CM.CD, CM.CD_NAME
              FROM  CODE_MST CM, (SELECT 'A' A FROM DUAL) A
             WHERE  CM.MADE_TYPE != 'DE'
               AND  CM.CD_GRP = 'SALES_CAT1'
             ORDER  BY CM.CD_NAME
 
	</query>
		
	<!-- 계획버전 리스트 -->
	<query id="monthly_plant_alloc_combo_version_list">
	
			SELECT  PV.VERSION, ROWNUM NUM, PV.STATUS
			  FROM  (   SELECT  PV.VERSION, PV.STATUS
			              FROM  PLAN_VERSION_LOG PV, (SELECT 'A' FROM DUAL) A
			             WHERE  PV.MADE_TYPE != 'DE'
			               AND  PV.PERIOD_TYPE = 'MONTHLY'
			               AND  PV.CAT_ID = 'FA'
			               AND  PV.VERSION IS NOT NULL
			             ORDER  BY PV.VERSION DESC ) PV
			 WHERE  ROWNUM &lt; 21
			 
	</query>
	
	<!-- grid monthly date -->
	<query id="grid_months">
			#if( "$!{selected_version}" == "" )
			<!-- 화면 최초 실행시 -->
			SELECT  TO_CHAR(ADD_MONTHS(MV.DUE_DATE,-1), 'YYYY/MM') PRE
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,0), 'YYYY/MM') M01
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,1), 'YYYY/MM') M02
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,2), 'YYYY/MM') M03
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,3), 'YYYY/MM') M04
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,4), 'YYYY/MM') M05
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,5), 'YYYY/MM') M06
			  FROM  (   SELECT  MIN(DUE_DATE) DUE_DATE
			              FROM  PLANT_ALLOC_PLAN
			             WHERE  VERSION = ( SELECT  MAX(PV.VERSION) VERSION
			                                  FROM  PLAN_VERSION_LOG PV
			                                 WHERE  PV.MADE_TYPE != 'DE'
			                                   AND  PV.PERIOD_TYPE = 'MONTHLY'
			                                   AND  PV.CAT_ID = 'FA' ) ) MV
			#else                                  
			SELECT  TO_CHAR(ADD_MONTHS(MV.DUE_DATE,-1), 'YYYY/MM') PRE
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,0), 'YYYY/MM') M01
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,1), 'YYYY/MM') M02
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,2), 'YYYY/MM') M03
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,3), 'YYYY/MM') M04
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,4), 'YYYY/MM') M05
			        , TO_CHAR(ADD_MONTHS(MV.DUE_DATE,5), 'YYYY/MM') M06
			  FROM  (   SELECT  MIN(DUE_DATE) DUE_DATE
			              FROM  PLANT_ALLOC_PLAN
			             WHERE  VERSION = '$!{selected_version}' ) MV
			 #end
			 
	</query>
		
	<!-- 
	=============================
		공장별 월간 공장할당계획 조회
	=============================
	-->
	
	<!-- 월간 공장할당계획 조회(공장별) -->
	<query id="sc_06010_monthlyProductionPlanByPlant_list" paging="true">
	
			#if("$!{selected_version}" == "")
			<!-- 화면 최초 실행시 -->
            SELECT  HR.PLANT_NAME, CM.CD_NAME TYPE1, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC
            		, SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) TOT -- 합계
            		------------------------------------------------------------------------------------------------------------------------------------------------------------------------                  
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,-1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) PRE_QTY --전월 생산 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M00_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M01_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M02_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M03_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M04_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M05_BEST_QTY --최적생산량 수량
              FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_DTL ID
                    , ( SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.SALES_CAT01
                          FROM  ITEM_MST IM
                         WHERE  IM.MADE_TYPE != 'DE'
                           AND  IM.ITYPE = 'FERT' 
                      ) IM  -- 완제품
                    , ( SELECT  HR.HID PLANT_ID, HR.HID_NAME PLANT_NAME
                          FROM  HRCHY HR
                         WHERE  HR.MADE_TYPE != 'DE'
                           AND  HR.LVL_TYPE = '공장' 
                      ) HR  
                    , ( SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.MADE_TYPE != 'DE'
                           AND  CM.CD_GRP = 'SALES_CAT1' 
                      ) CM   -- 영업품종분류1 목록
                    , ( SELECT  MAX(PV.VERSION) VERSION
                          FROM  PLAN_VERSION_LOG PV
                         WHERE  PV.MADE_TYPE != 'DE'
                           AND  PV.PERIOD_TYPE = 'MONTHLY'
                           AND  PV.CAT_ID = 'FA' 
                      ) MV  -- 최신버전   
                    , ( SELECT  MIN(DUE_DATE) DUE_DATE
                          FROM  PLANT_ALLOC_PLAN
                         WHERE  VERSION = ( SELECT  MAX(PV.VERSION) VERSION
                                              FROM  PLAN_VERSION_LOG PV
                                             WHERE  PV.MADE_TYPE != 'DE'
                                               AND  PV.PERIOD_TYPE = 'MONTHLY'
                                               AND  PV.CAT_ID = 'FA' ) 
                      ) MD -- 계획 최초 일자       
             WHERE  PA.MADE_TYPE != 'DE'
               AND  ID.MADE_TYPE != 'DE'
               AND  PA.PLANT_ID = ID.PLANT_ID(+)
               AND  PA.ITEM_ID = ID.ITEM_ID(+)
               AND  PA.PLANT_ID = HR.PLANT_ID -- 공장이름 가져오기위해서
               AND  PA.ITEM_ID = IM.ITEM_ID(+)               
               AND  IM.SALES_CAT01 = CM.CD
               AND  PA.VERSION = MV.VERSION              
             GROUP  BY HR.PLANT_NAME, CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC
             ORDER  BY HR.PLANT_NAME, CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC			 
			#else			
            SELECT  HR.PLANT_NAME, CM.CD_NAME TYPE1, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC
            		, SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) TOT -- 합계
            		------------------------------------------------------------------------------------------------------------------------------------------------------------------------                  
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,-1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) PRE_QTY --전월 생산 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M00_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M01_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M02_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M03_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M04_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M05_BEST_QTY --최적생산량 수량
              FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_DTL ID
                    , ( SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.SALES_CAT01
                          FROM  ITEM_MST IM
                         WHERE  IM.MADE_TYPE != 'DE'
                           AND  IM.ITYPE = 'FERT' 
                      ) IM  -- 완제품
                    , ( SELECT  HR.HID PLANT_ID, HR.HID_NAME PLANT_NAME
                          FROM  HRCHY HR
                         WHERE  HR.MADE_TYPE != 'DE'
                           AND  HR.LVL_TYPE = '공장' 
                      ) HR  
                    , ( SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.MADE_TYPE != 'DE'
                           AND  CM.CD_GRP = 'SALES_CAT1' 
                      ) CM   -- 영업품종분류1 목록                    
                    , ( SELECT  MIN(DUE_DATE) DUE_DATE
                          FROM  PLANT_ALLOC_PLAN
                         WHERE  VERSION = '$!{selected_version}' 
                      ) MD     -- 버전  
             WHERE  PA.MADE_TYPE != 'DE'
               AND  ID.MADE_TYPE != 'DE'
               AND  PA.PLANT_ID = ID.PLANT_ID(+)
               AND  PA.ITEM_ID = ID.ITEM_ID(+)
               AND  PA.PLANT_ID = HR.PLANT_ID -- 공장이름 가져오기위해서
               AND  PA.ITEM_ID = IM.ITEM_ID(+)               
               AND  IM.SALES_CAT01 = CM.CD
               AND  PA.VERSION = '$!{selected_version}'        --버전
              [AND  PA.PLANT_ID = '${selected_plant}']       --공장
              [AND  IM.SALES_CAT01 = '${selected_sales_cat1}']    --영업품종분류1
              [AND  PA.ITEM_ID LIKE '%${item_id}%']
              [AND  IM.ITEM_NAME LIKE '%${item_name}%']
             GROUP  BY HR.PLANT_NAME, CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC
             ORDER  BY HR.PLANT_NAME, CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC                                                  
			#end          
           
	</query>

	<!-- 
	=============================
		대분류별 월간 생산계획 조회
	=============================
	-->
	
	<!-- 대분류별 월간 생산계획 조회 -->
	<query id="sc_06020_monthlyProductionPlanByItem_list" paging="true">
			
			#if("$!{selected_version}" == "")
			<!-- 화면 최초 실행시 -->
            SELECT  CM.CD_NAME TYPE1, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.PLANT_NAME
            		, SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) TOT -- 합계
            		------------------------------------------------------------------------------------------------------------------------------------------------------------------------                 
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,-1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) PRE_QTY --전월 생산 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M00_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M01_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M02_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M03_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M04_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M05_BEST_QTY --최적생산량 수량
              FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_DTL ID
                    , ( SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.SALES_CAT01
                          FROM  ITEM_MST IM
                         WHERE  IM.MADE_TYPE != 'DE'
                           AND  IM.ITYPE = 'FERT' 
                      ) IM  -- 완제품
                    , ( SELECT  HR.HID PLANT_ID, HR.HID_NAME PLANT_NAME
                          FROM  HRCHY HR
                         WHERE  HR.MADE_TYPE != 'DE'
                           AND  HR.LVL_TYPE = '공장' 
                      ) HR  
                    , ( SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.MADE_TYPE != 'DE'
                           AND  CM.CD_GRP = 'SALES_CAT1' 
                      ) CM   -- 영업품종분류1 목록
                    , ( SELECT  MAX(PV.VERSION) VERSION
                          FROM  PLAN_VERSION_LOG PV
                         WHERE  PV.MADE_TYPE != 'DE'
                           AND  PV.PERIOD_TYPE = 'MONTHLY'
                           AND  PV.CAT_ID = 'FA' 
                      ) MV  -- 최신버전   
                    , ( SELECT  MIN(DUE_DATE) DUE_DATE
                          FROM  PLANT_ALLOC_PLAN
                         WHERE  VERSION = ( SELECT  MAX(PV.VERSION) VERSION
                                              FROM  PLAN_VERSION_LOG PV
                                             WHERE  PV.MADE_TYPE != 'DE'
                                               AND  PV.PERIOD_TYPE = 'MONTHLY'
                                               AND  PV.CAT_ID = 'FA' ) 
                      ) MD -- 계획 최초 일자       
             WHERE  PA.MADE_TYPE != 'DE'
               AND  ID.MADE_TYPE != 'DE'
               AND  PA.PLANT_ID = ID.PLANT_ID(+)
               AND  PA.ITEM_ID = ID.ITEM_ID(+)
               AND  PA.PLANT_ID = HR.PLANT_ID -- 공장이름 가져오기위해서
               AND  PA.ITEM_ID = IM.ITEM_ID(+)               
               AND  IM.SALES_CAT01 = CM.CD
               AND  PA.VERSION = MV.VERSION              
             GROUP  BY CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.PLANT_NAME
             ORDER  BY CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.PLANT_NAME	 
			#else			
            SELECT  CM.CD_NAME TYPE1, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.PLANT_NAME
            		, SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) 
                    + SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) TOT -- 합계
            		------------------------------------------------------------------------------------------------------------------------------------------------------------------------                  
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,-1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) PRE_QTY --전월 생산 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,0), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M00_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,1), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M01_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,2), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M02_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,3), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M03_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,4), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M04_BEST_QTY --최적생산량 수량
                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYY-MM') = TO_CHAR(ADD_MONTHS(MD.DUE_DATE,5), 'YYYY-MM') THEN  PA.QTY ELSE 0 END) M05_BEST_QTY --최적생산량 수량
              FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA, ITEM_DTL ID
                    , ( SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.SALES_CAT01
                          FROM  ITEM_MST IM
                         WHERE  IM.MADE_TYPE != 'DE'
                           AND  IM.ITYPE = 'FERT' 
                      ) IM  -- 완제품
                    , ( SELECT  HR.HID PLANT_ID, HR.HID_NAME PLANT_NAME
                          FROM  HRCHY HR
                         WHERE  HR.MADE_TYPE != 'DE'
                           AND  HR.LVL_TYPE = '공장' 
                      ) HR  
                    , ( SELECT  CM.CD, CM.CD_NAME
                          FROM  CODE_MST CM
                         WHERE  CM.MADE_TYPE != 'DE'
                           AND  CM.CD_GRP = 'SALES_CAT1' 
                      ) CM   -- 영업품종분류1 목록                    
                    , ( SELECT  MIN(DUE_DATE) DUE_DATE
                          FROM  PLANT_ALLOC_PLAN
                         WHERE  VERSION = '$!{selected_version}' 
                      ) MD     -- 버전  
             WHERE  PA.MADE_TYPE != 'DE'
               AND  ID.MADE_TYPE != 'DE'
               AND  PA.PLANT_ID = ID.PLANT_ID(+)
               AND  PA.ITEM_ID = ID.ITEM_ID(+)
               AND  PA.PLANT_ID = HR.PLANT_ID -- 공장이름 가져오기위해서
               AND  PA.ITEM_ID = IM.ITEM_ID(+)               
               AND  IM.SALES_CAT01 = CM.CD
               AND  PA.VERSION = '$!{selected_version}'        --버전
              [AND  PA.PLANT_ID = '${selected_plant}']       --공장
              [AND  IM.SALES_CAT01 = '${selected_sales_cat1}']    --영업품종분류1
              [AND  PA.ITEM_ID LIKE '%${item_id}%']
              [AND  IM.ITEM_NAME LIKE '%${item_name}%']
             GROUP  BY CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.PLANT_NAME
             ORDER  BY CM.CD_NAME, PA.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.PLANT_NAME                                             
			#end          
	
	</query>
	
<!--	
=====================================================================================================
	생산계획 >> 기준정보 
=====================================================================================================
--> 
	
	<!-- 
	=============================
		조 운영 캘린더 관리
	=============================
	-->
	
	<!-- 조 운영 캘린더 관리 조회 -->
	<query id="sc_01050_shiftOperationCalendar_list">
	
			SELECT  HR.TEAM_ID, HR.TEAM_NAME, HR.LINE_ID, HR.LINE_NAME, HR.PROC_ID, HR.PROC_NAME
			        , CA.TEAM_TYPE, CA.BREAK, CA.ETC
			        , CA.D01_SHIFT1_WORKTY_ID, CA.D01_SHIFT1_O_FLAG, CA.D01_SHIFT1_TEAM, CA.D01_SHIFT1_ID
			        , CA.D01_SHIFT3_WORKTY_ID, CA.D01_SHIFT3_O_FLAG, CA.D01_SHIFT3_TEAM, CA.D01_SHIFT3_ID
			        , CA.D01_SHIFT5_WORKTY_ID, CA.D01_SHIFT5_O_FLAG, CA.D01_SHIFT5_TEAM, CA.D01_SHIFT5_ID
			        ---------------------------------------------------------------------------
			        , CA.D02_SHIFT1_WORKTY_ID, CA.D02_SHIFT1_O_FLAG, CA.D02_SHIFT1_TEAM, CA.D02_SHIFT1_ID
			        , CA.D02_SHIFT3_WORKTY_ID, CA.D02_SHIFT3_O_FLAG, CA.D02_SHIFT3_TEAM, CA.D02_SHIFT3_ID
			        , CA.D02_SHIFT5_WORKTY_ID, CA.D02_SHIFT5_O_FLAG, CA.D02_SHIFT5_TEAM, CA.D02_SHIFT5_ID
			        ---------------------------------------------------------------------------
			        , CA.D03_SHIFT1_WORKTY_ID, CA.D03_SHIFT1_O_FLAG, CA.D03_SHIFT1_TEAM, CA.D03_SHIFT1_ID
			        , CA.D03_SHIFT3_WORKTY_ID, CA.D03_SHIFT3_O_FLAG, CA.D03_SHIFT3_TEAM, CA.D03_SHIFT3_ID
			        , CA.D03_SHIFT5_WORKTY_ID, CA.D03_SHIFT5_O_FLAG, CA.D03_SHIFT5_TEAM, CA.D03_SHIFT5_ID
			        ---------------------------------------------------------------------------
			        , CA.D04_SHIFT1_WORKTY_ID, CA.D04_SHIFT1_O_FLAG, CA.D04_SHIFT1_TEAM, CA.D04_SHIFT1_ID
			        , CA.D04_SHIFT3_WORKTY_ID, CA.D04_SHIFT3_O_FLAG, CA.D04_SHIFT3_TEAM, CA.D04_SHIFT3_ID
			        , CA.D04_SHIFT5_WORKTY_ID, CA.D04_SHIFT5_O_FLAG, CA.D04_SHIFT5_TEAM, CA.D04_SHIFT5_ID
			        ---------------------------------------------------------------------------
			        , CA.D05_SHIFT1_WORKTY_ID, CA.D05_SHIFT1_O_FLAG, CA.D05_SHIFT1_TEAM, CA.D05_SHIFT1_ID
			        , CA.D05_SHIFT3_WORKTY_ID, CA.D05_SHIFT3_O_FLAG, CA.D05_SHIFT3_TEAM, CA.D05_SHIFT3_ID
			        , CA.D05_SHIFT5_WORKTY_ID, CA.D05_SHIFT5_O_FLAG, CA.D05_SHIFT5_TEAM, CA.D05_SHIFT5_ID
			        ---------------------------------------------------------------------------
			        , CA.D06_SHIFT1_WORKTY_ID, CA.D06_SHIFT1_O_FLAG, CA.D06_SHIFT1_TEAM, CA.D06_SHIFT1_ID
			        , CA.D06_SHIFT3_WORKTY_ID, CA.D06_SHIFT3_O_FLAG, CA.D06_SHIFT3_TEAM, CA.D06_SHIFT3_ID
			        , CA.D06_SHIFT5_WORKTY_ID, CA.D06_SHIFT5_O_FLAG, CA.D06_SHIFT5_TEAM, CA.D06_SHIFT5_ID
			        ---------------------------------------------------------------------------
			        , CA.D07_SHIFT1_WORKTY_ID, CA.D07_SHIFT1_O_FLAG, CA.D07_SHIFT1_TEAM, CA.D07_SHIFT1_ID
			        , CA.D07_SHIFT3_WORKTY_ID, CA.D07_SHIFT3_O_FLAG, CA.D07_SHIFT3_TEAM, CA.D07_SHIFT3_ID
			        , CA.D07_SHIFT5_WORKTY_ID, CA.D07_SHIFT5_O_FLAG, CA.D07_SHIFT5_TEAM, CA.D07_SHIFT5_ID
			        ---------------------------------------------------------------------------        
			  FROM  (   SELECT  VH.PLANT_ID, VH.PLANT_NAME, VH.TEAM_ID, VH.TEAM_NAME, VH.LINE_ID
			                    , VH.LINE_NAME, VH.PROC_ID, VH.PROC_NAME
			              FROM  V_HRCHY_PROC VH
			             WHERE  VH.PLANT_ID = '$!{selected_plant}'
			             --WHERE  VH.PLANT_ID = '1120'
			              [AND  VH.TEAM_ID = '${selected_won}'] -- 원가부문 
			               --AND  VH.TEAM_ID = '120'
			              [AND  VH.LINE_ID = '${selected_line}'] -- 라인
			             ORDER  BY VH.PLANT_ID, VH.TEAM_ID, VH.LINE_ID, VH.PROC_ID ) HR
			        ,(  SELECT  WD.PLANT_ID, WD.PROC_ID
			                    , MAX(SUBSTR(WD.WORKTY_ID,1,1)) || '교대' AS TEAM_TYPE
			                    , DECODE(MAX(SUBSTR(WD.WORKTY_ID,3,1)),'N','X','B','O') AS BREAK
			                    , DECODE(MAX(SUBSTR(WD.WORKTY_ID,4,1))
			                        ,'A','일반','B','음료','C','(조/야)','D','(조/주)','E','주간상주','F','야간') AS ETC
			                    ---------------------------------------------------------------------------------
			                    /* 일요일 */
			                    --조간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')         
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D01_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ') 
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D01_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ') 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D01_SHIFT1_TEAM --조간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D01_SHIFT1_ID -- 조간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --주간        
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'    
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D01_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D01_SHIFT3_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D01_SHIFT3_TEAM --주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD')
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D01_SHIFT3_ID -- 주간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------    
			                    --야간    
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D01_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D01_SHIFT5_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D01_SHIFT5_TEAM --야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D01_SHIFT5_ID -- 야간 SHIFT_ID
			                    /***************************************************************************************/
			                    /*월요일*/
			                    --조간     
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D02_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D02_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D02_SHIFT1_TEAM -- 조간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D02_SHIFT1_ID -- 조간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --주간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D02_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'       
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D02_SHIFT3_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D02_SHIFT3_TEAM -- 주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D02_SHIFT3_ID -- 주간 SHIFT_ID
			                    -----------------------------------------------------------------------------------------
			                    --야간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D02_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')       
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D02_SHIFT5_O_FLAG -- 연장 FLAG        
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D02_SHIFT5_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D02_SHIFT5_ID -- 야간 SHIFT_ID
			                    /****************************************************************************************/
			                    /*화요일*/
			                    --조간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D03_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')      
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D03_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D03_SHIFT1_TEAM -- 조간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D03_SHIFT1_ID -- 조간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------  
			                    --주간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'         
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D03_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'         
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D03_SHIFT3_O_FLAG -- 연장 FLAG      
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D03_SHIFT3_TEAM -- 주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D03_SHIFT3_ID -- 주간 SHIFT_ID
			                    -----------------------------------------------------------------------------------------
			                    --야간 
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                   AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')         
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D03_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')      
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D03_SHIFT5_O_FLAG -- 연장 FLAG       
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D03_SHIFT5_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')    
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D03_SHIFT5_ID -- 야간 SHIFT_ID
			                    /****************************************************************************************/
			                    /*수요일*/
			                    --조간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')      
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D04_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')       
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D04_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D04_SHIFT1_TEAM -- 조간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D04_SHIFT1_ID -- 조간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --주간        
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'          
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D04_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'          
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D04_SHIFT3_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D04_SHIFT3_TEAM -- 주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D04_SHIFT3_ID -- 주간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --야간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')          
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D04_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')         
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D04_SHIFT5_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D04_SHIFT5_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D04_SHIFT5_ID -- 야간 SHIFT_ID
			                    /****************************************************************************************/
			                    /*목요일*/
			                    --조간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D05_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D05_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D05_SHIFT1_TEAM -- 조간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D05_SHIFT1_ID -- 조간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --주간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D05_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D05_SHIFT3_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D05_SHIFT3_TEAM -- 주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D05_SHIFT3_ID -- 주간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --야간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D05_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D05_SHIFT5_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D05_SHIFT5_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D05_SHIFT5_ID -- 야간 SHIFT_ID
			                    /****************************************************************************************/
			                    /*금요일*/
			                    --조간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D06_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D06_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D06_SHIFT1_TEAM -- 조간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D06_SHIFT1_ID -- 조간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --주간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D06_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D06_SHIFT3_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D06_SHIFT3_TEAM -- 주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D06_SHIFT3_ID -- 주간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --야간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D06_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D06_SHIFT5_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D06_SHIFT5_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D06_SHIFT5_ID -- 야간 SHIFT_ID
			                    /***************************************************************************************/
			                    /*토요일*/
			                    --조간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D07_SHIFT1_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D07_SHIFT1_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D07_SHIFT1_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D07_SHIFT1_ID -- 야간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --주간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D07_SHIFT3_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D07_SHIFT3_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D07_SHIFT3_TEAM -- 주간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY' 
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D07_SHIFT3_ID -- 주간 SHIFT_ID
			                    ----------------------------------------------------------------------------------------
			                    --야간
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                   AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')        
			                            THEN WD.WORKTY_ID 
			                            ELSE '' 
			                            END) D07_SHIFT5_WORKTY_ID -- WORKTY_ID
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                   AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')        
			                            THEN SUBSTR(WD.WORKTY_ID,2,1) 
			                            ELSE '' 
			                            END) D07_SHIFT5_O_FLAG -- 연장 FLAG
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                    AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.DUTY_TEAM 
			                            ELSE '' 
			                            END) D07_SHIFT5_TEAM -- 야간 조
			                    , MAX(CASE 
			                            WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
			                                   AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')   
			                            THEN WD.SHIFT_ID 
			                            ELSE '' 
			                            END) D07_SHIFT5_ID -- 야간 SHIFT_ID
			                    -------------------------------------------------------------------------------------------------------------------------------------------------
			              FROM  WORK_DIARY WD
			             WHERE  WD.PLANT_ID = '$!{selected_plant}'
			             --WHERE  WD.PLANT_ID = '1120'
			               AND  WD.DUTY_DATE BETWEEN TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD')
                           AND  TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD')
			             GROUP  BY WD.PLANT_ID, WD.PROC_ID ) CA
			 WHERE  HR.PLANT_ID = CA.PLANT_ID(+)
			   AND  HR.PROC_ID = CA.PROC_ID(+)    
			 ORDER  BY CA.PROC_ID
	
	</query>
	
	<!-- WORK TYPE 리스트 -->
	<query id="shif_oper_cal_workty_list">
	
			SELECT  DISTINCT WM.WORKTY_ID, WM.WORKTY_DESC
			  FROM  WORKTY_MST WM
			 WHERE  WM.MADE_TYPE != 'DE'
	
	</query>
	
	<!-- 라인 리스트 -->
	<query id="shift_oper_cal_combo_line_list">
	
            SELECT  DISTINCT 
            		VH.PLANT_ID, VH.TEAM_ID, VH.LINE_ID, VH.LINE_NAME
              FROM  V_HRCHY_PROC VH
             ORDER  BY VH.PLANT_ID, VH.TEAM_ID, VH.LINE_NAME   
	
	</query>	
	
	<query id="sc_01050_shiftOperationCalendar_list_save_01" fix="stored_plant stored_duty_date" iterator="proc_cd sun_shift1_workty_id sun_shift1_shift_id shift_1_sun sun_shift1_check_flag sun_shift3_workty_id sun_shift3_shift_id shift_3_sun sun_shift3_check_flag sun_shift5_workty_id sun_shift5_shift_id shift_5_sun sun_shift5_check_flag mon_shift1_workty_id mon_shift1_shift_id shift_1_mon mon_shift1_check_flag mon_shift3_workty_id mon_shift3_shift_id shift_3_mon mon_shift3_check_flag mon_shift5_workty_id mon_shift5_shift_id shift_5_mon mon_shift5_check_flag tue_shift1_workty_id tue_shift1_shift_id shift_1_tue tue_shift1_check_flag tue_shift3_workty_id tue_shift3_shift_id shift_3_tue tue_shift3_check_flag tue_shift5_workty_id tue_shift5_shift_id shift_5_tue tue_shift5_check_flag wed_shift1_workty_id wed_shift1_shift_id shift_1_wed wed_shift1_check_flag wed_shift3_workty_id wed_shift3_shift_id shift_3_wed wed_shift3_check_flag wed_shift5_workty_id wed_shift5_shift_id shift_5_wed wed_shift5_check_flag thu_shift1_workty_id thu_shift1_shift_id shift_1_thu thu_shift1_check_flag thu_shift3_workty_id thu_shift3_shift_id shift_3_thu thu_shift3_check_flag thu_shift5_workty_id thu_shift5_shift_id shift_5_thu thu_shift5_check_flag fri_shift1_workty_id fri_shift1_shift_id shift_1_fri fri_shift1_check_flag fri_shift3_workty_id fri_shift3_shift_id shift_3_fri fri_shift3_check_flag fri_shift5_workty_id fri_shift5_shift_id shift_5_fri fri_shift5_check_flag sat_shift1_workty_id sat_shift1_shift_id shift_1_sat sat_shift1_check_flag sat_shift3_workty_id sat_shift3_shift_id shift_3_sat sat_shift3_check_flag sat_shift5_workty_id sat_shift5_shift_id shift_5_sat sat_shift5_check_flag">
	
            UPDATE  /*+ bypass_ujvc*/
                    (
                    SELECT  WD.WORKTY_ID, WD.SHIFT_ID, WD.START_TIME, WD.END_TIME, WD.PAUSE_TIME, 
                            WD.WORK_TIME, WD.DUTY_TEAM, WD.IF_FLAG,
                            IP.O_WORKTY_ID, IP.O_SHIFT_ID, IP.O_START_TIME, IP.O_END_TIME, 
                            IP.O_PAUSE_TIME, IP.O_WORK_TIME, IP.DUTY_TEAM AS NEW_DUTY_TEAM, 
                            IP.IF_FLAG AS NEW_IF_FLAG
                    FROM    (
                            SELECT  WD.PLANT_ID, WD.DUTY_DATE, WD.PROC_ID, WD.WORKTY_ID, WD.SHIFT_ID, 
                            WD.START_TIME, WD.END_TIME, WD.PAUSE_TIME, WD.WORK_TIME, WD.DUTY_TEAM, 
                            WD.IF_FLAG, WD.IF_DATE, WD.IF_TIME, WD.IF_MSGS, WD.IF_UNAME 
                            FROM    WORK_DIARY WD
                            WHERE   WD.PLANT_ID = '$!{stored_plant}'
                            AND     WD.PROC_ID = '$!{proc_cd}'
                            )   WD, 
                            (
                            /*일요일*/
                            --조간
                            SELECT  '$!{sun_shift1_workty_id}' AS WORKTY_ID, '$!{sun_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_sun}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{sun_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{sun_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{sun_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{sun_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{sun_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{sun_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{sun_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{sun_shift1_shift_id}'
                            AND     '$!{sun_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{sun_shift3_workty_id}' AS WORKTY_ID, '$!{sun_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_sun}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{sun_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{sun_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{sun_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{sun_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{sun_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{sun_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{sun_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{sun_shift3_shift_id}'
                            AND     '$!{sun_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{sun_shift5_workty_id}' AS WORKTY_ID, '$!{sun_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_sun}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{sun_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{sun_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{sun_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{sun_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{sun_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{sun_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{sun_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{sun_shift5_shift_id}'
                            AND     '$!{sun_shift5_check_flag}' &gt; '0'
                            /******************************************************************************/
                            UNION   ALL
                            /*월요일*/
                            --조간
                            SELECT  '$!{mon_shift1_workty_id}' AS WORKTY_ID, '$!{mon_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_mon}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{mon_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{mon_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{mon_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{mon_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{mon_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{mon_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{mon_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{mon_shift1_shift_id}'
                            AND     '$!{mon_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{mon_shift3_workty_id}' AS WORKTY_ID, '$!{mon_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_mon}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{mon_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{mon_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{mon_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{mon_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{mon_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{mon_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{mon_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{mon_shift3_shift_id}'
                            AND     '$!{mon_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{mon_shift5_workty_id}' AS WORKTY_ID, '$!{mon_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_mon}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{mon_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{mon_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{mon_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{mon_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{mon_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{mon_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{mon_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{mon_shift5_shift_id}'
                            AND     '$!{mon_shift5_check_flag}' &gt; '0'
                            /******************************************************************************/
                            UNION   ALL
                            /*화요일*/
                            --조간
                            SELECT  '$!{tue_shift1_workty_id}' AS WORKTY_ID, '$!{tue_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_tue}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{tue_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{tue_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{tue_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{tue_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{tue_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{tue_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{tue_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{tue_shift1_shift_id}'
                            AND     '$!{tue_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{tue_shift3_workty_id}' AS WORKTY_ID, '$!{tue_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_tue}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{tue_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{tue_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{tue_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{tue_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{tue_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{tue_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{tue_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{tue_shift3_shift_id}'
                            AND     '$!{tue_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{tue_shift5_workty_id}' AS WORKTY_ID, '$!{tue_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_tue}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{tue_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{tue_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{tue_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{tue_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{tue_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{tue_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{tue_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{tue_shift5_shift_id}'
                            AND     '$!{tue_shift5_check_flag}' &gt; '0'
                            /******************************************************************************/
                            UNION   ALL
                            /*수요일*/
                            --조간
                            SELECT  '$!{wed_shift1_workty_id}' AS WORKTY_ID, '$!{wed_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_wed}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{wed_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{wed_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{wed_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{wed_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{wed_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{wed_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{wed_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{wed_shift1_shift_id}'
                            AND     '$!{wed_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{wed_shift3_workty_id}' AS WORKTY_ID, '$!{wed_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_wed}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{wed_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{wed_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{wed_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{wed_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{wed_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{wed_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{wed_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{wed_shift3_shift_id}'
                            AND     '$!{wed_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{wed_shift5_workty_id}' AS WORKTY_ID, '$!{wed_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_wed}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{wed_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{wed_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{wed_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{wed_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{wed_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{wed_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{wed_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{wed_shift5_shift_id}'
                            AND     '$!{wed_shift5_check_flag}' &gt; '0'
                            /******************************************************************************/
                            UNION   ALL
                            /*목요일*/
                            --조간
                            SELECT  '$!{thu_shift1_workty_id}' AS WORKTY_ID, '$!{thu_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_thu}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{thu_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{thu_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{thu_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{thu_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{thu_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{thu_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{thu_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{thu_shift1_shift_id}'
                            AND     '$!{thu_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{thu_shift3_workty_id}' AS WORKTY_ID, '$!{thu_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_thu}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{thu_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{thu_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{thu_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{thu_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{thu_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{thu_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{thu_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{thu_shift3_shift_id}'
                            AND     '$!{thu_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{thu_shift5_workty_id}' AS WORKTY_ID, '$!{thu_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_thu}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{thu_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{thu_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{thu_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{thu_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{thu_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{thu_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{thu_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{thu_shift5_shift_id}'
                            AND     '$!{thu_shift5_check_flag}' &gt; '0'
                            /******************************************************************************/
                            UNION   ALL
                            /*금요일*/
                            --조간
                            SELECT  '$!{fri_shift1_workty_id}' AS WORKTY_ID, '$!{fri_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_fri}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{fri_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{fri_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{fri_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{fri_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{fri_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{fri_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{fri_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{fri_shift1_shift_id}'
                            AND     '$!{fri_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{fri_shift3_workty_id}' AS WORKTY_ID, '$!{fri_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_fri}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{fri_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{fri_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{fri_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{fri_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{fri_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{fri_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{fri_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{fri_shift3_shift_id}'
                            AND     '$!{fri_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{fri_shift5_workty_id}' AS WORKTY_ID, '$!{fri_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_fri}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{fri_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{fri_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{fri_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{fri_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{fri_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{fri_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{fri_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{fri_shift5_shift_id}'
                            AND     '$!{fri_shift5_check_flag}' &gt; '0'
                            /******************************************************************************/
                            UNION   ALL
                            /*토요일*/
                            --조간
                            SELECT  '$!{sat_shift1_workty_id}' AS WORKTY_ID, '$!{sat_shift1_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_1_sat}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{sat_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{sat_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{sat_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{sat_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{sat_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{sat_shift1_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{sat_shift1_workty_id}'
                            AND     VM.SHIFT_ID = '$!{sat_shift1_shift_id}'
                            AND     '$!{sat_shift1_check_flag}' &gt; '0'
                            UNION   ALL
                            --주간
                            SELECT  '$!{sat_shift3_workty_id}' AS WORKTY_ID, '$!{sat_shift3_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') AS DUTY_DATE, 
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_3_sat}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{sat_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{sat_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{sat_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{sat_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{sat_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{sat_shift3_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{sat_shift3_workty_id}'
                            AND     VM.SHIFT_ID = '$!{sat_shift3_shift_id}'
                            AND     '$!{sat_shift3_check_flag}' &gt; '0'
                            UNION   ALL
                            --야간
                            SELECT  '$!{sat_shift5_workty_id}' AS WORKTY_ID, '$!{sat_shift5_shift_id}' AS SHIFT_ID, 
                                    TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') AS DUTY_DATE,  
                                    VM.START_TIME AS START_TIME, VM.END_TIME AS END_TIME, 
                                    VM.PAUSE_TIME AS PAUSE_TIME, VM.WORK_TIME AS WORK_TIME,
                                    '$!{shift_5_sat}' AS DUTY_TEAM, NULL AS IF_FLAG,
                                    CASE
                                    WHEN '$!{sat_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORKTY_ID
                                    ELSE
                                            VM.WORKTY_ID
                                    END     O_WORKTY_ID,
                                    CASE
                                    WHEN '$!{sat_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_SHIFT_ID
                                    ELSE
                                            VM.SHIFT_ID
                                    END     O_SHIFT_ID,
                                    CASE
                                    WHEN '$!{sat_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_START_TIME
                                    ELSE
                                            VM.START_TIME
                                    END     O_START_TIME,
                                    CASE
                                    WHEN '$!{sat_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_END_TIME
                                    ELSE
                                            VM.END_TIME
                                    END     O_END_TIME,
                                    CASE
                                    WHEN '$!{sat_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_PAUSE_TIME
                                    ELSE
                                            VM.PAUSE_TIME
                                    END     O_PAUSE_TIME,
                                    CASE
                                    WHEN '$!{sat_shift5_check_flag}' IN ('2','3')
                                    THEN
                                            VM.O_WORK_TIME
                                    ELSE
                                            VM.WORK_TIME
                                    END     O_WORK_TIME
                            FROM    V_MAP_WORKTY_MST VM
                            WHERE   VM.WORKTY_ID = '$!{sat_shift5_workty_id}'
                            AND     VM.SHIFT_ID = '$!{sat_shift5_shift_id}'
                            AND     '$!{sat_shift5_check_flag}' &gt; '0'
                            )   IP
                    WHERE   WD.WORKTY_ID = IP.WORKTY_ID
                    AND     WD.SHIFT_ID = IP.SHIFT_ID
                    AND     WD.DUTY_DATE = IP.DUTY_DATE  
                    )
            SET     WORKTY_ID = O_WORKTY_ID,
                    SHIFT_ID = O_SHIFT_ID,
                    START_TIME = O_START_TIME,
                    END_TIME = O_END_TIME,
                    PAUSE_TIME = O_PAUSE_TIME,
                    WORK_TIME = O_WORK_TIME,
                    DUTY_TEAM = NEW_DUTY_TEAM,
                    IF_FLAG = NEW_IF_FLAG
	
	</query>
	
	<!-- IF_FLAG를 NULL 변경 -->
	<query id="sc_01050_shiftOperationCalendar_list_save_02">
	
            UPDATE  WORK_DIARY
            SET     IF_FLAG = NULL
            WHERE   PLANT_ID = '$!{stored_plant}'
           [AND     PROC_ID LIKE '${stored_team}%']
            AND     DUTY_DATE BETWEEN   TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),'D'),'YYYYMMDD') 
                              AND       TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD')	
	
	</query>
	
	<!--조 운영 캘린더 변경시 work_diary_adj의 데이터를 변경하기 위해  -->
	<!--1. 조운영 캘린더 에서 변경된 내용을 work_diary_adj에서 delete  -->
	<query id="work_diary_adj_del">
	
			DELETE  WORK_DIARY_ADJ
			WHERE   PLANT_ID = '$!{stored_plant}'
		   [AND     PROC_ID LIKE '${stored_team}%'] -- 원가부문
		   [AND     PROC_ID LIKE SUBSTR('${stored_line}',1,4) || '%'] -- 라인
			AND     DUTY_DATE BETWEEN TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),'D'),'YYYYMMDD')
			                  AND     TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD')
	
	</query>
	
	<!--2. 변경된 데이터를 work_diary_adj에 insert  -->
	<query id="work_diary_adj_save">
	
			INSERT  INTO WORK_DIARY_ADJ
			SELECT  WD.PLANT_ID, WD.DUTY_DATE, WD.PROC_ID, WD.WORKTY_ID, WD.SHIFT_ID, WD.START_TIME, WD.END_TIME,
			        'AD' AS MADE_TYPE,
			        SYSDATE AS MADE_DTTM,
			        'admin' AS MADE_BY
			FROM    WORK_DIARY WD
			WHERE   PLANT_ID = '$!{stored_plant}'
		   [AND     PROC_ID LIKE '${stored_team}%'] -- 원가부문
		   [AND     PROC_ID LIKE SUBSTR('${stored_line}',1,4) || '%'] -- 라인
			AND     DUTY_DATE BETWEEN TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),'D'),'YYYYMMDD')
			                  AND     TO_CHAR(TRUNC(TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD')
	
	</query>
	
	<!--조 운영 캘린더 변경시 V_WORK_DIARY_IDX의 데이터를 변경하기 위해  -->
	<!--1. V_WORK_DIARY_IDX delete  -->
	<query id="v_work_diary_idx_del">
	
			DELETE  V_WORK_DIARY_IDX
	
	</query>
	
	<!--2. V_WORK_DIARY_IDX2 데이터를 V_WORK_DIARY_IDX에 insert  -->
	<query id="v_work_diary_idx_save">
	
			INSERT  INTO V_WORK_DIARY_IDX(PLANT_ID, PROC_ID, DUTY_DATE, SHIFT_NAME, IDX, START_TIME, END_TIME)
			SELECT  PLANT_ID, PROC_ID, DUTY_DATE, SHIFT_NAME, IDX, START_TIME, END_TIME 
			FROM    V_WORK_DIARY_IDX2
	
	</query>
	
	<!--  기본 패턴으로 work dairy data 생성 : 프로시저 호출 -->
	<query id="sc_01050_shiftOperationCalendar_list_create" >
			
			CALL SP_PS_WORK_DIARY_CREATE('CRE_DATA',TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'),1,1,'',sysdate);
			
	</query>
	
	<!-- 생성된 DATA WORK_DIARY_ADJ와 동기화 -->
	<query id="insert_work_diary_adj_new_data">
	
			INSERT  INTO WORK_DIARY_ADJ(PLANT_ID, DUTY_DATE, PROC_ID, WORKTY_ID, SHIFT_ID, 
			            START_TIME, END_TIME, MADE_TYPE, MADE_DTTM, MADE_BY)
			SELECT  PLANT_ID, DUTY_DATE, PROC_ID, WORKTY_ID, SHIFT_ID, START_TIME, END_TIME,
			        'AD' MADE_TYPE, SYSDATE MADE_DTTM, '$!{_user_id}' MADE_BY
			FROM    WORK_DIARY        
			WHERE   DUTY_DATE > (
			                    SELECT  MAX(DUTY_DATE)
			                    FROM    WORK_DIARY_ADJ
			                    )
	
	</query>
	
	<!--  음료공장 교대조 변경 : 프로시저 호출 -->
	<query id="sc_01050_shiftOperationCalendar_list_change" >
			
			CALL SP_PS_WORK_DIARY_PART_CREATE('CRE_DATA', TO_DATE('$!{stored_duty_date}','YYYY-MM-DD'), 1, 1, '$!{stored_plant}', SYSDATE, '$!{selected_line}', '$!{selected_job_type}', '$!{selected_break}', '$!{selected_etc}', '$!{selected_from_day}', '$!{selected_to_day}')
			
	</query>	
	
	<!--  차주이후 조운영칼레다 적용 : 프로시저 호출 -->
	<query id="sc_01050_SP_PS_WORK_DIARY_PLANT" >
			
			CALL SP_PS_WORK_DIARY_PLANT('CRE_DATA', TRUNC(SYSDATE), 1, 1, '$!{selected_plant}', SYSDATE, '$!{duty_date}')
			
	</query>	

	<!-- 헤더에 주차별 날짜 (일~토) -->
	<query id="shift_oper_cal_header_dates">
		
		#if("$!{duty_date}" == "")
			-- DEFAULT 오늘 날짜 기준  
			SELECT  TO_CHAR(TRUNC(SYSDATE, 'D')+0,'MM/DD(DY)') AS SUN
			        , TO_CHAR(TRUNC(SYSDATE, 'D')+1,'MM/DD(DY)') AS MON
			        , TO_CHAR(TRUNC(SYSDATE, 'D')+2,'MM/DD(DY)') AS TUE
			        , TO_CHAR(TRUNC(SYSDATE, 'D')+3,'MM/DD(DY)') AS WED
			        , TO_CHAR(TRUNC(SYSDATE, 'D')+4,'MM/DD(DY)') AS THU
			        , TO_CHAR(TRUNC(SYSDATE, 'D')+5,'MM/DD(DY)') AS FRI
			        , TO_CHAR(TRUNC(SYSDATE, 'D')+6,'MM/DD(DY)') AS SAT
			  FROM  DUAL
		#else
			-- 입력된 변수가 있을시
			SELECT  TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'MM/DD(DY)') AS SUN
			        , TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'MM/DD(DY)') AS MON
			        , TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'MM/DD(DY)') AS TUE
			        , TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'MM/DD(DY)') AS WED
			        , TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'MM/DD(DY)') AS THU
			        , TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'MM/DD(DY)') AS FRI
			        , TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'MM/DD(DY)') AS SAT
			  FROM  DUAL
		#end	   
			
	</query>
	
	<!-- 생성 버튼 활성화/비활성화 체크  -->
	<query id="create_button_able_check">
	
			/*
			    입력된 날짜의 주차 데이터가 WORK_DIARY 에 있으면 NULL
			                                             없으면 'Y'를 반환
			    ---------------------------------------------------------------
			    WORK_DIARY의 데이터를 생성하는 SP_PS_WORK_DIARY_CREATE 프로시저를
			    실행하는 버튼을 활성화 또는 비활성화 시키기 위해서 필요.                                             
			*/
			SELECT  'Y' AS DISABLE
			FROM    DUAL
			WHERE   EXISTS 
			        (
			        SELECT  DW.WORKTY_ID
			        FROM    WORK_DIARY DW, V_HRCHY_PROC VH
			        WHERE   DW.PLANT_ID = VH.PLANT_ID
			        AND     DW.PROC_ID  = VH.PROC_ID
			        AND     DW.PLANT_ID = '$!{selected_plant}'
			       [AND     VH.TEAM_ID = '${selected_won}']
			       [AND     VH.LINE_ID = '${selected_line}']
			        AND     DW.DUTY_DATE BETWEEN TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD')
			                             AND     TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD')
			        )
	
	</query>
	
	<!-- 조운영 캘린더 : 시간 조정 : popup -->
	<query id="sc_01050_shiftOperationCalendar_popup">
	
			SELECT  WD.TEAM_ID, WD.TEAM_NAME, WD.LINE_ID, WD.LINE_NAME, WD.PROC_ID, WD.PROC_NAME,
                    MAX(SUBSTR(WD.WORKTY_ID,1,1)) || '교대' AS TEAM_TYPE,
                    DECODE(MAX(SUBSTR(WD.WORKTY_ID,3,1)),'N','X','B','O') AS BREAK,
                    DECODE(MAX(SUBSTR(WD.WORKTY_ID,4,1))
                        ,'A','일반','B','음료','C','(조/야)','D','(조/주)','E','주간상주','F','야간') AS ETC,
                    ----------------------------------------------------------------------------------
                    /* 일요일 */
                    --조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D01_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D01_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D01_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D01_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D01_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D01_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D01_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D01_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간 
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN') 
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D01_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN') 
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D01_SHIFT5_SHIFT_ID,
                    -- START_TIME  
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D01_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+0,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D01_SHIFT5_END,   
                    /*********************************************************************************/
                    /* 월요일 */
                    -- 조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D02_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D02_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D02_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D02_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D02_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D02_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D02_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D02_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D02_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D02_SHIFT5_SHIFT_ID,
                    -- START_TIME   
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D02_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+1,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D02_SHIFT5_END,
                    /*********************************************************************************/
                    /* 화요일 */
                    -- 조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D03_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D03_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D03_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D03_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D03_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D03_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D03_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D03_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간   
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D03_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D03_SHIFT5_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D03_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+2,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D03_SHIFT5_END,
                    /*********************************************************************************/
                    /* 수요일 */   
                    -- 조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D04_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D04_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D04_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D04_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D04_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D04_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D04_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D04_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D04_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D04_SHIFT5_SHIFT_ID,
                    -- START_TIME   
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D04_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+3,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D04_SHIFT5_END,
                    /*********************************************************************************/
                    /* 목요일 */   
                    -- 조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D05_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D05_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D05_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D05_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D05_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D05_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D05_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D05_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D05_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D05_SHIFT5_SHIFT_ID,
                    -- START_TIME   
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D05_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+4,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D05_SHIFT5_END,
                    /*********************************************************************************/
                    /* 금요일 */   
                    -- 조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D06_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D06_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D06_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D06_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D06_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D06_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D06_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D06_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간 
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D06_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D06_SHIFT5_SHIFT_ID,
                    -- START_TIME  
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D06_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+5,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D06_SHIFT5_END,
                    /*********************************************************************************/
                    /* 토요일 */   
                    -- 조간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D07_SHIFT1_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D07_SHIFT1_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D07_SHIFT1_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('JOG','OTD','OTJ')
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D07_SHIFT1_END,  
                    ----------------------------------------------------------------------------------
                    --주간
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D07_SHIFT3_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D07_SHIFT3_SHIFT_ID,
                    -- START_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D07_SHIFT3_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) = 'DAY'
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D07_SHIFT3_END, 
                    -----------------------------------------------------------------------------------
                    --야간  
                    -- WORKTY_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.WORKTY_ID
                        ELSE ''
                        END
                       )    D07_SHIFT5_WORKTY_ID,
                    -- SHIFT_ID
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.SHIFT_ID
                        ELSE ''
                        END
                       )    D07_SHIFT5_SHIFT_ID,
                    -- START_TIME 
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.START_TIME
                        ELSE ''
                        END
                       )    D07_SHIFT5_START, 
                    -- END_TIME
                    MAX(
                        CASE
                        WHEN WD.DUTY_DATE = TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'), 'D')+6,'YYYYMMDD') 
                                          AND SUBSTR(WD.SHIFT_ID,1,3) IN ('NIG','OTN')  
                        THEN WD.END_TIME
                        ELSE ''
                        END
                       )    D07_SHIFT5_END       
            FROM    (
                    SELECT  WD.PLANT_ID, VH.PLANT_NAME, VH.TEAM_ID, VH.TEAM_NAME, WD.DUTY_DATE, 
                            VH.LINE_ID, VH.LINE_NAME, WD.PROC_ID, VH.PROC_NAME, WD.WORKTY_ID, 
                            WD.SHIFT_ID, WD.START_TIME, WD.END_TIME
                    FROM    WORK_DIARY_ADJ WD, 
                            V_HRCHY_PROC VH
                    WHERE   WD.PLANT_ID = '$!{selected_plant}'
                    AND     WD.DUTY_DATE BETWEEN TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D'),'YYYYMMDD')
                                         AND     TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD')
                    AND     WD.PLANT_ID = VH.PLANT_ID
                    AND     WD.PROC_ID  = VH.PROC_ID
                    AND     VH.CAT = '포장'
                    [AND     VH.TEAM_ID = '${selected_won}']
                    [AND	 VH.LINE_ID = '${selected_line}']                     
                    ORDER   BY WD.PLANT_ID, WD.DUTY_DATE, WD.PROC_ID, WD.WORKTY_ID, WD.SHIFT_ID, WD.START_TIME, WD.END_TIME
                    ) WD
            GROUP   BY WD.TEAM_ID, WD.TEAM_NAME, WD.LINE_ID, WD.LINE_NAME, WD.PROC_ID, WD.PROC_NAME
            ORDER   BY WD.PROC_ID	
	
	</query>
	
	<!-- 조 운영 캘린더 : POPUP : 저장 -->
	<query id="sc_01050_shiftOperationCalendar_popup_save_01" fix="selected_plant duty_date" iterator="proc_cd sun_shift1_workty_id sun_shift1_shift_id shift_1_sun_start shift_1_sun_end sun_shift3_workty_id sun_shift3_shift_id shift_3_sun_start shift_3_sun_end sun_shift5_workty_id sun_shift5_shift_id shift_5_sun_start shift_5_sun_end mon_shift1_workty_id mon_shift1_shift_id shift_1_mon_start shift_1_mon_end mon_shift3_workty_id mon_shift3_shift_id shift_3_mon_start shift_3_mon_end mon_shift5_workty_id mon_shift5_shift_id shift_5_mon_start shift_5_mon_end tue_shift1_workty_id tue_shift1_shift_id shift_1_tue_start shift_1_tue_end tue_shift3_workty_id tue_shift3_shift_id shift_3_tue_start shift_3_tue_end tue_shift5_workty_id tue_shift5_shift_id shift_5_tue_start shift_5_tue_end wed_shift1_workty_id wed_shift1_shift_id shift_1_wed_start shift_1_wed_end wed_shift3_workty_id wed_shift3_shift_id shift_3_wed_start shift_3_wed_end wed_shift5_workty_id wed_shift5_shift_id shift_5_wed_start shift_5_wed_end thu_shift1_workty_id thu_shift1_shift_id shift_1_thu_start shift_1_thu_end thu_shift3_workty_id thu_shift3_shift_id shift_3_thu_start shift_3_thu_end thu_shift5_workty_id thu_shift5_shift_id shift_5_thu_start shift_5_thu_end fri_shift1_workty_id fri_shift1_shift_id shift_1_fri_start shift_1_fri_end fri_shift3_workty_id fri_shift3_shift_id shift_3_fri_start shift_3_fri_end fri_shift5_workty_id fri_shift5_shift_id shift_5_fri_start shift_5_fri_end sat_shift1_workty_id sat_shift1_shift_id shift_1_sat_start shift_1_sat_end sat_shift3_workty_id sat_shift3_shift_id shift_3_sat_start shift_3_sat_end sat_shift5_workty_id sat_shift5_shift_id shift_5_sat_start shift_5_sat_end">
	
			UPDATE  /*+ bypass_ujvc*/
                    (
                    SELECT  WA.START_TIME, WA.END_TIME,
                            IT.NEW_START_TIME, IT.NEW_END_TIME
                    FROM    (
                            SELECT  WA.PLANT_ID, WA.DUTY_DATE, WA.PROC_ID, WA.WORKTY_ID, WA.SHIFT_ID,
                                    WA.START_TIME, WA.END_TIME
                            FROM    WORK_DIARY_ADJ WA
                            WHERE   WA.PLANT_ID = '$!{selected_plant}'
                            AND     WA.PROC_ID = '$!{proc_cd}'
                            AND     WA.DUTY_DATE BETWEEN  TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D'),'YYYYMMDD')
                                                 AND      TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD')
                            ) WA,
                            (
                            /* 일요일 */
                            -- 조
                            SELECT  '$!{sun_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{sun_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+0,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_sun_start}' AS NEW_START_TIME,
                                    '$!{shift_1_sun_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{sun_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{sun_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+0,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_sun_start}' AS NEW_START_TIME,
                                    '$!{shift_3_sun_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{sun_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{sun_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+0,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_sun_start}' AS NEW_START_TIME,
                                    '$!{shift_5_sun_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            /* 월요일 */
                            -- 조
                            SELECT  '$!{mon_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{mon_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+1,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_mon_start}' AS NEW_START_TIME,
                                    '$!{shift_1_mon_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{mon_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{mon_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+1,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_mon_start}' AS NEW_START_TIME,
                                    '$!{shift_3_mon_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{mon_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{mon_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+1,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_mon_start}' AS NEW_START_TIME,
                                    '$!{shift_5_mon_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            /* 화요일 */
                            -- 조
                            SELECT  '$!{tue_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{tue_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+2,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_tue_start}' AS NEW_START_TIME,
                                    '$!{shift_1_tue_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{tue_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{tue_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+2,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_tue_start}' AS NEW_START_TIME,
                                    '$!{shift_3_tue_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{tue_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{tue_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+2,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_tue_start}' AS NEW_START_TIME,
                                    '$!{shift_5_tue_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            /* 수요일 */
                            -- 조
                            SELECT  '$!{wed_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{wed_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+3,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_wed_start}' AS NEW_START_TIME,
                                    '$!{shift_1_wed_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{wed_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{wed_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+3,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_wed_start}' AS NEW_START_TIME,
                                    '$!{shift_3_wed_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{wed_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{wed_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+3,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_wed_start}' AS NEW_START_TIME,
                                    '$!{shift_5_wed_end}' AS NEW_END_TIME
                            FROM    DUAL
                            /* 목요일 */
                            UNION   ALL
                            -- 조
                            SELECT  '$!{thu_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{thu_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+4,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_thu_start}' AS NEW_START_TIME,
                                    '$!{shift_1_thu_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{thu_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{thu_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+4,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_thu_start}' AS NEW_START_TIME,
                                    '$!{shift_3_thu_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{thu_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{thu_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+4,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_thu_start}' AS NEW_START_TIME,
                                    '$!{shift_5_thu_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            /* 금요일 */
                            -- 조
                            SELECT  '$!{fri_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{fri_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+5,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_fri_start}' AS NEW_START_TIME,
                                    '$!{shift_1_fri_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{fri_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{fri_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+5,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_fri_start}' AS NEW_START_TIME,
                                    '$!{shift_3_fri_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{fri_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{fri_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+5,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_fri_start}' AS NEW_START_TIME,
                                    '$!{shift_5_fri_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            /* 토요일 */
                            -- 조
                            SELECT  '$!{sat_shift1_workty_id}' AS WORKTY_ID,
                                    '$!{sat_shift1_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_1_sat_start}' AS NEW_START_TIME,
                                    '$!{shift_1_sat_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 주
                            SELECT  '$!{sat_shift3_workty_id}' AS WORKTY_ID,
                                    '$!{sat_shift3_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_3_sat_start}' AS NEW_START_TIME,
                                    '$!{shift_3_sat_end}' AS NEW_END_TIME
                            FROM    DUAL
                            UNION   ALL
                            -- 야
                            SELECT  '$!{sat_shift5_workty_id}' AS WORKTY_ID,
                                    '$!{sat_shift5_shift_id}' AS SHIFT_ID,
                                    TO_CHAR(TRUNC(TO_DATE('$!{duty_date}','YYYY-MM-DD'),'D')+6,'YYYYMMDD') AS DUTY_DATE,
                                    '$!{shift_5_sat_start}' AS NEW_START_TIME,
                                    '$!{shift_5_sat_end}' AS NEW_END_TIME
                            FROM    DUAL
                            ) IT
                    WHERE   WA.WORKTY_ID = IT.WORKTY_ID
                    AND     WA.SHIFT_ID = IT.SHIFT_ID
                    AND     WA.DUTY_DATE = IT.DUTY_DATE                
                    )
            SET     START_TIME = NEW_START_TIME,
                    END_TIME = NEW_END_TIME
	
	</query>
	
<!--	
=====================================================================================================
	생산계획 >> 주문정보 
=====================================================================================================
--> 
	
	<!-- 
	=============================
		주문 정보 조회
	=============================
	-->
	
	<!-- 주문 정보 조회 -->
	<query id="sc_14010_order_list" paging="true">
		<!-- 처음 페이지를 로드하는 경우, 인터페이스 일시가 없으면 최근 인터페이스 일시로 조회 -->
		#if("$!{selected_if_date}" == "")
			SELECT	*
			FROM	DUAL
			WHERE	1=0
		#else	
			SELECT  DECODE(IM.MTO_MTS_TYPE,'0001','MTO','MTS')  AS MTO_MTS_TYPE,
			        TRIM(NO.ORD_NO)                             AS ORD_NO, 
			        TO_CHAR(NO.PROD_REQ_DATE, 'YYYY-MM-DD')     AS PROD_REQ_DATE,
			        NO.DOMAIN, NO.ORD_TYPE, NO.ORD_ITEM_NO, NO.ITEM_ID, 
			        IM.ITEM_NAME, IM.SPEC, NO.QTY, NO.QTY_UOM,
			        TO_CHAR(NO.ORD_DATE, 'YYYY-MM-DD')          AS ORD_DATE, 
			        TO_CHAR(NO.DUE_DATE, 'YYYY-MM-DD')          AS DUE_DATE,        
			        NVL(CT.CUST_NAME,NO.CUST_ID)                AS CUST_NAME, 
			        DM.DC_SHORT_NAME
			FROM    NFOS_ORDER NO, ITEM_MST IM, CUSTOMER CT, DC_MST DM
			WHERE   NO.ITEM_ID  = IM.ITEM_ID(+)
			AND     NO.CUST_ID  = CT.CUST_ID(+)
			AND     NO.LOC_ID   = DM.DC_ID(+)
			AND     NO.IF_DTTM  = TO_DATE('$!{selected_if_date}','YYYY-MM-DD') 
		   [AND     NO.DOMAIN = '${selected_domain}'] 
		   [AND     IM.ITYPE    = '${selected_itype}']
		   [AND     NO.ITEM_ID LIKE '%${item_id}%'] 
		   [AND     IM.ITEM_NAME LIKE '%${item_name}%']
		   [AND     IM.CAT01 = '${selected_cat01}']
		   [AND     NO.PROD_REQ_DATE = TO_DATE('${selected_prod_req_date}','YYYY-MM-DD')] 
		   [AND		IM.MTO_MTS_TYPE = '${selected_mto}']
		   [AND		NO.ORD_NO LIKE '%${selected_ord}%']        
			ORDER   BY MTO_MTS_TYPE DESC, NO.ORD_NO, PROD_REQ_DATE, NO.DOMAIN, NO.ORD_TYPE, 
						NO.ORD_ITEM_NO, NO.ITEM_ID
		#end
			
	</query>
	
	<!-- 인터페이스 일시 리스트 -->
	<query id="order_combo_if_date_list">
	
		SELECT	YYYYMMDD, ROWNUM
		FROM	(			 
				SELECT	YYYYMMDD
				FROM	CAL_MST
				WHERE	HOLIDAY_FLAG 	IS NULL
				AND		CAL_DATE &lt;= TRUNC(SYSDATE)
				ORDER
				BY		YYYYMMDD DESC
				)
		WHERE	ROWNUM	&lt;= 5	
			 
	</query>
	
	<!-- 생산 요청일 리스트 -->
	<query id="order_combo_prod_req_date_list">
		#if("$!{selected_if_date}" == "")
			SELECT  TO_CHAR(NO.PROD_REQ_DATE,'YYYY-MM-DD') PROD_REQ_DATE
			FROM    (            
			        SELECT  DISTINCT
			                NO.PROD_REQ_DATE
			        FROM    NFOS_ORDER NO
			        WHERE   NO.IF_DTTM = (     
							                SELECT  MAX(IF_DTTM) IF_DTTM
							                FROM    NFOS_ORDER  
							             ) --MAX IF_DTTM
			        AND     NO.PROD_REQ_DATE IS NOT NULL        
			        ORDER   BY NO.PROD_REQ_DATE DESC
			        ) NO 	
		#else
			SELECT  TO_CHAR(NO.PROD_REQ_DATE,'YYYY-MM-DD') PROD_REQ_DATE
			FROM    (            
			        SELECT  DISTINCT
			                NO.PROD_REQ_DATE
			        FROM    NFOS_ORDER NO
			        WHERE   NO.IF_DTTM = TO_DATE('$!{selected_if_date}','YYYY-MM-DD')
			        AND     NO.PROD_REQ_DATE IS NOT NULL        
			        ORDER   BY NO.PROD_REQ_DATE DESC
			        ) NO 
		#end
	</query>

<!--
=====================================================================================================
	생산계획 >> 계획분석
=====================================================================================================
--> 
	
	<!--
	======================================================================
		완/반제품/자재 재고조회
	======================================================================
	-->
	
	<!-- 완/반제품/자재 재고조회 -->
	<query id="sc_15010_stockInfo_list" paging="false">
	
			SELECT  P1.PLANT_NAME, CM.CD_NAME, IL.ITEM_ID, IM.ITEM_NAME, IM.SPEC, 
                    TO_CHAR(ES.USABLE_DATE,'YYYY-MM-DD') AS ES_USABLE_DATE, 
                    ES.QTY ES_QTY, ES.QTY_UOM ES_QTY_UOM ,
                    TO_CHAR(QS.USABLE_DATE,'YYYY-MM-DD') AS QS_USABLE_DATE, 
                    QS.QTY QS_QTY, QS.QTY_UOM QS_QTY_UOM,
                    P2.PLANT_NAME ST_PLANT_NAME, 
                    TO_CHAR(ST.TRANS_DATE,'YYYY-MM-DD') AS TRANS_DATE, 
                    ST.QTY ST_QTY, ST.QTY_UOM ST_QTY_UOM
            FROM    (
                    SELECT  DISTINCT LOC_ID PLANT_ID, ITEM_ID, USABLE_DATE
                    FROM    ERP_STOCK
                    WHERE   IF_DTTM = TO_DATE('$!{selected_if_date}','YYYY-MM-DD')
                    AND     LOC_TYPE = 'PLANT'
                    UNION
                    SELECT  DISTINCT PLANT_ID, ITEM_ID, USABLE_DATE
                    FROM    QI_STOCK
                    WHERE   IF_DTTM = TO_DATE('$!{selected_if_date}','YYYY-MM-DD')
                    UNION
                    SELECT  DISTINCT TGT_PLANT PLANT_ID, ITEM_ID, TRANS_DATE USABLE_DATE
                    FROM    ERP_STO
                    WHERE   TO_CHAR(IF_DTTM,'YYYY-MM-DD') = DECODE(TO_CHAR(TO_DATE('$!{selected_if_date}','YYYY-MM-DD'),'DY')
                                                                         ,'월',TO_CHAR(TO_DATE('$!{selected_if_date}','YYYY-MM-DD')-3,'YYYY-MM-DD')
                                                                              ,TO_CHAR(TO_DATE('$!{selected_if_date}','YYYY-MM-DD')-1,'YYYY-MM-DD'))
                    ) IL,
                    (
                    SELECT  IF_DTTM, LOC_ID, ITEM_ID, ITYPE, USABLE_DATE, QTY, QTY_UOM 
                    FROM    ERP_STOCK
                    WHERE   IF_DTTM = TO_DATE('$!{selected_if_date}','YYYY-MM-DD')
                    AND     LOC_TYPE = 'PLANT'
                    ) ES,
                    (
                    SELECT  IF_DTTM, PLANT_ID, ITEM_ID, USABLE_DATE, SUM(QTY) QTY, QTY_UOM
                    FROM    QI_STOCK
                    WHERE   IF_DTTM = TO_DATE('$!{selected_if_date}','YYYY-MM-DD')
                    GROUP   BY IF_DTTM, PLANT_ID, ITEM_ID, USABLE_DATE, QTY_UOM
                    ) QS,
                    (
                    SELECT  IF_DTTM, PLANT_ID, ITEM_ID, TRANS_DATE, QTY, QTY_UOM, TGT_PLANT 
                    FROM    ERP_STO
                    WHERE   TO_CHAR(IF_DTTM,'YYYY-MM-DD') = DECODE(TO_CHAR(TO_DATE('$!{selected_if_date}','YYYY-MM-DD'),'DY')
                                                                         ,'월',TO_CHAR(TO_DATE('$!{selected_if_date}','YYYY-MM-DD')-3,'YYYY-MM-DD')
                                                                              ,TO_CHAR(TO_DATE('$!{selected_if_date}','YYYY-MM-DD')-1,'YYYY-MM-DD'))
                    ) ST,
                    ITEM_MST IM, 
                    (     
                    SELECT  CM.CD, CM.CD_NAME
                    FROM    CODE_MST CM
                    WHERE   CM.MADE_TYPE != 'DE'
                    AND     CM.CD_GRP = 'ITYPE' 
                    ) CM, 
                    ( 
                    SELECT  HR.HID PLANT_ID, HR.HID_NAME PLANT_NAME
                    FROM  HRCHY HR
                    WHERE  HR.MADE_TYPE != 'DE'
                    AND  HR.LVL_TYPE = '공장' 
                    ) P1, 
                    ( 
                    SELECT  HR.HID PLANT_ID, HR.HID_NAME PLANT_NAME
                    FROM  HRCHY HR
                    WHERE  HR.MADE_TYPE != 'DE'
                    AND  HR.LVL_TYPE = '공장' 
                    ) P2		
            WHERE   IL.ITEM_ID = ES.ITEM_ID(+)
            AND     IL.ITEM_ID = QS.ITEM_ID(+)
            AND     IL.ITEM_ID = ST.ITEM_ID(+)
            AND     IL.USABLE_DATE = ES.USABLE_DATE(+)
            AND     IL.USABLE_DATE = QS.USABLE_DATE(+) 
            AND     IL.USABLE_DATE = ST.TRANS_DATE(+)
            AND     IL.PLANT_ID = ES.LOC_ID(+)
            AND     IL.PLANT_ID = QS.PLANT_ID(+)
            AND     IL.PLANT_ID = ST.TGT_PLANT(+)
            AND     IL.ITEM_ID = IM.ITEM_ID(+)
            AND     IL.PLANT_ID = P1.PLANT_ID(+)
            AND     ST.PLANT_ID = P2.PLANT_ID(+)
            AND     IM.ITYPE = CM.CD(+)
            [AND    IL.PLANT_ID = '${selected_plant}'] --공장변수
            [AND    IM.ITYPE = '${selected_itype}'] --자재구분 변수
            [AND    IL.ITEM_ID LIKE '%${item_id}%'] --자재(제품)변수
            [AND    IM.ITEM_NAME LIKE '%${item_name}%'] --자재(제품)명 변수	
            ORDER	BY IL.PLANT_ID, IL.ITEM_ID, IL.USABLE_DATE		 
					
	</query>
	
	<!-- 인터페이스 일시 리스트 --> 
	<query id="stockInofo_combo_if_date_list">
	
			
		    SELECT  A.IF_DTTM, ROWNUM
			 FROM (   
               		SELECT  DISTINCT(TO_CHAR( ES.IF_DTTM, 'YYYY-MM-DD')) IF_DTTM
		          	 FROM  ERP_STOCK ES
			         WHERE 	IF_DTTM = (SELECT MAX(IF_DTTM) FROM ERP_STOCK)
                     AND	 MADE_TYPE != 'DE'
			        UNION
			        SELECT  DISTINCT(TO_CHAR( QS.IF_DTTM, 'YYYY-MM-DD')) IF_DTTM
			          FROM  QI_STOCK QS
			         WHERE 	IF_DTTM = (SELECT MAX(IF_DTTM) FROM QI_STOCK)
                     AND	  MADE_TYPE != 'DE'
		         	UNION
			        SELECT  DISTINCT(TO_CHAR( ST.IF_DTTM, 'YYYY-MM-DD')) IF_DTTM
			          FROM  ERP_STO ST
			         WHERE 	IF_DTTM = (SELECT MAX(IF_DTTM) FROM ERP_STO)
                     AND  MADE_TYPE != 'DE'
			         ORDER  BY 1 DESC
                     )A
                     WHERE ROWNUM &lt; 21
	
	</query>
	
<!--
=====================================================================================================
	생산계획 >> 분석정보 >> 결과검증 
=====================================================================================================
--> 

	<!-- 
	=======================
		공장할당결과 검증 
	=======================
	-->
	<!-- 공장할당결과 검증 조회 -->
	<query id="sc_05220_plantAllocCheck_list">
		
		#if("$!{selected_plan_period}" == "MONTHLY")
			SELECT  SC1.CD_NAME, SC2.CD_NAME, LT.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.HID_NAME, PR.ALLOC_RATE
					, CASE WHEN PA.D01 = 0 THEN NULL ELSE PA.D01 END
					, CASE WHEN PA.D02 = 0 THEN NULL ELSE PA.D02 END
					, CASE WHEN PA.D03 = 0 THEN NULL ELSE PA.D03 END
					, CASE WHEN PA.D04 = 0 THEN NULL ELSE PA.D04 END
					, CASE WHEN PA.D05 = 0 THEN NULL ELSE PA.D05 END
					, CASE WHEN PA.D06 = 0 THEN NULL ELSE PA.D06 END
			  FROM  (   SELECT  DISTINCT ITEM_ID, PLANT_ID
			              FROM  PLANT_ALLOC_ACT_RATE
			             WHERE  MADE_TYPE != 'DE'
			               AND  ITEM_ID IN (    SELECT  DISTINCT  ITEM_ID
			                                      FROM  PLANT_ALLOC_PLAN
			                                     WHERE  MADE_TYPE != 'DE'
			                                       AND  VERSION = '$!{selected_version}'
			                                       AND  TO_CHAR(DUE_DATE,'YYYYMM') BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0),'YYYYMM') 
			                                       AND  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5),'YYYYMM') )
			             UNION
			            SELECT  DISTINCT ITEM_ID, PLANT_ID
			              FROM  PLANT_ALLOC_PLAN
			             WHERE  MADE_TYPE != 'DE'
			               AND  VERSION = '$!{selected_version}'
			               AND  TO_CHAR(DUE_DATE,'YYYYMM') BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0),'YYYYMM') 
			               AND  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5),'YYYYMM')
			             ORDER  BY 1, 2 ) LT  -- 두 테이블 ITEM_ID, PLANT_ID UNION
			        , PLANT_ALLOC_ACT_RATE PR
			        , ( SELECT  PA.ITEM_ID, PA.PLANT_ID
			                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0),'YYYYMM') AND PT.T01 != 0 THEN TRUNC(PA.QTY/PT.T01*100,2) ELSE 0 END) D01
			                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),1),'YYYYMM') AND PT.T02 != 0 THEN TRUNC(PA.QTY/PT.T02*100,2) ELSE 0 END) D02
			                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),2),'YYYYMM') AND PT.T03 != 0 THEN TRUNC(PA.QTY/PT.T03*100,2) ELSE 0 END) D03
			                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),3),'YYYYMM') AND PT.T04 != 0 THEN TRUNC(PA.QTY/PT.T04*100,2) ELSE 0 END) D04
			                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),4),'YYYYMM') AND PT.T05 != 0 THEN TRUNC(PA.QTY/PT.T05*100,2) ELSE 0 END) D05
			                    , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5),'YYYYMM') AND PT.T06 != 0 THEN TRUNC(PA.QTY/PT.T06*100,2) ELSE 0 END) D06
			              FROM  (
						  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
								FROM    PLANT_ALLOC_PLAN
								GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
								) PA
			                    , ( SELECT  PA.VERSION, PA.ITEM_ID
			                                , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0),'YYYYMM') THEN PA.QTY ELSE 0 END) T01
			                                , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),1),'YYYYMM') THEN PA.QTY ELSE 0 END) T02
			                                , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),2),'YYYYMM') THEN PA.QTY ELSE 0 END) T03
			                                , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),3),'YYYYMM') THEN PA.QTY ELSE 0 END) T04
			                                , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),4),'YYYYMM') THEN PA.QTY ELSE 0 END) T05
			                                , SUM(CASE WHEN TO_CHAR(PA.DUE_DATE,'YYYYMM') =  TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5),'YYYYMM') THEN PA.QTY ELSE 0 END) T06
			                          FROM  (
									  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
											FROM    PLANT_ALLOC_PLAN
											GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
											) PA
			                         WHERE  PA.MADE_TYPE != 'DE'
			                           AND  PA.VERSION = '$!{selected_version}'
			               			   AND  TO_CHAR(PA.DUE_DATE,'YYYYMM') BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0),'YYYYMM') AND TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5),'YYYYMM')
			                         GROUP  BY PA.VERSION, PA.ITEM_ID 
			                         ORDER  BY PA.VERSION, PA.ITEM_ID ) PT -- ITEM별 생산량 합계                    
			             WHERE  PA.VERSION = '$!{selected_version}'
			               AND  TO_CHAR(PA.DUE_DATE,'YYYYMM') BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0),'YYYYMM') AND TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5),'YYYYMM')            
			               AND  PA.VERSION = PT.VERSION(+)
			               AND  PA.ITEM_ID = PT.ITEM_ID(+)                          
			             GROUP  BY PA.ITEM_ID, PA.PLANT_ID
			             ORDER  BY PA.ITEM_ID, PA.PLANT_ID ) PA
			        , ITEM_MST IM
			        , ( SELECT  HR.HID, HR.HID_NAME
			              FROM  HRCHY HR
			             WHERE  HR.MADE_TYPE != 'DE'
			               AND  HR.LVL_TYPE = '공장' ) HR
			        , ( SELECT  CM.CD, CM.CD_NAME
			              FROM  CODE_MST CM
			             WHERE  CM.MADE_TYPE != 'DE'
			               AND  CM.CD_GRP = 'SALES_CAT1' ) SC1
			        , ( SELECT  CM.CD, CM.CD_NAME
			              FROM  CODE_MST CM
			             WHERE  CM.MADE_TYPE != 'DE'
			               AND  CM.CD_GRP = 'SALES_CAT2' ) SC2
			 WHERE  LT.ITEM_ID = PR.ITEM_ID(+)
			   AND  LT.PLANT_ID = PR.PLANT_ID(+)
			   AND  LT.ITEM_ID = PA.ITEM_ID(+)
			   AND  LT.PLANT_ID = PA.PLANT_ID(+)
			   AND  LT.ITEM_ID = IM.ITEM_ID
			   AND  LT.PLANT_ID = HR.HID
			   AND  IM.SALES_CAT01 = SC1.CD(+)
			   AND  IM.SALES_CAT02 = SC2.CD(+)
			  [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --영업품종분류1
			  [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --영업품종분류2
			  [AND  IM.CAT01 = '${selected_cat01}'] --품종특성분류
			 ORDER  BY SC1.CD_NAME, SC2.CD_NAME, LT.ITEM_ID, LT.PLANT_ID
		#else	
			SELECT  SC1.CD_NAME, SC2.CD_NAME, LT.ITEM_ID, IM.ITEM_NAME, IM.SPEC, HR.HID_NAME, PR.ALLOC_RATE
			        , CASE WHEN PA.D01 = 0 THEN NULL ELSE PA.D01 END
			        , CASE WHEN PA.D02 = 0 THEN NULL ELSE PA.D02 END
			        , CASE WHEN PA.D03 = 0 THEN NULL ELSE PA.D03 END
			        , CASE WHEN PA.D04 = 0 THEN NULL ELSE PA.D04 END
			        , CASE WHEN PA.D05 = 0 THEN NULL ELSE PA.D05 END
			        , CASE WHEN PA.D06 = 0 THEN NULL ELSE PA.D06 END
			        , CASE WHEN PA.D07 = 0 THEN NULL ELSE PA.D07 END
			        , CASE WHEN PA.D08 = 0 THEN NULL ELSE PA.D08 END
			        , CASE WHEN PA.D09 = 0 THEN NULL ELSE PA.D09 END
			        , CASE WHEN PA.D10 = 0 THEN NULL ELSE PA.D10 END
			        , CASE WHEN PA.D11 = 0 THEN NULL ELSE PA.D11 END
			        , CASE WHEN PA.D12 = 0 THEN NULL ELSE PA.D12 END
			        , CASE WHEN PA.D13 = 0 THEN NULL ELSE PA.D13 END
			        , CASE WHEN PA.D14 = 0 THEN NULL ELSE PA.D14 END
			        , CASE WHEN PA.D15 = 0 THEN NULL ELSE PA.D15 END
			        , CASE WHEN PA.D16 = 0 THEN NULL ELSE PA.D16 END
			        , CASE WHEN PA.D17 = 0 THEN NULL ELSE PA.D17 END
			        , CASE WHEN PA.D18 = 0 THEN NULL ELSE PA.D18 END
			        , CASE WHEN PA.D19 = 0 THEN NULL ELSE PA.D19 END
			        , CASE WHEN PA.D20 = 0 THEN NULL ELSE PA.D20 END
			        , CASE WHEN PA.D21 = 0 THEN NULL ELSE PA.D21 END
			  FROM  (   SELECT  DISTINCT ITEM_ID, PLANT_ID
			              FROM  PLANT_ALLOC_ACT_RATE
			             WHERE  MADE_TYPE != 'DE'
			               AND  ITEM_ID IN (    SELECT  DISTINCT  ITEM_ID
			                                      FROM  PLANT_ALLOC_PLAN
			                                     WHERE  MADE_TYPE != 'DE'
			                                       AND  VERSION = '$!{selected_version}'
			                                       AND  DUE_DATE BETWEEN TO_DATE('$!{sdateD}','YYYY-MM-DD') AND TO_DATE('$!{sdateD}','YYYY-MM-DD')+20 )
			             UNION
			            SELECT  DISTINCT ITEM_ID, PLANT_ID
			              FROM  PLANT_ALLOC_PLAN
			             WHERE  MADE_TYPE != 'DE'
			               AND  VERSION = '$!{selected_version}'
			               AND  DUE_DATE BETWEEN TO_DATE('$!{sdateD}','YYYY-MM-DD') AND TO_DATE('$!{sdateD}','YYYY-MM-DD')+20
			             ORDER  BY 1, 2 ) LT  -- 두 테이블 ITEM_ID, PLANT_ID UNION
			        , PLANT_ALLOC_ACT_RATE PR
			        , ( SELECT  PA.ITEM_ID, PA.PLANT_ID
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+0 AND PT.T01 != 0 THEN TRUNC(PA.QTY/PT.T01*100,2) ELSE 0 END) D01
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+1 AND PT.T02 != 0 THEN TRUNC(PA.QTY/PT.T02*100,2) ELSE 0 END) D02
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+2 AND PT.T03 != 0 THEN TRUNC(PA.QTY/PT.T03*100,2) ELSE 0 END) D03
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+3 AND PT.T04 != 0 THEN TRUNC(PA.QTY/PT.T04*100,2) ELSE 0 END) D04
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+4 AND PT.T05 != 0 THEN TRUNC(PA.QTY/PT.T05*100,2) ELSE 0 END) D05
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+5 AND PT.T06 != 0 THEN TRUNC(PA.QTY/PT.T06*100,2) ELSE 0 END) D06
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+6 AND PT.T07 != 0 THEN TRUNC(PA.QTY/PT.T07*100,2) ELSE 0 END) D07
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+7 AND PT.T08 != 0 THEN TRUNC(PA.QTY/PT.T08*100,2) ELSE 0 END) D08
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+8 AND PT.T09 != 0 THEN TRUNC(PA.QTY/PT.T09*100,2) ELSE 0 END) D09
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+9 AND PT.T10 != 0 THEN TRUNC(PA.QTY/PT.T10*100,2) ELSE 0 END) D10
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+10 AND PT.T11 != 0 THEN TRUNC(PA.QTY/PT.T11*100,2) ELSE 0 END) D11
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+11 AND PT.T12 != 0 THEN TRUNC(PA.QTY/PT.T12*100,2) ELSE 0 END) D12
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+12 AND PT.T13 != 0 THEN TRUNC(PA.QTY/PT.T13*100,2) ELSE 0 END) D13
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+13 AND PT.T14 != 0 THEN TRUNC(PA.QTY/PT.T14*100,2) ELSE 0 END) D14
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+14 AND PT.T15 != 0 THEN TRUNC(PA.QTY/PT.T15*100,2) ELSE 0 END) D15
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+15 AND PT.T16 != 0 THEN TRUNC(PA.QTY/PT.T16*100,2) ELSE 0 END) D16
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+16 AND PT.T17 != 0 THEN TRUNC(PA.QTY/PT.T17*100,2) ELSE 0 END) D17
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+17 AND PT.T18 != 0 THEN TRUNC(PA.QTY/PT.T18*100,2) ELSE 0 END) D18
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+18 AND PT.T19 != 0 THEN TRUNC(PA.QTY/PT.T19*100,2) ELSE 0 END) D19
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+19 AND PT.T20 != 0 THEN TRUNC(PA.QTY/PT.T20*100,2) ELSE 0 END) D20
			                    , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+20 AND PT.T21 != 0 THEN TRUNC(PA.QTY/PT.T21*100,2) ELSE 0 END) D21
			              FROM  (
						  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
								FROM    PLANT_ALLOC_PLAN
								GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
								) PA
			                    , ( SELECT  PA.VERSION, PA.ITEM_ID
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+0 THEN PA.QTY ELSE 0 END) T01
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+1 THEN PA.QTY ELSE 0 END) T02
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+2 THEN PA.QTY ELSE 0 END) T03
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+3 THEN PA.QTY ELSE 0 END) T04
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+4 THEN PA.QTY ELSE 0 END) T05
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+5 THEN PA.QTY ELSE 0 END) T06
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+6 THEN PA.QTY ELSE 0 END) T07
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+7 THEN PA.QTY ELSE 0 END) T08
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+8 THEN PA.QTY ELSE 0 END) T09
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+9 THEN PA.QTY ELSE 0 END) T10
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+10 THEN PA.QTY ELSE 0 END) T11
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+11 THEN PA.QTY ELSE 0 END) T12
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+12 THEN PA.QTY ELSE 0 END) T13
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+13 THEN PA.QTY ELSE 0 END) T14
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+14 THEN PA.QTY ELSE 0 END) T15
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+15 THEN PA.QTY ELSE 0 END) T16
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+16 THEN PA.QTY ELSE 0 END) T17
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+17 THEN PA.QTY ELSE 0 END) T18
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+18 THEN PA.QTY ELSE 0 END) T19
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+19 THEN PA.QTY ELSE 0 END) T20
			                                , SUM(CASE WHEN PA.DUE_DATE = TO_DATE('$!{sdateD}','YYYY-MM-DD')+20 THEN PA.QTY ELSE 0 END) T21
			                          FROM  (
									  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
											FROM    PLANT_ALLOC_PLAN
											GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
											) PA
			                         WHERE  PA.MADE_TYPE != 'DE'
			                           AND  PA.VERSION = '$!{selected_version}'
			             			   AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdateD}','YYYY-MM-DD') AND TO_DATE('$!{sdateD}','YYYY-MM-DD')+20
			                         GROUP  BY PA.VERSION, PA.ITEM_ID 
			                         ORDER  BY PA.VERSION, PA.ITEM_ID ) PT -- ITEM별 생산량 합계                    
			             WHERE  PA.VERSION = '$!{selected_version}'
			               AND  PA.DUE_DATE BETWEEN TO_DATE('$!{sdateD}','YYYY-MM-DD') AND TO_DATE('$!{sdateD}','YYYY-MM-DD')+20               
			               AND  PA.VERSION = PT.VERSION(+)
			               AND  PA.ITEM_ID = PT.ITEM_ID(+)                          
			             GROUP  BY PA.ITEM_ID, PA.PLANT_ID
			             ORDER  BY PA.ITEM_ID, PA.PLANT_ID ) PA
			        , ITEM_MST IM
			        , ( SELECT  HR.HID, HR.HID_NAME
			              FROM  HRCHY HR
			             WHERE  HR.MADE_TYPE != 'DE'
			               AND  HR.LVL_TYPE = '공장' ) HR
			        , ( SELECT  CM.CD, CM.CD_NAME
			              FROM  CODE_MST CM
			             WHERE  CM.MADE_TYPE != 'DE'
			               AND  CM.CD_GRP = 'SALES_CAT1' ) SC1
			        , ( SELECT  CM.CD, CM.CD_NAME
			              FROM  CODE_MST CM
			             WHERE  CM.MADE_TYPE != 'DE'
			               AND  CM.CD_GRP = 'SALES_CAT2' ) SC2
			 WHERE  LT.ITEM_ID = PR.ITEM_ID(+)
			   AND  LT.PLANT_ID = PR.PLANT_ID(+)
			   AND  LT.ITEM_ID = PA.ITEM_ID(+)
			   AND  LT.PLANT_ID = PA.PLANT_ID(+)
			   AND  LT.ITEM_ID = IM.ITEM_ID
			   AND  LT.PLANT_ID = HR.HID
			   AND  IM.SALES_CAT01 = SC1.CD(+)
			   AND  IM.SALES_CAT02 = SC2.CD(+)
			  [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --영업품종분류1
			  [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --영업품종분류2
			  [AND  IM.CAT01 = '${selected_cat01}'] --품종특성분류
			 ORDER  BY SC1.CD_NAME, SC2.CD_NAME, LT.ITEM_ID, LT.PLANT_ID
		#end
			
	</query>
	
	<!-- 그리드 날짜 리스트:일간계획 -->
	<query id="plant_alloc_chk_date_list">
	
			SELECT  (CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+0, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+0, 'DD (DY)') END) D01
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+1, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+1, 'DD (DY)') END) D02
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+2, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+2, 'DD (DY)') END) D03
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+3, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+3, 'DD (DY)') END) D04
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+4, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+4, 'DD (DY)') END) D05
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+5, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+5, 'DD (DY)') END) D06
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+6, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+6, 'DD (DY)') END) D07
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+7, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+7, 'DD (DY)') END) D08
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+8, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+8, 'DD (DY)') END) D09
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+9, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+9, 'DD (DY)') END) D10
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+10, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+10, 'DD (DY)') END) D11
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+11, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+11, 'DD (DY)') END) D12
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+12, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+12, 'DD (DY)') END) D13
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+13, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+13, 'DD (DY)') END) D14
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+14, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+14, 'DD (DY)') END) D15
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+15, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+15, 'DD (DY)') END) D16
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+16, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+16, 'DD (DY)') END) D17
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+17, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+17, 'DD (DY)') END) D18
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+18, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+18, 'DD (DY)') END) D19
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+19, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+19, 'DD (DY)') END) D20
			        ,(CASE WHEN '$!{sdateD} ' = ' ' THEN TO_CHAR(SYSDATE+20, 'DD (DY)') ELSE TO_CHAR(TO_DATE(' $!{sdateD}','YYYY-MM-DD')+20, 'DD (DY)') END) D22
			  FROM  DUAL
	
	</query>
	
	<!-- 그리드 날짜 리스트:월간계획 -->
	<query id="plant_alloc_chk_month_list">
	
            SELECT  (CASE WHEN '$!{sdateM} ' = ' ' THEN TO_CHAR(ADD_MONTHS(SYSDATE,0), 'MM') ELSE TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),0), 'MM') END) || '월' D01 
                    ,(CASE WHEN '$!{sdateM} ' = ' ' THEN TO_CHAR(ADD_MONTHS(SYSDATE,1), 'MM') ELSE TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),1), 'MM') END) || '월' D02
                    ,(CASE WHEN '$!{sdateM} ' = ' ' THEN TO_CHAR(ADD_MONTHS(SYSDATE,2), 'MM') ELSE TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),2), 'MM') END) || '월' D03
                    ,(CASE WHEN '$!{sdateM} ' = ' ' THEN TO_CHAR(ADD_MONTHS(SYSDATE,3), 'MM') ELSE TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),3), 'MM') END) || '월' D04
                    ,(CASE WHEN '$!{sdateM} ' = ' ' THEN TO_CHAR(ADD_MONTHS(SYSDATE,4), 'MM') ELSE TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),4), 'MM') END) || '월' D05
                    ,(CASE WHEN '$!{sdateM} ' = ' ' THEN TO_CHAR(ADD_MONTHS(SYSDATE,5), 'MM') ELSE TO_CHAR(ADD_MONTHS(TO_DATE('$!{sdateM}','YYYY-MM'),5), 'MM') END) || '월' D06                   
              FROM  DUAL
            
	</query>
	
	<!-- 계획버전 리스트 -->
	<query id="plant_alloc_chk_version_list">
	
			SELECT  PV.PERIOD_TYPE, PV.VERSION, ROWNUM NUM, PV.STATUS
			  FROM  (   SELECT  PV.PERIOD_TYPE, PV.VERSION, PV.STATUS
			              FROM  PLAN_VERSION_LOG PV
			             WHERE  PV.MADE_TYPE != 'DE'
			               AND  PV.PERIOD_TYPE = 'DAILY'
			               AND  PV.CAT_ID = 'FA'
			             --AND  PV.STATUS = '23'     
			               AND  PV.VERSION IS NOT NULL                   
			             ORDER  BY PV.PERIOD_TYPE, PV.VERSION DESC ) PV
			 WHERE  ROWNUM &lt; 21
			 UNION  ALL
			SELECT  PV.PERIOD_TYPE, PV.VERSION, ROWNUM NUM, PV.STATUS
			  FROM  (   SELECT  PV.PERIOD_TYPE, PV.VERSION, PV.STATUS
			              FROM  PLAN_VERSION_LOG PV
			             WHERE  PV.MADE_TYPE != 'DE'
			               AND  PV.PERIOD_TYPE = 'MONTHLY'
			               AND  PV.CAT_ID = 'FA'
			             --AND  PV.STATUS = '23'     
			               AND  PV.VERSION IS NOT NULL                   
			             ORDER  BY PV.PERIOD_TYPE, PV.VERSION DESC ) PV
			 WHERE  ROWNUM &lt; 21
	
	</query>
	
	<!-- 
	===============================
		라인별 생산계획결과 검증 
	===============================
	-->
	<!-- 라인별 생산계획결과 검증 조회 -->
	<query id="sc_05230_productionPlanCheckByLine_list" paging="true">
	
			SELECT  VH.PLANT_NAME, VH.LINE_NAME, ST.CD_NAME, NVL(IC.CAPA,0), DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D01
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE01
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D02
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE02
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D03
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE03
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D04
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE04
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D05
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE05
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D06
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE06
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D07
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE07
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D08
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE08
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D09
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE09
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D10
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE10
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D11
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE11
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D12
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE12
			        , SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END ) D13
			        , NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.SHIFT_QTY ELSE 0 END )/IC.CAPA*100, 0) RATE13
			  FROM  ITEM_MST IM
			        , ( SELECT  DS.CAT_ID, DS.VERSION, DS.PLANT_ID, DS.LINE_ID, DS.ITEM_ID, DS.PROD_DATES, DS.SHIFT_TYPE, SUM(DS.SHIFT_QTY) SHIFT_QTY
			              FROM  DAILY_SCH_PLAN_SHIFT DS, V_HRCHY_PROC VH
			             WHERE  DS.MADE_TYPE != 'DE'
			               AND  DS.PLANT_ID = VH.PLANT_ID
			               AND  DS.LINE_ID = VH.LINE_ID
			               AND  DS.PROC_ID = VH.PROC_ID
			               AND  VH.CAT = '포장'
			             GROUP  BY DS.CAT_ID, DS.VERSION, DS.PLANT_ID, DS.LINE_ID, DS.ITEM_ID, DS.PROD_DATES, DS.SHIFT_TYPE
			             ORDER  BY DS.CAT_ID, DS.VERSION, DS.PLANT_ID, DS.LINE_ID, DS.ITEM_ID, DS.PROD_DATES, DS.SHIFT_TYPE ) DS
			        , ( SELECT  IC.PLANT_ID, IC.LINE_ID, IC.ITEM_ID, IC.CAPA_MC, IC.QTY, (24 * IC.QTY / IC.CAPA_MC) AS CAPA
			              FROM  ITEM_CAPA IC, V_HRCHY_PROC VH
			             WHERE  IC.MADE_TYPE != 'DE'
			               AND  IC.PLANT_ID = VH.PLANT_ID
			               AND  IC.LINE_ID = VH.LINE_ID
			               AND  IC.PROC_ID = VH.PROC_ID
			               AND  VH.CAT = '포장'
			               AND  IC.CAPA_MC > 0
			               AND  IC.PLANT_ID != '1300' -- 생산 공장만
			               --AND  IC.PLANT_ID = '1110'
			             GROUP  BY IC.PLANT_ID, IC.LINE_ID, IC.ITEM_ID, IC.CAPA_MC, IC.QTY, (24 * IC.QTY / IC.CAPA_MC)
			             ORDER  BY IC.PLANT_ID, IC.LINE_ID, IC.ITEM_ID, IC.CAPA_MC, IC.QTY  ) IC
			        , ( SELECT  VH.PLANT_ID, VH.PLANT_NAME, VH.LINE_ID, VH.LINE_NAME
			              FROM  V_HRCHY_PROC VH
			             GROUP  BY VH.PLANT_ID, VH.PLANT_NAME, VH.LINE_ID, VH.LINE_NAME
			             ORDER  BY VH.PLANT_ID, VH.PLANT_NAME, VH.LINE_ID, VH.LINE_NAME ) VH
			        , ( SELECT  CM.CD, CM.CD_NAME
			              FROM  CODE_MST CM
			             WHERE  CM.MADE_TYPE != 'DE'
			               AND  CM.CD_GRP = 'SHIFT_TYPE' ) ST --SHIFT TYPE(조,주,야)
			 WHERE  IM.MADE_TYPE != 'DE'  
			   AND  DS.PLANT_ID = IC.PLANT_ID(+)
			   AND  DS.LINE_ID = IC.LINE_ID(+)
			   AND  DS.ITEM_ID = IC.ITEM_ID(+)
			   AND  DS.ITEM_ID = IM.ITEM_ID
			   AND  DS.PLANT_ID = VH.PLANT_ID(+)
			   AND  DS.LINE_ID = VH.LINE_ID(+)
			   AND  DS.SHIFT_TYPE = ST.CD
			   AND  DS.CAT_ID = '$!{selected_plan_type}' -- 계획구분
			  [AND  DS.PLANT_ID = '${selected_plant}'] -- 공장
			  [AND  DS.LINE_ID = '${selected_line}'] -- 라인
			   AND  DS.VERSION = '$!{selected_version}' -- 버전
			   AND  DS.PROD_DATES BETWEEN TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD'),'YYYYMMDD') AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD')
			  [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --SALES_CAT1
			  [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --SALES_CAT2
			  [AND  IM.CAT01 = '${selected_cat01}'] -- 품종특성
			 GROUP  BY VH.PLANT_NAME, VH.LINE_NAME, ST.CD_NAME, IC.CAPA, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC
			 ORDER  BY VH.PLANT_NAME, VH.LINE_NAME, ST.CD_NAME, IC.CAPA, DS.ITEM_ID, IM.ITEM_NAME, IM.SPEC
	
	</query>
	
	<!-- 버전 리스트 -->
	<query id="prod_plan_chk_version_list">
	
			SELECT  PV.CAT_ID, PV.VERSION, ROWNUM NUM, PV.STATUS
			  FROM  (   SELECT  PV.CAT_ID, PV.VERSION, PV.STATUS
			              FROM  PLAN_VERSION_LOG PV
			             WHERE  PV.MADE_TYPE != 'DE'               
			               AND  PV.PERIOD_TYPE = 'DAILY'                
			               AND  PV.CAT_ID = 'PS'   
			               AND  PV.VERSION IS NOT NULL            
			             --AND  PV.STATUS = '23'                       
			             --GROUP  BY PV.CAT_ID, PV.VERSION
			             ORDER  BY PV.CAT_ID, PV.VERSION DESC ) PV
			 WHERE  ROWNUM &lt; 21
			 UNION  ALL
			SELECT  PV.CAT_ID, PV.VERSION, ROWNUM NUM, PV.STATUS
			  FROM  (   SELECT  PV.CAT_ID, PV.VERSION, PV.STATUS
			              FROM  PLAN_VERSION_LOG PV
			             WHERE  PV.MADE_TYPE != 'DE'               
			               AND  PV.PERIOD_TYPE = 'DAILY'                
			               AND  PV.CAT_ID = 'SS'   
			               AND  PV.VERSION IS NOT NULL            
			             --AND  PV.STATUS = '23'                       
			             --GROUP  BY PV.CAT_ID, PV.VERSION
			             ORDER  BY PV.CAT_ID, PV.VERSION DESC ) PV
			 WHERE  ROWNUM &lt; 21
	
	</query>

	<!-- 
	==================================
		작업장별 생산계획결과 검증 
	==================================
	-->
	<!-- 생산계획결과 검증 조회 -->
	<query id="sc_05250_schCapaRateCheck_list" paging="true">
	
			SELECT DS.PLANT_NAME, DS.HID_NAME, DS.LINE_NAME, DS.PROC_NAME, 
			       TO_CHAR(DS.AVG_CAPA_EA,'999,999,999'), DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D01,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+0,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE01,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D02,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+1,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE02,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D03,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+2,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE03,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D04,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+3,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE04,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D05,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+4,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE05,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D06,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+5,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE06,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D07,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+6,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE07,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D08,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+7,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE08,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D09,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+8,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE09,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D10,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+9,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE10,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D11,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+10,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE11,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D12,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+11,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE12,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D13,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+12,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE13,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D14,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+13,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE14,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D15,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+14,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE15,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D16,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+15,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE16,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D17,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+16,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE17,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D18,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+17,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE18,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D19,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+18,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE19,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D20,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+19,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE20,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.EA_QTY ELSE 0 END ),0) D21,
			       NVL(SUM(CASE WHEN DS.PROD_DATES = TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD') THEN DS.RATE ELSE 0 END ),0) RATE21
			  FROM (
			        SELECT SQ.PLANT_ID, PL.PLANT_NAME, CO.HID_NAME, SQ.LINE_ID, LN.LINE_NAME, SQ.PROC_ID, CA.PROC_NAME,
			               CA.PROC_AVG_CAPA_EA AVG_CAPA_EA, SQ.ITEM_ID, IM.ITEM_NAME, IM.SPEC, SQ.PROD_DATES,        
			               SQ.QTY BOX_QTY, IM.QTY EA_PER_BOX, ROUND(SQ.QTY*IM.QTY, 0) EA_QTY, ROUND(((SQ.QTY*IM.QTY)/CA.PROC_AVG_CAPA_EA)*100,1) RATE
			          FROM (SELECT SC.PLANT_ID, SC.LINE_ID, SC.PROC_ID, SC.ITEM_ID, SC.PROD_DATES, SUM(SC.SHIFT_QTY) QTY
			                  FROM DAILY_SCH_PLAN_SHIFT SC
			                 WHERE  SC.MADE_TYPE != 'DE'
			                   AND  SC.CAT_ID = '$!{selected_plan_type}' -- 계획구분   
			                   AND  SC.VERSION = '$!{selected_version}' -- 버전
			                  [AND  SC.PLANT_ID = '${selected_plant}'] -- 공장
			                  [AND  SC.LINE_ID = '${selected_line}'] -- 라인
			                  [AND  SC.PROC_ID = '${selected_proc}'] -- 작업장
			                   AND  SC.PROD_DATES BETWEEN TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD'),'YYYYMMDD') AND TO_CHAR(TO_DATE('$!{sdate}','YYYY-MM-DD')+20,'YYYYMMDD')
			                 GROUP  BY SC.PLANT_ID, SC.LINE_ID, SC.PROC_ID, SC.ITEM_ID, SC.PROD_DATES
			               ) SQ,
			               (SELECT CA.DIVISION, CA.ITYPE, CA.PLANT_ID, CA.LINE_ID, CA.PROC_ID, CA.PROC_NAME, CA.PROC_AVG_CAPA_EA
			                  FROM DAY_PROC_AVG_CAPA_EA CA
			                 WHERE CA.ITYPE = 'FERT'
			                 --WHERE CA.ITYPE = DECODE('$!{selected_plan_type}','PS','FERT','SS','HALB')
			                  [AND CA.PLANT_ID  = '${selected_plant}']
			               ) CA,
			               ITEM_MST IM,
			               (SELECT HTYPE PLANT_ID, HID, HID_NAME PLANT_NAME
			                  FROM HRCHY
			                 WHERE LVL_TYPE = '공장'
			                   AND HTYPE != '1300'
			               ) PL,
			               (SELECT HTYPE PLANT_ID, HID, HID_NAME 
			                  FROM HRCHY
			                 WHERE LVL_TYPE = '원가부문'
			                   AND HTYPE != '1300'
			               ) CO,       
			               (SELECT HTYPE PLANT_ID, HID LINE_ID, HID_NAME LINE_NAME, PARENT_HID
			                  FROM HRCHY
			                 WHERE LVL_TYPE = '라인'
			                   AND HTYPE != '1300'         
			               ) LN             
			         WHERE SQ.PLANT_ID   = CA.PLANT_ID(+)
			           AND SQ.LINE_ID    = CA.LINE_ID(+)
			           AND SQ.PROC_ID    = CA.PROC_ID(+)
			           AND SQ.PLANT_ID   = PL.PLANT_ID(+)
			           AND SQ.PLANT_ID   = LN.PLANT_ID(+)
			           AND SQ.LINE_ID    = LN.LINE_ID(+)
			           AND SQ.ITEM_ID    = IM.ITEM_ID(+)
			           AND IM.ITYPE      = CA.ITYPE
			           AND LN.PLANT_ID   = CO.PLANT_ID
			           AND LN.PARENT_HID = CO.HID
			          [AND  IM.SALES_CAT01 = '${selected_hr_type1}'] --SALES_CAT1
			          [AND  IM.SALES_CAT02 = '${selected_hr_type}'] --SALES_CAT2
			          [AND  IM.CAT01 = '${selected_cat01}'] -- 품종특성
			     ) DS
			 GROUP BY DS.PLANT_NAME, DS.HID_NAME, DS.LINE_NAME, DS.PROC_NAME, DS.AVG_CAPA_EA, DS.ITEM_ID, DS.ITEM_NAME, DS.SPEC
			 ORDER BY DS.PLANT_NAME, DS.HID_NAME, DS.LINE_NAME, DS.PROC_NAME, DS.AVG_CAPA_EA, DS.ITEM_ID
	
	</query>
	
	<!-- 작업장 리스트 -->
	<query id="sch_capa_rate_combo_proc_list">
	
			SELECT  VH.PLANT_ID, VH.LINE_ID, VH.PROC_ID, VH.PROC_NAME
			  FROM  V_HRCHY_PROC VH
			 ORDER  BY VH.PLANT_ID, VH.LINE_ID, VH.PROC_ID, VH.PROC_NAME
	
	</query>
	
	<!--
	=============================
		주(일)간 계획 결과 검증 
	=============================
	-->
		
	<!--주(일)간 계획 결과 검증-->
	<query id="sc_02170_dailyPlanResultCheck_list" paging="true">
	
			/* DEMAND 정보 */
			SELECT  DM.DEMAND_TYPE, DM.DOMAIN, DM.ITEM_ID, DM.ITEM_NAME, TO_CHAR(DM.DUE_DATE,'YYYY-MM-DD') DUE_DATE,
			        DM.QTY, DM.QTY_UOM, DM.ORD_NO, DM.ORD_ITEM_NO, DM.PROD_REQ_DATE, DM.LOC_ID, DC.DC_SHORT_NAME
			  FROM  (/* 주문정보 : 내수/수출 */
			        	SELECT  '주문' DEMAND_TYPE, DECODE(OD.DOMAIN, 'DO', '내수', '수출') DOMAIN, OD.ITEM_ID, IM.ITEM_NAME, OD.DUE_DATE, 
			               		OD.QTY, OD.QTY_UOM, 
			               		OD.ORD_NO, OD.ORD_ITEM_NO, OD.PROD_REQ_DATE, OD.LOC_ID,
			               		TO_CHAR(OD.IF_DTTM, 'yyyymmdd') VERSION
			          	  FROM  NFOS_ORDER OD, ITEM_MST IM
			          	  		, (	SELECT  MAX(IF_DTTM) IF_DTTM
			                  		  FROM  NFOS_ORDER ) MV
			         	 WHERE  OD.IF_DTTM = MV.IF_DTTM 
			           	   AND  OD.ITEM_ID = IM.ITEM_ID(+)
			           	  [AND  OD.ITEM_ID LIKE '%${item_id}%'] -- ITEM_ID
			           	  [AND  IM.ITEM_NAME LIKE '%${item_name}%']
			             UNION
				        /* 판매계획 : 내수 */
				        SELECT  '판매계획' DEMAND_TYPE, DECODE(SP.DOMAIN, 'DO', '내수', '수출') DOMAIN, SP.ITEM_ID, IM.ITEM_NAME, TO_DATE(SP.YYYYMMDD, 'yyyymmdd') DUE_DATE,
				                (NORMAL_QTY + PROM_QTY + SUPT_QTY + SAMP_QTY) QTY, 'BOX' QTY_UOM, 
				                NULL ORD_NO, NULL ORD_ITEM_NO, NULL PROD_REQ_DATE, SP.DELIV_LOC LOC_ID,
				                SP.YYYY||'_'||SP.VERSION VERSION
				          FROM  NFOS_SALES_PLAN_WEEKLY SP,
				                (	SELECT  SP.YYYY, MAX(SP.VERSION) VERSION
				                  	  FROM  NFOS_SALES_PLAN_WEEKLY SP,
				                       		(	SELECT  MAX(YYYY) YYYY
				                          		  FROM  NFOS_SALES_PLAN_WEEKLY ) MV
				                 	 WHERE  SP.YYYY = MV.YYYY 
				                 	 GROUP  BY SP.YYYY ) MV
				                , ITEM_MST IM
				         WHERE  SP.YYYY = MV.YYYY
				           AND  SP.VERSION = MV.VERSION
				           AND  SP.ITEM_ID = IM.ITEM_ID(+)
				          [AND  SP.ITEM_ID = '${item_id}'] -- ITEM_ID
				          [AND  IM.ITEM_NAME LIKE '%${item_name}%']
				           AND  SP.DOMAIN  = 'DO' ) DM
				    , DC_MST DC
			 WHERE  DM.LOC_ID = DC.DC_ID
			  [AND  DM.DEMAND_TYPE = '${selected_demand_type}']
			  [AND  DM.DOMAIN = '${selected_domain}']       
			 ORDER  BY DM.DEMAND_TYPE, DM.DOMAIN, DM.ITEM_ID, DM.ITEM_NAME, DM.DUE_DATE, 
			       	   DM.ORD_NO, DM.ORD_ITEM_NO, DM.PROD_REQ_DATE, DM.LOC_ID

	</query>
	
	<!-- 공장할당 결과-->
	<query id="plant_alloc_result_list" >
	
			/* 해당품목에 대한 공장할당 결과 */
			SELECT  PA.ITEM_ID, IM.ITEM_NAME, PA.PLANT_ID, HR.PLANT_NAME, PA.VERSION, TO_CHAR(PA.DUE_DATE,'YYYY-MM-DD') DUE_DATE, PA.QTY, PA.QTY_UOM, PA.ORDER_INFO
			  FROM  (
			  		SELECT  VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, SUM(QTY) QTY, QTY_UOM, ORDER_INFO, MADE_TYPE
					FROM    PLANT_ALLOC_PLAN
					GROUP   BY VERSION, SEQ, PLANT_ID, ITEM_ID, DUE_DATE, QTY_UOM, ORDER_INFO, MADE_TYPE 
					) PA
			        , ( SELECT  MAX(VERSION) VERSION
			            --SELECT  VERSION
			              FROM  PLAN_VERSION_LOG
			             WHERE  PERIOD_TYPE = 'DAILY'
			               AND  CAT_ID      = 'FA'
			               AND  RUN_DATE = TO_DATE('$!{run_date}','YYYY-MM-DD') 
			           ) MV
			        , ITEM_MST IM
			        , ( SELECT  HID PLANT_ID, HID_NAME PLANT_NAME
			              FROM  HRCHY
			             WHERE  LVL_TYPE = '공장' ) HR
			 WHERE  PA.VERSION = MV.VERSION 
			   AND  PA.ITEM_ID = '$!{item_id}'
			   AND  PA.ITEM_ID = IM.ITEM_ID(+)
			   AND  PA.PLANT_ID = HR.PLANT_ID(+)
			 ORDER  BY PA.VERSION, PA.ITEM_ID, IM.ITEM_NAME, PA.PLANT_ID, PA.DUE_DATE 	
	
	</query>
		
	<!-- 생산계획 결과-->
	<query id="daily_production_plan_result_list" >
	
			 /* 해당품목에 대한 완제품 생산계획 결과 */
			SELECT  SC.ITEM_ID, IM.ITEM_NAME, SC.PLANT_ID, VH.PLANT_NAME, SC.LINE_ID, VH.LINE_NAME, SC.PROC_ID, VH.PROC_NAME
					, SC.VERSION, SC.PROD_DATES, SC.SHIFT_QTY, SC.QTY_UOM, SC.SHIFT_TYPE, SC.WO_ID, TO_CHAR(SC.START_DTTM,'YYYY-MM-DD HH:MI:SS') START_DTTM
					, TO_CHAR(SC.END_DTTM,'YYYY-MM-DD HH:MI:SS') END_DTTM, SC.PRIORITY, SC.ORD_NO, SC.ORD_ITEM_NO, SC.GRP_WO_ID
			  FROM  DAILY_SCH_PLAN_SHIFT SC
			        , ( SELECT  PV.CAT_ID, PV.SUB_CAT, CD.CAT01 PLANT_ID, CD.CD_NAME PLANT_NAME, MAX(PV.VERSION) VERSION
			              FROM  PLAN_VERSION_LOG PV
			                    , ( SELECT  PV.PERIOD_TYPE, PV.RUN_DATE, PV.CAT_ID, PV.SUB_CAT, MAX(RUN_SEQ) RUN_SEQ
			                          FROM  PLAN_VERSION_LOG PV
			                         WHERE  PV.PERIOD_TYPE = 'DAILY'
			                           AND  PV.CAT_ID      = 'PS'
			                           AND  PV.RUN_DATE    = TO_DATE('$!{run_date}','YYYY-MM-DD')
			                           AND  PV.SUB_CAT IS NOT NULL  
			                           AND  PV.VERSION IS NOT NULL        
			                         GROUP  BY PV.PERIOD_TYPE, PV.RUN_DATE, PV.CAT_ID, PV.SUB_CAT ) MV,
			                    (   SELECT  CD_GRP, CD, CD_NAME, DESCR, CAT01
			                          FROM  CODE_MST
			                         WHERE  CD_GRP = 'SUB_CAT' ) CD
			             WHERE  PV.PERIOD_TYPE = MV.PERIOD_TYPE
			               AND  PV.RUN_DATE    = MV.RUN_DATE
			               AND  PV.CAT_ID      = MV.CAT_ID
			               AND  PV.SUB_CAT     = MV.SUB_CAT
			               AND  PV.RUN_SEQ     = MV.RUN_SEQ
			               AND  PV.VERSION IS NOT NULL
			               AND  PV.SUB_CAT     = CD.CD(+)
			             GROUP  BY PV.CAT_ID, PV.SUB_CAT, CD.CAT01, CD.CD_NAME ) MV
			        , ITEM_MST IM, V_HRCHY_PROC VH
			 WHERE  SC.CAT_ID   = MV.CAT_ID
			   AND  SC.PLANT_ID = MV.PLANT_ID
			   AND  SC.VERSION  = MV.VERSION    
			   AND  SC.ITEM_ID  = '$!{item_id}'
			   AND  SC.ITEM_ID  = IM.ITEM_ID(+)
			   AND  SC.PLANT_ID = VH.PLANT_ID
			   AND  SC.LINE_ID = VH.LINE_ID
			   AND  SC.PROC_ID = VH.PROC_ID
			 ORDER  BY SC.ITEM_ID, IM.ITEM_NAME, SC.PLANT_ID, SC.LINE_ID, SC.PROC_ID, SC.VERSION
                    , SC.PROD_DATES, SC.SHIFT_TYPE, SC.WO_ID, SC.START_DTTM, SC.END_DTTM
	
	</query>
	
	<!-- 반제품 생산계획 결과-->
	<query id="daily_semifinished_production_plan_result_list" >
	
			/* 해당품목에 대한 반제품 생산계획 결과 : 완제품 - 반제품 BOM TREE 참조 */
			SELECT  SC.ITEM_ID, IM.ITEM_NAME, SC.PLANT_ID, VH.PLANT_NAME, SC.LINE_ID, VH.LINE_NAME, SC.PROC_ID, VH.PROC_NAME
					, SC.VERSION, SC.PROD_DATES, SC.SHIFT_QTY, SC.QTY_UOM, SC.SHIFT_TYPE, SC.WO_ID, TO_CHAR(SC.START_DTTM,'YYYY-MM-DD HH:MI:SS') START_DTTM
					, TO_CHAR(SC.END_DTTM,'YYYY-MM-DD HH:MI:SS') END_DTTM, SC.PRIORITY, SC.ORD_NO, SC.ORD_ITEM_NO, SC.GRP_WO_ID
			  FROM  DAILY_SCH_PLAN_SHIFT SC
			        , ( SELECT  PV.CAT_ID, PV.SUB_CAT, MAX(PV.VERSION) VERSION
			              FROM  PLAN_VERSION_LOG PV
			                    , ( SELECT  PV.PERIOD_TYPE, PV.RUN_DATE, PV.CAT_ID, PV.SUB_CAT, MAX(RUN_SEQ) RUN_SEQ
			                          FROM  PLAN_VERSION_LOG PV
			                         WHERE  PV.PERIOD_TYPE = 'DAILY'
			                           AND  PV.CAT_ID      = 'SS'
			                           AND  PV.RUN_DATE    = TO_DATE('$!{run_date}','YYYY-MM-DD')
			                           AND  PV.SUB_CAT IS NOT NULL  
			                           AND  PV.VERSION IS NOT NULL        
			                         GROUP  BY PV.PERIOD_TYPE, PV.RUN_DATE, PV.CAT_ID, PV.SUB_CAT ) MV
			             WHERE  PV.PERIOD_TYPE = MV.PERIOD_TYPE
			               AND  PV.RUN_DATE    = MV.RUN_DATE
			               AND  PV.CAT_ID      = MV.CAT_ID
			               AND  PV.SUB_CAT     = MV.SUB_CAT
			               AND  PV.RUN_SEQ     = MV.RUN_SEQ
			               AND  PV.VERSION IS NOT NULL
			             GROUP  BY PV.CAT_ID, PV.SUB_CAT ) MV
			        , ITEM_MST IM
			        , ( SELECT  BM.PROD_ITEM_ID ITEM_ID, BM.PROD_ITEM_TYPE ITYPE
			              FROM  (   SELECT  DISTINCT PLANT_ID
			                                , DECODE(CONS_ITEM_TYPE, 'ROH1', 'MAT', 'ROH2', 'MAT', CONS_ITEM_ID) CONS_ITEM_ID
			                                , DECODE(CONS_ITEM_TYPE, 'ROH1', 'ROH', 'ROH2', 'ROH', CONS_ITEM_TYPE) CONS_ITEM_TYPE
			                                , PROD_ITEM_ID, PROD_ITEM_TYPE, PROD_VER, YIELD, ALT_BOM, VALID_START, VALID_END
			                          FROM  MBOM 
			                         WHERE  PROD_ITEM_TYPE||'_'||CONS_ITEM_TYPE IN ('FERT_HALB', 'HALB_HALB', 'HALB_ROH1', 'HALB_ROH2') 
			                         ORDER  BY PLANT_ID, PROD_ITEM_ID ) BM
			             WHERE  BM.PROD_ITEM_TYPE IN ('HALB')       
			             START  WITH PROD_ITEM_ID = '$!{item_id}'
			           CONNECT  BY PROD_ITEM_ID = PRIOR CONS_ITEM_ID AND PROD_ITEM_TYPE = PRIOR CONS_ITEM_TYPE AND PROD_VER = PRIOR PROD_VER 
			             UNION
			            SELECT  BM.CONS_ITEM_ID, BM.CONS_ITEM_TYPE
			              FROM  (   SELECT  DISTINCT PLANT_ID 
			                                , DECODE(CONS_ITEM_TYPE, 'ROH1', 'MAT', 'ROH2', 'MAT', CONS_ITEM_ID) CONS_ITEM_ID 
			                                , DECODE(CONS_ITEM_TYPE, 'ROH1', 'ROH', 'ROH2', 'ROH', CONS_ITEM_TYPE) CONS_ITEM_TYPE 
			                                , PROD_ITEM_ID, PROD_ITEM_TYPE, PROD_VER, YIELD, ALT_BOM, VALID_START, VALID_END
			                          FROM  MBOM 
			                         WHERE  PROD_ITEM_TYPE||'_'||CONS_ITEM_TYPE IN ('FERT_HALB', 'HALB_HALB', 'HALB_ROH1', 'HALB_ROH2')
			                         ORDER  BY PLANT_ID, PROD_ITEM_ID ) BM
			             WHERE  BM.CONS_ITEM_TYPE IN ('HALB')
			             START  WITH PROD_ITEM_ID = '$!{item_id}' --AND PLANT_ID = '1170'
			           CONNECT  BY PROD_ITEM_ID = PRIOR CONS_ITEM_ID AND PROD_ITEM_TYPE = PRIOR CONS_ITEM_TYPE AND PROD_VER = PRIOR PROD_VER ) HA
			        , V_HRCHY_PROC VH   
			 WHERE  SC.CAT_ID   = MV.CAT_ID
			   AND  SC.VERSION  = MV.VERSION    
			   AND  SC.ITEM_ID  = HA.ITEM_ID
			   AND  SC.ITEM_ID  = IM.ITEM_ID(+)
			   AND  SC.PLANT_ID = VH.PLANT_ID
			   AND  SC.LINE_ID = VH.LINE_ID
			   AND  SC.PROC_ID = VH.PROC_ID
			 ORDER  BY SC.PLANT_ID, SC.VERSION, SC.WO_ID, SC.ITEM_ID, IM.ITEM_NAME, SC.LINE_ID, SC.PROC_ID
			           , SC.PROD_DATES, SC.SHIFT_TYPE, SC.START_DTTM, SC.END_DTTM	
	
	</query>
	
	<!-- 공급할당량-->
	<query id="alloc_plan_result_list" >
	
			/* 해당품목 공급할당량 */
			SELECT  DT.ITEM_ID, IM.ITEM_NAME, DT.SALES_LOC, SL.SALES_LOC_NAME, DT.DELIV_LOC, DM.DC_SHORT_NAME, DT.YYYYMMDD, DT.QTY
					, DT.DM_TYPE, DT.YYYY, DT.VERSION
			  FROM  DEMAND_FOR_TRANSPLAN DT
			        , V_SALES_LOC SL
			        , DC_MST DM
			        , ITEM_MST IM
			 WHERE  DT.ITEM_ID = '$!{item_id}'
			   AND  DT.SALES_LOC = SL.SALES_LOC_ID
			   AND  DT.DELIV_LOC = DM.DC_ID
			   AND  DT.ITEM_ID = IM.ITEM_ID
			 ORDER  BY DT.ITEM_ID, DT.YYYYMMDD, DT.SALES_LOC, DT.DELIV_LOC
	
	</query>
	
	<!-- 수송계획-->
	<query id="trans_plan_result_list" >
	
			 /* 해당품목의 수송계획 */
			SELECT  TP.ITEM_ID, IM.ITEM_NAME, TP.TGT_LOC, TG.DC_SHORT_NAME, TP.SRC_LOC, SR.DC_SHORT_NAME, TP.VERSION
					, TO_CHAR(TP.TRANS_DATE,'YYYY-MM-DD') TRANS_DATE
					, TP.TRUCK_SEQ, TP.ROUTE_ID, TP.BRAND_NO, TP.BRAND_LINE_NO, TP.DESCRIPTION
			        , TP.BASE_STK_QTY, TP.BASE_STK_PLT, TP.ADD_STK_QTY, TP.ADD_STK_PLT
			        , TP.PROD_QTY, TP.PROD_PLT, TP.MOD_FLAG, TP.MOD_QTY
			  FROM  TRANS_PLAN TP
			        , ( SELECT  MAX(PV.VERSION) VERSION
			              FROM  PLAN_VERSION_LOG PV
			             WHERE  PV.PERIOD_TYPE = 'DAILY'
                           AND  PV.CAT_ID      = 'RP'
                           AND  PV.RUN_DATE    = TO_DATE('$!{run_date}','YYYY-MM-DD')
                           AND  PV.SUB_CAT IS NOT NULL  
                           AND  PV.VERSION IS NOT NULL ) MV
			        , DC_MST TG
			        , DC_MST SR
			        , ITEM_MST IM
			 WHERE  TP.VERSION = MV.VERSION     
			   AND  TP.ITEM_ID = '$!{item_id}' 
			   AND  TP.TGT_LOC = TG.DC_ID
			   AND  TP.SRC_LOC = SR.DC_ID 
			   AND  TP.ITEM_ID = IM.ITEM_ID
			 ORDER  BY TP.VERSION, TP.TRANS_DATE, TP.TGT_LOC, TG.DC_SHORT_NAME, TP.SRC_LOC, SR.DC_SHORT_NAME, TP.TRUCK_SEQ
			        , TP.ITEM_ID, TP.ROUTE_ID, TP.BRAND_NO, TP.BRAND_LINE_NO, TP.DESCRIPTION
			        , TP.BASE_STK_QTY, TP.BASE_STK_PLT, TP.ADD_STK_QTY, TP.ADD_STK_PLT
			        , TP.PROD_QTY, TP.PROD_PLT, TP.MOD_FLAG, TP.MOD_QTY
	
	</query>
	
	<!-- 주(일)간 계획 결과 검증 : RUN DATE 조회 : POPUP -->
	<query id="sc_02170_dailyPlanResultCheck_popup" paging="true">
	
			SELECT  VL.PERIOD_TYPE, TO_CHAR(VL.RUN_DATE,'YYYY-MM-DD') RUN_DATE, VL.PL_NAME, VL.PLANT_NAME
			  FROM  (   SELECT  DISTINCT PV.PERIOD_TYPE, PV.RUN_DATE, PT.PL_NAME, PL.PLANT_NAME
			              FROM  PLAN_VERSION_LOG PV
			                    , ( SELECT  CD , CD_NAME PL_NAME
			                          FROM  CODE_MST
			                         WHERE  CD_GRP = 'CAT_ID' ) PT
			                    , ( SELECT  CD, CD_NAME PLANT_NAME
			                          FROM  CODE_MST
			                         WHERE  CD_GRP = 'SUB_CAT'  
			                         /*AND  CD NOT IN (SELECT CD FROM CODE_MST WHERE CD_GRP = 'CAT_ID')*/  ) PL
			             WHERE  PV.PERIOD_TYPE = 'DAILY'
			               AND  PV.CAT_ID      = PT.CD(+)
			               AND  PV.SUB_CAT     = PL.CD
			             ORDER  BY PV.RUN_DATE DESC ) VL
			 WHERE  ROWNUM &lt;= 30
			 ORDER  BY RUN_DATE DESC, VL.PL_NAME
	
	</query>
	
	
<!--
=====================================================================================================
	기준정보 >> 생산계획 
=====================================================================================================
--> 

	<!-- 
	===============================
		생산계획 미 반영 작업장
	===============================
	-->
		
	<!--생산계획 미 반영 작업장  조회--> 
	<query id="md_05140_schedulingNotUseProc_list">
			 
		#if("$!{selected_plant}" == "")
			#set( $selected_plant = 1110 )
		#end
			SELECT  A.ITEM_ID, B.ITEM_NAME, B.SPEC, A.PLANT_ID, C.PLANT_NAME, A.LINE_ID, C.LINE_NAME,         
			        DECODE(A.USE_FLAG,NULL, '사용', '미사용') USE_DESC
			FROM    (                
			        SELECT  DISTINCT        
			                A.PLANT_ID, A.ITEM_ID, A.LINE_ID,         
			                B.USE_FLAG
			        FROM    ITEM_CAPA A,
			                ITEM_PLANT_LINE_CTL B    
			        WHERE   A.ITEM_ID    = B.ITEM_ID (+)		
			        AND     A.PLANT_ID   = B.PLANT_ID (+)		
			        AND     A.LINE_ID    = B.LINE_ID (+)
			        AND     A.PLANT_ID  != '1300'
			        AND     A.MADE_TYPE != 'DE'	
			        ) A,
			        ITEM_MST B,
			        (
			        SELECT  DISTINCT
			                PLANT_ID, PLANT_NAME, LINE_ID, LINE_NAME
			        FROM    V_HRCHY_PROC
			        ) C	
			WHERE   A.PLANT_ID 	= C.PLANT_ID(+)
			AND     A.LINE_ID  	= C.LINE_ID(+)
			AND     A.ITEM_ID  	= B.ITEM_ID(+)
		   [AND  	B.ITEM_ID 	LIKE '%${search_item_id}%']
		   [AND  	B.ITEM_NAME LIKE '%${search_item_name}%']
		   [AND  	B.DIVISION 	= '${selected_division}']
	 	   [AND  	A.PLANT_ID 	= '${selected_plant}']
		   [AND  	A.LINE_ID 	= '${selected_line}']
		    ORDER   BY PLANT_ID, ITEM_ID, LINE_ID		 
	
	</query>

	<!-- 01.데이터 INSERT-->
	<query id="md_05140_schedulingNotUseProc_list_save_02" fix="_user_id" iterator="use_flag item_id plant_id line_id">
	
		#if( "$!{use_flag}" == "N" )
			--미 사용		
			INSERT  INTO ITEM_PLANT_LINE_CTL(ITEM_ID, PLANT_ID, LINE_ID, USE_FLAG, MADE_TYPE, MADE_DTTM, MADE_BY)   
			SELECT  
			        A.ITEM_ID, A.PLANT_ID, A.LINE_ID, A.USE_FLAG, 
			        'AD'    		AS MADE_TYPE,
			        SYSDATE 		AS MADE_DTTM,
			        '$!{_user_id}'  AS MADE_BY   --사용자 ID
			FROM    (
			        SELECT  
			                '$!{item_id}' AS ITEM_ID, '$!{plant_id}' AS PLANT_ID, '$!{line_id}' AS LINE_ID, '$!{use_flag}' AS USE_FLAG
			        FROM    DUAL
			        ) A
			WHERE   A.USE_FLAG = 'N' --미 사용
			AND     NOT EXISTS  (/* 테이블에 입력하는 데이터가 존재하는지 체크 */
			                    SELECT  
			                            ITEM_ID, PLANT_ID, LINE_ID
			                    FROM    ITEM_PLANT_LINE_CTL
			                    WHERE   ITEM_ID  = A.ITEM_ID
			                    AND     PLANT_ID = A.PLANT_ID
			                    AND     LINE_ID  = A.LINE_ID
			                    )
		#else
			--사용
			DELETE  ITEM_PLANT_LINE_CTL
			WHERE   ITEM_ID  = '$!{item_id}'
			AND     PLANT_ID = '$!{plant_id}'
			AND     LINE_ID  = '$!{line_id}'
			AND     'Y'      = '$!{use_flag}' --사용		
		#end 
	
	</query>
	
	<!-- 선택한 제품, 공장에 대해 생산 가능한 라인 리스트 -->
	<query id="item_and_plant_of_line_list">
	
			SELECT  DISTINCT IC.LINE_ID, HR.LINE_NAME
			  FROM  ITEM_CAPA IC
			        , ( SELECT  HTYPE, HID LINE_ID, HID_NAME LINE_NAME
			              FROM  HRCHY
			             WHERE  MADE_TYPE != 'DE'
			               AND  LVL_TYPE = '라인' ) HR
			WHERE  	IC.MADE_TYPE != 'DE'
			AND		IC.ITEM_ID = '$!{item_id}'
			AND  	IC.PLANT_ID = '$!{plant_id}'   
			AND  	IC.PLANT_ID = HR.HTYPE(+) 
			AND  	IC.LINE_ID = HR.LINE_ID(+)
			ORDER  	BY IC.LINE_ID
	
	</query>

	<!-- 
	===============================
		공장할당 실적 비율 관리
	===============================
	-->
		
	<!--공장할당 실적 비율 관리  조회-->
	<query id="md_05150_plantAllocActualResultRate_list" paging="true">
	
			SELECT  ID.ITEM_ID, IM.ITEM_NAME, IM.SPEC, ID.PLANT_ID, HR.PLANT_NAME, AR.ALLOC_RATE 
			FROM    (
			        /*
			            ITEM별 생산공장 리스트
			        */
			        SELECT  ID.ITEM_ID, ID.PLANT_ID
			        FROM    ITEM_DTL ID
			        WHERE   ID.PLANT_ID != '1300'
			        AND     ID.ITYPE = 'FERT'
			        ORDER   BY ID.ITEM_ID, ID.PLANT_ID
			        ) ID,
			        (
			        /*
			            ITEM별 생산공장별 생산실적 기준 배분율
			        */
			        SELECT  AR.ITEM_ID, AR.PLANT_ID, AR.ALLOC_RATE
			        FROM    PLANT_ALLOC_ACT_RATE AR
			        ORDER   BY ITEM_ID, PLANT_ID
			        ) AR,
			        (
			        /*
			            완제품
			            ------------------------------
			            제품코드, 품목타입, 제품명, 규격
			        */
			        SELECT  ITEM_ID, ITYPE, ITEM_NAME, SALES_CAT01, SALES_CAT02, SPEC, CAT01
			        FROM    ITEM_MST
			        WHERE   ITYPE = 'FERT' 
			        ) IM,
			        (
			        /*
			            공장
			            -----------------
			            공장 코드, 공장 명
			        */
			        SELECT  HID AS PLANT_ID,
			                HID_NAME AS PLANT_NAME
			        FROM    HRCHY
			        WHERE   LVL_TYPE = '공장'
			        ) HR
			WHERE   ID.ITEM_ID = AR.ITEM_ID(+)
			AND     ID.PLANT_ID = AR.PLANT_ID(+)        
			AND     ID.ITEM_ID = IM.ITEM_ID(+)
			AND     ID.PLANT_ID = HR.PLANT_ID(+)
		   [AND     IM.SALES_CAT01 = '${selected_hr_type1}']
		   [AND     IM.SALES_CAT02 = '${selected_hr_type2}']
		   [AND     IM.CAT01 = '${selected_cat01}']
		   [AND		ID.ITEM_ID LIKE '%${item_id}%']
		   [AND		IM.ITEM_NAME LIKE '%${item_name}%']
			ORDER   BY ID.ITEM_ID, ID.PLANT_ID
				
	</query>
	
	<!-- 01. 화면에 있는 데이터 모두 삭제 -->
	<query id="md_05150_plantAllocActualResultRate_list_save_01" fix="" iterator="dp_item_id rate" >
		
			DELETE  PLANT_ALLOC_ACT_RATE
			WHERE   ITEM_ID = '$!{dp_item_id}'
			AND     '$!{rate}' IS NOT NULL	
				
	</query>
	<!-- 02. 화면에 있는 데이터 모두 INSERT-->
	<query id="md_05150_plantAllocActualResultRate_list_save_02" fix="_user_id" iterator="dp_item_id plant_id rate" >	
	
			INSERT  INTO PLANT_ALLOC_ACT_RATE(ITEM_ID, PLANT_ID, ALLOC_RATE, MADE_TYPE, MADE_DTTM, MADE_BY)
			SELECT  '$!{dp_item_id}' AS ITEM_ID,
			        '$!{plant_id}' AS PLANT_ID,
			        '$!{rate}' AS ALLOC_RATE,
			        'AD' AS MADE_TYPE,
			        SYSDATE AS MADE_DTTM,
			        '$!{_user_id}' AS MADE_BY
			FROM    DUAL
			WHERE   NOT EXISTS (    SELECT  AR.ITEM_ID, AR.PLANT_ID
			                        FROM    PLANT_ALLOC_ACT_RATE AR
			                        WHERE   AR.ITEM_ID = '$!{dp_item_id}'
			                        AND     AR.PLANT_ID = '$!{plant_id}'
			                   )
			AND     '$!{rate}' IS NOT NULL	
	
	</query>
	
	<!-- 화면에 있는 데이터 모두 삭제 -->
	<query id="md_05150_plantAllocActualResultRate_list_del" fix="" iterator="dp_item_id">
	
			DELETE  PLANT_ALLOC_ACT_RATE
			WHERE   ITEM_ID = '$!{dp_item_id}'
	
	</query>
	
	<!-- 
	===============================
		WORKING DAY 캘린더
	===============================
	-->
		
	<!--WORKING DAY 캘린더  조회-->
	<query id="md_05160_calendarHoliday_list" >	
		
		#if("$!{std_yyyymm}" == "")
			SELECT  CM.YYYYMMDD, 
			        CM.DD,  
			        CM.HOLIDAY_FLAG, 
			        DECODE(CM.WEEK_DAY,'월',1,'화',2,'수',3,'목',4,'금',5,'토',6,7) WEEK_DAY 
			FROM    CAL_MST CM, DUAL
			WHERE   CM.CAL_DATE BETWEEN TRUNC(TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM') || '-01','YYYY-MM-DD'),'D')
                                AND     TRUNC(TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM') || '-01','YYYY-MM-DD'),'D') + 34
	    	ORDER   BY CM.YYYYMMDD	
		#else
			SELECT  CM.YYYYMMDD, 
			        CM.DD,  
			        CM.HOLIDAY_FLAG, 
			        DECODE(CM.WEEK_DAY,'월',1,'화',2,'수',3,'목',4,'금',5,'토',6,7) WEEK_DAY 
			FROM    CAL_MST CM, DUAL
			WHERE   CM.CAL_DATE BETWEEN TRUNC(TO_DATE('$!{std_yyyymm}' || '-01','YYYY-MM-DD'),'D')
                                AND     TRUNC(TO_DATE('$!{std_yyyymm}' || '-01','YYYY-MM-DD'),'D') + 34
	    	ORDER   BY CM.YYYYMMDD 	
		#end
		
	</query>
	
	<!-- holiday_flag update -->
	<query id="md_05160_calendarHoliday_update">
	
			UPDATE  CAL_MST
			SET     HOLIDAY_FLAG = '$!{is_holiday}'
			WHERE   CAL_DATE = TO_DATE('$!{selected_date}','YYYYMMDD')
	
	</query>
	
<!--
=====================================================================================================
	생산계획 >> 분석정보 
=====================================================================================================
--> 

	<!-- 
	===============================
		공장별 생산계획 대비 실적 조회
	===============================
	-->
		
	<!--공장별 생산계획 대비 실적 조회-->
	<query id="sc_02190_planVsActualResultByPlant_list">
	
		#if("$!{selected_type}" == "2")
            SELECT  IL.SALES_CAT03, IL.CD_NAME, IL.GUBN, 
                    /*
                        0 : NULL(화면에서 빈칸으로 보이도록 하기위해서)
                        식 : ITEM_MST.QTY를 곱해준다.
                        BOX : 변경없음
                    */
                    CASE
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANY_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANY_QTY,'0',NULL,TO_CHAR(PL.ANY_QTY,'FM999,999,999'))
                    END     ANY_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANS_QTY,'0',NULL,TO_CHAR(PL.ANS_QTY,'FM999,999,999'))
                    END     ANS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANSB_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANSB_QTY,'0',NULL,TO_CHAR(PL.ANSB_QTY,'FM999,999,999'))
                    END     ANSB_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ASA_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ASA_QTY,'0',NULL,TO_CHAR(PL.ASA_QTY,'FM999,999,999'))
                    END     ASA_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.KUM_QTY,'FM999,999,999')
                    ELSE DECODE(PL.KUM_QTY,'0',NULL,TO_CHAR(PL.KUM_QTY,'FM999,999,999'))
                    END     KUM_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.PUS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.PUS_QTY,'0',NULL,TO_CHAR(PL.PUS_QTY,'FM999,999,999'))
                    END     PUS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.NOK_QTY,'FM999,999,999')
                    ELSE DECODE(PL.NOK_QTY,'0',NULL,TO_CHAR(PL.NOK_QTY,'FM999,999,999')) 
                    END     NOK_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.TOT,'FM999,999,999')
                    ELSE DECODE(PL.TOT,'0',NULL,TO_CHAR(PL.TOT,'FM999,999,999'))  
                    END     TOT
            FROM    (
                    /*
                        ITEM_MST.SALES_CAT03(중분류) 리스트
                    */
                    SELECT  ID.SALES_CAT03, ID.CD_NAME, GB.GUBN
                    FROM    (                    
                            SELECT  IM.SALES_CAT03, CM.CD_NAME        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR IM.MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM,
                                    (
                                    SELECT  CD, CD_NAME
                                    FROM    CODE_MST
                                    WHERE   CD_GRP = 'SALES_CAT3'
                                    ) CM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            AND     IM.SALES_CAT03 = CM.CD
                            GROUP   BY IM.SALES_CAT03, CM.CD_NAME   
                            ORDER   BY IM.SALES_CAT03                          
                            ) ID,
                            (
                            SELECT  '계획' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '실적' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '차이' AS GUBN
                            FROM    DUAL
                            ) GB
                    ) IL,
                    (            
                    /*
                        계획량
                    */
                    SELECT  ID.SALES_CAT03, '계획' GUBN,
                            SUM(ID.ANY_QTY)     AS ANY_QTY,
                            SUM(ID.ANS_QTY)     AS ANS_QTY,
                            SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                            SUM(ID.ASA_QTY)     AS ASA_QTY,
                            SUM(ID.KUM_QTY)     AS KUM_QTY,
                            SUM(ID.PUS_QTY)     AS PUS_QTY,
                            SUM(ID.NOK_QTY)     AS NOK_QTY,
                            SUM(ID.TOT)         AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.SALES_CAT03,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANY_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANSB_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ASA_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS KUM_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS PUS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    TOT
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID                            
                            GROUP   BY ID.ITEM_ID, IM.SALES_CAT03
                            ) ID
                    GROUP   BY ID.SALES_CAT03
                    UNION   ALL
                    /*
                        실적량
                    */
                    SELECT  ID.SALES_CAT03, '실적' GUBN, 
                            NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                            NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                            NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                            NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                            NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                            NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                            NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                            NVL(EP.TOT,0)       AS TOT 
                    FROM    (
                            /*
                                ITEM LIST
                            */
                            SELECT  IM.SALES_CAT03, CM.CD_NAME        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM,
                                    (
                                    SELECT  CD, CD_NAME
                                    FROM    CODE_MST
                                    WHERE   CD_GRP = 'SALES_CAT3'
                                    ) CM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            AND     IM.SALES_CAT03 = CM.CD
                            GROUP   BY IM.SALES_CAT03, CM.CD_NAME   
                            ORDER   BY IM.SALES_CAT03
                            ) ID,
                            (
                            SELECT  EP.SALES_CAT03, '실적' GUBN,
                                    SUM(EP.ANY_QTY)     AS ANY_QTY,
                                    SUM(EP.ANS_QTY)     AS ANS_QTY,
                                    SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                                    SUM(EP.ASA_QTY)     AS ASA_QTY,
                                    SUM(EP.KUM_QTY)     AS KUM_QTY,
                                    SUM(EP.PUS_QTY)     AS PUS_QTY,
                                    SUM(EP.NOK_QTY)     AS NOK_QTY,
                                    SUM(EP.TOT)         AS TOT
                            FROM    (
                                    SELECT  EP.ITEM_ID, IM.SALES_CAT03,
                                            SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANY_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANS_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANSB_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ASA_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS KUM_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS PUS_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS NOK_QTY,
                                        ---------------------------------------------------------------
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    TOT
                                    FROM    V_ERP_PO_MES EP,
                                            ITEM_MST IM
                                    WHERE   /*EP.STATUS = 'DLV'
                                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                    AND     EP.ITEM_ID = IM.ITEM_ID
                                    AND     IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    GROUP   BY EP.ITEM_ID, IM.SALES_CAT03
                                    ) EP
                            GROUP   BY EP.SALES_CAT03
                            ) EP
                    WHERE   ID.SALES_CAT03 = EP.SALES_CAT03(+)
                    UNION   ALL
                    /*
                        차이 : 실적량 - 계획량
                    */
                    SELECT  PL.SALES_CAT03, '차이' GUBN,
                            OL.ANY_QTY - PL.ANY_QTY     AS ANY_QTY,
                            OL.ANS_QTY - PL.ANS_QTY     AS ANS_QTY,
                            OL.ANSB_QTY - PL.ANSB_QTY   AS ANSB_QTY,
                            OL.ASA_QTY - PL.ASA_QTY     AS ASA_QTY,
                            OL.KUM_QTY - PL.KUM_QTY     AS KUM_QTY,
                            OL.PUS_QTY - PL.PUS_QTY     AS PUS_QTY,
                            OL.NOK_QTY - PL.NOK_QTY     AS NOK_QTY,
                            OL.TOT - PL.TOT             AS TOT
                    FROM    (
                            /* 계획량 */
                            SELECT  ID.SALES_CAT03, '계획' GUBN,
                                    SUM(ID.ANY_QTY)     AS ANY_QTY,
                                    SUM(ID.ANS_QTY)     AS ANS_QTY,
                                    SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                                    SUM(ID.ASA_QTY)     AS ASA_QTY,
                                    SUM(ID.KUM_QTY)     AS KUM_QTY,
                                    SUM(ID.PUS_QTY)     AS PUS_QTY,
                                    SUM(ID.NOK_QTY)     AS NOK_QTY,
                                    SUM(ID.TOT)         AS TOT
                            FROM    (
                                    SELECT  ID.ITEM_ID, IM.SALES_CAT03,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANY_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANS_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANSB_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ASA_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS KUM_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS PUS_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS NOK_QTY,
                                            ---------------------------------------------------------------
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    TOT
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end
		                                    ) IM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    GROUP   BY ID.ITEM_ID, IM.SALES_CAT03
                                    ) ID
                            GROUP   BY ID.SALES_CAT03
                            ) PL,
                            (
                            /* 실적량 */
                            SELECT  ID.SALES_CAT03, '실적' GUBN, 
                                    NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                                    NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                                    NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                                    NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                                    NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                                    NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                                    NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                                    NVL(EP.TOT,0)       AS TOT 
                            FROM    (
                                    /*
                                        ITEM LIST
                                    */
                                    SELECT  IM.SALES_CAT03, CM.CD_NAME        
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end 
		                                    ) IM,
                                            (
                                            SELECT  CD, CD_NAME
                                            FROM    CODE_MST
                                            WHERE   CD_GRP = 'SALES_CAT3'
                                            ) CM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    AND     IM.SALES_CAT03 = CM.CD
                                    GROUP   BY IM.SALES_CAT03, CM.CD_NAME   
                                    ORDER   BY IM.SALES_CAT03
                                    ) ID,
                                    (
                                    SELECT  EP.SALES_CAT03, '실적' GUBN,
                                            SUM(EP.ANY_QTY)     AS ANY_QTY,
                                            SUM(EP.ANS_QTY)     AS ANS_QTY,
                                            SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                                            SUM(EP.ASA_QTY)     AS ASA_QTY,
                                            SUM(EP.KUM_QTY)     AS KUM_QTY,
                                            SUM(EP.PUS_QTY)     AS PUS_QTY,
                                            SUM(EP.NOK_QTY)     AS NOK_QTY,
                                            SUM(EP.TOT)         AS TOT
                                    FROM    (
                                            SELECT  EP.ITEM_ID, IM.SALES_CAT03,
                                                    SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANY_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANS_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANSB_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ASA_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS KUM_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS PUS_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS NOK_QTY,
                                                ---------------------------------------------------------------
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    TOT
                                            FROM    V_ERP_PO_MES EP,
                                                    ITEM_MST IM
                                            WHERE   /*EP.STATUS = 'DLV'
                                            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                            AND     EP.ITEM_ID = IM.ITEM_ID
                                            AND     IM.ITYPE = 'FERT'
                                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
		                                #if("$!{selected_ord}" == "DO")
				                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
				                        #elseif("$!{selected_ord}" == "EX")
				                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
				                        #end
                                            GROUP   BY EP.ITEM_ID, IM.SALES_CAT03
                                            ) EP
                                    GROUP   BY EP.SALES_CAT03
                                    ) EP
                            WHERE   ID.SALES_CAT03 = EP.SALES_CAT03(+)
                            ) OL
                    WHERE   PL.SALES_CAT03 = OL.SALES_CAT03
                    ) PL
            WHERE   IL.SALES_CAT03 = PL.SALES_CAT03(+)
            AND     IL.GUBN = PL.GUBN(+)  
            UNION   ALL
            /*
                계획량 합계
            */
            SELECT  '','합계', '계획' GUBN,
                    TO_CHAR(SUM(ID.ANY_QTY),'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(SUM(ID.ANS_QTY),'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(SUM(ID.ANSB_QTY),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM(ID.ASA_QTY),'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(SUM(ID.KUM_QTY),'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(SUM(ID.PUS_QTY),'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(SUM(ID.NOK_QTY),'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(SUM(ID.TOT),'FM999,999,999')         AS TOT
            FROM    (
                    SELECT  ID.ITEM_ID, IM.SALES_CAT03,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    GROUP   BY ID.ITEM_ID, IM.SALES_CAT03
                    ) ID
            UNION   ALL
            /*
                실적량 합계
            */
            SELECT  '','합계', '실적' GUBN,
                    TO_CHAR(SUM(EP.ANY_QTY),'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(SUM(EP.ANS_QTY),'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(SUM(EP.ANSB_QTY),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM(EP.ASA_QTY),'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(SUM(EP.KUM_QTY),'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(SUM(EP.PUS_QTY),'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(SUM(EP.NOK_QTY),'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(SUM(EP.TOT),'FM999,999,999')         AS TOT
            FROM    (
                    SELECT  EP.ITEM_ID, IM.SALES_CAT03,
                            SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANY_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANS_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANSB_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ASA_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS KUM_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS PUS_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS NOK_QTY,
                        ---------------------------------------------------------------
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    TOT
                    FROM    V_ERP_PO_MES EP,
                            ITEM_MST IM
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     EP.ITEM_ID = IM.ITEM_ID
                    AND     IM.ITYPE = 'FERT'
                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                #if("$!{selected_ord}" == "DO")
                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
                #elseif("$!{selected_ord}" == "EX")
                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
                #end
                    GROUP   BY EP.ITEM_ID, IM.SALES_CAT03
                    ) EP
            UNION   ALL
            /*
                차이 합계
            */
            SELECT  '','합계', '차이' GUBN,
                    TO_CHAR(OL.ANY_QTY - PL.ANY_QTY,'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(OL.ANS_QTY - PL.ANS_QTY,'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(OL.ANSB_QTY - PL.ANSB_QTY,'FM999,999,999')   AS ANSB_QTY,
                    TO_CHAR(OL.ASA_QTY - PL.ASA_QTY,'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(OL.KUM_QTY - PL.KUM_QTY,'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(OL.PUS_QTY - PL.PUS_QTY,'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(OL.NOK_QTY - PL.NOK_QTY,'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(OL.TOT - PL.TOT,'FM999,999,999')             AS TOT
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '', '계획' GUBN,
                            SUM(ID.ANY_QTY)     AS ANY_QTY,
                            SUM(ID.ANS_QTY)     AS ANS_QTY,
                            SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                            SUM(ID.ASA_QTY)     AS ASA_QTY,
                            SUM(ID.KUM_QTY)     AS KUM_QTY,
                            SUM(ID.PUS_QTY)     AS PUS_QTY,
                            SUM(ID.NOK_QTY)     AS NOK_QTY,
                            SUM(ID.TOT)         AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.SALES_CAT03,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANY_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANSB_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ASA_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS KUM_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS PUS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    TOT
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT03
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.SALES_CAT03
                            ) ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM(EP.ANY_QTY)     AS ANY_QTY,
                            SUM(EP.ANS_QTY)     AS ANS_QTY,
                            SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                            SUM(EP.ASA_QTY)     AS ASA_QTY,
                            SUM(EP.KUM_QTY)     AS KUM_QTY,
                            SUM(EP.PUS_QTY)     AS PUS_QTY,
                            SUM(EP.NOK_QTY)     AS NOK_QTY,
                            SUM(EP.TOT)         AS TOT
                    FROM    (
                            SELECT  EP.ITEM_ID, IM.SALES_CAT03,
                                    SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANY_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANS_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANSB_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ASA_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS KUM_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS PUS_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS NOK_QTY,
                                ---------------------------------------------------------------
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    TOT
                            FROM    V_ERP_PO_MES EP,
                                    ITEM_MST IM
                            WHERE   /*EP.STATUS = 'DLV'
                            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                            AND     EP.ITEM_ID = IM.ITEM_ID
                            AND     IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
                        #elseif("$!{selected_ord}" == "EX")
                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
                        #end
                            GROUP   BY EP.ITEM_ID, IM.SALES_CAT03
                            ) EP
                    ) OL
            UNION	ALL
            /*
                달성률 : 실적 합계 / 계획 합계 * 100
            */
            SELECT  '','달성률(%)','',
                    TO_CHAR(ROUND(OL.ANY_QTY / DECODE(PL.ANY_QTY,0,1,PL.ANY_QTY)  *100,2),'FM999990.00')   AS ANY_RATE,
                    TO_CHAR(ROUND(OL.ANS_QTY / DECODE(PL.ANS_QTY,0,1,PL.ANS_QTY)  *100,2),'FM999990.00')   AS ANS_RATE,
                    TO_CHAR(ROUND(OL.ANSB_QTY/ DECODE(PL.ANSB_QTY,0,1,PL.ANSB_QTY)*100,2),'FM999990.00')   AS ANSB_RATE,
                    TO_CHAR(ROUND(OL.ASA_QTY / DECODE(PL.ASA_QTY,0,1,PL.ASA_QTY)  *100,2),'FM999990.00')   AS ASA_RATE,
                    TO_CHAR(ROUND(OL.KUM_QTY / DECODE(PL.KUM_QTY,0,1,PL.KUM_QTY)  *100,2),'FM999990.00')   AS KUM_RATE,
                    TO_CHAR(ROUND(OL.PUS_QTY / DECODE(PL.PUS_QTY,0,1,PL.PUS_QTY)  *100,2),'FM999990.00')   AS PUS_RATE,
                    TO_CHAR(ROUND(OL.NOK_QTY / DECODE(PL.NOK_QTY,0,1,PL.NOK_QTY)  *100,2),'FM999990.00')   AS NOK_RATE,
                    TO_CHAR(ROUND(OL.TOT     / DECODE(PL.TOT,0,1,PL.TOT)          *100,2),'FM999990.00')   AS TOT_RATE
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '','합계', '계획' GUBN,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_ERP_PO_MES EP,
                            (
                            /*
                                ITEM LIST
                            */
                            SELECT  ID.ITEM_ID, IM.QTY        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.QTY        
                            ) ID
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     ID.ITEM_ID = EP.ITEM_ID
                    ) OL
            ORDER   BY 1, 3
        #elseif("$!{selected_type}" == "3")
            SELECT  IL.SALES_CAT01, IL.CD_NAME, IL.GUBN, 
                    /*
                        0 : NULL(화면에서 빈칸으로 보이도록 하기위해서)
                        식 : ITEM_MST.QTY를 곱해준다.
                        BOX : 변경없음
                    */
                    CASE
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANY_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANY_QTY,'0',NULL,TO_CHAR(PL.ANY_QTY,'FM999,999,999'))
                    END     ANY_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANS_QTY,'0',NULL,TO_CHAR(PL.ANS_QTY,'FM999,999,999'))
                    END     ANS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANSB_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANSB_QTY,'0',NULL,TO_CHAR(PL.ANSB_QTY,'FM999,999,999'))
                    END     ANSB_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ASA_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ASA_QTY,'0',NULL,TO_CHAR(PL.ASA_QTY,'FM999,999,999'))
                    END     ASA_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.KUM_QTY,'FM999,999,999')
                    ELSE DECODE(PL.KUM_QTY,'0',NULL,TO_CHAR(PL.KUM_QTY,'FM999,999,999'))
                    END     KUM_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.PUS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.PUS_QTY,'0',NULL,TO_CHAR(PL.PUS_QTY,'FM999,999,999'))
                    END     PUS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.NOK_QTY,'FM999,999,999')
                    ELSE DECODE(PL.NOK_QTY,'0',NULL,TO_CHAR(PL.NOK_QTY,'FM999,999,999')) 
                    END     NOK_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.TOT,'FM999,999,999')
                    ELSE DECODE(PL.TOT,'0',NULL,TO_CHAR(PL.TOT,'FM999,999,999'))  
                    END     TOT
            FROM    (
                    /*
                        ITEM_MST.SALES_CAT01(중분류) 리스트
                    */
                    SELECT  ID.SALES_CAT01, ID.CD_NAME, GB.GUBN
                    FROM    (                    
                            SELECT  IM.SALES_CAT01, CM.CD_NAME        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM,
                                    (
                                    SELECT  CD, CD_NAME
                                    FROM    CODE_MST
                                    WHERE   CD_GRP = 'SALES_CAT1'
                                    ) CM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            AND     IM.SALES_CAT01 = CM.CD
                            GROUP   BY IM.SALES_CAT01, CM.CD_NAME   
                            ORDER   BY IM.SALES_CAT01                          
                            ) ID,
                            (
                            SELECT  '계획' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '실적' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '차이' AS GUBN
                            FROM    DUAL
                            ) GB
                    ) IL,
                    (            
                    /*
                        계획량
                    */
                    SELECT  ID.SALES_CAT01, '계획' GUBN,
                            SUM(ID.ANY_QTY)     AS ANY_QTY,
                            SUM(ID.ANS_QTY)     AS ANS_QTY,
                            SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                            SUM(ID.ASA_QTY)     AS ASA_QTY,
                            SUM(ID.KUM_QTY)     AS KUM_QTY,
                            SUM(ID.PUS_QTY)     AS PUS_QTY,
                            SUM(ID.NOK_QTY)     AS NOK_QTY,
                            SUM(ID.TOT)         AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.SALES_CAT01,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANY_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANSB_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ASA_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS KUM_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS PUS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    TOT
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.SALES_CAT01
                            ) ID
                    GROUP   BY ID.SALES_CAT01
                    UNION   ALL
                    /*
                        실적량
                    */
                    SELECT  ID.SALES_CAT01, '실적' GUBN, 
                            NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                            NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                            NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                            NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                            NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                            NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                            NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                            NVL(EP.TOT,0)       AS TOT 
                    FROM    (
                            /*
                                ITEM LIST
                            */
                            SELECT  IM.SALES_CAT01, CM.CD_NAME        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM,
                                    (
                                    SELECT  CD, CD_NAME
                                    FROM    CODE_MST
                                    WHERE   CD_GRP = 'SALES_CAT3'
                                    ) CM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            AND     IM.SALES_CAT01 = CM.CD
                            GROUP   BY IM.SALES_CAT01, CM.CD_NAME   
                            ORDER   BY IM.SALES_CAT01
                            ) ID,
                            (
                            SELECT  EP.SALES_CAT01, '실적' GUBN,
                                    SUM(EP.ANY_QTY)     AS ANY_QTY,
                                    SUM(EP.ANS_QTY)     AS ANS_QTY,
                                    SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                                    SUM(EP.ASA_QTY)     AS ASA_QTY,
                                    SUM(EP.KUM_QTY)     AS KUM_QTY,
                                    SUM(EP.PUS_QTY)     AS PUS_QTY,
                                    SUM(EP.NOK_QTY)     AS NOK_QTY,
                                    SUM(EP.TOT)         AS TOT
                            FROM    (
                                    SELECT  EP.ITEM_ID, IM.SALES_CAT01,
                                            SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANY_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANS_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANSB_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ASA_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS KUM_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS PUS_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS NOK_QTY,
                                        ---------------------------------------------------------------
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    TOT
                                    FROM    V_ERP_PO_MES EP,
                                            ITEM_MST IM
                                    WHERE   /*EP.STATUS = 'DLV'
                                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                    AND     EP.ITEM_ID = IM.ITEM_ID
                                    AND     IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    GROUP   BY EP.ITEM_ID, IM.SALES_CAT01
                                    ) EP
                            GROUP   BY EP.SALES_CAT01
                            ) EP
                    WHERE   ID.SALES_CAT01 = EP.SALES_CAT01(+)
                    UNION   ALL
                    /*
                        차이 : 실적량 - 계획량
                    */
                    SELECT  PL.SALES_CAT01, '차이' GUBN,
                            OL.ANY_QTY - PL.ANY_QTY     AS ANY_QTY,
                            OL.ANS_QTY - PL.ANS_QTY     AS ANS_QTY,
                            OL.ANSB_QTY - PL.ANSB_QTY   AS ANSB_QTY,
                            OL.ASA_QTY - PL.ASA_QTY     AS ASA_QTY,
                            OL.KUM_QTY - PL.KUM_QTY     AS KUM_QTY,
                            OL.PUS_QTY - PL.PUS_QTY     AS PUS_QTY,
                            OL.NOK_QTY - PL.NOK_QTY     AS NOK_QTY,
                            OL.TOT - PL.TOT             AS TOT
                    FROM    (
                            /* 계획량 */
                            SELECT  ID.SALES_CAT01, '계획' GUBN,
                                    SUM(ID.ANY_QTY)     AS ANY_QTY,
                                    SUM(ID.ANS_QTY)     AS ANS_QTY,
                                    SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                                    SUM(ID.ASA_QTY)     AS ASA_QTY,
                                    SUM(ID.KUM_QTY)     AS KUM_QTY,
                                    SUM(ID.PUS_QTY)     AS PUS_QTY,
                                    SUM(ID.NOK_QTY)     AS NOK_QTY,
                                    SUM(ID.TOT)         AS TOT
                            FROM    (
                                    SELECT  ID.ITEM_ID, IM.SALES_CAT01,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANY_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANS_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANSB_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ASA_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS KUM_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS PUS_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS NOK_QTY,
                                            ---------------------------------------------------------------
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    TOT
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end
		                                    ) IM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    GROUP   BY ID.ITEM_ID, IM.SALES_CAT01
                                    ) ID
                            GROUP   BY ID.SALES_CAT01
                            ) PL,
                            (
                            /* 실적량 */
                            SELECT  ID.SALES_CAT01, '실적' GUBN, 
                                    NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                                    NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                                    NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                                    NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                                    NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                                    NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                                    NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                                    NVL(EP.TOT,0)       AS TOT 
                            FROM    (
                                    /*
                                        ITEM LIST
                                    */
                                    SELECT  IM.SALES_CAT01, CM.CD_NAME        
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end
		                                    ) IM,
                                            (
                                            SELECT  CD, CD_NAME
                                            FROM    CODE_MST
                                            WHERE   CD_GRP = 'SALES_CAT3'
                                            ) CM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    AND     IM.SALES_CAT01 = CM.CD
                                    GROUP   BY IM.SALES_CAT01, CM.CD_NAME   
                                    ORDER   BY IM.SALES_CAT01
                                    ) ID,
                                    (
                                    SELECT  EP.SALES_CAT01, '실적' GUBN,
                                            SUM(EP.ANY_QTY)     AS ANY_QTY,
                                            SUM(EP.ANS_QTY)     AS ANS_QTY,
                                            SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                                            SUM(EP.ASA_QTY)     AS ASA_QTY,
                                            SUM(EP.KUM_QTY)     AS KUM_QTY,
                                            SUM(EP.PUS_QTY)     AS PUS_QTY,
                                            SUM(EP.NOK_QTY)     AS NOK_QTY,
                                            SUM(EP.TOT)         AS TOT
                                    FROM    (
                                            SELECT  EP.ITEM_ID, IM.SALES_CAT01,
                                                    SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANY_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANS_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANSB_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ASA_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS KUM_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS PUS_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS NOK_QTY,
                                                ---------------------------------------------------------------
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    TOT
                                            FROM    V_ERP_PO_MES EP,
                                                    ITEM_MST IM
                                            WHERE   /*EP.STATUS = 'DLV'
                                            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                            AND     EP.ITEM_ID = IM.ITEM_ID
                                            AND     IM.ITYPE = 'FERT'
                                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
		                                #if("$!{selected_ord}" == "DO")
				                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
				                        #elseif("$!{selected_ord}" == "EX")
				                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
				                        #end
		                        			GROUP   BY EP.ITEM_ID, IM.SALES_CAT01
                                            ) EP
                                    GROUP   BY EP.SALES_CAT01
                                    ) EP
                            WHERE   ID.SALES_CAT01 = EP.SALES_CAT01(+)
                            ) OL
                    WHERE   PL.SALES_CAT01 = OL.SALES_CAT01
                    ) PL
            WHERE   IL.SALES_CAT01 = PL.SALES_CAT01(+)
            AND     IL.GUBN = PL.GUBN(+)  
            UNION   ALL
            /*
                계획량 합계
            */
            SELECT  '','합계', '계획' GUBN,
                    TO_CHAR(SUM(ID.ANY_QTY),'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(SUM(ID.ANS_QTY),'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(SUM(ID.ANSB_QTY),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM(ID.ASA_QTY),'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(SUM(ID.KUM_QTY),'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(SUM(ID.PUS_QTY),'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(SUM(ID.NOK_QTY),'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(SUM(ID.TOT),'FM999,999,999')         AS TOT
            FROM    (
                    SELECT  ID.ITEM_ID, IM.SALES_CAT01,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    GROUP   BY ID.ITEM_ID, IM.SALES_CAT01
                    ) ID
            UNION   ALL
            /*
                실적량 합계
            */
            SELECT  '','합계', '실적' GUBN,
                    TO_CHAR(SUM(EP.ANY_QTY),'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(SUM(EP.ANS_QTY),'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(SUM(EP.ANSB_QTY),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM(EP.ASA_QTY),'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(SUM(EP.KUM_QTY),'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(SUM(EP.PUS_QTY),'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(SUM(EP.NOK_QTY),'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(SUM(EP.TOT),'FM999,999,999')         AS TOT
            FROM    (
                    SELECT  EP.ITEM_ID, IM.SALES_CAT01,
                            SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANY_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANS_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANSB_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ASA_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS KUM_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS PUS_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS NOK_QTY,
                        ---------------------------------------------------------------
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    TOT
                    FROM    V_ERP_PO_MES EP,
                            ITEM_MST IM
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     EP.ITEM_ID = IM.ITEM_ID
                    AND     IM.ITYPE = 'FERT'
                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                #if("$!{selected_ord}" == "DO")
                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
                #elseif("$!{selected_ord}" == "EX")
                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
                #end
                    GROUP   BY EP.ITEM_ID, IM.SALES_CAT01
                    ) EP
            UNION   ALL
            /*
                차이 합계
            */
            SELECT  '','합계', '차이' GUBN,
                    TO_CHAR(OL.ANY_QTY - PL.ANY_QTY,'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(OL.ANS_QTY - PL.ANS_QTY,'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(OL.ANSB_QTY - PL.ANSB_QTY,'FM999,999,999')   AS ANSB_QTY,
                    TO_CHAR(OL.ASA_QTY - PL.ASA_QTY,'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(OL.KUM_QTY - PL.KUM_QTY,'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(OL.PUS_QTY - PL.PUS_QTY,'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(OL.NOK_QTY - PL.NOK_QTY,'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(OL.TOT - PL.TOT,'FM999,999,999')             AS TOT
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '', '계획' GUBN,
                            SUM(ID.ANY_QTY)     AS ANY_QTY,
                            SUM(ID.ANS_QTY)     AS ANS_QTY,
                            SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                            SUM(ID.ASA_QTY)     AS ASA_QTY,
                            SUM(ID.KUM_QTY)     AS KUM_QTY,
                            SUM(ID.PUS_QTY)     AS PUS_QTY,
                            SUM(ID.NOK_QTY)     AS NOK_QTY,
                            SUM(ID.TOT)         AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.SALES_CAT01,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANY_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANSB_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ASA_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS KUM_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS PUS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    TOT
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.SALES_CAT01
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.SALES_CAT01
                            ) ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM(EP.ANY_QTY)     AS ANY_QTY,
                            SUM(EP.ANS_QTY)     AS ANS_QTY,
                            SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                            SUM(EP.ASA_QTY)     AS ASA_QTY,
                            SUM(EP.KUM_QTY)     AS KUM_QTY,
                            SUM(EP.PUS_QTY)     AS PUS_QTY,
                            SUM(EP.NOK_QTY)     AS NOK_QTY,
                            SUM(EP.TOT)         AS TOT
                    FROM    (
                            SELECT  EP.ITEM_ID, IM.SALES_CAT01,
                                    SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANY_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANS_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANSB_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ASA_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS KUM_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS PUS_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS NOK_QTY,
                                ---------------------------------------------------------------
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    TOT
                            FROM    V_ERP_PO_MES EP,
                                    ITEM_MST IM
                            WHERE   /*EP.STATUS = 'DLV'
                            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                            AND     EP.ITEM_ID = IM.ITEM_ID
                            AND     IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
                        #elseif("$!{selected_ord}" == "EX")
                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
                        #end
                			GROUP   BY EP.ITEM_ID, IM.SALES_CAT01
                            ) EP
                    ) OL
            UNION	ALL
            /*
                달성률 : 실적 합계 / 계획 합계 * 100
            */
            SELECT  '','달성률(%)','',
                    TO_CHAR(ROUND(OL.ANY_QTY / DECODE(PL.ANY_QTY,0,1,PL.ANY_QTY)  *100,2),'FM999990.00')   AS ANY_RATE,
                    TO_CHAR(ROUND(OL.ANS_QTY / DECODE(PL.ANS_QTY,0,1,PL.ANS_QTY)  *100,2),'FM999990.00')   AS ANS_RATE,
                    TO_CHAR(ROUND(OL.ANSB_QTY/ DECODE(PL.ANSB_QTY,0,1,PL.ANSB_QTY)*100,2),'FM999990.00')   AS ANSB_RATE,
                    TO_CHAR(ROUND(OL.ASA_QTY / DECODE(PL.ASA_QTY,0,1,PL.ASA_QTY)  *100,2),'FM999990.00')   AS ASA_RATE,
                    TO_CHAR(ROUND(OL.KUM_QTY / DECODE(PL.KUM_QTY,0,1,PL.KUM_QTY)  *100,2),'FM999990.00')   AS KUM_RATE,
                    TO_CHAR(ROUND(OL.PUS_QTY / DECODE(PL.PUS_QTY,0,1,PL.PUS_QTY)  *100,2),'FM999990.00')   AS PUS_RATE,
                    TO_CHAR(ROUND(OL.NOK_QTY / DECODE(PL.NOK_QTY,0,1,PL.NOK_QTY)  *100,2),'FM999990.00')   AS NOK_RATE,
                    TO_CHAR(ROUND(OL.TOT     / DECODE(PL.TOT,0,1,PL.TOT)          *100,2),'FM999990.00')   AS TOT_RATE
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '','합계', '계획' GUBN,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_ERP_PO_MES EP,
                            (
                            /*
                                ITEM LIST
                            */
                            SELECT  ID.ITEM_ID, IM.QTY        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.QTY        
                            ) ID
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     ID.ITEM_ID = EP.ITEM_ID
                    ) OL
            ORDER   BY 1, 3
        #elseif("$!{selected_type}" == "4")
            SELECT  IL.CAT06, IL.CD_NAME, IL.GUBN, 
                    /*
                        0 : NULL(화면에서 빈칸으로 보이도록 하기위해서)
                        식 : ITEM_MST.QTY를 곱해준다.
                        BOX : 변경없음
                    */
                    CASE
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANY_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANY_QTY,'0',NULL,TO_CHAR(PL.ANY_QTY,'FM999,999,999'))
                    END     ANY_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANS_QTY,'0',NULL,TO_CHAR(PL.ANS_QTY,'FM999,999,999'))
                    END     ANS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANSB_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANSB_QTY,'0',NULL,TO_CHAR(PL.ANSB_QTY,'FM999,999,999'))
                    END     ANSB_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ASA_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ASA_QTY,'0',NULL,TO_CHAR(PL.ASA_QTY,'FM999,999,999'))
                    END     ASA_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.KUM_QTY,'FM999,999,999')
                    ELSE DECODE(PL.KUM_QTY,'0',NULL,TO_CHAR(PL.KUM_QTY,'FM999,999,999'))
                    END     KUM_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.PUS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.PUS_QTY,'0',NULL,TO_CHAR(PL.PUS_QTY,'FM999,999,999'))
                    END     PUS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.NOK_QTY,'FM999,999,999')
                    ELSE DECODE(PL.NOK_QTY,'0',NULL,TO_CHAR(PL.NOK_QTY,'FM999,999,999')) 
                    END     NOK_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.TOT,'FM999,999,999')
                    ELSE DECODE(PL.TOT,'0',NULL,TO_CHAR(PL.TOT,'FM999,999,999'))  
                    END     TOT
            FROM    (
                    /*
                        ITEM_MST.CAT06 공장할당 기준정보(SCM생산분류)
                    */
                    SELECT  ID.CAT06, ID.CD_NAME, GB.GUBN
                    FROM    (                    
                            SELECT  IM.CAT06, CM.CD_NAME        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM,
                                    (
                                    SELECT  CD, CD_NAME
                                    FROM    CODE_MST
                                    WHERE   CD_GRP = 'CAT06'
                                    ) CM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            AND     IM.CAT06 = CM.CD
                            GROUP   BY IM.CAT06, CM.CD_NAME   
                            ORDER   BY IM.CAT06                          
                            ) ID,
                            (
                            SELECT  '계획' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '실적' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '차이' AS GUBN
                            FROM    DUAL
                            ) GB
                    ) IL,
                    (            
                    /*
                        계획량
                    */
                    SELECT  ID.CAT06, '계획' GUBN,
                            SUM(ID.ANY_QTY)     AS ANY_QTY,
                            SUM(ID.ANS_QTY)     AS ANS_QTY,
                            SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                            SUM(ID.ASA_QTY)     AS ASA_QTY,
                            SUM(ID.KUM_QTY)     AS KUM_QTY,
                            SUM(ID.PUS_QTY)     AS PUS_QTY,
                            SUM(ID.NOK_QTY)     AS NOK_QTY,
                            SUM(ID.TOT)         AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.CAT06,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANY_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANSB_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ASA_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS KUM_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS PUS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    TOT
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.CAT06
                            ) ID
                    GROUP   BY ID.CAT06
                    UNION   ALL
                    /*
                        실적량
                    */
                    SELECT  ID.CAT06, '실적' GUBN, 
                            NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                            NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                            NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                            NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                            NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                            NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                            NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                            NVL(EP.TOT,0)       AS TOT 
                    FROM    (
                            /*
                                ITEM LIST
                            */
                            SELECT  IM.CAT06, CM.CD_NAME        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM,
                                    (
                                    SELECT  CD, CD_NAME
                                    FROM    CODE_MST
                                    WHERE   CD_GRP = 'CAT06'
                                    ) CM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            AND     IM.CAT06 = CM.CD
                            GROUP   BY IM.CAT06, CM.CD_NAME   
                            ORDER   BY IM.CAT06
                            ) ID,
                            (
                            SELECT  EP.CAT06, '실적' GUBN,
                                    SUM(EP.ANY_QTY)     AS ANY_QTY,
                                    SUM(EP.ANS_QTY)     AS ANS_QTY,
                                    SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                                    SUM(EP.ASA_QTY)     AS ASA_QTY,
                                    SUM(EP.KUM_QTY)     AS KUM_QTY,
                                    SUM(EP.PUS_QTY)     AS PUS_QTY,
                                    SUM(EP.NOK_QTY)     AS NOK_QTY,
                                    SUM(EP.TOT)         AS TOT
                            FROM    (
                                    SELECT  EP.ITEM_ID, IM.CAT06,
                                            SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANY_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANS_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ANSB_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS ASA_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS KUM_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS PUS_QTY,
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    AS NOK_QTY,
                                        ---------------------------------------------------------------
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           ) +
                                        SUM( 
                                            CASE 
                                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                            ELSE 0 
                                            END
                                           )    TOT
                                    FROM    V_ERP_PO_MES EP,
                                            ITEM_MST IM
                                    WHERE   /*EP.STATUS = 'DLV'
                                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                    AND     EP.ITEM_ID = IM.ITEM_ID
                                    AND     IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                        			GROUP   BY EP.ITEM_ID, IM.CAT06
                                    ) EP
                            GROUP   BY EP.CAT06
                            ) EP
                    WHERE   ID.CAT06 = EP.CAT06(+)
                    UNION   ALL
                    /*
                        차이 : 실적량 - 계획량
                    */
                    SELECT  PL.CAT06, '차이' GUBN,
                            OL.ANY_QTY - PL.ANY_QTY     AS ANY_QTY,
                            OL.ANS_QTY - PL.ANS_QTY     AS ANS_QTY,
                            OL.ANSB_QTY - PL.ANSB_QTY   AS ANSB_QTY,
                            OL.ASA_QTY - PL.ASA_QTY     AS ASA_QTY,
                            OL.KUM_QTY - PL.KUM_QTY     AS KUM_QTY,
                            OL.PUS_QTY - PL.PUS_QTY     AS PUS_QTY,
                            OL.NOK_QTY - PL.NOK_QTY     AS NOK_QTY,
                            OL.TOT - PL.TOT             AS TOT
                    FROM    (
                            /* 계획량 */
                            SELECT  ID.CAT06, '계획' GUBN,
                                    SUM(ID.ANY_QTY)     AS ANY_QTY,
                                    SUM(ID.ANS_QTY)     AS ANS_QTY,
                                    SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                                    SUM(ID.ASA_QTY)     AS ASA_QTY,
                                    SUM(ID.KUM_QTY)     AS KUM_QTY,
                                    SUM(ID.PUS_QTY)     AS PUS_QTY,
                                    SUM(ID.NOK_QTY)     AS NOK_QTY,
                                    SUM(ID.TOT)         AS TOT
                            FROM    (
                                    SELECT  ID.ITEM_ID, IM.CAT06,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANY_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANS_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ANSB_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS ASA_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS KUM_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS PUS_QTY,
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    AS NOK_QTY,
                                            ---------------------------------------------------------------
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               ) +
                                            SUM( 
                                                CASE 
                                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                                ELSE 0 
                                                END
                                               )    TOT
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end
		                                    ) IM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    GROUP   BY ID.ITEM_ID, IM.CAT06
                                    ) ID
                            GROUP   BY ID.CAT06
                            ) PL,
                            (
                            /* 실적량 */
                            SELECT  ID.CAT06, '실적' GUBN, 
                                    NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                                    NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                                    NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                                    NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                                    NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                                    NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                                    NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                                    NVL(EP.TOT,0)       AS TOT 
                            FROM    (
                                    /*
                                        ITEM LIST
                                    */
                                    SELECT  IM.CAT06, CM.CD_NAME        
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end
		                                    ) IM,
                                            (
                                            SELECT  CD, CD_NAME
                                            FROM    CODE_MST
                                            WHERE   CD_GRP = 'CAT06'
                                            ) CM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    AND     IM.CAT06 = CM.CD
                                    GROUP   BY IM.CAT06, CM.CD_NAME   
                                    ORDER   BY IM.CAT06
                                    ) ID,
                                    (
                                    SELECT  EP.CAT06, '실적' GUBN,
                                            SUM(EP.ANY_QTY)     AS ANY_QTY,
                                            SUM(EP.ANS_QTY)     AS ANS_QTY,
                                            SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                                            SUM(EP.ASA_QTY)     AS ASA_QTY,
                                            SUM(EP.KUM_QTY)     AS KUM_QTY,
                                            SUM(EP.PUS_QTY)     AS PUS_QTY,
                                            SUM(EP.NOK_QTY)     AS NOK_QTY,
                                            SUM(EP.TOT)         AS TOT
                                    FROM    (
                                            SELECT  EP.ITEM_ID, IM.CAT06,
                                                    SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANY_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANS_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ANSB_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS ASA_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS KUM_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS PUS_QTY,
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    AS NOK_QTY,
                                                ---------------------------------------------------------------
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   ) +
                                                SUM( 
                                                    CASE 
                                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                                    ELSE 0 
                                                    END
                                                   )    TOT
                                            FROM    V_ERP_PO_MES EP,
                                                    ITEM_MST IM
                                            WHERE   /*EP.STATUS = 'DLV'
                                            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                            AND     EP.ITEM_ID = IM.ITEM_ID
                                            AND     IM.ITYPE = 'FERT'
                                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
		                                #if("$!{selected_ord}" == "DO")
				                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
				                        #elseif("$!{selected_ord}" == "EX")
				                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
				                        #end
                                            GROUP   BY EP.ITEM_ID, IM.CAT06
                                            ) EP
                                    GROUP   BY EP.CAT06
                                    ) EP
                            WHERE   ID.CAT06 = EP.CAT06(+)
                            ) OL
                    WHERE   PL.CAT06 = OL.CAT06
                    ) PL
            WHERE   IL.CAT06 = PL.CAT06(+)
            AND     IL.GUBN = PL.GUBN(+)  
            UNION   ALL
            /*
                계획량 합계
            */
            SELECT  '','합계', '계획' GUBN,
                    TO_CHAR(SUM(ID.ANY_QTY),'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(SUM(ID.ANS_QTY),'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(SUM(ID.ANSB_QTY),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM(ID.ASA_QTY),'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(SUM(ID.KUM_QTY),'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(SUM(ID.PUS_QTY),'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(SUM(ID.NOK_QTY),'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(SUM(ID.TOT),'FM999,999,999')         AS TOT
            FROM    (
                    SELECT  ID.ITEM_ID, IM.CAT06,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    GROUP   BY ID.ITEM_ID, IM.CAT06
                    ) ID
            UNION   ALL
            /*
                실적량 합계
            */
            SELECT  '','합계', '실적' GUBN,
                    TO_CHAR(SUM(EP.ANY_QTY),'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(SUM(EP.ANS_QTY),'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(SUM(EP.ANSB_QTY),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM(EP.ASA_QTY),'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(SUM(EP.KUM_QTY),'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(SUM(EP.PUS_QTY),'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(SUM(EP.NOK_QTY),'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(SUM(EP.TOT),'FM999,999,999')         AS TOT
            FROM    (
                    SELECT  EP.ITEM_ID, IM.CAT06,
                            SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANY_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANS_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ANSB_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS ASA_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS KUM_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS PUS_QTY,
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    AS NOK_QTY,
                        ---------------------------------------------------------------
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           ) +
                        SUM( 
                            CASE 
                            WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                            WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                            ELSE 0 
                            END
                           )    TOT
                    FROM    V_ERP_PO_MES EP,
                            ITEM_MST IM
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     EP.ITEM_ID = IM.ITEM_ID
                    AND     IM.ITYPE = 'FERT'
                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                #if("$!{selected_ord}" == "DO")
                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
                #elseif("$!{selected_ord}" == "EX")
                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
                #end
                    GROUP   BY EP.ITEM_ID, IM.CAT06
                    ) EP
            UNION   ALL
            /*
                차이 합계
            */
            SELECT  '','합계', '차이' GUBN,
                    TO_CHAR(OL.ANY_QTY - PL.ANY_QTY,'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(OL.ANS_QTY - PL.ANS_QTY,'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(OL.ANSB_QTY - PL.ANSB_QTY,'FM999,999,999')   AS ANSB_QTY,
                    TO_CHAR(OL.ASA_QTY - PL.ASA_QTY,'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(OL.KUM_QTY - PL.KUM_QTY,'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(OL.PUS_QTY - PL.PUS_QTY,'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(OL.NOK_QTY - PL.NOK_QTY,'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(OL.TOT - PL.TOT,'FM999,999,999')             AS TOT
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '', '계획' GUBN,
                            SUM(ID.ANY_QTY)     AS ANY_QTY,
                            SUM(ID.ANS_QTY)     AS ANS_QTY,
                            SUM(ID.ANSB_QTY)    AS ANSB_QTY,
                            SUM(ID.ASA_QTY)     AS ASA_QTY,
                            SUM(ID.KUM_QTY)     AS KUM_QTY,
                            SUM(ID.PUS_QTY)     AS PUS_QTY,
                            SUM(ID.NOK_QTY)     AS NOK_QTY,
                            SUM(ID.TOT)         AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.CAT06,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANY_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ANSB_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS ASA_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS KUM_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS PUS_QTY,
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       ) +
                                    SUM( 
                                        CASE 
                                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                        ELSE 0 
                                        END
                                       )    TOT
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY, IM.CAT06
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.CAT06
                            ) ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM(EP.ANY_QTY)     AS ANY_QTY,
                            SUM(EP.ANS_QTY)     AS ANS_QTY,
                            SUM(EP.ANSB_QTY)    AS ANSB_QTY,
                            SUM(EP.ASA_QTY)     AS ASA_QTY,
                            SUM(EP.KUM_QTY)     AS KUM_QTY,
                            SUM(EP.PUS_QTY)     AS PUS_QTY,
                            SUM(EP.NOK_QTY)     AS NOK_QTY,
                            SUM(EP.TOT)         AS TOT
                    FROM    (
                            SELECT  EP.ITEM_ID, IM.CAT06,
                                    SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANY_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANS_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ANSB_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS ASA_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS KUM_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS PUS_QTY,
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    AS NOK_QTY,
                                ---------------------------------------------------------------
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   ) +
                                SUM( 
                                    CASE 
                                    WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                    WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                    ELSE 0 
                                    END
                                   )    TOT
                            FROM    V_ERP_PO_MES EP,
                                    ITEM_MST IM
                            WHERE   /*EP.STATUS = 'DLV'
                            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                            AND     EP.ITEM_ID = IM.ITEM_ID
                            AND     IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
                        #elseif("$!{selected_ord}" == "EX")
                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
                        #end
                            GROUP   BY EP.ITEM_ID, IM.CAT06
                            ) EP
                    ) OL
            UNION	ALL
            /*
                달성률 : 실적 합계 / 계획 합계 * 100
            */
            SELECT  '','달성률(%)','',
                    TO_CHAR(ROUND(OL.ANY_QTY / DECODE(PL.ANY_QTY,0,1,PL.ANY_QTY)  *100,2),'FM999990.00')   AS ANY_RATE,
                    TO_CHAR(ROUND(OL.ANS_QTY / DECODE(PL.ANS_QTY,0,1,PL.ANS_QTY)  *100,2),'FM999990.00')   AS ANS_RATE,
                    TO_CHAR(ROUND(OL.ANSB_QTY/ DECODE(PL.ANSB_QTY,0,1,PL.ANSB_QTY)*100,2),'FM999990.00')   AS ANSB_RATE,
                    TO_CHAR(ROUND(OL.ASA_QTY / DECODE(PL.ASA_QTY,0,1,PL.ASA_QTY)  *100,2),'FM999990.00')   AS ASA_RATE,
                    TO_CHAR(ROUND(OL.KUM_QTY / DECODE(PL.KUM_QTY,0,1,PL.KUM_QTY)  *100,2),'FM999990.00')   AS KUM_RATE,
                    TO_CHAR(ROUND(OL.PUS_QTY / DECODE(PL.PUS_QTY,0,1,PL.PUS_QTY)  *100,2),'FM999990.00')   AS PUS_RATE,
                    TO_CHAR(ROUND(OL.NOK_QTY / DECODE(PL.NOK_QTY,0,1,PL.NOK_QTY)  *100,2),'FM999990.00')   AS NOK_RATE,
                    TO_CHAR(ROUND(OL.TOT     / DECODE(PL.TOT,0,1,PL.TOT)          *100,2),'FM999990.00')   AS TOT_RATE
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '','합계', '계획' GUBN,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_ERP_PO_MES EP,
                            (
                            /*
                                ITEM LIST
                            */
                            SELECT  ID.ITEM_ID, IM.QTY        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.QTY        
                            ) ID
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     ID.ITEM_ID = EP.ITEM_ID
                    ) OL
            ORDER   BY 1, 3
        #else
            SELECT  IL.ITEM_ID, IL.ITEM_NAME, IL.SPEC, IL.GUBN, 
                    /*
                        0 : NULL(화면에서 빈칸으로 보이도록 하기위해서)
                        식 : ITEM_MST.QTY를 곱해준다.
                        BOX : 변경없음
                    */
                    CASE
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANY_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANY_QTY,'0',NULL,TO_CHAR(PL.ANY_QTY,'FM999,999,999'))
                    END     ANY_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANS_QTY,'0',NULL,TO_CHAR(PL.ANS_QTY,'FM999,999,999'))
                    END     ANS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ANSB_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ANSB_QTY,'0',NULL,TO_CHAR(PL.ANSB_QTY,'FM999,999,999'))
                    END     ANSB_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.ASA_QTY,'FM999,999,999')
                    ELSE DECODE(PL.ASA_QTY,'0',NULL,TO_CHAR(PL.ASA_QTY,'FM999,999,999'))
                    END     ASA_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.KUM_QTY,'FM999,999,999')
                    ELSE DECODE(PL.KUM_QTY,'0',NULL,TO_CHAR(PL.KUM_QTY,'FM999,999,999'))
                    END     KUM_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.PUS_QTY,'FM999,999,999')
                    ELSE DECODE(PL.PUS_QTY,'0',NULL,TO_CHAR(PL.PUS_QTY,'FM999,999,999'))
                    END     PUS_QTY, 
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.NOK_QTY,'FM999,999,999')
                    ELSE DECODE(PL.NOK_QTY,'0',NULL,TO_CHAR(PL.NOK_QTY,'FM999,999,999')) 
                    END     NOK_QTY,
                    CASE 
                    WHEN IL.GUBN = '차이' THEN TO_CHAR(PL.TOT,'FM999,999,999')
                    ELSE DECODE(PL.TOT,'0',NULL,TO_CHAR(PL.TOT,'FM999,999,999'))  
                    END     TOT
            FROM    (
                    /*
                        ITEM 리스트
                    */
                    SELECT  ID.ITEM_ID, ID.ITEM_NAME, ID.SPEC, GB.GUBN
                    FROM    (
                            SELECT  ID.ITEM_ID, IM.ITEM_NAME, IM.SPEC        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                   #if("$!{selected_ord}" == "DO")
			                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
			                        #elseif("$!{selected_ord}" == "EX")
			                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
			                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.ITEM_NAME, IM.SPEC      
                            ORDER   BY ID.ITEM_ID
                            ) ID,
                            (
                            SELECT  '계획' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '실적' AS GUBN
                            FROM    DUAL
                            UNION   ALL
                            SELECT  '차이' AS GUBN
                            FROM    DUAL
                            ) GB
                    ) IL,
                    (
                    /*
                        계획량
                    */
                    SELECT  ID.ITEM_ID, '계획' GUBN,
                            SUM( CASE WHEN ID.PLANT_ID = '1110' THEN ID.QTY ELSE 0 END) AS ANY_QTY,
                            SUM( CASE WHEN ID.PLANT_ID = '1120' THEN ID.QTY ELSE 0 END) AS ANS_QTY,
                            SUM( CASE WHEN ID.PLANT_ID = '1130' THEN ID.QTY ELSE 0 END) AS ANSB_QTY,
                            SUM( CASE WHEN ID.PLANT_ID = '1140' THEN ID.QTY ELSE 0 END) AS ASA_QTY,
                            SUM( CASE WHEN ID.PLANT_ID = '1160' THEN ID.QTY ELSE 0 END) AS KUM_QTY,
                            SUM( CASE WHEN ID.PLANT_ID = '1170' THEN ID.QTY ELSE 0 END) AS PUS_QTY,
                            SUM( CASE WHEN ID.PLANT_ID = '1180' THEN ID.QTY ELSE 0 END) AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( CASE WHEN ID.PLANT_ID = '1110' THEN ID.QTY ELSE 0 END)
                            + SUM( CASE WHEN ID.PLANT_ID = '1120' THEN ID.QTY ELSE 0 END)
                            + SUM( CASE WHEN ID.PLANT_ID = '1130' THEN ID.QTY ELSE 0 END)
                            + SUM( CASE WHEN ID.PLANT_ID = '1140' THEN ID.QTY ELSE 0 END)
                            + SUM( CASE WHEN ID.PLANT_ID = '1160' THEN ID.QTY ELSE 0 END)
                            + SUM( CASE WHEN ID.PLANT_ID = '1170' THEN ID.QTY ELSE 0 END)
                            + SUM( CASE WHEN ID.PLANT_ID = '1180' THEN ID.QTY ELSE 0 END) TOT
                    FROM    (
                    		SELECT	T1.PLANT_ID, T1.PROC_ID, T1.ITEM_ID, T1.PLAN_KIND, T1.SCH_TYPE, T1.START_DATE,
									T1.START_TIME, T1.END_DATE, T1.END_TIME,
									DECODE('$!{checked_uom}','EA',T3.QTY*T1.QTY, T1.QTY)	QTY			
							FROM	V_IF_MES_SCH_PLAN	T1,
									ITEM_MST			T3
							WHERE	T1.ITEM_ID	= T3.ITEM_ID
							AND		T3.ITYPE	= 'FERT'
                    		) ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    GROUP   BY ID.ITEM_ID
                    UNION   ALL
                    /*
                        실적량
                    */
                    SELECT  ID.ITEM_ID, '실적' GUBN, 
                            NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                            NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                            NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                            NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                            NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                            NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                            NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                            NVL(EP.TOT,0)       AS TOT 
                    FROM    (
                            /*
                                ITEM LIST
                            */
                            SELECT  ID.ITEM_ID        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end  
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID
                            ) ID,
                            (
                            SELECT  EP.ITEM_ID, '실적' GUBN,
                                    SUM( CASE WHEN EP.PLANT_ID = '1110' THEN EP.COMPL_QTY ELSE 0 END) AS ANY_QTY,
                                    SUM( CASE WHEN EP.PLANT_ID = '1120' THEN EP.COMPL_QTY ELSE 0 END) AS ANS_QTY,
                                    SUM( CASE WHEN EP.PLANT_ID = '1130' THEN EP.COMPL_QTY ELSE 0 END) AS ANSB_QTY,
                                    SUM( CASE WHEN EP.PLANT_ID = '1140' THEN EP.COMPL_QTY ELSE 0 END) AS ASA_QTY,
                                    SUM( CASE WHEN EP.PLANT_ID = '1160' THEN EP.COMPL_QTY ELSE 0 END) AS KUM_QTY,
                                    SUM( CASE WHEN EP.PLANT_ID = '1170' THEN EP.COMPL_QTY ELSE 0 END) AS PUS_QTY,
                                    SUM( CASE WHEN EP.PLANT_ID = '1180' THEN EP.COMPL_QTY ELSE 0 END) AS NOK_QTY,
                                    --------------------------------------------------------------------  
                                    SUM( CASE WHEN EP.PLANT_ID = '1110' THEN EP.COMPL_QTY ELSE 0 END)
                                    + SUM( CASE WHEN EP.PLANT_ID = '1120' THEN EP.COMPL_QTY ELSE 0 END)
                                    + SUM( CASE WHEN EP.PLANT_ID = '1130' THEN EP.COMPL_QTY ELSE 0 END)
                                    + SUM( CASE WHEN EP.PLANT_ID = '1140' THEN EP.COMPL_QTY ELSE 0 END)
                                    + SUM( CASE WHEN EP.PLANT_ID = '1160' THEN EP.COMPL_QTY ELSE 0 END)
                                    + SUM( CASE WHEN EP.PLANT_ID = '1170' THEN EP.COMPL_QTY ELSE 0 END)
                                    + SUM( CASE WHEN EP.PLANT_ID = '1180' THEN EP.COMPL_QTY ELSE 0 END) TOT
                            FROM    (
                            		SELECT	T1.PLANT_ID, T1.ITEM_ID, T1.PO_ID, T1.QTY_UOM, 
											T1.START_DTTM, T1.SHIFT_ID,
											DECODE('$!{checked_uom}','EA',T3.QTY*T1.COMPL_QTY, T1.COMPL_QTY)	COMPL_QTY			
									FROM	V_ERP_PO_MES	T1,
											ITEM_MST		T3
									WHERE	T1.ITEM_ID	= T3.ITEM_ID
									AND		T3.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
									AND		T3.ITYPE	= 'FERT'
                            		) EP
                            WHERE   EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                            GROUP   BY EP.ITEM_ID
                            ) EP
                    WHERE   ID.ITEM_ID = EP.ITEM_ID(+)
                    UNION   ALL
                    /*
                        차이 : 실적량 - 계획량
                    */
                    SELECT  PL.ITEM_ID, '차이' GUBN,
                            OL.ANY_QTY - PL.ANY_QTY     AS ANY_QTY,
                            OL.ANS_QTY - PL.ANS_QTY     AS ANS_QTY,
                            OL.ANSB_QTY - PL.ANSB_QTY   AS ANSB_QTY,
                            OL.ASA_QTY - PL.ASA_QTY     AS ASA_QTY,
                            OL.KUM_QTY - PL.KUM_QTY     AS KUM_QTY,
                            OL.PUS_QTY - PL.PUS_QTY     AS PUS_QTY,
                            OL.NOK_QTY - PL.NOK_QTY     AS NOK_QTY,
                            OL.TOT - PL.TOT             AS TOT
                    FROM    (
                            SELECT  ID.ITEM_ID, '계획' GUBN,
                                    SUM( CASE WHEN ID.PLANT_ID = '1110' THEN ID.QTY ELSE 0 END) AS ANY_QTY,
                                    SUM( CASE WHEN ID.PLANT_ID = '1120' THEN ID.QTY ELSE 0 END) AS ANS_QTY,
                                    SUM( CASE WHEN ID.PLANT_ID = '1130' THEN ID.QTY ELSE 0 END) AS ANSB_QTY,
                                    SUM( CASE WHEN ID.PLANT_ID = '1140' THEN ID.QTY ELSE 0 END) AS ASA_QTY,
                                    SUM( CASE WHEN ID.PLANT_ID = '1160' THEN ID.QTY ELSE 0 END) AS KUM_QTY,
                                    SUM( CASE WHEN ID.PLANT_ID = '1170' THEN ID.QTY ELSE 0 END) AS PUS_QTY,
                                    SUM( CASE WHEN ID.PLANT_ID = '1180' THEN ID.QTY ELSE 0 END) AS NOK_QTY,
                                    ---------------------------------------------------------------
                                    SUM( CASE WHEN ID.PLANT_ID = '1110' THEN ID.QTY ELSE 0 END)
                                    + SUM( CASE WHEN ID.PLANT_ID = '1120' THEN ID.QTY ELSE 0 END)
                                    + SUM( CASE WHEN ID.PLANT_ID = '1130' THEN ID.QTY ELSE 0 END)
                                    + SUM( CASE WHEN ID.PLANT_ID = '1140' THEN ID.QTY ELSE 0 END)
                                    + SUM( CASE WHEN ID.PLANT_ID = '1160' THEN ID.QTY ELSE 0 END)
                                    + SUM( CASE WHEN ID.PLANT_ID = '1170' THEN ID.QTY ELSE 0 END)
                                    + SUM( CASE WHEN ID.PLANT_ID = '1180' THEN ID.QTY ELSE 0 END) TOT
                            FROM    (
		                    		SELECT	T1.PLANT_ID, T1.PROC_ID, T1.ITEM_ID, T1.PLAN_KIND, T1.SCH_TYPE, T1.START_DATE,
											T1.START_TIME, T1.END_DATE, T1.END_TIME,
											DECODE('$!{checked_uom}','EA',T3.QTY*T1.QTY, T1.QTY)	QTY			
									FROM	V_IF_MES_SCH_PLAN	T1,
											ITEM_MST			T3
									WHERE	T1.ITEM_ID	= T3.ITEM_ID
									AND		T3.ITYPE	= 'FERT'
									AND		T3.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
		                    		) ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID
                            ) PL,
                            (
                            SELECT  ID.ITEM_ID, '실적' GUBN, 
                                    NVL(EP.ANY_QTY,0)   AS ANY_QTY, 
                                    NVL(EP.ANS_QTY,0)   AS ANS_QTY,  
                                    NVL(EP.ANSB_QTY,0)  AS ANSB_QTY,  
                                    NVL(EP.ASA_QTY,0)   AS ASA_QTY, 
                                    NVL(EP.KUM_QTY,0)   AS KUM_QTY,  
                                    NVL(EP.PUS_QTY,0)   AS PUS_QTY,  
                                    NVL(EP.NOK_QTY,0)   AS NOK_QTY,  
                                    NVL(EP.TOT,0)       AS TOT 
                            FROM    (
                                    /*
                                        ITEM LIST
                                    */
                                    SELECT  ID.ITEM_ID        
                                    FROM    V_IF_MES_SCH_PLAN ID,
                                            (
                                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                                            FROM    HRCHY
                                            WHERE   LVL_TYPE = '작업장'
                                            AND     CAT = '포장'
                                            ) HR,
		                                    (
		                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
		                                    FROM    ITEM_MST IM
		                                    WHERE   IM.ITYPE = 'FERT'
		                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
	                                    #if("$!{selected_ord}" == "DO")
		                                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                                #elseif("$!{selected_ord}" == "EX")
		                                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                                #end
		                                    ) IM
                                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                                    AND     ID.PROC_ID = HR.PROC_ID   
                                    AND     ID.PLAN_KIND = 'PROD' 
                                    AND     ID.SCH_TYPE = 'D'    
                                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                                    AND     ID.ITEM_ID = IM.ITEM_ID
                                    GROUP   BY ID.ITEM_ID
                                    ) ID,
                                    (
                                    SELECT  EP.ITEM_ID, '실적' GUBN,
                                            SUM( CASE WHEN EP.PLANT_ID = '1110' THEN EP.COMPL_QTY ELSE 0 END) AS ANY_QTY,
                                            SUM( CASE WHEN EP.PLANT_ID = '1120' THEN EP.COMPL_QTY ELSE 0 END) AS ANS_QTY,
                                            SUM( CASE WHEN EP.PLANT_ID = '1130' THEN EP.COMPL_QTY ELSE 0 END) AS ANSB_QTY,
                                            SUM( CASE WHEN EP.PLANT_ID = '1140' THEN EP.COMPL_QTY ELSE 0 END) AS ASA_QTY,
                                            SUM( CASE WHEN EP.PLANT_ID = '1160' THEN EP.COMPL_QTY ELSE 0 END) AS KUM_QTY,
                                            SUM( CASE WHEN EP.PLANT_ID = '1170' THEN EP.COMPL_QTY ELSE 0 END) AS PUS_QTY,
                                            SUM( CASE WHEN EP.PLANT_ID = '1180' THEN EP.COMPL_QTY ELSE 0 END) AS NOK_QTY,
                                            --------------------------------------------------------------------  
                                            SUM( CASE WHEN EP.PLANT_ID = '1110' THEN EP.COMPL_QTY ELSE 0 END)
                                            + SUM( CASE WHEN EP.PLANT_ID = '1120' THEN EP.COMPL_QTY ELSE 0 END)
                                            + SUM( CASE WHEN EP.PLANT_ID = '1130' THEN EP.COMPL_QTY ELSE 0 END)
                                            + SUM( CASE WHEN EP.PLANT_ID = '1140' THEN EP.COMPL_QTY ELSE 0 END)
                                            + SUM( CASE WHEN EP.PLANT_ID = '1160' THEN EP.COMPL_QTY ELSE 0 END)
                                            + SUM( CASE WHEN EP.PLANT_ID = '1170' THEN EP.COMPL_QTY ELSE 0 END)
                                            + SUM( CASE WHEN EP.PLANT_ID = '1180' THEN EP.COMPL_QTY ELSE 0 END) TOT
                                    FROM    (
		                            		SELECT	T1.PLANT_ID, T1.ITEM_ID, T1.PO_ID, T1.QTY_UOM, 
													T1.START_DTTM, T1.SHIFT_ID,
													DECODE('$!{checked_uom}','EA',T3.QTY*T1.COMPL_QTY, T1.COMPL_QTY)	COMPL_QTY			
											FROM	V_ERP_PO_MES	T1,
													ITEM_MST		T3
											WHERE	T1.ITEM_ID	= T3.ITEM_ID
											AND		T3.ITYPE	= 'FERT'
											AND		T3.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
		                            		) EP
                                    WHERE   EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                                    GROUP   BY EP.ITEM_ID
                                    ) EP
                            WHERE   ID.ITEM_ID = EP.ITEM_ID(+)
                            ) OL
                    WHERE   PL.ITEM_ID = OL.ITEM_ID
                    ) PL,
                    ITEM_MST IM
            WHERE   IL.ITEM_ID = PL.ITEM_ID(+)
            AND     IL.GUBN = PL.GUBN(+)  
            AND     IL.ITEM_ID = IM.ITEM_ID(+)
            UNION   ALL
            /*
                계획량 합계
            */
            SELECT  '','합계', '', '계획' GUBN,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ANY_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ANS_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ASA_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS KUM_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS PUS_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS NOK_QTY,
                    ---------------------------------------------------------------
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                        WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    TOT
            FROM    V_IF_MES_SCH_PLAN ID,
                    (
                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                    FROM    HRCHY
                    WHERE   LVL_TYPE = '작업장'
                    AND     CAT = '포장'
                    ) HR,
                    (
                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                    FROM    ITEM_MST IM
                    WHERE   IM.ITYPE = 'FERT'
                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                #if("$!{selected_ord}" == "DO")
		            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		        #elseif("$!{selected_ord}" == "EX")
		            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		        #end
                    ) IM
            WHERE   ID.PLANT_ID = HR.PLANT_ID
            AND     ID.PROC_ID = HR.PROC_ID   
            AND     ID.PLAN_KIND = 'PROD' 
            AND     ID.SCH_TYPE = 'D'    
            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
            AND     ID.ITEM_ID = IM.ITEM_ID
            UNION   ALL
            /*
                실적량 합계
            */
            SELECT  '','합계', '', '실적' GUBN,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ANY_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ANS_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ANSB_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS ASA_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS KUM_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS PUS_QTY,
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    AS NOK_QTY,
                    ---------------------------------------------------------------
                    TO_CHAR(SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ) +
                    SUM( 
                        CASE 
                        WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                        WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                        ELSE 0 
                        END
                       ),'FM999,999,999')    TOT
            FROM    V_ERP_PO_MES EP,
                    (
                    /*
                        ITEM LIST
                    */
                    SELECT  ID.ITEM_ID, IM.QTY        
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    GROUP   BY ID.ITEM_ID, IM.QTY        
                    ) ID
            WHERE   /*EP.STATUS = 'DLV'
            AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
            AND     ID.ITEM_ID = EP.ITEM_ID
            UNION   ALL
            /*
                차이 합계
            */
            SELECT  '','합계', '', '차이' GUBN,
                    TO_CHAR(OL.ANY_QTY - PL.ANY_QTY,'FM999,999,999')     AS ANY_QTY,
                    TO_CHAR(OL.ANS_QTY - PL.ANS_QTY,'FM999,999,999')     AS ANS_QTY,
                    TO_CHAR(OL.ANSB_QTY - PL.ANSB_QTY,'FM999,999,999')   AS ANSB_QTY,
                    TO_CHAR(OL.ASA_QTY - PL.ASA_QTY,'FM999,999,999')     AS ASA_QTY,
                    TO_CHAR(OL.KUM_QTY - PL.KUM_QTY,'FM999,999,999')     AS KUM_QTY,
                    TO_CHAR(OL.PUS_QTY - PL.PUS_QTY,'FM999,999,999')     AS PUS_QTY,
                    TO_CHAR(OL.NOK_QTY - PL.NOK_QTY,'FM999,999,999')     AS NOK_QTY,
                    TO_CHAR(OL.TOT - PL.TOT,'FM999,999,999')             AS TOT
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '','합계', '계획' GUBN,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_ERP_PO_MES EP,
                            (
                            /*
                                ITEM LIST
                            */
                            SELECT  ID.ITEM_ID, IM.QTY        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.QTY        
                            ) ID
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     ID.ITEM_ID = EP.ITEM_ID
                    ) OL
            UNION	ALL
            /*
                달성률 : 실적 합계 / 계획 합계 * 100
            */
            SELECT  '','달성률(%)','','',
                    TO_CHAR(ROUND(OL.ANY_QTY / DECODE(PL.ANY_QTY,0,1,PL.ANY_QTY)  *100,2),'FM999990.00')   AS ANY_RATE,
                    TO_CHAR(ROUND(OL.ANS_QTY / DECODE(PL.ANS_QTY,0,1,PL.ANS_QTY)  *100,2),'FM999990.00')   AS ANS_RATE,
                    TO_CHAR(ROUND(OL.ANSB_QTY/ DECODE(PL.ANSB_QTY,0,1,PL.ANSB_QTY)*100,2),'FM999990.00')   AS ANSB_RATE,
                    TO_CHAR(ROUND(OL.ASA_QTY / DECODE(PL.ASA_QTY,0,1,PL.ASA_QTY)  *100,2),'FM999990.00')   AS ASA_RATE,
                    TO_CHAR(ROUND(OL.KUM_QTY / DECODE(PL.KUM_QTY,0,1,PL.KUM_QTY)  *100,2),'FM999990.00')   AS KUM_RATE,
                    TO_CHAR(ROUND(OL.PUS_QTY / DECODE(PL.PUS_QTY,0,1,PL.PUS_QTY)  *100,2),'FM999990.00')   AS PUS_RATE,
                    TO_CHAR(ROUND(OL.NOK_QTY / DECODE(PL.NOK_QTY,0,1,PL.NOK_QTY)  *100,2),'FM999990.00')   AS NOK_RATE,
                    TO_CHAR(ROUND(OL.TOT     / DECODE(PL.TOT,0,1,PL.TOT)          *100,2),'FM999990.00')   AS TOT_RATE
            FROM    (
                    /*
                        계획량 합계
                    */
                    SELECT  '','합계', '계획' GUBN,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180' THEN ID.QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1110'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1120'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1130'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1140'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1160'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1170'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN ID.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN ID.QTY * DECODE(IM.QTY,0,1,IM.QTY)
                                WHEN ID.PLANT_ID = '1180'                   THEN ID.QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_IF_MES_SCH_PLAN ID,
                            (
                            SELECT  HTYPE PLANT_ID, HID PROC_ID
                            FROM    HRCHY
                            WHERE   LVL_TYPE = '작업장'
                            AND     CAT = '포장'
                            ) HR,
                            (
                            SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                            FROM    ITEM_MST IM
                            WHERE   IM.ITYPE = 'FERT'
                            AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                        #if("$!{selected_ord}" == "DO")
		                    AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                #elseif("$!{selected_ord}" == "EX")
		                    AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                #end
                            ) IM
                    WHERE   ID.PLANT_ID = HR.PLANT_ID
                    AND     ID.PROC_ID = HR.PROC_ID   
                    AND     ID.PLAN_KIND = 'PROD' 
                    AND     ID.SCH_TYPE = 'D'    
                    AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                            BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                    AND     ID.ITEM_ID = IM.ITEM_ID
                    ) PL,
                    (
                    /*
                        실적량 합계
                    */
                    SELECT  '','합계', '실적' GUBN,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANY_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ANSB_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS ASA_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS KUM_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS PUS_QTY,
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    AS NOK_QTY,
                            ---------------------------------------------------------------
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1110' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1110'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1120' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1120'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1130' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1130'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1140' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1140'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1160' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1160'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1170' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1170'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               ) +
                            SUM( 
                                CASE 
                                WHEN EP.PLANT_ID = '1180' AND '$!{checked_uom}' = 'EA'   THEN EP.COMPL_QTY * DECODE(ID.QTY,0,1,ID.QTY)
                                WHEN EP.PLANT_ID = '1180'                   THEN EP.COMPL_QTY             
                                ELSE 0 
                                END
                               )    TOT
                    FROM    V_ERP_PO_MES EP,
                            (
                            /*
                                ITEM LIST
                            */
                            SELECT  ID.ITEM_ID, IM.QTY        
                            FROM    V_IF_MES_SCH_PLAN ID,
                                    (
                                    SELECT  HTYPE PLANT_ID, HID PROC_ID
                                    FROM    HRCHY
                                    WHERE   LVL_TYPE = '작업장'
                                    AND     CAT = '포장'
                                    ) HR,
                                    (
                                    SELECT  IM.ITEM_ID, IM.ITEM_NAME, IM.SPEC, IM.QTY
                                    FROM    ITEM_MST IM
                                    WHERE   IM.ITYPE = 'FERT'
                                    AND		IM.MTO_MTS_TYPE LIKE '%'||'$!{mto_gubn}'||'%'
                                #if("$!{selected_ord}" == "DO")
		                            AND     (IM.MATERIAL_GROUP &lt; '5K000' OR MATERIAL_GROUP &gt; '5S999')   
		                        #elseif("$!{selected_ord}" == "EX")
		                            AND     IM.MATERIAL_GROUP BETWEEN '5K000' AND '5S999'  
		                        #end
                                    ) IM
                            WHERE   ID.PLANT_ID = HR.PLANT_ID
                            AND     ID.PROC_ID = HR.PROC_ID   
                            AND     ID.PLAN_KIND = 'PROD' 
                            AND     ID.SCH_TYPE = 'D'    
                            AND     DECODE(SIGN(TO_NUMBER(ID.START_TIME)-060000),-1,TO_DATE(ID.START_DATE,'YYYYMMDD')-1,ID.START_DATE) 
                                    BETWEEN REPLACE('$!{sdate}','-','') AND REPLACE('$!{edate}','-','')
                            AND     ID.ITEM_ID = IM.ITEM_ID
                            GROUP   BY ID.ITEM_ID, IM.QTY        
                            ) ID
                    WHERE   /*EP.STATUS = 'DLV'
                    AND*/     EP.START_DTTM BETWEEN TO_DATE('$!{sdate}','YYYY-MM-DD') AND TO_DATE('$!{edate}','YYYY-MM-DD')
                    AND     ID.ITEM_ID = EP.ITEM_ID
                    ) OL
            ORDER   BY 1, 4
            --ORDER   BY 1, 4            
        #end
		
	</query>	
		
<!--
=====================================================================================================
 끝  
=====================================================================================================
--> 

</queries>
