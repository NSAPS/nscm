<?xml version="1.0" encoding="EUC-KR"?>
<queries>	

	<!-- 
	=======================
	  제품/품종별 판매현황조회
	=======================
	-->

	<!-- 일자표시 HEADER  --> 
	<query id="ip_06010_HEADER_DATE" paging="false"> 

	#if("$!{chk_sel_term}" == "M")	

		SELECT	TO_CHAR(T1.CAL_DATE,'YYYY.MM')	CAL_DATE,
				NVL2(T2.CAL_DATE,100,0)			SHOW_FLAG
		FROM	(								
				SELECT	TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}'),ROWNUM-1),'MM')	CAL_DATE
				FROM	CODE_MST
				WHERE	ROWNUM &lt;= 12		
				)	T1,
				(
				SELECT	TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}'),ROWNUM-1),'MM')	CAL_DATE
				FROM	CODE_MST
				WHERE	ROWNUM &lt;= 12						
				)	T2
		WHERE	T1.CAL_DATE = T2.CAL_DATE(+)
		AND		T2.CAL_DATE(+) BETWEEN TRUNC(TO_DATE('$!{in_fr_date}'),'MM') AND TRUNC(TO_DATE('$!{in_to_date}'),'MM')
		ORDER
		BY		CAL_DATE

	#else

		SELECT	TO_CHAR(T1.CAL_DATE,'MM/DD')	CAL_DATE,
				NVL2(T2.CAL_DATE,60,0) 			SHOW_FLAG
		FROM	CAL_MST	T1,
				CAL_MST	T2
		WHERE	T1.CAL_DATE	= T2.CAL_DATE(+)
		AND		T2.CAL_DATE(+)	BETWEEN '$!{in_fr_date}' AND '$!{in_to_date}'
		AND		T1.CAL_DATE		BETWEEN TO_DATE(NVL(REPLACE('$!{in_fr_date}','-',''),TO_CHAR(SYSDATE,'YYYYMMDD')))
								AND 	TO_DATE(NVL(REPLACE('$!{in_fr_date}','-',''),TO_CHAR(SYSDATE,'YYYYMMDD')))+30
		ORDER
		BY		T1.CAL_DATE
		
	#end
		
	</query> 

	<!-- 제품/품종별 판매현황조회(영업조직popup)  --> 
	<query id="ip_06010_SalesLoc_popup" paging="false"> 

		SELECT	DEPT_CODE,
				DEPT_NAME,
				DEPT_GRAD_CODE
		FROM	SDSTT401,
				DUAL
		WHERE	APPL_STRT_YYMM	&lt;= TO_CHAR(SYSDATE, 'YYYYMM')
		AND		APPL_END_YYMM	&gt;= TO_CHAR(SYSDATE, 'YYYYMM')
		AND		SUPL_APPL_GUBN	IS NULL
	#if("$!{in_dept_grad_code}" != "00")
		AND		DEPT_GRAD_CODE	= '$!{in_dept_grad_code}'
	#end
		ORDER
		BY		DEPT_GRAD_CODE, DEPT_CODE
	</query> 

	<!-- 제품/품종별 판매현황조회(최상위조직 조회)  --> 
	<query id="ip_06010_SalesLoc_Default" paging="false"> 

		SELECT	DEPT_CODE,
				DEPT_NAME
		FROM	SDSTT401,
				DUAL
		WHERE	APPL_STRT_YYMM	&lt;= TO_CHAR(SYSDATE, 'YYYYMM')
		AND		APPL_END_YYMM	&gt;= TO_CHAR(SYSDATE, 'YYYYMM')
		AND		SUPL_APPL_GUBN	IS NULL
		AND		DEPT_GRAD_CODE	= '10'
		AND		ROWNUM = 1

	</query> 

	<!-- 영업지점 이름조회  --> 
	<query id="ip_06010_F_GETSALESLOCNAME" paging="false"> 

		SELECT	DEPT_NAME,
				DEPT_GRAD_CODE
		FROM	SDSTT401,
				DUAL
		WHERE	APPL_STRT_YYMM	&lt;= TO_CHAR(SYSDATE, 'YYYYMM')
		AND		APPL_END_YYMM	&gt;= TO_CHAR(SYSDATE, 'YYYYMM')
		AND		SUPL_APPL_GUBN	IS NULL
		AND		DEPT_CODE		= '$!{in_sales_loc}'
	
	</query> 

	<!-- 조회단위 조회  --> 
	<query id="ip_06010_SALES_ACT_SEL_GUBN" paging="false"> 

		SELECT	CD,
				CD_NAME
		FROM	CODE_MST, DUAL
		WHERE	CD_GRP	LIKE 'SALES_ACT_SEL_GUBN'
		AND		TO_NUMBER(CD) 		>= TO_NUMBER('$!{in_dept_grad_code}')
		ORDER
		BY		TO_NUMBER(CD)

	</query> 

	<!-- 조회기간 check  --> 
	<query id="ip_06010_TERM_CHECK" paging="false"> 

	#if("$!{chk_sel_term}" == "D")	
		SELECT	CASE
					/* 뒷날짜가 앞날짜보다 앞서는 경우 */
					WHEN (TO_DATE('$!{in_to_date}') - TO_DATE('$!{in_fr_date}')) &lt; 0 THEN -1
					/* 조회기간이 31일이 넘은경우 */
					WHEN (TO_DATE('$!{in_to_date}') - TO_DATE('$!{in_fr_date}')) &gt; 30 THEN -2 
					ELSE 1
				END	TERM_CHECK,
				0
		FROM	DUAL
	#else
		SELECT	CASE
					/* 뒷날짜가 앞날짜보다 앞서는 경우 */
					WHEN MONTHS_BETWEEN(TRUNC(TO_DATE('$!{in_to_date}'),'MM'), TRUNC(TO_DATE('$!{in_fr_date}'),'MM')) &lt; 0 THEN -1
					/* 조회기간이 12개월이 넘은경우 */
					WHEN MONTHS_BETWEEN(TRUNC(TO_DATE('$!{in_to_date}'),'MM'), TRUNC(TO_DATE('$!{in_fr_date}'),'MM')) &gt; 12 THEN -2
					ELSE 1
				END	TERM_CHECK,
				0
		FROM	DUAL
	#end
	
	</query> 

	<!-- 품목Popup  --> 
	<query id="ip_06010_Item_popup" paging="false"> 

		SELECT	ITEM_ID,
				ITEM_NAME,
				CASE
					WHEN SELL_STOP_DATE	>= TO_CHAR(SYSDATE,'YYYYMMDD') THEN '판매중'
					ELSE '판매중지'
				END	SELL_STOP_DATE,
				to_clob(
				CASE
					WHEN ITEM_STATUS = 'ST' AND ITYPE = 'FERT' THEN '생산가능'
					WHEN ITEM_STATUS = 'ST' AND ITYPE = 'HAWA' THEN '매입가능'
					WHEN ITEM_STATUS = 'D1' AND ITYPE = 'FERT' THEN '생산중지'
					WHEN ITEM_STATUS = 'D1' AND ITYPE = 'HAWA' THEN '매입중지'
					ELSE '확인필요'
				END)	ITEM_STATUS
		FROM	ITEM_MST, DUAL
		WHERE	(	
					(
					/* 판매중 */
					'$!{in_item_status}' = '01'
					AND	SELL_STOP_DATE	&gt;= TO_CHAR(SYSDATE,'YYYYMMDD')
					)
					OR
					(
					/* 생산/매입중 */
					'$!{in_item_status}'	= '02'
					AND	ITEM_STATUS	= 'ST'
					)
					OR
					(
					/* 판매중지 */
					'$!{in_item_status}' = '03'
					AND	SELL_STOP_DATE	&lt; TO_CHAR(SYSDATE,'YYYYMMDD')
					)
					OR
					/* 전체조회 */
					'$!{in_item_status}' = '00'
				)
		AND		ITYPE	IN ('FERT','HAWA')
		AND		NVL(CAT03,'XX') NOT LIKE 'O%'	
		[AND	(ITEM_ID	LIKE '%'||'$!{selected_item_id}'||'%'
						OR ITEM_NAME	LIKE '%'||'$!{selected_item_id}'||'%')]
		ORDER
		BY		ITEM_ID	

	</query> 

	<!-- 품종Popup  --> 
	<query id="ip_06010_Prty_popup" paging="false"> 

	#if("$!{in_sel_gubn}" == "02")
		/* 사업코드 */
		SELECT	HID			CODE,
				HID_NAME	CODE_NAME
		FROM	HRCHY, DUAL
		WHERE	HTYPE	= '품종분류'
		AND		LVL		= '20'
		[AND	(HID	LIKE '%'||'$!{selected_item_id}'||'%'
						OR HID_NAME	LIKE '%'||'$!{selected_item_id}'||'%')]
		ORDER
		BY		1
	#elseif("$!{in_sel_gubn}" == "03")	
		/* 브랜드코드 */
		SELECT	HID			CODE,
				HID_NAME	CODE_NAME
		FROM	HRCHY, DUAL
		WHERE	HTYPE	= '품종분류'
		AND		LVL		= '30'
		[AND	(HID	LIKE '%'||'$!{selected_item_id}'||'%'
						OR HID_NAME	LIKE '%'||'$!{selected_item_id}'||'%')]
		ORDER
		BY		1
	#elseif("$!{in_sel_gubn}" == "04")	
		/* 대표제품 */
		SELECT	HID			CODE,
				HID_NAME	CODE_NAME
		FROM	HRCHY, DUAL
		WHERE	HTYPE	= '품종분류'
		AND		LVL		= '40'
		[AND	(HID	LIKE '%'||'$!{selected_item_id}'||'%'
						OR HID_NAME	LIKE '%'||'$!{selected_item_id}'||'%')]
		ORDER
		BY		1
	#elseif("$!{in_sel_gubn}" == "05")	
		/* 품종 */
		SELECT	CD CODE,
				DECODE(SUBSTR(CD_GRP,10,1),'1','대_','2','중_','소_')||CD_NAME	CODE_NAME
		FROM	CODE_MST, DUAL
		WHERE	CD_GRP	LIKE 'SALES_CAT%'
		AND		SUBSTR(CD_GRP,10,1)	IN ('1','2','3')
		[AND	(CD	LIKE '%'||'$!{selected_item_id}'||'%'
						OR CD_NAME	LIKE '%'||'$!{selected_item_id}'||'%')]
		ORDER
		BY		SUBSTR(CD_GRP,10,1), CD
	#elseif("$!{in_sel_gubn}" == "06")	
		/* 유형 */
		SELECT	ITEM_ID,
				ITEM_NAME
		FROM	ITEM_MST, DUAL
		WHERE	ITYPE	IN ('HALB')
		AND		ITEM_ID	LIKE '79%'
		[AND	(ITEM_ID	LIKE '%'||'$!{selected_item_id}'||'%'
						OR ITEM_NAME	LIKE '%'||'$!{selected_item_id}'||'%')]
		ORDER
		BY		ITEM_ID			
	#else
		SELECT	'$!{in_sel_gubn}',''
		FROM	DUAL
		WHERE	1 = 0
	#end

	</query> 

	<!-- 품종Popup  --> 
	<query id="ip_06010_GetItemName" paging="false"> 
	
	#if("$!{in_sel_gubn}" == "01")	
		/* 품목코드,명 */
		SELECT	ITEM_ID,
				ITEM_NAME
		FROM	ITEM_MST, DUAL
		WHERE	ITYPE	IN ('FERT','HAWA')
		AND		ITEM_ID	= '$!{in_item_id}'
		
	#elseif("$!{in_sel_gubn}" == "02")
		/* 사업코드 */
		SELECT	HID			CODE,
				HID_NAME	CODE_NAME
		FROM	HRCHY, DUAL
		WHERE	HTYPE	= '품종분류'
		AND		LVL		= '20'
		AND		HID		= '$!{in_item_id}'
	#elseif("$!{in_sel_gubn}" == "03")	
		/* 브랜드코드 */
		SELECT	HID			CODE,
				HID_NAME	CODE_NAME
		FROM	HRCHY, DUAL
		WHERE	HTYPE	= '품종분류'
		AND		LVL		= '30'
		AND		HID		= '$!{in_item_id}'
	#elseif("$!{in_sel_gubn}" == "04")	
		/* 대표제품 */
		SELECT	HID			CODE,
				HID_NAME	CODE_NAME
		FROM	HRCHY, DUAL
		WHERE	HTYPE	= '품종분류'
		AND		LVL		= '40'
		AND		HID		= '$!{in_item_id}'
	#elseif("$!{in_sel_gubn}" == "05")	
		/* 품종 */
		SELECT	CD CODE,
				DECODE(SUBSTR(CD_GRP,10,1),'1','대_','2','중_','소_')||CD_NAME	CODE_NAME
		FROM	CODE_MST, DUAL
		WHERE	CD_GRP	LIKE 'SALES_CAT%'
		AND		SUBSTR(CD_GRP,10,1)	IN ('1','2','3')
		AND		CD		= '$!{in_item_id}'
	#elseif("$!{in_sel_gubn}" == "06")	
		/* 유형 */
		SELECT	ITEM_ID,
				ITEM_NAME
		FROM	ITEM_MST, DUAL
		WHERE	ITYPE	IN ('HALB')
		AND		ITEM_ID	LIKE '79%'
		AND		ITEM_ID	= '$!{in_item_id}'
	#else
		SELECT	'$!{in_sel_gubn}',''
		FROM	DUAL
		WHERE	1 = 0
	#end

	</query> 

	<!-- 거래처 담당조회  --> 
	<query id="ip_06010_GetCustArea" paging="false"> 

		SELECT	T3.DEPT_NAME,
				T2.EMP_NO||' '||T2.HAN_NAME
		FROM	SDSTT105	T1,
				NCOMT005	T2,
				NCOMT001	T3
		WHERE	PRTN_ROLE	= 'VE'
		AND		T1.PRTN_CUST_CODE	= T2.EMP_NO
		AND		T3.APPL_END_DATE	= '99991231'
		AND		T2.DEPT_CODE		= T3.DEPT_CODE
		AND		T1.CUST_CODE		= '$!{in_cust_code}'
		AND		ROWNUM				= 1

	</query> 

	<!-- 상위영업코드 조회  --> 
	<query id="ip_06010_GetPrioDept" paging="false"> 

		SELECT	DISTINCT	T2.DEPT_CODE, T2.DEPT_NAME
		FROM	SDSTT401	T1,
				SDSTT401	T2
		WHERE	T1.APPL_STRT_YYMM 	&lt;= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
		AND		T1.APPL_END_YYMM	&gt;= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
		AND		T2.APPL_STRT_YYMM 	&lt;= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
		AND		T2.APPL_END_YYMM	&gt;= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
		AND		T1.PRIO_DEPT_CODE	= T2.DEPT_CODE
		AND		T1.DEPT_CODE		= '$!{in_sales_loc}'
		
	</query> 
	
	<!-- 제품/품종별 판매현황조회  --> 
	<query id="ip_06010_ProdSalesAct_list" paging="true"> 

	#if("$!{in_sel_type_special}" == "s01") -- special 조회

		#if("$!{chk_sel_term}" == "D")

			/* 유통본부,거래처유형,배송지점 --> 지점-배송지점-거래처 단위 */
			SELECT	K2.DEPT_CODE,
					K2.DEPT_NAME,
					K3.STOR_CODE,
					F_GETDCNAME(K3.STOR_CODE),
					K1.CUST_ID,
					K3.CUST_NAME			CUST_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY K2.DEPT_CODE),2)          
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	CUST_ID,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	CUST_ID,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM'),'YYYYMMDD')
															AND TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1)),'YYYYMMDD')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")	
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)
							GROUP
							BY		CUST_ID
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	CUST_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.SOLD_PART							CUST_ID,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.SOLD_PART,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							)
					GROUP
					BY		CUST_ID
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					(
					SELECT	T1.CUST_CODE											CUST_ID,
							T2.CUST_NAME											CUST_NAME,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
							NVL(MIN(GRUP_CODE),'99')								GRUP_CODE,
							NVL(MIN(GRUP_CODE1),'99')								GRUP_CODE1
					FROM	SDSTT103	T1,
							SDSTT101	T2
					WHERE	T1.CUST_CODE	= T2.CUST_CODE
					#if("$!{in_sel_type}" == "60") -- 유통본부
						AND		GRUP_CODE = '$!{in_sel_code}'
					#elseif("$!{in_sel_type}" == "70") -- 거래처유형
						AND		GRUP_CODE1 = '$!{in_sel_code}'
					#elseif("$!{in_sel_type}" == "80") -- 배송지점
						AND		STOR_CODE = '$!{in_sel_code}'
					#else
						AND 1=0
					#end
					GROUP
					BY		T1.CUST_CODE,
							T2.CUST_NAME		
					)			K3
			WHERE	K1.CUST_ID		= K3.CUST_ID
			AND		K2.DEPT_CODE	= K3.DEPT_CODE
			HAVING	SUM(PRE_MON_SELL) + SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.DEPT_CODE,
					K2.DEPT_NAME,
					K3.STOR_CODE,
					F_GETDCNAME(K3.STOR_CODE),
					K1.CUST_ID,
					K3.CUST_NAME
			ORDER
			BY		K2.DEPT_CODE, K3.STOR_CODE, K1.CUST_ID

		#else -- 월간

			/* 거래처 단위(월간) */
			SELECT	K2.DEPT_CODE,
					K2.DEPT_NAME,
					K3.STOR_CODE,
					F_GETDCNAME(K3.STOR_CODE),
					K1.CUST_ID,
					K3.CUST_NAME			CUST_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K2.DEPT_CODE),2) 
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	CUST_ID,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							GROUP
							BY		T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		CUST_ID
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					(
					SELECT	T1.CUST_CODE											CUST_ID,
							T2.CUST_NAME											CUST_NAME,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
							NVL(MIN(GRUP_CODE),'99')								GRUP_CODE,
							NVL(MIN(GRUP_CODE1),'99')								GRUP_CODE1
					FROM	SDSTT103	T1,
							SDSTT101	T2
					WHERE	T1.CUST_CODE	= T2.CUST_CODE
					#if("$!{in_sel_type}" == "60") -- 유통본부
						AND		GRUP_CODE = '$!{in_sel_code}'
					#elseif("$!{in_sel_type}" == "70") -- 거래처유형
						AND		GRUP_CODE1 = '$!{in_sel_code}'
					#elseif("$!{in_sel_type}" == "80") -- 배송지점
						AND		STOR_CODE = '$!{in_sel_code}'
					#else
						AND 1=0
					#end
					GROUP
					BY		T1.CUST_CODE,
							T2.CUST_NAME		
					)			K3
			WHERE	K1.CUST_ID		= K3.CUST_ID
			AND		K2.DEPT_CODE	= K3.DEPT_CODE
			HAVING	SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.DEPT_CODE,
					K2.DEPT_NAME,
					K3.STOR_CODE,
					F_GETDCNAME(K3.STOR_CODE),
					K1.CUST_ID,
					K3.CUST_NAME
			ORDER
			BY		K2.DEPT_CODE, K3.STOR_CODE, K1.CUST_ID
		
		#end
		
	#else
	
	#if("$!{chk_sel_term}" == "D")
		/* 일간(D) */
		#if("$!{in_sel_type}" == "20")
	
			/* 사업부단위 조회 */
			SELECT	K4.PRIO_DEPT_CODE,
					f_getSalesLocName(K4.PRIO_DEPT_CODE)	PRIO_DEPT_NAME,
					K4.DEPT_CODE							SALES_LOC,
					f_getSalesLocName(K4.DEPT_CODE)			DEPT_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					K9.MAX_SELL				MAX_SELL,
					K9.STD_DEV				STD_DEV,
					K9.AVG_SELL				AVG_SELL,
					SUM(TOT_CUST)			TOT_CUST,
					SUM(REAL_CUST)			REAL_CUST,
					DECODE(SUM(TOT_CUST),0,0,ROUND(SUM(REAL_CUST)/SUM(TOT_CUST)*100,1))		SUPL_RATE,
					SUM(GOAL_BOX)			GOAL_BOX,
					SUM(PLAN_BOX)			PLAN_BOX,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(RANK() OVER (ORDER BY K4.PRIO_DEPT_CODE,K4.DEPT_CODE),2)         
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	SALES_LOC,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	SALES_LOC,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
															)
									AND		D1.ITEM_ID		= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)
							GROUP
							BY		SALES_LOC
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.SALES_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
												SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
															)
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.SALES_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.DEPT_CODE							SALES_LOC,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.DEPT_CODE,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							)
					GROUP
					BY		SALES_LOC
					UNION	ALL
					/* 총거래처, 실적거래처, 취급율 */
					SELECT	S1.SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							S1.TOT_CUST										TOT_CUST,
							NVL(S2.REAL_CUST,0)								REAL_CUST,
							ROUND(NVL(S2.REAL_CUST,0)/S1.TOT_CUST*100,1)	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31   
					FROM	(
							SELECT	DEPT_CODE			SALES_LOC,
									COUNT(CUST_CODE)	TOT_CUST
							FROM	SDSTT103
							WHERE	TRAD_STOP_DATE	= '99991231'
							GROUP
							BY		DEPT_CODE
							)	S1,
							(
							SELECT	DEPT_CODE			SALES_LOC,
									COUNT(CUST_CODE)	REAL_CUST
							FROM	(		
									SELECT	DISTINCT	DEPT_CODE, CUST_CODE
									FROM	(
											SELECT	DISTINCT T1.PROD_CODE, T1.CUST_CODE, T1.DEPT_CODE		
											FROM	SDRDT103	T1
											WHERE	T1.CNFM_DATE	IN
																	(
																	SELECT	YYYYMMDD
																	FROM	CAL_MST
																	WHERE	YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																	)
											AND		T1.SELL_GUBN_CODE	= '01'
											AND		SELL_BOX &gt; 0
											)	K1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)	K2
									WHERE	K1.PROD_CODE	= K2.ITEM_ID
									)
							GROUP
							BY		DEPT_CODE	
							)	S2,
							SDSTT401	S3
					WHERE	S1.SALES_LOC	= S2.SALES_LOC(+)
					AND		S1.SALES_LOC	= S3.DEPT_CODE
					AND		S3.APPL_END_YYMM	= '999912'
					AND		S3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
					UNION	ALL
					SELECT	SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							SUM(GOAL_BOX)	GOAL_BOX,
							SUM(PLAN_BOX)	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31 
					FROM	(		
							/* 당월목표 */
							SELECT	DEPT_CODE		SALES_LOC,
									SUM(GOAL_BOX)	GOAL_BOX,
									0				PLAN_BOX
							FROM	SDPLT102	D1,
									(
									SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
									FROM	ITEM_HIST	T1,
											ITEM_MST	T2
									WHERE	END_DATE(+)	= '99991231'
									AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
								#if("$!{in_sel_gubn}" == "01")	
									AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
								#elseif("$!{in_sel_gubn}" == "05")
									AND		(--품종 대중소
											('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
											OR
											('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
											OR
											('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
											)
								#else
									AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
								#end
									)			D2
							WHERE	CNFM_YYMM	= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
							AND		D1.PROD_CODE	= D2.ITEM_ID
							GROUP
							BY		DEPT_CODE
							UNION	ALL
							/* 판매계획 */
							SELECT	S1.SALES_LOC,
									0											GOAL_BOX,
									SUM(NORMAL_QTY+PROM_QTY+SUPT_QTY+SAMP_QTY)	PLAN_BOX
							FROM	NFOS_SALES_PLAN_WEEKLY	S1,
									(
									SELECT	YYYY, VERSION, YYYYMMDD
									FROM	V_NFOS_PLAN_VERSION
									WHERE	CAL_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)						S2
							WHERE	S1.YYYY		= S2.YYYY
							AND		S1.VERSION	= S2.VERSION
							AND		S1.YYYYMMDD	= S2.YYYYMMDD
							AND		S1.ITEM_ID	IN
												(
												SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
												FROM	ITEM_HIST	T1,
														ITEM_MST	T2
												WHERE	END_DATE(+)	= '99991231'
												AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
											#if("$!{in_sel_gubn}" == "01")	
												AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
											#elseif("$!{in_sel_gubn}" == "05")
												AND		(--품종 대중소
														('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
														)
											#else
												AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
											#end
												)
							GROUP
							BY		S1.SALES_LOC
							)
					GROUP
					BY		SALES_LOC
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					SDSTT401	K3,
					SDSTT401	K4,
					(
					/* 기간 최대판매, 표준편차, 평균판매 */
					SELECT	DEPT_CODE,
							MAX(SUM_BOX)				MAX_SELL,
							ROUND(STDDEV(SUM_BOX),0)	STD_DEV,
							ROUND(AVG(SUM_BOX),0)		AVG_SELL
					FROM	(	
							SELECT	K4.DEPT_CODE,
									K1.SALE_DATE,
									SUM(SUM_BOX)			SUM_BOX
							FROM	(
									/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(SELL_BOX)	SUM_BOX
									FROM	(				
											/* 실적에서 조회 */
											SELECT	T1.SALES_LOC,
													T1.SALE_DATE,
													NVL(T2.QTY,0)		SELL_BOX
											FROM	(
													SELECT	CAL_DATE	SALE_DATE,
															SALES_LOC
													FROM	CAL_MST,
															(
															SELECT	DEPT_CODE	SALES_LOC
															FROM	SDSTT401
															WHERE	APPL_END_YYMM	= '999912'
															AND		DEPT_GRAD_CODE	= '40'
															AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
															)
													WHERE	HOLIDAY_FLAG	IS NULL
													AND		CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
													AND		CAL_DATE		&lt; TRUNC(SYSDATE)
													)		T1,
													(
													SELECT	SALES_LOC,
															SALE_DATE,
															SUM(QTY)	QTY
													FROM	SALES_ACT	D1,
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)			D2
													WHERE	D1.DOMAIN IN ('DO','EX')
													AND		SALE_DATE	IN (
																			SELECT	CAL_DATE
																			FROM	CAL_MST
																			WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
																			)
													AND		D1.ITEM_ID	= D2.ITEM_ID
												#if("$!{in_act_type}" != "00")
													AND		ACT_TYPE	= '$!{in_act_type}'
												#end
													GROUP
													BY		SALES_LOC,
															SALE_DATE
													)		T2
											WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
											AND		T1.SALES_LOC	= T2.SALES_LOC(+)
											UNION	ALL
											/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
											SELECT	T1.SALES_LOC,
													T1.SALE_DATE,
													NVL(T2.QTY,0)		SELL_BOX
											FROM	(
													SELECT	CAL_DATE	SALE_DATE,
															SALES_LOC
													FROM	CAL_MST,
															(
															SELECT	DEPT_CODE	SALES_LOC
															FROM	SDSTT401
															WHERE	APPL_END_YYMM	= '999912'
															AND		DEPT_GRAD_CODE	= '40'
															AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
															)
													WHERE	HOLIDAY_FLAG	IS NULL
													AND		CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
													)		T1,
													(
													SELECT  A.DEPT_CODE							SALES_LOC,
															TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
															SUM(
																CASE
																WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
																	CASE
																	WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
																		DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
																	ELSE
																		-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
																	END
																ELSE
																	DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
																END
															)									QTY        
													FROM    SDORT101    A,
															SDORT102    B,
															(
															SELECT	CODE		ITEM_CATG,
																	CODE_NAME4	SIGN1
															FROM	SDSTT500
															WHERE	CODE_GUBN	= 'OR103'
															AND		CODE_NAME2	= 'Y'
															AND		CODE_NAME3	= '01'
															)			D
													WHERE   A.SLIP_NO		= B.SLIP_NO
													AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
													AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
													AND		B.ITEM_CATG			= D.ITEM_CATG(+)
													AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
													AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
													AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
													#if("$!{in_act_type}" == '01')		-- 일반
														AND		NVL(D.ITEM_CATG,'TA') != 'TA'
													#elseif("$!{in_act_type}" == '02') -- 타계정
														AND		NVL(D.ITEM_CATG,'TA') = 'TA'
													#end
													GROUP 
													BY		A.DEPT_CODE,
															A.CNFM_DATE,
															D.ITEM_CATG	
													)		T2
											WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
											AND		T1.SALES_LOC	= T2.SALES_LOC(+)
											)
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)			K1,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			K2,
									SDSTT401	K3,
									SDSTT401	K4
							WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
							AND		K2.PRIO_DEPT_CODE	= K3.DEPT_CODE
							AND		K3.APPL_END_YYMM	= '999912'
							AND		K3.DEPT_GRAD_CODE	= '30'
							AND		K3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */		
							AND		K3.PRIO_DEPT_CODE	= K4.DEPT_CODE
							AND		K4.APPL_END_YYMM	= '999912'
							AND		K4.DEPT_GRAD_CODE	= '20'
							AND		K4.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
							GROUP
							BY		K4.DEPT_CODE,
									K1.SALE_DATE
							)
					GROUP
					BY		DEPT_CODE			
					)			K9
			WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
			AND		K2.PRIO_DEPT_CODE	= K3.DEPT_CODE
			AND		K3.APPL_END_YYMM	= '999912'
			AND		K3.DEPT_GRAD_CODE	= '30'
			AND		K3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */		
			AND		K3.PRIO_DEPT_CODE	= K4.DEPT_CODE
			AND		K4.APPL_END_YYMM	= '999912'
			AND		K4.DEPT_GRAD_CODE	= '20'
			AND		K4.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
			AND		K4.DEPT_CODE		= K9.DEPT_CODE
			GROUP
			BY		K4.PRIO_DEPT_CODE,
					K4.DEPT_CODE,
					K9.MAX_SELL,
					K9.STD_DEV,
					K9.AVG_SELL
			ORDER
			BY		K4.PRIO_DEPT_CODE,
					K4.DEPT_CODE	
	
		#elseif("$!{in_sel_type}" == "30")
	
			/* 영업부단위 조회 */
			SELECT	K3.PRIO_DEPT_CODE,
					f_getSalesLocName(K3.PRIO_DEPT_CODE)	PRIO_DEPT_NAME,
					K3.DEPT_CODE							SALES_LOC,
					f_getSalesLocName(K3.DEPT_CODE)			DEPT_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					K9.MAX_SELL				MAX_SELL,
					K9.STD_DEV				STD_DEV,
					K9.AVG_SELL				AVG_SELL,
					SUM(TOT_CUST)			TOT_CUST,
					SUM(REAL_CUST)			REAL_CUST,
					DECODE(SUM(TOT_CUST),0,0,ROUND(SUM(REAL_CUST)/SUM(TOT_CUST)*100,1))		SUPL_RATE,
					SUM(GOAL_BOX)			GOAL_BOX,
					SUM(PLAN_BOX)			PLAN_BOX,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY K3.PRIO_DEPT_CODE),2)         
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	SALES_LOC,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	SALES_LOC,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
															)
									AND		D1.ITEM_ID		= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)
							GROUP
							BY		SALES_LOC
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.SALES_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
															)
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.SALES_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.DEPT_CODE							SALES_LOC,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.DEPT_CODE,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							)
					GROUP
					BY		SALES_LOC
					UNION	ALL
					/* 총거래처, 실적거래처, 취급율 */
					SELECT	S1.SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							S1.TOT_CUST										TOT_CUST,
							NVL(S2.REAL_CUST,0)								REAL_CUST,
							ROUND(NVL(S2.REAL_CUST,0)/S1.TOT_CUST*100,1)	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31   
					FROM	(
							SELECT	DEPT_CODE			SALES_LOC,
									COUNT(CUST_CODE)	TOT_CUST
							FROM	SDSTT103
							WHERE	TRAD_STOP_DATE	= '99991231'
							GROUP
							BY		DEPT_CODE
							)	S1,
							(
							SELECT	DEPT_CODE			SALES_LOC,
									COUNT(CUST_CODE)	REAL_CUST
							FROM	(		
									SELECT	DISTINCT	DEPT_CODE, CUST_CODE
									FROM	(
											SELECT	DISTINCT T1.PROD_CODE, T1.CUST_CODE, T1.DEPT_CODE		
											FROM	SDRDT103	T1
											WHERE	T1.CNFM_DATE	IN
																	(
																	SELECT	YYYYMMDD
																	FROM	CAL_MST
																	WHERE	YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																	)
											AND		T1.SELL_GUBN_CODE	= '01'
											AND		SELL_BOX &gt; 0
											)	K1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)	K2
									WHERE	K1.PROD_CODE	= K2.ITEM_ID
									)
							GROUP
							BY		DEPT_CODE
							)	S2,
							SDSTT401	S3
					WHERE	S1.SALES_LOC	= S2.SALES_LOC(+)
					AND		S1.SALES_LOC	= S3.DEPT_CODE
					AND		S3.APPL_END_YYMM	= '999912'
					AND		S3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
					UNION	ALL
					SELECT	SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							SUM(GOAL_BOX)	GOAL_BOX,
							SUM(PLAN_BOX)	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31 
					FROM	(		
							/* 당월목표 */
							SELECT	DEPT_CODE		SALES_LOC,
									SUM(GOAL_BOX)	GOAL_BOX,
									0				PLAN_BOX
							FROM	SDPLT102	D1,
									(
									SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
									FROM	ITEM_HIST	T1,
											ITEM_MST	T2
									WHERE	END_DATE(+)	= '99991231'
									AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
								#if("$!{in_sel_gubn}" == "01")	
									AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
								#elseif("$!{in_sel_gubn}" == "05")
									AND		(--품종 대중소
											('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
											OR
											('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
											OR
											('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
											)
								#else
									AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
								#end
									)			D2
							WHERE	CNFM_YYMM	= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
							AND		D1.PROD_CODE	= D2.ITEM_ID
							GROUP
							BY		DEPT_CODE
							UNION	ALL
							/* 판매계획 */
							SELECT	S1.SALES_LOC,
									0											GOAL_BOX,
									SUM(NORMAL_QTY+PROM_QTY+SUPT_QTY+SAMP_QTY)	PLAN_BOX
							FROM	NFOS_SALES_PLAN_WEEKLY	S1,
									(
									SELECT	YYYY, VERSION, YYYYMMDD
									FROM	V_NFOS_PLAN_VERSION
									WHERE	CAL_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)						S2
							WHERE	S1.YYYY		= S2.YYYY
							AND		S1.VERSION	= S2.VERSION
							AND		S1.YYYYMMDD	= S2.YYYYMMDD
							AND		S1.ITEM_ID	IN
												(
												SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
												FROM	ITEM_HIST	T1,
														ITEM_MST	T2
												WHERE	END_DATE(+)	= '99991231'
												AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
											#if("$!{in_sel_gubn}" == "01")	
												AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
											#elseif("$!{in_sel_gubn}" == "05")
												AND		(--품종 대중소
														('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
														)
											#else
												AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
											#end
												)
							GROUP
							BY		S1.SALES_LOC
							)
					GROUP
					BY		SALES_LOC
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					SDSTT401	K3,
					(
					/* 기간 최대판매, 표준편차, 평균판매 */
					SELECT	DEPT_CODE,
							MAX(SUM_BOX)				MAX_SELL,
							ROUND(STDDEV(SUM_BOX),0)	STD_DEV,
							ROUND(AVG(SUM_BOX),0)		AVG_SELL
					FROM	(	
							SELECT	K3.DEPT_CODE,
									K1.SALE_DATE,
									SUM(SUM_BOX)			SUM_BOX
							FROM	(
									/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(SELL_BOX)	SUM_BOX
									FROM	(				
											/* 실적에서 조회 */
											SELECT	T1.SALES_LOC,
													T1.SALE_DATE,
													NVL(T2.QTY,0)		SELL_BOX
											FROM	(
													SELECT	CAL_DATE	SALE_DATE,
															SALES_LOC
													FROM	CAL_MST,
															(
															SELECT	DEPT_CODE	SALES_LOC
															FROM	SDSTT401
															WHERE	APPL_END_YYMM	= '999912'
															AND		DEPT_GRAD_CODE	= '40'
															AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
															)
													WHERE	HOLIDAY_FLAG	IS NULL
													AND		CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
													AND		CAL_DATE		&lt; TRUNC(SYSDATE)
													)		T1,
													(
													SELECT	SALES_LOC,
															SALE_DATE,
															SUM(QTY)	QTY
													FROM	SALES_ACT	D1,
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)			D2
													WHERE	D1.DOMAIN IN ('DO','EX')
													AND		SALE_DATE	IN (
																			SELECT	CAL_DATE
																			FROM	CAL_MST
																			WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
																			)
													AND		D1.ITEM_ID	= D2.ITEM_ID
												#if("$!{in_act_type}" != "00")
													AND		ACT_TYPE	= '$!{in_act_type}'
												#end
													GROUP
													BY		SALES_LOC,
															SALE_DATE
													)		T2
											WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
											AND		T1.SALES_LOC	= T2.SALES_LOC(+)
											UNION	ALL
											/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
											SELECT	T1.SALES_LOC,
													T1.SALE_DATE,
													NVL(T2.QTY,0)		SELL_BOX
											FROM	(
													SELECT	CAL_DATE	SALE_DATE,
															SALES_LOC
													FROM	CAL_MST,
															(
															SELECT	DEPT_CODE	SALES_LOC
															FROM	SDSTT401
															WHERE	APPL_END_YYMM	= '999912'
															AND		DEPT_GRAD_CODE	= '40'
															AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
															)
													WHERE	HOLIDAY_FLAG	IS NULL
													AND		CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
													)		T1,
													(
													SELECT  A.DEPT_CODE							SALES_LOC,
															TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
															SUM(
																CASE
																WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
																	CASE
																	WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
																		DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
																	ELSE
																		-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
																	END
																ELSE
																	DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
																END
															)									QTY        
													FROM    SDORT101    A,
															SDORT102    B,
															(
															SELECT	CODE		ITEM_CATG,
																	CODE_NAME4	SIGN1
															FROM	SDSTT500
															WHERE	CODE_GUBN	= 'OR103'
															AND		CODE_NAME2	= 'Y'
															AND		CODE_NAME3	= '01'
															)			D
													WHERE   A.SLIP_NO		= B.SLIP_NO
													AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
													AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
													AND		B.ITEM_CATG			= D.ITEM_CATG(+)
													AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
													AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
													AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
													#if("$!{in_act_type}" == '01')		-- 일반
														AND		NVL(D.ITEM_CATG,'TA') != 'TA'
													#elseif("$!{in_act_type}" == '02') -- 타계정
														AND		NVL(D.ITEM_CATG,'TA') = 'TA'
													#end
													GROUP 
													BY		A.DEPT_CODE,
															A.CNFM_DATE,
															D.ITEM_CATG	
													)		T2
											WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
											AND		T1.SALES_LOC	= T2.SALES_LOC(+)
											)
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)			K1,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			K2,
									SDSTT401	K3
							WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
							AND		K2.PRIO_DEPT_CODE	= K3.DEPT_CODE
							AND		K3.APPL_END_YYMM	= '999912'
							AND		K3.DEPT_GRAD_CODE	= '30'
							AND		K3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */		
							GROUP
							BY		K3.DEPT_CODE,
									K1.SALE_DATE
							)
					GROUP
					BY		DEPT_CODE			
					)			K9
			WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
			AND		K2.PRIO_DEPT_CODE	= K3.DEPT_CODE
			AND		K3.APPL_END_YYMM	= '999912'
			AND		K3.DEPT_GRAD_CODE	= '30'
			AND		K3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */		
			AND		K3.DEPT_CODE		= K9.DEPT_CODE
			GROUP
			BY		K3.PRIO_DEPT_CODE,
					K3.DEPT_CODE,
					K9.MAX_SELL,
					K9.STD_DEV,
					K9.AVG_SELL
			ORDER
			BY		K3.PRIO_DEPT_CODE,
					K3.DEPT_CODE
		
		#elseif("$!{in_sel_type}" == "40")
		
			/* 지점단위 조회 */
			SELECT	K2.PRIO_DEPT_CODE,
					f_getSalesLocName(K2.PRIO_DEPT_CODE)	PRIO_DEPT_NAME,
					K1.SALES_LOC,
					f_getSalesLocName(K1.SALES_LOC)			DEPT_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(TOT_CUST)			TOT_CUST,
					SUM(REAL_CUST)			REAL_CUST,
					SUM(SUPL_RATE)			SUPL_RATE,
					SUM(GOAL_BOX)			GOAL_BOX,
					SUM(PLAN_BOX)			PLAN_BOX,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY K2.PRIO_DEPT_CODE),2)         
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	SALES_LOC,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	SALES_LOC,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
															)
									AND		D1.ITEM_ID		= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)
							GROUP
							BY		SALES_LOC
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.SALES_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
															)
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.SALES_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.DEPT_CODE							SALES_LOC,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.DEPT_CODE,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							)
					GROUP
					BY		SALES_LOC
					UNION	ALL
					/* 총거래처, 실적거래처, 취급율 */
					SELECT	S1.SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							S1.TOT_CUST										TOT_CUST,
							NVL(S2.REAL_CUST,0)								REAL_CUST,
							ROUND(NVL(S2.REAL_CUST,0)/S1.TOT_CUST*100,1)	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31   
					FROM	(
							SELECT	DEPT_CODE			SALES_LOC,
									COUNT(CUST_CODE)	TOT_CUST
							FROM	SDSTT103
							WHERE	TRAD_STOP_DATE	= '99991231'
							GROUP
							BY		DEPT_CODE
							)	S1,
							(
							SELECT	DEPT_CODE			SALES_LOC,
									COUNT(CUST_CODE)	REAL_CUST
							FROM	(		
									SELECT	DISTINCT	DEPT_CODE, CUST_CODE
									FROM	(
											SELECT	DISTINCT T1.PROD_CODE, T1.CUST_CODE, T1.DEPT_CODE		
											FROM	SDRDT103	T1
											WHERE	T1.CNFM_DATE	IN
																	(
																	SELECT	YYYYMMDD
																	FROM	CAL_MST
																	WHERE	YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																	)
											AND		T1.SELL_GUBN_CODE	= '01'
											AND		SELL_BOX &gt; 0
											)	K1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)	K2
									WHERE	K1.PROD_CODE	= K2.ITEM_ID
									)
							GROUP
							BY		DEPT_CODE
							)	S2,
							SDSTT401	S3
					WHERE	S1.SALES_LOC	= S2.SALES_LOC(+)
					AND		S1.SALES_LOC	= S3.DEPT_CODE
					AND		S3.APPL_END_YYMM	= '999912'
					AND		S3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
					UNION	ALL
					SELECT	SALES_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							SUM(GOAL_BOX)	GOAL_BOX,
							SUM(PLAN_BOX)	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31 
					FROM	(		
							/* 당월목표 */
							SELECT	DEPT_CODE		SALES_LOC,
									SUM(GOAL_BOX)	GOAL_BOX,
									0				PLAN_BOX
							FROM	SDPLT102	D1,
									(
									SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
									FROM	ITEM_HIST	T1,
											ITEM_MST	T2
									WHERE	END_DATE(+)	= '99991231'
									AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
								#if("$!{in_sel_gubn}" == "01")	
									AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
								#elseif("$!{in_sel_gubn}" == "05")
									AND		(--품종 대중소
											('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
											OR
											('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
											OR
											('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
											)
								#else
									AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
								#end
									)			D2
							WHERE	CNFM_YYMM	= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
							AND		D1.PROD_CODE	= D2.ITEM_ID
							GROUP
							BY		DEPT_CODE
							UNION	ALL
							/* 판매계획 */
							SELECT	S1.SALES_LOC,
									0											GOAL_BOX,
									SUM(NORMAL_QTY+PROM_QTY+SUPT_QTY+SAMP_QTY)	PLAN_BOX
							FROM	NFOS_SALES_PLAN_WEEKLY	S1,
									(
									SELECT	YYYY, VERSION, YYYYMMDD
									FROM	V_NFOS_PLAN_VERSION
									WHERE	CAL_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)						S2
							WHERE	S1.YYYY		= S2.YYYY
							AND		S1.VERSION	= S2.VERSION
							AND		S1.YYYYMMDD	= S2.YYYYMMDD
							AND		S1.ITEM_ID	IN
												(
												SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
												FROM	ITEM_HIST	T1,
														ITEM_MST	T2
												WHERE	END_DATE(+)	= '99991231'
												AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
											#if("$!{in_sel_gubn}" == "01")	
												AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
											#elseif("$!{in_sel_gubn}" == "05")
												AND		(--품종 대중소
														('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
														)
											#else
												AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
											#end
												)
							GROUP
							BY		S1.SALES_LOC
							)
					GROUP
					BY		SALES_LOC
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2
			WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
			--HAVING	SUM(PRE_MON_SELL) + SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.PRIO_DEPT_CODE,
					K1.SALES_LOC
			ORDER
			BY		K2.PRIO_DEPT_CODE,
					K1.SALES_LOC
		
		#elseif("$!{in_sel_type}" == "50")	
		
			/* 거래처 단위 */
			SELECT	K2.DEPT_CODE,
					K2.DEPT_NAME,
					K1.CUST_ID,
					K3.CUST_NAME			CUST_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY K2.DEPT_CODE),2)          
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	CUST_ID,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	CUST_ID,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM'),'YYYYMMDD')
															AND TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1)),'YYYYMMDD')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)
							GROUP
							BY		CUST_ID
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	CUST_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.SOLD_PART							CUST_ID,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.SOLD_PART,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							)
					GROUP
					BY		CUST_ID
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					(
					/* 지점-거래처-출고장 MAPPING */
					SELECT	T1.CUST_CODE											CUST_ID,
							T2.CUST_NAME											CUST_NAME,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
							NVL(MIN(GRUP_CODE1),'99')								GRUP_CODE1
					FROM	SDSTT103	T1,
							SDSTT101	T2
					WHERE	T1.CUST_CODE	= T2.CUST_CODE
					GROUP
					BY		T1.CUST_CODE,
							T2.CUST_NAME		
					)			K3
			WHERE	K1.CUST_ID		= K3.CUST_ID
			AND		K2.DEPT_CODE	= K3.DEPT_CODE
			HAVING	SUM(PRE_MON_SELL) + SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.DEPT_CODE,
					K2.DEPT_NAME,
					K1.CUST_ID,
					K3.CUST_NAME
			ORDER
			BY		SUM_BOX DESC  --거래처는 기간합기준으로 SORT	
		
		#elseif("$!{in_sel_type}" == "60")
		
			/* 유통본부 단위 */
			SELECT	K3.GRUP_CODE1,
					f_get_code_name('GRUP_CODE1',K3.GRUP_CODE1)			CUST_NAME,
					NVL(SUM(PRE_MON_SELL)	,0)		PRE_MON_SELL,
					NVL(SUM(PRE_MEAN_SELL)	,0)		PRE_MEAN_SELL,
					NVL(SUM(PRE_MAX_SELL)	,0)		PRE_MAX_SELL,
					NVL(K9.MAX_SELL			,0)		MAX_SELL,
					NVL(K9.STD_DEV			,0)		STD_DEV,
					NVL(K9.AVG_SELL			,0)		AVG_SELL,
					NVL(SUM(SUM_BOX)		,0)		SUM_BOX,
					NVL(SUM(D01)			,0)		D01,
					NVL(SUM(D02)			,0)		D02,
					NVL(SUM(D03)			,0)		D03,
					NVL(SUM(D04)			,0)		D04,
					NVL(SUM(D05)			,0)		D05,
					NVL(SUM(D06)			,0)		D06,
					NVL(SUM(D07)			,0)		D07,
					NVL(SUM(D08)			,0)		D08,
					NVL(SUM(D09)			,0)		D09,
					NVL(SUM(D10)			,0)		D10,
					NVL(SUM(D11)			,0)		D11,
					NVL(SUM(D12)			,0)		D12,
					NVL(SUM(D13)			,0)		D13,
					NVL(SUM(D14)			,0)		D14,
					NVL(SUM(D15)			,0)		D15,
					NVL(SUM(D16)			,0)		D16,
					NVL(SUM(D17)			,0)		D17,
					NVL(SUM(D18)			,0)		D18,
					NVL(SUM(D19)			,0)		D19,
					NVL(SUM(D20)			,0)		D20,
					NVL(SUM(D21)			,0)		D21,
					NVL(SUM(D22)			,0)		D22,
					NVL(SUM(D23)			,0)		D23,
					NVL(SUM(D24)			,0)		D24,
					NVL(SUM(D25)			,0)		D25,
					NVL(SUM(D26)			,0)		D26,
					NVL(SUM(D27)			,0)		D27,
					NVL(SUM(D28)			,0)		D28,
					NVL(SUM(D29)			,0)		D29,
					NVL(SUM(D30)			,0)		D30,
					NVL(SUM(D31)            ,0)	    D31,
					MOD(DENSE_RANK() OVER (ORDER BY K3.GRUP_CODE1),2)             
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	CUST_ID,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	CUST_ID,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM'),'YYYYMMDD')
															AND TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1)),'YYYYMMDD')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)
							GROUP
							BY		CUST_ID
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	CUST_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.SOLD_PART							CUST_ID,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.SOLD_PART,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							)
					GROUP
					BY		CUST_ID
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					(
					/* 지점-거래처-출고장-유통본부 MAPPING */
					SELECT	T1.CUST_CODE											CUST_ID,
							T2.CUST_NAME											CUST_NAME,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
							MIN(T2.GRUP_CODE)										GRUP_CODE1
					FROM	SDSTT103	T1,
							SDSTT101	T2
					WHERE	T1.CUST_CODE	= T2.CUST_CODE
					AND		TRIM(GRUP_CODE)	IN (
							SELECT	CODE
							FROM	SDSTT500
							WHERE	CODE_GUBN	= 'ST115')
					GROUP
					BY		T1.CUST_CODE,
							T2.CUST_NAME		
					)			K3,
					(
					/* 기간 최대판매, 표준편차, 기간평균 */
					SELECT	GRUP_CODE1,
							MAX(SUM_BOX)				MAX_SELL,
							ROUND(STDDEV(SUM_BOX),0)	STD_DEV,
							ROUND(AVG(SUM_BOX),0)		AVG_SELL
					FROM	(
							SELECT	K3.GRUP_CODE1,
									K1.SALE_DATE,
									SUM(SELL_BOX)			SUM_BOX     
							FROM	(
									/* 실적에서 조회 */
									SELECT	T1.CUST_ID,
											T1.SALE_DATE,
											NVL(T2.QTY,0)		SELL_BOX
									FROM	(
											SELECT	CAL_DATE	SALE_DATE,
													CUST_ID
											FROM	CAL_MST,
													(
													/* 거래처코드 */
													SELECT	CUST_CODE	CUST_ID
													FROM	SDSTT101
													)
											WHERE	HOLIDAY_FLAG	IS NULL
											AND		CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
											AND		CAL_DATE		&lt; TRUNC(SYSDATE)
											)		T1,
											(
										#if("$!{in_act_type}" != "02")
											/* 영업 일반실적 */
											SELECT	CUST_CODE	CUST_ID,
													TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
													SUM(SELL_BOX)	QTY
											FROM	SDRDT103	D1
											WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
											AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
											AND		SELL_GUBN_CODE	= '01'
											GROUP
											BY		CUST_CODE,
													TO_DATE(CNFM_DATE,'YYYY-MM-DD')
										#end
										#if("$!{in_act_type}" == "00")
											UNION	ALL
										#end
										#if("$!{in_act_type}" != "01")
											/* 거래처 타계정 실적 */
											SELECT	CUST_ID,
													SALE_DATE,
													SUM(QTY)	QTY
											FROM	CUST_ETC_ACT	D1,
													(
													SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	END_DATE(+)	= '99991231'
													AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
												#if("$!{in_sel_gubn}" == "01")	
													AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
												#elseif("$!{in_sel_gubn}" == "05")
													AND		(--품종 대중소
															('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
															OR
															('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
															OR
															('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
															)
												#else
													AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
												#end
													)				D2
											WHERE	SALE_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
											AND		D1.ITEM_ID	= D2.ITEM_ID
											GROUP
											BY		CUST_ID,
													SALE_DATE
										#end
											)		T2
									WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
									AND		T1.CUST_ID		= T2.CUST_ID(+)
									UNION	ALL
									/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
									SELECT	T1.CUST_ID,
											T1.SALE_DATE,
											NVL(T2.QTY,0)		SELL_BOX
									FROM	(
											SELECT	CAL_DATE	SALE_DATE,
													CUST_ID
											FROM	CAL_MST,
													(
													/* 거래처코드 */
													SELECT	CUST_CODE	CUST_ID
													FROM	SDSTT101
													)
											WHERE	HOLIDAY_FLAG	IS NULL
											AND		CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
											)		T1,
											(
											SELECT  A.SOLD_PART							CUST_ID,
													TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
													SUM(
														CASE
														WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
															CASE
															WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
																DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
															ELSE
																-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
															END
														ELSE
															DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
														END
													)									QTY        
											FROM    SDORT101    A,
													SDORT102    B,
													(
													SELECT	CODE		ITEM_CATG,
															CODE_NAME4	SIGN1
													FROM	SDSTT500
													WHERE	CODE_GUBN	= 'OR103'
													AND		CODE_NAME2	= 'Y'
													AND		CODE_NAME3	= '01'
													)			D
											WHERE   A.SLIP_NO		= B.SLIP_NO
											AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
											AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
											AND		B.ITEM_CATG			= D.ITEM_CATG(+)
											AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
											AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
											AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
											#if("$!{in_act_type}" == '01')		-- 일반
												AND		NVL(D.ITEM_CATG,'TA') != 'TA'
											#elseif("$!{in_act_type}" == '02') -- 타계정
												AND		NVL(D.ITEM_CATG,'TA') = 'TA'
											#end
											GROUP 
											BY		A.SOLD_PART,
													A.CNFM_DATE,
													D.ITEM_CATG	
											)		T2
									WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
									AND		T1.CUST_ID		= T2.CUST_ID(+)
									)			K1,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			K2,
									(
									/* 지점-거래처-출고장-유통본부 MAPPING */
									SELECT	T1.CUST_CODE											CUST_ID,
											T2.CUST_NAME											CUST_NAME,
											NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
											NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
											MIN(T2.GRUP_CODE)										GRUP_CODE1
									FROM	SDSTT103	T1,
											SDSTT101	T2
									WHERE	T1.CUST_CODE	= T2.CUST_CODE
									AND		TRIM(GRUP_CODE)	IN (
											SELECT	CODE
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'ST115')
									GROUP
									BY		T1.CUST_CODE,
											T2.CUST_NAME		
									)			K3
							WHERE	K1.CUST_ID		= K3.CUST_ID
							AND		K2.DEPT_CODE	= K3.DEPT_CODE
							GROUP
							BY		K3.GRUP_CODE1,
									K1.SALE_DATE
							)
					GROUP
					BY		GRUP_CODE1
					)			K9
			WHERE	K1.CUST_ID		= K3.CUST_ID
			AND		K2.DEPT_CODE	= K3.DEPT_CODE
			AND		K3.GRUP_CODE1	= K9.GRUP_CODE1
			GROUP
			BY		K3.GRUP_CODE1,
					K9.MAX_SELL,
					K9.STD_DEV,
					K9.AVG_SELL
			ORDER
			BY		K3.GRUP_CODE1 
		
		#elseif("$!{in_sel_type}" == "70")
		
			/* 거래처유형 단위 */
			SELECT	K3.CUST_TYPE,
					f_get_code_name('FCST_GRPCD',K3.CUST_TYPE)			CUST_TYPE_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					K9.MAX_SELL				MAX_SELL,
					K9.STD_DEV				STD_DEV,
					K9.AVG_SELL				AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY K3.CUST_TYPE),2)         
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	CUST_ID,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	CUST_ID,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM'),'YYYYMMDD')
															AND TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1)),'YYYYMMDD')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)
							GROUP
							BY		CUST_ID
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	CUST_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.CUST_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.SOLD_PART							CUST_ID,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.SOLD_PART,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							)
					GROUP
					BY		CUST_ID
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					(
					/* 지점-거래처-출고장-거래처유형 MAPPING */
					SELECT	T1.CUST_CODE											CUST_ID,
							T2.CUST_NAME											CUST_NAME,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
							NVL(MIN(GRUP_CODE1),'99')								CUST_TYPE
					FROM	SDSTT103	T1,
							SDSTT101	T2
					WHERE	T1.CUST_CODE	= T2.CUST_CODE
					GROUP
					BY		T1.CUST_CODE,
							T2.CUST_NAME		
					)			K3,
					(
					/* 기간 최대판매, 표준편차, 기간평균 */
					SELECT	CUST_TYPE,
							MAX(SUM_BOX)				MAX_SELL,
							ROUND(STDDEV(SUM_BOX),0)	STD_DEV,
							ROUND(AVG(SUM_BOX),0)		AVG_SELL
					FROM	(
							SELECT	K3.CUST_TYPE,
									K1.SALE_DATE,
									SUM(SELL_BOX)			SUM_BOX     
							FROM	(
									/* 실적에서 조회 */
									SELECT	T1.CUST_ID,
											T1.SALE_DATE,
											NVL(T2.QTY,0)		SELL_BOX
									FROM	(
											SELECT	CAL_DATE	SALE_DATE,
													CUST_ID
											FROM	CAL_MST,
													(
													/* 거래처코드 */
													SELECT	CUST_CODE	CUST_ID
													FROM	SDSTT101
													)
											WHERE	HOLIDAY_FLAG	IS NULL
											AND		CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
											AND		CAL_DATE		&lt; TRUNC(SYSDATE)
											)		T1,
											(
										#if("$!{in_act_type}" != "02")
											/* 영업 일반실적 */
											SELECT	CUST_CODE	CUST_ID,
													TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
													SUM(SELL_BOX)	QTY
											FROM	SDRDT103	D1
											WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
											AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
											AND		SELL_GUBN_CODE	= '01'
											GROUP
											BY		CUST_CODE,
													TO_DATE(CNFM_DATE,'YYYY-MM-DD')
										#end
										#if("$!{in_act_type}" == "00")
											UNION	ALL
										#end
										#if("$!{in_act_type}" != "01")
											/* 거래처 타계정 실적 */
											SELECT	CUST_ID,
													SALE_DATE,
													SUM(QTY)	QTY
											FROM	CUST_ETC_ACT	D1,
													(
													SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	END_DATE(+)	= '99991231'
													AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
												#if("$!{in_sel_gubn}" == "01")	
													AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
												#elseif("$!{in_sel_gubn}" == "05")
													AND		(--품종 대중소
															('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
															OR
															('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
															OR
															('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
															)
												#else
													AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
												#end
													)				D2
											WHERE	SALE_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
											AND		D1.ITEM_ID	= D2.ITEM_ID
											GROUP
											BY		CUST_ID,
													SALE_DATE
										#end
											)		T2
									WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
									AND		T1.CUST_ID		= T2.CUST_ID(+)
									UNION	ALL
									/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
									SELECT	T1.CUST_ID,
											T1.SALE_DATE,
											NVL(T2.QTY,0)		SELL_BOX
									FROM	(
											SELECT	CAL_DATE	SALE_DATE,
													CUST_ID
											FROM	CAL_MST,
													(
													/* 거래처코드 */
													SELECT	CUST_CODE	CUST_ID
													FROM	SDSTT101
													)
											WHERE	HOLIDAY_FLAG	IS NULL
											AND		CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
											)		T1,
											(
											SELECT  A.SOLD_PART							CUST_ID,
													TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
													SUM(
														CASE
														WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
															CASE
															WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
																DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
															ELSE
																-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
															END
														ELSE
															DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
														END
													)									QTY        
											FROM    SDORT101    A,
													SDORT102    B,
													(
													SELECT	CODE		ITEM_CATG,
															CODE_NAME4	SIGN1
													FROM	SDSTT500
													WHERE	CODE_GUBN	= 'OR103'
													AND		CODE_NAME2	= 'Y'
													AND		CODE_NAME3	= '01'
													)			D
											WHERE   A.SLIP_NO		= B.SLIP_NO
											AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
											AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
											AND		B.ITEM_CATG			= D.ITEM_CATG(+)
											AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
											AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
											AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
											#if("$!{in_act_type}" == '01')		-- 일반
												AND		NVL(D.ITEM_CATG,'TA') != 'TA'
											#elseif("$!{in_act_type}" == '02') -- 타계정
												AND		NVL(D.ITEM_CATG,'TA') = 'TA'
											#end
											GROUP 
											BY		A.SOLD_PART,
													A.CNFM_DATE,
													D.ITEM_CATG	
											)		T2
									WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
									AND		T1.CUST_ID		= T2.CUST_ID(+)
									)			K1,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			K2,
									(
									/* 지점-거래처-출고장-거래처유형 MAPPING */
									SELECT	T1.CUST_CODE											CUST_ID,
											T2.CUST_NAME											CUST_NAME,
											NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
											NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
											NVL(MIN(GRUP_CODE1),'99')								CUST_TYPE
									FROM	SDSTT103	T1,
											SDSTT101	T2
									WHERE	T1.CUST_CODE	= T2.CUST_CODE
									GROUP
									BY		T1.CUST_CODE,
											T2.CUST_NAME
									)			K3
							WHERE	K1.CUST_ID		= K3.CUST_ID
							AND		K2.DEPT_CODE	= K3.DEPT_CODE
							GROUP
							BY		K3.CUST_TYPE,
									K1.SALE_DATE
							)
					GROUP
					BY		CUST_TYPE
					)			K9
			WHERE	K1.CUST_ID		= K3.CUST_ID
			AND		K2.DEPT_CODE	= K3.DEPT_CODE
			AND		K3.CUST_TYPE	= K9.CUST_TYPE
			HAVING	(SUM(PRE_MON_SELL)+SUM(SUM_BOX)) != 0	
			GROUP
			BY		K3.CUST_TYPE,
					K9.MAX_SELL,
					K9.STD_DEV,
					K9.AVG_SELL
			ORDER
			BY		K3.CUST_TYPE
		
		#elseif("$!{in_sel_type}" == "80")
		
			/* 배송지점 단위 */
			SELECT	K1.DELIV_LOC,
					f_getDCName(K1.DELIV_LOC)			DELIV_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(TOT_CUST)			TOT_CUST,
					SUM(REAL_CUST)			REAL_CUST,
					SUM(SUPL_RATE)			SUPL_RATE,
					SUM(GOAL_BOX)			GOAL_BOX,
					SUM(PLAN_BOX)			PLAN_BOX,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY K1.DELIV_LOC),2)        
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	DELIV_LOC,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	DELIV_LOC,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
									SELECT	DELIV_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
															)
									AND		D1.ITEM_ID		= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		DELIV_LOC,
											SALE_DATE
									)
							GROUP
							BY		DELIV_LOC
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	DELIV_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.DELIV_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											DELIV_LOC
									FROM	CAL_MST,
											(
											SELECT	DC_ID			DELIV_LOC,
													DC_SHORT_NAME
											FROM	DC_MST
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	DELIV_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
															)
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		DELIV_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.DELIV_LOC	= T2.DELIV_LOC(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.DELIV_LOC,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											DELIV_LOC
									FROM	CAL_MST,
											(
											SELECT	DC_ID			DELIV_LOC,
													DC_SHORT_NAME
											FROM	DC_MST
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT  A.STOR_CODE							DELIV_LOC,
											TO_DATE(A.CNFM_DATE,'YYYY-MM-DD')	SALE_DATE,
											SUM(
												CASE
												WHEN D.ITEM_CATG IS NULL THEN /* 타계정 실적이다 */
													CASE
													WHEN SUBSTR(B.ITEM_CATG,1,2) = 'YO' THEN
														DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													ELSE
														-1*DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX)
													END
												ELSE
													DECODE(B.UPDT_GUBN,'01',B.REQT_BOX,B.SELL_BOX) * D.SIGN1
												END
											)									QTY        
									FROM    SDORT101    A,
											SDORT102    B,
											(
											SELECT	CODE		ITEM_CATG,
													CODE_NAME4	SIGN1
											FROM	SDSTT500
											WHERE	CODE_GUBN	= 'OR103'
											AND		CODE_NAME2	= 'Y'
											AND		CODE_NAME3	= '01'
											)			D
									WHERE   A.SLIP_NO		= B.SLIP_NO
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,1)	= 'Y'
									AND		SUBSTR(A.SLIP_GUBN_CODE,1,2)	NOT IN ('YR') /* 반품 제외 */
									AND		B.ITEM_CATG			= D.ITEM_CATG(+)
									AND		B.PROD_CODE			IN
																(
																SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
																FROM	ITEM_HIST	T1,
																		ITEM_MST	T2
																WHERE	END_DATE(+)	= '99991231'
																AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
															#if("$!{in_sel_gubn}" == "01")	
																AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
															#elseif("$!{in_sel_gubn}" == "05")
																AND		(--품종 대중소
																		('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																		OR
																		('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																		)
															#else
																AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
															#end
																)
									AND		A.CNFM_DATE		IN
																(
																SELECT	YYYYMMDD
																FROM	CAL_MST
																WHERE	YYYYMMDD >=  TO_CHAR(SYSDATE,'YYYYMMDD')
																AND		YYYYMMDD BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
																)	
									AND		A.SOLD_PART	IN (SELECT CUST_CODE FROM SDSTT101)
									#if("$!{in_act_type}" == '01')		-- 일반
										AND		NVL(D.ITEM_CATG,'TA') != 'TA'
									#elseif("$!{in_act_type}" == '02') -- 타계정
										AND		NVL(D.ITEM_CATG,'TA') = 'TA'
									#end
									GROUP 
									BY		A.STOR_CODE,
											A.CNFM_DATE,
											D.ITEM_CATG	
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.DELIV_LOC	= T2.DELIV_LOC(+)
							)
					GROUP
					BY		DELIV_LOC
					UNION	ALL
					/* 총거래처, 실적거래처, 취급율 */
					SELECT	S1.	DELIV_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							S1.TOT_CUST										TOT_CUST,
							NVL(S2.REAL_CUST,0)								REAL_CUST,
							ROUND(NVL(S2.REAL_CUST,0)/S1.TOT_CUST*100,1)	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31   
					FROM	(
							SELECT	STOR_CODE			DELIV_LOC,
									COUNT(CUST_CODE)	TOT_CUST
							FROM	SDSTT103
							WHERE	TRAD_STOP_DATE	= '99991231'
							GROUP
							BY		STOR_CODE
							)	S1,
							(
							SELECT	DELIV_LOC			DELIV_LOC,
									COUNT(CUST_CODE)	REAL_CUST
							FROM	(
									SELECT	DISTINCT	T2.STOR_CODE	DELIV_LOC,
											T1.CUST_CODE		
									FROM	SDRDT103	T1,
											SDSTT103	T2
									WHERE	T1.CUST_CODE	= T2.CUST_CODE
									AND		T1.CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		T1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		T1.SELL_GUBN_CODE	= '01'
									AND		SELL_BOX &gt; 0
									)
							GROUP
							BY		DELIV_LOC
							)	S2
					WHERE	S1.DELIV_LOC	= S2.DELIV_LOC(+)
					UNION	ALL
					SELECT	DELIV_LOC,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							SUM(PLAN_BOX)	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31 
					FROM	(		
							/* 당월목표 */
							-- 출고장 목표 없다
							/* 판매계획 */
							SELECT	S1.DELIV_LOC,
									0											GOAL_BOX,
									SUM(NORMAL_QTY+PROM_QTY+SUPT_QTY+SAMP_QTY)	PLAN_BOX
							FROM	NFOS_SALES_PLAN_WEEKLY	S1,
									(
									SELECT	YYYY, VERSION, YYYYMMDD
									FROM	V_NFOS_PLAN_VERSION
									WHERE	CAL_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)						S2
							WHERE	S1.YYYY		= S2.YYYY
							AND		S1.VERSION	= S2.VERSION
							AND		S1.YYYYMMDD	= S2.YYYYMMDD
							AND		S1.ITEM_ID	IN
												(
												SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
												FROM	ITEM_HIST	T1,
														ITEM_MST	T2
												WHERE	END_DATE(+)	= '99991231'
												AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
											#if("$!{in_sel_gubn}" == "01")	
												AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
											#elseif("$!{in_sel_gubn}" == "05")
												AND		(--품종 대중소
														('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
														OR
														('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
														)
											#else
												AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
											#end
												)
							GROUP
							BY		S1.DELIV_LOC
							)
					GROUP
					BY		DELIV_LOC
					)			K1
			WHERE	TRIM(K1.DELIV_LOC)	IS NOT NULL	
			HAVING	SUM(PRE_MON_SELL) + SUM(SUM_BOX) != 0	
			GROUP
			BY		K1.DELIV_LOC
			ORDER
			BY		K1.DELIV_LOC	

		#elseif("$!{in_sel_type}" == "90")
		
			/* 품목 단위 */
			SELECT	K2.ITEM_ID,
					K2.ITEM_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(TOT_CUST)			TOT_CUST,
					SUM(REAL_CUST)			REAL_CUST,
					SUM(SUPL_RATE)			SUPL_RATE,
					SUM(GOAL_BOX)			GOAL_BOX,
					SUM(PLAN_BOX)			PLAN_BOX,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(RANK() OVER (ORDER BY K2.ITEM_ID),2)         
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	ITEM_ID,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31        
					FROM	(			
							SELECT	ITEM_ID,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
									SELECT	D2.ITEM_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID		 ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE		IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
															)
									AND		D1.ITEM_ID		= D2.OLD_ITEM_ID
									AND		D1.SALES_LOC	= D3.DEPT_CODE
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		D2.ITEM_ID,
											SALE_DATE
									)
							GROUP
							BY		ITEM_ID
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	ITEM_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.ITEM_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											ITEM_ID
									FROM	CAL_MST,
											(
											SELECT	K1.ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													AND		NEW_ITEM_ID = OLD_ITEM_ID
													/* ITEM_HIST에 존재않는 코드 */
													UNION	ALL
													SELECT	T2.ITEM_ID	NEW_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.NEW_ITEM_ID	
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	D2.ITEM_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
															)
									AND		D1.ITEM_ID	= D2.OLD_ITEM_ID
									AND		D1.SALES_LOC	= D3.DEPT_CODE
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		D2.ITEM_ID,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.ITEM_ID		= T2.ITEM_ID(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.ITEM_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											ITEM_ID
									FROM	CAL_MST,
											(
											SELECT	K1.ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													AND		NEW_ITEM_ID = OLD_ITEM_ID
													/* ITEM_HIST에 존재않는 코드 */
													UNION	ALL
													SELECT	T2.ITEM_ID	NEW_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.NEW_ITEM_ID	
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT	D1.ITEM_ID,
											DUE_DATE		SALE_DATE,
											SUM(QTY)	QTY
									FROM	NFOS_ORDER	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	IF_DTTM	= TRUNC(SYSDATE)
									AND		IF_DTTM BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		D1.ITEM_ID		= D2.OLD_ITEM_ID
									AND		D1.SELLER_ID	= D3.DEPT_CODE
									GROUP
									BY		D1.ITEM_ID,
											DUE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.ITEM_ID		= T2.ITEM_ID(+)
							)
					GROUP
					BY		ITEM_ID
					UNION	ALL
					/* 총거래처, 실적거래처, 취급율 */
					SELECT	S2.ITEM_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							S1.TOT_CUST										TOT_CUST,
							NVL(S2.REAL_CUST,0)								REAL_CUST,
							ROUND(NVL(S2.REAL_CUST,0)/S1.TOT_CUST*100,1)	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31   
					FROM	(
							SELECT	COUNT(CUST_CODE)	TOT_CUST
							FROM	SDSTT103	D1,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			D3
							WHERE	TRAD_STOP_DATE	= '99991231'
							AND		D1.DEPT_CODE	= D3.DEPT_CODE
							)	S1,
							(
							SELECT	ITEM_ID,
									COUNT(CUST_CODE)	REAL_CUST
							FROM	(
									SELECT	DISTINCT	D2.ITEM_ID,
											T1.CUST_CODE		
									FROM	SDRDT103	T1,
											SDSTT103	T2,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	T1.CUST_CODE	= T2.CUST_CODE
									AND		T1.CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		T1.PROD_CODE	= D2.OLD_ITEM_ID
									AND		T2.DEPT_CODE	= D3.DEPT_CODE
									AND		T1.SELL_GUBN_CODE	= '01'
									AND		SELL_BOX &gt; 0
									)
							GROUP
							BY		ITEM_ID
							)	S2
					UNION	ALL
					SELECT	ITEM_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							SUM(GOAL_BOX)	GOAL_BOX,
							SUM(PLAN_BOX)	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31 
					FROM	(		
							/* 당월목표 */
							SELECT	D2.ITEM_ID,
									SUM(GOAL_BOX)	GOAL_BOX,
									0				PLAN_BOX
							FROM	SDPLT102	D1,
									(
									SELECT	K2.OLD_ITEM_ID,
											K2.NEW_ITEM_ID ITEM_ID
									FROM	ITEM_MST	K1,
											(
											/* ITEM_HIST에 존재하는 신코드 */
											SELECT	NEW_ITEM_ID,
													OLD_ITEM_ID
											FROM	ITEM_HIST
											WHERE	END_DATE = '99991231'
											/* ITEM_HIST에 존재않는 코드 */
											UNION
											SELECT	T2.ITEM_ID	NEW_ITEM_ID,
													T2.ITEM_ID	OLD_ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
											AND		T2.ITYPE		IN ('HAWA','FERT')
											AND		T1.NEW_ITEM_ID		IS NULL
											)			K2
									WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
									)			D2,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			D3
							WHERE	CNFM_YYMM	= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
							AND		D1.PROD_CODE	= D2.OLD_ITEM_ID
							AND		D1.DEPT_CODE	= D3.DEPT_CODE
							GROUP
							BY		D2.ITEM_ID
							UNION	ALL
							/* 판매계획 */
							SELECT	D2.ITEM_ID,
									0											GOAL_BOX,
									SUM(NORMAL_QTY+PROM_QTY+SUPT_QTY+SAMP_QTY)	PLAN_BOX
							FROM	NFOS_SALES_PLAN_WEEKLY	S1,
									(
									SELECT	YYYY, VERSION, YYYYMMDD
									FROM	V_NFOS_PLAN_VERSION
									WHERE	CAL_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)						S2,
									(
									SELECT	K2.OLD_ITEM_ID,
											K2.NEW_ITEM_ID ITEM_ID
									FROM	ITEM_MST	K1,
											(
											/* ITEM_HIST에 존재하는 신코드 */
											SELECT	NEW_ITEM_ID,
													OLD_ITEM_ID
											FROM	ITEM_HIST
											WHERE	END_DATE = '99991231'
											/* ITEM_HIST에 존재않는 코드 */
											UNION
											SELECT	T2.ITEM_ID	NEW_ITEM_ID,
													T2.ITEM_ID	OLD_ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
											AND		T2.ITYPE		IN ('HAWA','FERT')
											AND		T1.NEW_ITEM_ID		IS NULL
											)			K2
									WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
									)			D2,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			D3
							WHERE	S1.YYYY		= S2.YYYY
							AND		S1.VERSION	= S2.VERSION
							AND		S1.YYYYMMDD	= S2.YYYYMMDD
							AND		S1.ITEM_ID	= D2.OLD_ITEM_ID
							AND		S1.SALES_LOC	= D3.DEPT_CODE
							GROUP
							BY		D2.ITEM_ID
							)
					GROUP
					BY		ITEM_ID
					)			K1,
					(
					SELECT	ITEM_ID,
							ITEM_NAME
					FROM	ITEM_MST
					WHERE	ITYPE	IN ('FERT','HAWA')
				#if("$!{in_sel_gubn}" == "01")	
					--AND		ITEM_ID	= '$!{in_item_id}'  --품목코드
				#elseif("$!{in_sel_gubn}" == "05")
					AND		(--품종 대중소
							('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
							)
				#else
					AND		HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
				#end					
					)			K2
			WHERE	K1.ITEM_ID	= K2.ITEM_ID	
			HAVING	SUM(PRE_MON_SELL) + SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.ITEM_ID,
					K2.ITEM_NAME
			ORDER
			BY		K2.ITEM_ID
			
		#elseif("$!{in_sel_type}" == "100")
		
			/* Top10_금액 단위 */
			SELECT	DENSE_RANK() OVER (ORDER BY SUM(AMOUNT) DESC) RANK,
					K2.ITEM_ID,
					K2.ITEM_NAME,
					SUM(PRE_MON_SELL)		PRE_MON_SELL,
					SUM(PRE_MEAN_SELL)		PRE_MEAN_SELL,
					SUM(PRE_MAX_SELL)		PRE_MAX_SELL,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(TOT_CUST)			TOT_CUST,
					SUM(REAL_CUST)			REAL_CUST,
					SUM(SUPL_RATE)			SUPL_RATE,
					SUM(GOAL_BOX)			GOAL_BOX,
					SUM(PLAN_BOX)			PLAN_BOX,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(D01)				D01,
					SUM(D02)				D02,
					SUM(D03)				D03,
					SUM(D04)				D04,
					SUM(D05)				D05,
					SUM(D06)				D06,
					SUM(D07)				D07,
					SUM(D08)				D08,
					SUM(D09)				D09,
					SUM(D10)				D10,
					SUM(D11)				D11,
					SUM(D12)				D12,
					SUM(D13)				D13,
					SUM(D14)				D14,
					SUM(D15)				D15,
					SUM(D16)				D16,
					SUM(D17)				D17,
					SUM(D18)				D18,
					SUM(D19)				D19,
					SUM(D20)				D20,
					SUM(D21)				D21,
					SUM(D22)				D22,
					SUM(D23)				D23,
					SUM(D24)				D24,
					SUM(D25)				D25,
					SUM(D26)				D26,
					SUM(D27)				D27,
					SUM(D28)				D28,
					SUM(D29)				D29,
					SUM(D30)				D30,
					SUM(D31)                D31,
					MOD(DENSE_RANK() OVER (ORDER BY SUM(AMOUNT) DESC),2)         
			FROM	(
					/* 전월실적, 전월일평균, 전월최대판매 */
					SELECT	ITEM_ID,
							PRE_MON_SELL,
							PRE_MEAN_SELL,
							PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31,
							0	AMOUNT        
					FROM	(			
							SELECT	ITEM_ID,
									SUM(QTY)		PRE_MON_SELL,
									ROUND(SUM(QTY)/(SELECT	COUNT(CAL_DATE)
											FROM	CAL_MST
											WHERE	CAL_DATE	BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
																	AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
											AND		HOLIDAY_FLAG	IS NULL
											),0)	PRE_MEAN_SELL,
									MAX(QTY)		PRE_MAX_SELL
							FROM	(
									SELECT	D2.ITEM_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TRUNC(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1),'MM')
															AND LAST_DAY(ADD_MONTHS(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),-1))
															)
									AND		D1.ITEM_ID		= D2.OLD_ITEM_ID
									AND		D1.SALES_LOC	= D3.DEPT_CODE
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		D2.ITEM_ID,
											SALE_DATE
									)
							GROUP
							BY		ITEM_ID
							)
					UNION	ALL
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	ITEM_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 0,SELL_BOX))	D01,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 1,SELL_BOX))	D02,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 2,SELL_BOX))	D03,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 3,SELL_BOX))	D04,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 4,SELL_BOX))	D05,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 5,SELL_BOX))	D06,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 6,SELL_BOX))	D07,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 7,SELL_BOX))	D08,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 8,SELL_BOX))	D09,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+ 9,SELL_BOX))	D10,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+10,SELL_BOX))	D11,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+11,SELL_BOX))	D12,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+12,SELL_BOX))	D13,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+13,SELL_BOX))	D14,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+14,SELL_BOX))	D15,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+15,SELL_BOX))	D16,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+16,SELL_BOX))	D17,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+17,SELL_BOX))	D18,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+18,SELL_BOX))	D19,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+19,SELL_BOX))	D20,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+20,SELL_BOX))	D21,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+21,SELL_BOX))	D22,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+22,SELL_BOX))	D23,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+23,SELL_BOX))	D24,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+24,SELL_BOX))	D25,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+25,SELL_BOX))	D26,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+26,SELL_BOX))	D27,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+27,SELL_BOX))	D28,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+28,SELL_BOX))	D29,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+29,SELL_BOX))	D30,
							SUM(DECODE(SALE_DATE,to_date('$!{in_fr_date}','YYYY-MM-DD')+30,SELL_BOX))	D31,
							SUM(AMOUNT)																	AMOUNT
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.ITEM_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX,
									NVL(T2.AMOUNT,0)	AMOUNT
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											ITEM_ID
									FROM	CAL_MST,
											(
											SELECT	K1.ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													AND		NEW_ITEM_ID = OLD_ITEM_ID
													/* ITEM_HIST에 존재않는 코드 */
													UNION	ALL
													SELECT	T2.ITEM_ID	NEW_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.NEW_ITEM_ID	
											)
									WHERE	CAL_DATE		BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	D2.ITEM_ID,
											SALE_DATE,
											SUM(QTY)	QTY,
											SUM(AMOUNT)	AMOUNT
									FROM	SALES_ACT	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	IN (
															SELECT	CAL_DATE
															FROM	CAL_MST
															WHERE	CAL_DATE BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
															)
									AND		D1.ITEM_ID	= D2.OLD_ITEM_ID
									AND		D1.SALES_LOC	= D3.DEPT_CODE
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		D2.ITEM_ID,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.ITEM_ID		= T2.ITEM_ID(+)
							UNION	ALL
							/* 오늘 이후는 주문에서 조회 -> 일반주문 ONLY */
							SELECT	T1.ITEM_ID,
									T1.SALE_DATE,
									NVL(T2.QTY,0)		SELL_BOX,
									0					AMOUNT
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											ITEM_ID
									FROM	CAL_MST,
											(
											SELECT	K1.ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													AND		NEW_ITEM_ID = OLD_ITEM_ID
													/* ITEM_HIST에 존재않는 코드 */
													UNION	ALL
													SELECT	T2.ITEM_ID	NEW_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.NEW_ITEM_ID	
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(SYSDATE) AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)		T1,
									(
									SELECT	D1.ITEM_ID,
											DUE_DATE		SALE_DATE,
											SUM(QTY)	QTY
									FROM	NFOS_ORDER	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	IF_DTTM	= TRUNC(SYSDATE)
									AND		IF_DTTM BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									AND		D1.ITEM_ID		= D2.OLD_ITEM_ID
									AND		D1.SELLER_ID	= D3.DEPT_CODE
									GROUP
									BY		D1.ITEM_ID,
											DUE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.ITEM_ID		= T2.ITEM_ID(+)
							)
					GROUP
					BY		ITEM_ID
					UNION	ALL
					/* 총거래처, 실적거래처, 취급율 */
					SELECT	S2.ITEM_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							S1.TOT_CUST										TOT_CUST,
							NVL(S2.REAL_CUST,0)								REAL_CUST,
							ROUND(NVL(S2.REAL_CUST,0)/S1.TOT_CUST*100,1)	SUPL_RATE,
							0	GOAL_BOX,
							0	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31,
							0	AMOUNT   
					FROM	(
							SELECT	COUNT(CUST_CODE)	TOT_CUST
							FROM	SDSTT103	D1,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			D3
							WHERE	TRAD_STOP_DATE	= '99991231'
							AND		D1.DEPT_CODE	= D3.DEPT_CODE
							)	S1,
							(
							SELECT	ITEM_ID,
									COUNT(CUST_CODE)	REAL_CUST
							FROM	(
									SELECT	DISTINCT	D2.ITEM_ID,
											T1.CUST_CODE		
									FROM	SDRDT103	T1,
											SDSTT103	T2,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	T1.CUST_CODE	= T2.CUST_CODE
									AND		T1.CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		T1.PROD_CODE	= D2.OLD_ITEM_ID
									AND		T2.DEPT_CODE	= D3.DEPT_CODE
									AND		T1.SELL_GUBN_CODE	= '01'
									AND		SELL_BOX &gt; 0
									)
							GROUP
							BY		ITEM_ID
							)	S2
					UNION	ALL
					SELECT	ITEM_ID,
							0	PRE_MON_SELL,
							0	PRE_MEAN_SELL,
							0	PRE_MAX_SELL,
							0	MAX_SELL,
							0	STD_DEV, 
							0	AVG_SELL,
							0	TOT_CUST,
							0	REAL_CUST,
							0	SUPL_RATE,
							SUM(GOAL_BOX)	GOAL_BOX,
							SUM(PLAN_BOX)	PLAN_BOX,
							0	SUM_BOX,
							0	D01,     
							0	D02,     
							0	D03,     
							0	D04,     
							0	D05,     
							0	D06,     
							0	D07,     
							0	D08,     
							0	D09,     
							0	D10,     
							0	D11,     
							0	D12,     
							0	D13,     
							0	D14,     
							0	D15,     
							0	D16,     
							0	D17,     
							0	D18,     
							0	D19,     
							0	D20,     
							0	D21,     
							0	D22,     
							0	D23,     
							0	D24,     
							0	D25,     
							0	D26,     
							0	D27,     
							0	D28,     
							0	D29,     
							0	D30,     
							0	D31,
							0	AMOUNT  
					FROM	(		
							/* 당월목표 */
							SELECT	D2.ITEM_ID,
									SUM(GOAL_BOX)	GOAL_BOX,
									0				PLAN_BOX
							FROM	SDPLT102	D1,
									(
									SELECT	K2.OLD_ITEM_ID,
											K2.NEW_ITEM_ID ITEM_ID
									FROM	ITEM_MST	K1,
											(
											/* ITEM_HIST에 존재하는 신코드 */
											SELECT	NEW_ITEM_ID,
													OLD_ITEM_ID
											FROM	ITEM_HIST
											WHERE	END_DATE = '99991231'
											/* ITEM_HIST에 존재않는 코드 */
											UNION
											SELECT	T2.ITEM_ID	NEW_ITEM_ID,
													T2.ITEM_ID	OLD_ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
											AND		T2.ITYPE		IN ('HAWA','FERT')
											AND		T1.NEW_ITEM_ID		IS NULL
											)			K2
									WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
									)			D2,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			D3
							WHERE	CNFM_YYMM	= TO_CHAR(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'YYYYMM')
							AND		D1.PROD_CODE	= D2.OLD_ITEM_ID
							AND		D1.DEPT_CODE	= D3.DEPT_CODE
							GROUP
							BY		D2.ITEM_ID
							UNION	ALL
							/* 판매계획 */
							SELECT	D2.ITEM_ID,
									0											GOAL_BOX,
									SUM(NORMAL_QTY+PROM_QTY+SUPT_QTY+SAMP_QTY)	PLAN_BOX
							FROM	NFOS_SALES_PLAN_WEEKLY	S1,
									(
									SELECT	YYYY, VERSION, YYYYMMDD
									FROM	V_NFOS_PLAN_VERSION
									WHERE	CAL_DATE	BETWEEN TO_DATE('$!{in_fr_date}','YYYY-MM-DD') AND TO_DATE('$!{in_to_date}','YYYY-MM-DD')
									)						S2,
									(
									SELECT	K2.OLD_ITEM_ID,
											K2.NEW_ITEM_ID	ITEM_ID
									FROM	ITEM_MST	K1,
											(
											/* ITEM_HIST에 존재하는 신코드 */
											SELECT	NEW_ITEM_ID	NEW_ITEM_ID,
													OLD_ITEM_ID	OLD_ITEM_ID
											FROM	ITEM_HIST
											WHERE	END_DATE = '99991231'
											/* ITEM_HIST에 존재않는 코드 */
											UNION
											SELECT	T2.ITEM_ID	NEW_ITEM_ID,
													T2.ITEM_ID	OLD_ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
											AND		T2.ITYPE		IN ('HAWA','FERT')
											AND		T1.NEW_ITEM_ID		IS NULL
											)			K2
									WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
									)			D2,
									(
									SELECT	DEPT_CODE,
											DEPT_NAME,
											PRIO_DEPT_CODE
									FROM	SDSTT401
									WHERE	DEPT_GRAD_CODE	= '40'
									AND		APPL_END_YYMM	= '999912'
									AND		SUPL_APPL_GUBN	IS NULL
									#if("$!{in_sales_loc}" != "0000")
										START
										WITH	DEPT_CODE		= '$!{in_sales_loc}'
										CONNECT
										BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
										AND		PRIOR APPL_END_YYMM	= '999912'
										AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
									#end
									)			D3
							WHERE	S1.YYYY		= S2.YYYY
							AND		S1.VERSION	= S2.VERSION
							AND		S1.YYYYMMDD	= S2.YYYYMMDD
							AND		S1.ITEM_ID	= D2.OLD_ITEM_ID
							AND		S1.SALES_LOC	= D3.DEPT_CODE
							GROUP
							BY		D2.ITEM_ID
							)
					GROUP
					BY		ITEM_ID
					)			K1,
					(
					SELECT	ITEM_ID,
							ITEM_NAME
					FROM	ITEM_MST
					WHERE	ITYPE	IN ('FERT','HAWA')
				#if("$!{in_sel_gubn}" == "01")	
					--AND		ITEM_ID	= '$!{in_item_id}'  --품목코드
				#elseif("$!{in_sel_gubn}" == "05")
					AND		(--품종 대중소
							('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
							)
				#else
					AND		HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
				#end										
					)			K2
			WHERE	K1.ITEM_ID	= K2.ITEM_ID	
			HAVING	SUM(PRE_MON_SELL) + SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.ITEM_ID,
					K2.ITEM_NAME
			ORDER
			BY		RANK

		#else
	
			SELECT	''
			FROM	DUAL
			WHERE	1 = 0
	
		#end

	#else
		/* 월간(M) */
		#if("$!{in_sel_type}" == "20")
	
			/* 사업부단위 조회(월간) */
			SELECT	K4.PRIO_DEPT_CODE,
					f_getSalesLocName(K4.PRIO_DEPT_CODE)	PRIO_DEPT_NAME,
					K4.DEPT_CODE							SALES_LOC,
					f_getSalesLocName(K4.DEPT_CODE)			DEPT_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K4.PRIO_DEPT_CODE),2)  
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	SALES_LOC,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.SALES_LOC,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
												SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							GROUP
							BY		T1.SALES_LOC,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		SALES_LOC
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					SDSTT401	K3,
					SDSTT401	K4
			WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
			AND		K2.PRIO_DEPT_CODE	= K3.DEPT_CODE
			AND		K3.APPL_END_YYMM	= '999912'
			AND		K3.DEPT_GRAD_CODE	= '30'
			AND		K3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */		
			AND		K3.PRIO_DEPT_CODE	= K4.DEPT_CODE
			AND		K4.APPL_END_YYMM	= '999912'
			AND		K4.DEPT_GRAD_CODE	= '20'
			AND		K4.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
			GROUP
			BY		K4.PRIO_DEPT_CODE,
					K4.DEPT_CODE
			ORDER
			BY		K4.PRIO_DEPT_CODE,
					K4.DEPT_CODE	
	
		#elseif("$!{in_sel_type}" == "30")
	
			/* 영업부단위 조회(월간) */
			SELECT	K3.PRIO_DEPT_CODE,
					f_getSalesLocName(K3.PRIO_DEPT_CODE)	PRIO_DEPT_NAME,
					K3.DEPT_CODE							SALES_LOC,
					f_getSalesLocName(K3.DEPT_CODE)			DEPT_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K3.PRIO_DEPT_CODE),2) 
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	SALES_LOC,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.SALES_LOC,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							GROUP
							BY		T1.SALES_LOC,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		SALES_LOC
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					SDSTT401	K3
			WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
			AND		K2.PRIO_DEPT_CODE	= K3.DEPT_CODE
			AND		K3.APPL_END_YYMM	= '999912'
			AND		K3.DEPT_GRAD_CODE	= '30'
			AND		K3.SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */		
			GROUP
			BY		K3.PRIO_DEPT_CODE,
					K3.DEPT_CODE
			ORDER
			BY		K3.PRIO_DEPT_CODE,
					K3.DEPT_CODE
		
		#elseif("$!{in_sel_type}" == "40")
		
			/* 지점단위 조회(월간) */
			SELECT	K2.PRIO_DEPT_CODE,
					f_getSalesLocName(K2.PRIO_DEPT_CODE)	PRIO_DEPT_NAME,
					K1.SALES_LOC,
					f_getSalesLocName(K1.SALES_LOC)			DEPT_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K2.PRIO_DEPT_CODE),2) 
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	SALES_LOC,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.SALES_LOC,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											SALES_LOC
									FROM	CAL_MST,
											(
											SELECT	DEPT_CODE	SALES_LOC
											FROM	SDSTT401
											WHERE	APPL_END_YYMM	= '999912'
											AND		DEPT_GRAD_CODE	= '40'
											AND		SUPL_APPL_GUBN	IS NULL /* 종결지점 제외 */
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	SALES_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		SALES_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.SALES_LOC	= T2.SALES_LOC(+)
							GROUP
							BY		T1.SALES_LOC,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		SALES_LOC
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2
			WHERE	K1.SALES_LOC	= K2.DEPT_CODE	
			GROUP
			BY		K2.PRIO_DEPT_CODE,
					K1.SALES_LOC
			ORDER
			BY		K2.PRIO_DEPT_CODE,
					K1.SALES_LOC
		
		#elseif("$!{in_sel_type}" == "50")	
		
			/* 거래처 단위(월간) */
			SELECT	K2.DEPT_CODE,
					K2.DEPT_NAME,
					K1.CUST_ID,
					K3.CUST_NAME			CUST_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K2.DEPT_CODE),2) 
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	CUST_ID,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							GROUP
							BY		T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		CUST_ID
					)			K1,
					(
					SELECT	DEPT_CODE,
							DEPT_NAME,
							PRIO_DEPT_CODE
					FROM	SDSTT401
					WHERE	DEPT_GRAD_CODE	= '40'
					AND		APPL_END_YYMM	= '999912'
					AND		SUPL_APPL_GUBN	IS NULL
					#if("$!{in_sales_loc}" != "0000")
						START
						WITH	DEPT_CODE		= '$!{in_sales_loc}'
						CONNECT
						BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
						AND		PRIOR APPL_END_YYMM	= '999912'
						AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
					#end
					)			K2,
					(
					/* 지점-거래처-출고장 MAPPING */
					SELECT	T1.CUST_CODE											CUST_ID,
							T2.CUST_NAME											CUST_NAME,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
							NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
							NVL(MIN(GRUP_CODE1),'99')								GRUP_CODE1
					FROM	SDSTT103	T1,
							SDSTT101	T2
					WHERE	T1.CUST_CODE	= T2.CUST_CODE
					GROUP
					BY		T1.CUST_CODE,
							T2.CUST_NAME		
					)			K3
			WHERE	K1.CUST_ID		= K3.CUST_ID
			AND		K2.DEPT_CODE	= K3.DEPT_CODE
			HAVING	SUM(SUM_BOX) != 0	
			GROUP
			BY		K2.DEPT_CODE,
					K2.DEPT_NAME,
					K1.CUST_ID,
					K3.CUST_NAME
			ORDER
			BY		SUM_BOX DESC	
		
		#elseif("$!{in_sel_type}" == "60")
		
			/* 유통본부 단위(월간) */
			SELECT	K1.GRUP_CODE1,
					f_get_code_name('GRUP_CODE1',K1.GRUP_CODE1)			CUST_NAME,
					MAX(SELL_BOX)				MAX_SELL,
					ROUND(STDDEV(SELL_BOX),0)	STD_DEV,
					ROUND(AVG(SELL_BOX),0)		AVG_SELL,
					SUM(SELL_BOX)				SUM_BOX,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12,
					MOD(DENSE_RANK() OVER (ORDER BY K1.GRUP_CODE1),2)
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	S3.GRUP_CODE1,
							TRUNC(S1.SALE_DATE,'MM')	SALE_DATE,
							SUM(SELL_BOX)				SELL_BOX
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	HOLIDAY_FLAG	IS NULL
									AND		CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							GROUP
							BY		T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')
							)	S1,
							(
							SELECT	DEPT_CODE,
									DEPT_NAME,
									PRIO_DEPT_CODE
							FROM	SDSTT401
							WHERE	DEPT_GRAD_CODE	= '40'
							AND		APPL_END_YYMM	= '999912'
							AND		SUPL_APPL_GUBN	IS NULL
							#if("$!{in_sales_loc}" != "0000")
								START
								WITH	DEPT_CODE		= '$!{in_sales_loc}'
								CONNECT
								BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
								AND		PRIOR APPL_END_YYMM	= '999912'
								AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
							#end
							)	S2,
							(
							/* 지점-거래처-출고장-유통본부 MAPPING */
							SELECT	T1.CUST_CODE											CUST_ID,
									T2.CUST_NAME											CUST_NAME,
									NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
									NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
									MIN(T2.GRUP_CODE)										GRUP_CODE1
							FROM	SDSTT103	T1,
									SDSTT101	T2
							WHERE	T1.CUST_CODE	= T2.CUST_CODE
							AND		TRIM(GRUP_CODE)	IN (
									SELECT	CODE
									FROM	SDSTT500
									WHERE	CODE_GUBN	= 'ST115')
							GROUP
							BY		T1.CUST_CODE,
									T2.CUST_NAME										
							)	S3
					WHERE	S1.CUST_ID		= S3.CUST_ID
					AND		S2.DEPT_CODE	= S3.DEPT_CODE
					GROUP
					BY		S3.GRUP_CODE1,
							TRUNC(S1.SALE_DATE,'MM')
					)			K1
			GROUP
			BY		K1.GRUP_CODE1
			ORDER
			BY		K1.GRUP_CODE1
		
		#elseif("$!{in_sel_type}" == "70")
		
			/* 거래처유형 단위(월간) */
			SELECT	K1.CUST_TYPE,
					f_get_code_name('FCST_GRPCD',K1.CUST_TYPE)			CUST_TYPE_NAME,
					MAX(SELL_BOX)				MAX_SELL,
					ROUND(STDDEV(SELL_BOX),0)	STD_DEV,
					ROUND(AVG(SELL_BOX),0)		AVG_SELL,
					SUM(SELL_BOX)				SUM_BOX,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
					SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12,
					MOD(DENSE_RANK() OVER (ORDER BY K1.CUST_TYPE),2)
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	S3.CUST_TYPE,
							TRUNC(S1.SALE_DATE,'MM')	SALE_DATE,
							SUM(SELL_BOX)				SELL_BOX
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											CUST_ID
									FROM	CAL_MST,
											(
											/* 거래처코드 */
											SELECT	CUST_CODE	CUST_ID
											FROM	SDSTT101
											)
									WHERE	HOLIDAY_FLAG	IS NULL
									AND		CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
								#if("$!{in_act_type}" != "02")	
									/* 영업 일반실적 */
									SELECT	CUST_CODE	CUST_ID,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD') SALE_DATE,
											SUM(SELL_BOX)	QTY
									FROM	SDRDT103	D1
									WHERE	CNFM_DATE	BETWEEN REPLACE('$!{in_fr_date}','-','') AND REPLACE('$!{in_to_date}','-','')
									AND		D1.PROD_CODE	IN
															(
															SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
															FROM	ITEM_HIST	T1,
																	ITEM_MST	T2
															WHERE	END_DATE(+)	= '99991231'
															AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
														#if("$!{in_sel_gubn}" == "01")	
															AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
														#elseif("$!{in_sel_gubn}" == "05")
															AND		(--품종 대중소
																	('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
																	OR
																	('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
																	)
														#else
															AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
														#end
															)
									AND		SELL_GUBN_CODE	= '01'
									GROUP
									BY		CUST_CODE,
											TO_DATE(CNFM_DATE,'YYYY-MM-DD')
								#end
								#if("$!{in_act_type}" == "00")
									UNION	ALL
								#end
								#if("$!{in_act_type}" != "01")
									/* 거래처 타계정 실적 */
									SELECT	CUST_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	CUST_ETC_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)				D2
									WHERE	SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
									GROUP
									BY		CUST_ID,
											SALE_DATE
								#end
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.CUST_ID		= T2.CUST_ID(+)
							GROUP
							BY		T1.CUST_ID,
									TRUNC(T1.SALE_DATE,'MM')
							)	S1,
							(
							SELECT	DEPT_CODE,
									DEPT_NAME,
									PRIO_DEPT_CODE
							FROM	SDSTT401
							WHERE	DEPT_GRAD_CODE	= '40'
							AND		APPL_END_YYMM	= '999912'
							AND		SUPL_APPL_GUBN	IS NULL
							#if("$!{in_sales_loc}" != "0000")
								START
								WITH	DEPT_CODE		= '$!{in_sales_loc}'
								CONNECT
								BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
								AND		PRIOR APPL_END_YYMM	= '999912'
								AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
							#end
							)	S2,
							(
							/* 지점-거래처-출고장-거래처유형 MAPPING */
							SELECT	T1.CUST_CODE											CUST_ID,
									T2.CUST_NAME											CUST_NAME,
									NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),1,3)),'999')	DEPT_CODE,
									NVL(TRIM(SUBSTR(MIN(DEPT_CODE||STOR_CODE),4,4)),'8000')	STOR_CODE,
									NVL(MIN(GRUP_CODE1),'99')								CUST_TYPE
							FROM	SDSTT103	T1,
									SDSTT101	T2
							WHERE	T1.CUST_CODE	= T2.CUST_CODE
							GROUP
							BY		T1.CUST_CODE,
									T2.CUST_NAME									
							)	S3
					WHERE	S1.CUST_ID		= S3.CUST_ID
					AND		S2.DEPT_CODE	= S3.DEPT_CODE
					AND		TRIM(S3.CUST_TYPE)	IS NOT NULL
					GROUP
					BY		S3.CUST_TYPE,
							TRUNC(S1.SALE_DATE,'MM')
					)			K1
			GROUP
			BY		K1.CUST_TYPE
			ORDER
			BY		K1.CUST_TYPE
		
		#elseif("$!{in_sel_type}" == "80")
		
			/* 배송지점 단위(월간) */
			SELECT	K1.DELIV_LOC,
					f_getDCName(K1.DELIV_LOC)			DELIV_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K1.DELIV_LOC),2)
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	DELIV_LOC,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.DELIV_LOC,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											DELIV_LOC
									FROM	CAL_MST,
											(
											SELECT	DC_ID			DELIV_LOC,
													DC_SHORT_NAME
											FROM	DC_MST
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	DELIV_LOC,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	NVL(OLD_ITEM_ID,T2.ITEM_ID)	ITEM_ID
											FROM	ITEM_HIST	T1,
													ITEM_MST	T2
											WHERE	END_DATE(+)	= '99991231'
											AND		NEW_ITEM_ID(+)	= T2.ITEM_ID
										#if("$!{in_sel_gubn}" == "01")	
											AND		T2.ITEM_ID	= '$!{in_item_id}'  --품목코드
										#elseif("$!{in_sel_gubn}" == "05")
											AND		(--품종 대중소
													('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
													OR
													('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
													)
										#else
											AND		T2.HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
										#end
											)			D2
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.ITEM_ID
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		DELIV_LOC,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.DELIV_LOC	= T2.DELIV_LOC(+)
							GROUP
							BY		T1.DELIV_LOC,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		DELIV_LOC
					)			K1
			WHERE	TRIM(K1.DELIV_LOC)	IS NOT NULL	
			GROUP
			BY		K1.DELIV_LOC
			ORDER
			BY		K1.DELIV_LOC	
	
		#elseif("$!{in_sel_type}" == "90")
		
			/* 품목별 조회(월간) */
			SELECT	K2.ITEM_ID,
					K2.ITEM_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY K2.ITEM_ID),2)
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	ITEM_ID,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.ITEM_ID,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											ITEM_ID
									FROM	CAL_MST,
											(
											SELECT	K1.ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													AND		NEW_ITEM_ID = OLD_ITEM_ID
													/* ITEM_HIST에 존재않는 코드 */
													UNION	ALL
													SELECT	T2.ITEM_ID	NEW_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.NEW_ITEM_ID	
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	D2.ITEM_ID,
											SALE_DATE,
											SUM(QTY)	QTY
									FROM	SALES_ACT	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.OLD_ITEM_ID
									AND		D1.SALES_LOC	= D3.DEPT_CODE
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		D2.ITEM_ID,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.ITEM_ID		= T2.ITEM_ID(+)
							GROUP
							BY		T1.ITEM_ID,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		ITEM_ID
					)			K1,
					(
					SELECT	ITEM_ID,
							ITEM_NAME
					FROM	ITEM_MST
					WHERE	ITYPE	IN ('FERT','HAWA')
				#if("$!{in_sel_gubn}" == "01")	
					--AND		ITEM_ID	= '$!{in_item_id}'  --품목코드
				#elseif("$!{in_sel_gubn}" == "05")
					AND		(--품종 대중소
							('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
							)
				#else
					AND		HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
				#end										
					)			K2
			WHERE	K1.ITEM_ID	= K2.ITEM_ID	
			GROUP
			BY		K2.ITEM_ID,
					K2.ITEM_NAME
			ORDER
			BY		K2.ITEM_ID

		#elseif("$!{in_sel_type}" == "100")
		
			/* Top10_금액(월간) */
			SELECT	DENSE_RANK() OVER (ORDER BY SUM(AMOUNT) DESC) RANK,
					K2.ITEM_ID,
					K2.ITEM_NAME,
					SUM(MAX_SELL)			MAX_SELL,
					SUM(STD_DEV)			STD_DEV,
					SUM(AVG_SELL)			AVG_SELL,
					SUM(SUM_BOX)			SUM_BOX,
					SUM(M01)				M01,
					SUM(M02)				M02,
					SUM(M03)				M03,
					SUM(M04)				M04,
					SUM(M05)				M05,
					SUM(M06)				M06,
					SUM(M07)				M07,
					SUM(M08)				M08,
					SUM(M09)				M09,
					SUM(M10)				M10,
					SUM(M11)				M11,
					SUM(M12)				M12,
					MOD(DENSE_RANK() OVER (ORDER BY SUM(AMOUNT) DESC),2)
			FROM	(
					/* 기간 최대판매, 표준편차, 기간평균, 일자별 실적 */
					SELECT	ITEM_ID,
							ROUND(MAX(SELL_BOX),0)												MAX_SELL,
							ROUND(STDDEV(SELL_BOX),0)											STD_DEV,
							ROUND(AVG(SELL_BOX),0)												AVG_SELL,
							SUM(SELL_BOX)														SUM_BOX,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 0),SELL_BOX))	M01,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 1),SELL_BOX))	M02,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 2),SELL_BOX))	M03,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 3),SELL_BOX))	M04,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 4),SELL_BOX))	M05,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 5),SELL_BOX))	M06,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 6),SELL_BOX))	M07,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 7),SELL_BOX))	M08,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 8),SELL_BOX))	M09,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'), 9),SELL_BOX))	M10,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),10),SELL_BOX))	M11,
							SUM(DECODE(SALE_DATE,ADD_MONTHS(TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM'),11),SELL_BOX))	M12,
							SUM(AMOUNT)																							AMOUNT
					FROM	(				
							/* 실적에서 조회 */
							SELECT	T1.ITEM_ID,
									TRUNC(T1.SALE_DATE,'MM')	SALE_DATE,
									SUM(NVL(T2.QTY,0))			SELL_BOX,
									SUM(NVL(T2.AMOUNT,0))		AMOUNT
							FROM	(
									SELECT	CAL_DATE	SALE_DATE,
											ITEM_ID
									FROM	CAL_MST,
											(
											SELECT	K1.ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													AND		NEW_ITEM_ID = OLD_ITEM_ID
													/* ITEM_HIST에 존재않는 코드 */
													UNION	ALL
													SELECT	T2.ITEM_ID	NEW_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.NEW_ITEM_ID	
											)
									WHERE	CAL_DATE		BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		CAL_DATE		&lt; TRUNC(SYSDATE)
									)		T1,
									(
									SELECT	D2.ITEM_ID,
											SALE_DATE,
											SUM(QTY)	QTY,
											SUM(AMOUNT)	AMOUNT
									FROM	SALES_ACT	D1,
											(
											SELECT	K2.OLD_ITEM_ID,
													K2.NEW_ITEM_ID ITEM_ID
											FROM	ITEM_MST	K1,
													(
													/* ITEM_HIST에 존재하는 신코드 */
													SELECT	NEW_ITEM_ID,
															OLD_ITEM_ID
													FROM	ITEM_HIST
													WHERE	END_DATE = '99991231'
													/* ITEM_HIST에 존재않는 코드 */
													UNION
													SELECT	T2.ITEM_ID	NEW_ITEM_ID,
															T2.ITEM_ID	OLD_ITEM_ID
													FROM	ITEM_HIST	T1,
															ITEM_MST	T2
													WHERE	T1.OLD_ITEM_ID(+)	= T2.ITEM_ID
													AND		T2.ITYPE		IN ('HAWA','FERT')
													AND		T1.NEW_ITEM_ID		IS NULL
													)			K2
											WHERE	K1.ITEM_ID	= K2.OLD_ITEM_ID
											)			D2,
											(
											SELECT	DEPT_CODE,
													DEPT_NAME,
													PRIO_DEPT_CODE
											FROM	SDSTT401
											WHERE	DEPT_GRAD_CODE	= '40'
											AND		APPL_END_YYMM	= '999912'
											AND		SUPL_APPL_GUBN	IS NULL
											#if("$!{in_sales_loc}" != "0000")
												START
												WITH	DEPT_CODE		= '$!{in_sales_loc}'
												CONNECT
												BY		PRIOR DEPT_CODE 		= PRIO_DEPT_CODE
												AND		PRIOR APPL_END_YYMM	= '999912'
												AND		PRIOR DEPT_GRAD_CODE	&lt; '40'
											#end
											)			D3
									WHERE	D1.DOMAIN IN ('DO','EX')
									AND		SALE_DATE	BETWEEN TRUNC(TO_DATE('$!{in_fr_date}','YYYY-MM-DD'),'MM') AND TRUNC(LAST_DAY(TO_DATE('$!{in_to_date}','YYYY-MM-DD')))
									AND		D1.ITEM_ID	= D2.OLD_ITEM_ID
									AND		D1.SALES_LOC	= D3.DEPT_CODE
								#if("$!{in_act_type}" != "00")
									AND		ACT_TYPE	= '$!{in_act_type}'
								#end
									GROUP
									BY		D2.ITEM_ID,
											SALE_DATE
									)		T2
							WHERE	T1.SALE_DATE	= T2.SALE_DATE(+)
							AND		T1.ITEM_ID		= T2.ITEM_ID(+)
							GROUP
							BY		T1.ITEM_ID,
									TRUNC(T1.SALE_DATE,'MM')
							)
					GROUP
					BY		ITEM_ID
					)			K1,
					(
					SELECT	ITEM_ID,
							ITEM_NAME
					FROM	ITEM_MST
					WHERE	ITYPE	IN ('FERT','HAWA')
				#if("$!{in_sel_gubn}" == "01")	
					--AND		ITEM_ID	= '$!{in_item_id}'  --품목코드
				#elseif("$!{in_sel_gubn}" == "05")
					AND		(--품종 대중소
							('$!{in_item_name}' LIKE '대_%' AND SALES_CAT01 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '중_%' AND SALES_CAT02 = '$!{in_item_id}')
							OR
							('$!{in_item_name}' LIKE '소_%' AND SALES_CAT03 = '$!{in_item_id}')
							)
				#else
					AND		HR_TY1 LIKE '$!{in_item_id}'||'%' --사업코드,브랜드,대표코드
				#end										

					)			K2
			WHERE	K1.ITEM_ID	= K2.ITEM_ID	
			GROUP
			BY		K2.ITEM_ID,
					K2.ITEM_NAME
			ORDER
			BY		RANK

		#else
	
			SELECT	/* 월간 */
					''
			FROM	DUAL
			WHERE	1 = 0
	
		#end

	#end
	
	#end

	</query>	
	
<!--
=====================================================================================================
 끝  
=====================================================================================================
--> 

</queries>
